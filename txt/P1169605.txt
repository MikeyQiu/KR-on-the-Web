Accurate Temporal Action Proposal Generation with
Relation-Aware Pyramid Network

Jialin Gao1, Zhixiang Shi2, Jiani Li2, Guanshuo Wang1,
Yufeng Yuan2, Shiming Ge3∗, and Xi Zhou1,2
1Cooperative Medianet Innovation Center, Shanghai Jiao Tong University
2CloudWalk Technology Co., Ltd, China
3 Institute of Information Engineering, Chinese Academy of Sciences
{shizhixiang, lijiani, yuanyufeng, zhouxi}@cloudwalk.cn, {jialin gao,guanshuo.wang}@sjtu.edu.cn, geshiming@iie.ac.cn

0
2
0
2
 
r
a

M
 
9
 
 
]

V
C
.
s
c
[
 
 
1
v
5
4
1
4
0
.
3
0
0
2
:
v
i
X
r
a

Abstract

Accurate temporal action proposals play an important role in
detecting actions from untrimmed videos. The existing ap-
proaches have difﬁculties in capturing global contextual in-
formation and simultaneously localizing actions with differ-
ent durations. To this end, we propose a Relation-aware pyra-
mid Network (RapNet) to generate highly accurate tempo-
ral action proposals. In RapNet, a novel relation-aware mod-
ule is introduced to exploit bi-directional long-range relations
between local features for context distilling. This embedded
module enhances the RapNet in terms of its multi-granularity
temporal proposal generation ability, given predeﬁned anchor
boxes. We further introduce a two-stage adjustment scheme
to reﬁne the proposal boundaries and measure their conﬁ-
dence in containing an action with snippet-level actionness.
Extensive experiments on the challenging ActivityNet and
THUMOS14 benchmarks demonstrate our RapNet generates
superior accurate proposals over the existing state-of-the-art
methods.

Introduction
Temporal action proposal generation aims to propose candi-
date instances that probably contain an action from a long,
untrimmed video. Localizing human activities is of increas-
ing importance as it brings about a wide variety of appli-
cation in industry and serves as the basis in many research
areas, like action detection(Zhao et al. 2017), video summa-
rization (Gong et al. 2014; Yao, Mei, and Rui 2016), cap-
tioning (Wang et al. 2018b; Wang et al. 2018a), etc.

Current methods are mainly divided into two categories:
sliding-windows and snippet-level actionness score. The
former (Shou, Wang, and Chang 2016; Shou et al. 2017)
slides several manually deﬁned windows to generate pro-
posals with imprecise temporal boundaries and rank them
via a binary classiﬁer. Instead, the latter (Xiong et al. 2017;
Yuan et al. 2017) generates candidate instances with high
precision boundaries by actionness score grouping (Zhao et
al. 2017). But it has incorrect and omitted candidates due to
the difﬁculty in identifying action without long-term contex-
tual information.

∗Shiming Ge is the corresponding author.

Copyright c(cid:13) 2020, Association for the Advancement of Artiﬁcial
Intelligence (www.aaai.org). All rights reserved.

Figure 1: For action localization, two crucial issues lie in (a)
how to simultaneously localize action instances with various
durations, and (b) how to distill long-range context to cap-
ture informative contents for high precision boundaries. The
former can be solved by pyramid prediction and the latter
needs a novel context distilling module.

Several attempts have been made to overcome these draw-
backs. Boundary sensitive network (BSN) (Lin et al. 2018)
identiﬁes each snippet to be either starting, ending or course
for generating proposals with various durations. Comple-
mentary Temporal Action Proposal (CTAP) (Gao, Chen, and
Nevatia 2018) alleviates the problem of missing contextual
information by combining the results with window-based
methods. However, they only consider the complementary
characteristics of these two types of methods, while do not
address their intrinsic difﬁculties.

In order to address difﬁculties in accurately localizing ac-
tions, we refer to the perception mechanism of human. Con-
sidering a complete action may last from a second to sev-
eral minutes, humans prefer to skim though long instances
quickly while oversee short ones carefully in order to focus
on informative contents rather than backgrounds. To accu-
rately discriminate the starting and ending of an action, we
humans usually relate the present to the long-range contex-
tual information. These reveal two key factors relating to ac-
curate temporal proposal generation: how to simultaneously
detect actions in multi-scales and how to distill long-range
context. As shown in Fig.1, the context distilling block is re-
quired to extract long-range contextual information for aug-

menting corresponding local features, which are responsible
for generating multi-granularity action proposals.

For accurate action instance localization, the ﬁrst factor
could guarantee the generated proposals adaptive to various
duration of actions, and the second factor is introduced to
distinguish action contents from backgrounds for high preci-
sion boundary. To this end, a proposal generation approach
is required to capture long-range contextual information at
different temporal scales and then augment the correspond-
ing local features. Previous bottom-up methods, although
useful in locating action boundaries and prediction action-
ness score, are based only on local information and ignore
the long-range contextual information.

Therefore, a Relation-aware-pyramid Network (RapNet)
is proposed to generate accurate temporal action propos-
als. We ﬁrstly introduce a novel Relation-Aware Module
(RAM) to exploit long-range contextual information, which
is ignored in previous methods. This module captures bi-
directional relations between local patterns as context dis-
tilling, in order to relate the present local content to both the
past and future. Temporal information is squeezed within the
module to generate channel-wise mean statistics as a global
context for augmenting the corresponding local information.
Afterward, by embedding this module, the RapNet en-
hances its ability to generate multi-scales temporal action
proposals with high precision boundaries, given predeﬁned
anchor boxes by K-means clustering. Speciﬁcally, a global
context extractor employs a RAM to boost local features
with holistic information. Then a U-shape net with skip con-
nections is developed to construct a bottom-up feature pyra-
mid set, which is used to generate candidates in multi tem-
poral scales via separate generators.

Moreover, considering the precise boundaries of proposal
generated by actionness score grouping, we also predict
snippet-level actionness score to adjust the boundaries of
proposal candidates from RapNet and measure their conﬁ-
dence of containing an action in terms of proposal-level fea-
ture.

Finally, we conduct extensive experiments on the chal-
lenging THUMOS-14 and ActivityNet-v1.3 benchmarks to
demonstrate the effectiveness of our RapNet and relation-
aware module. In summary, our contributions are three-fold:

1) We propose a novel context distilling mechanism en-
hanced with pyramid networks to accurately generate
multi-granularity proposals, which captures long-range
contextual information at different temporal scales to aug-
ment local features.

2) We propose the relation-aware module, as an exemplar
of context distilling, to exploit bidirectional relations
between any two temporal locations, which relates the
present content to both the past and future for augment-
ing multi-granularity temporal proposal generation.

3) Our RapNet achieves the state-of-the-art performance on
the THUMOS-14 and ActivityNet-v1.3 datasets for the
temporal action proposal task and surpasses other meth-
ods by a considerable margin.

Related Work
Temporal Action Proposal Generation. There are two
types of methods for this task, which are sliding windows
and actionness score. SCNN-prop (Shou, Wang, and Chang
2016) regards this task as training a C3D network for binary
classiﬁcation task when generating segmental proposals. For
generating precise candidates, TAG (Zhao et al. 2017), serv-
ing as a typical actionness-based method, adopts watershed
algorithm to group contiguous high-score as proposals. BSN
(Lin et al. 2018) additionally predicts whether each temporal
point is the starting or ending point of an action and evalu-
ates proposals based on proposal-level feature. CTAP (Gao,
Chen, and Nevatia 2018) takes advantage of both segment
proposal and snippet-level actionness based methods to re-
organize the candidate set. MGG (Liu et al. 2019) embeds
the temporal location information and employs a bilinear
matching module. However, these approaches are based on
local information and ignore the global context, which is ex-
pected to be useful in accurately locating action boundaries
and predicting actionness score.

Action Recognition and detection. Action recognition
is the primary issue of video understanding and has been
extensively studied. Recent, long-range dependencies is of
central importance. Non-local network (Wang et al. 2018c)
introduces traditional non-local algorithm into CNNs. LFB
(Wu et al. 2019) designs a long-term feature bank to improve
state-of-the-art video models. These ﬁndings inspire us the
importance of global contextual information and long-range
dependency in video understanding.

Action detection focuses on detecting what the activity
is and when it starts and ends in untrimmed video. S-CNN
(Shou, Wang, and Chang 2016) adopts the ”proposal + clas-
siﬁcation” paradigm to tackle this problem using multi-stage
CNNs. SSN (Zhao et al. 2017) designs a structured temporal
pyramid architecture to hierarchically construct action pro-
posals and then distinguish whether them are completed or
not via two classiﬁers. Single Shot Action Detector (SSAD)
(Lin, Zhao, and Shou 2017) draws on the method of object
detection and detects action instances directly.

Relation-Aware Pyramid Network
Based on the above analysis, we propose a context distill-
ing mechanism to capture long-range contexts in different
temporal scales and combine them with corresponding lo-
calized contents for localizing action instance as accurately
as possible. With this purpose in mind, we will introduce
our Relation-Aware Pyramid network (RapNet), as shown in
Fig.2. Speciﬁcally, we ﬁrst introduce a novel relation-aware
module (RAM) to extract the long-range context. Then a
global context extractor employs a RAM to capture holistic
information for augmenting full-scale local features. A fol-
lowing temporal pyramid backbone is also enhanced with
our RAM to perform action proposals in multi temporal
scales.

Relation-Aware Module
In this section, we formulate how to distill long-range con-
texts over the entire video for augmenting the localized

Figure 2: The framework of our approach. First, a ResNet50-C3D is used for snippet-level video representations. Then a global
context extractor captures long-range dependency for predicting action probability on each snippet by actionness head. The fol-
lowing temporal pyramid backbone is enhanced with relation-aware modules for separately generating candidates instance with
different duration via anchor head. Finally, our relation-aware proposals are combined with tag candidates to adjust boundaries
and measure conﬁdence score though proposal ranking for retrieving.

information in our relation-aware module, dotted box in
Fig.2. This module ﬁrst captures bi-directional relations be-
tween any two temporal positions as context distilling. Then,
it squeezes temporal information to generate channel-wise
mean statistics as the global context. Afterward, two fully-
connected layers are introduced for adaptive feature re-
sponses recalibration.

Given a video representation sequence Ω, the content of
each snippet is encoded into a vector of C dimension so that
Ω with a shape C × T . Our relation-aware module can cap-
ture the long-range dependency between any two temporal
location in Ω and have a matrix M ∈ RT ×T shape.

As discussed in (Wang et al. 2018c), computing interac-
tions between any two positions of features is an efﬁcient,
generic and straightforward way to capture global under-
standing of the visual scene. We follow this principle and
deﬁne the relations between temporal positions as a dot-
product afﬁnity in the embedding spaces as:

m(xi, xj) = δijβ(xi)T α(xj),

(1)

where α, β are two projection functions, which can be im-
plemented by 1D convolution operation. δij denotes the in-
dex function that is used to control whether the visual con-
tent of jth snippet has an impact on that of ith.

Then, we reﬁne the features at ith snippet with visual con-

tents of the jth one via matrix M and we can have that:

ˆxi =

γ(xi)m(xi, xj),

(2)

T
(cid:88)

j=0

where γ(·) is an embedding function with learnable param-
eter Wγ ∈ RC×C. After Eq.1, 2, the original features map
at each temporal location can be reﬁned by capturing con-
textual information of other temporal positions. Afterward,
we propose to squeeze the temporal dimension to generate
channel-wise mean statistics X G ∈ RC, in order to obtain
the global context embedding. Finally, we learn channel-
wise interdependency for recalibrating feature responses and
augment the original features xi with the global context so
that:

(cid:48)

x

i = xi + W2σ(ε(W1xG

i )),

(3)

r and W1 ∈ R C
where W2 ∈ RC× C
r ×C with pre-deﬁned
reduction ratio r, σ, ε is an activation function and normal-
ization operation respectively.

Bi-directional relations. Due to timing characteristics of
video sequences, we not only need to capture the global con-
textual information, but also consider the role of directed
relation between visual contents of two snippets when local-
izing activity instances in untrimmed videos. Hence, we can
deﬁne directed relationship via our relation-aware module as
following two forms, also shown in Fig.2

δij =

(cid:26)0,
1,

i ≤ j
i > j

, (4) δij =

(cid:26)0,
1,

i > j
i ≤ j

. (5)

For Eq.4, the relationship matrix M becomes an lower tri-
angular one. Our relation-aware module only considers the
contents of snippets behind current snippet xi. Thus, the re-

ﬁned local pattern ˆx+

i can be deﬁned as:
(cid:88)

γ(xi)α(xi)T β(xj).

ˆx+
i =

j≥i

(6)

Similarity, when M follows the form in Eq.5, this upper tri-
angular matrix indicates our relation-aware module can cap-
ture what happens in the past and learn its impact on the
future. An enhanced feature ˆxi follows the format as:

ˆx∗
i =

(cid:88)

j≤i

γ(xi)α(xi)T β(xj).

(7)

Hence, Our relation-aware module models the bi-directional
relation between two local patterns via a concatenation form
deﬁned as ˆxi = [ ˆx+

i , ˆx∗
i ].

Architecture
In this section, we introduce the details of our relation-aware
pyramid network (RapNet) in Fig.2, which consists of three
components: Global Contextual Extractor (GCE), Temporal
Pyramid Backbone (TPB), Proposal Generator (PG). Previ-
ous works (Lin, Zhao, and Shou 2017; Liu et al. 2019) also
attempt feature pyramid networks for localizing action in-
stances. However, they are unaware of the global contextual
information and directed relations between two snippets. We
propose relation-aware module to learn global context at dif-
ferent semantic levels for augmenting corresponding local-
ized information when predicting actionness and proposals.
Global Contextual Extractor (GCE): For a T ×C video
representation, two 1D temporal convolution layers, and one
relation-aware module serve as an extractor to capture the
long-range context, which augments the feature used to pre-
dict action probabilities.

td, · · · , f i

Temporal Pyramid Backbone (TPB): Our temporal
pyramid backbone uses N -level down-sampling opera-
tions to get a top-down feature pyramid set Ftd =
td, · · · , f N −1
}, each ith level feature f i with T
{f 0
2i
length of time in temporal scale 2i
T . Each operation consists
of one relation-aware module and two Conv-BatchN orm-
Relu blocks, which captures holistic information at current
time scale to augment higher-level semantic features ex-
tracted at larger time scale.

td

Aiming to produce multi-granularity temporal action pro-
posals, we adopt lateral connections and up-sampling oper-
ations with a scale factor of 2 in the backbone. Relation-
td captured in ith level is passed to com-
aware feature f i
from ith + 1 level.
bine with the up-sampled feature f i+1
up
For this combination, high-level features are ﬁrst reduced
by half in channels and then up-sampled to twice the time
scale, which are ﬁnally concatenated with the correspond-
ing low-level ones. It is guaranteed that high-level seman-
tic information and the global context in a large time scale
are perceived by the lower-level ones. Hence, we have
the bottom-up feature pyramid set for proposal prediction
Fbu = {f 0

bu, · · · , f N −1

bu, · · · , f i

Proposal Generator (PG): We use a special prediction
module, called proposal generator, to predict conﬁdence
scores, Interaction-over-Union (IoU) and location offsets of

}.

bu

anchor-based action instances associated with each element
in Fbu. The conﬁdence score is used to indicate the prob-
ability of a prediction containing an action instance. The
other two predictions help our RapNet localize a true ac-
tion instance as accurately as possible. In addition, we em-
ploy IoU value as double-check for scoring a proposal pre-
diction, which can correct the conﬁdence error via multipli-
cation. As shown in Fig.2 with green boxes, these genera-
tors are implemented by two Conv-BatchNorm-Relu blocks
with kernel size 3, stride size 1. Every temporal scale fea-
ture f i
bu has its own generator to predict M action instances
at each temporal location so that generating T
2i × M propos-
als in total. Hence, each generator will output T
2i × M × 4
2i } and pj =
predictions, that is Pi = {p0, · · · , pj, · · · , p
{(ˆpjk
w )}M
k=0. Since we have the location off-
sets ˆpjk

iou, ˆpjk
w , the adjusted location is deﬁned as:

conf , ˆpjk
c , ˆpjk

c , ˆpjk

T

c = (tjk
φjk
w = tjk
φjk

c + pjk
c )/ti
s
w ∗ exppjk

w

,

(8)

c and tjk

where tjk
stance at the jth temporal location in ti
is easily to get the predicted action instance φjk = [φjk
w , φj
φjk
2 · φj
P = {P i = {pj = {(ˆpjk

w are center and width of kth anchor in-
2i time scale. It
c − 1
2 ·
w] and the total generations can be denoted as:
j=0}N −1
c , ˆpjk
i=0 .

conf , ˆpjk

iou, ˆpjk

s = T

w )}M

c + 1

k=0}

T
2i

Loss Function
Our RapNet captures the global contextual information at
different temporal scales to produce anchor-based proposals
and snippet-level actionness. Hence, the objective function
for training can be formulated with a L2 regularization as:
Ltotal = λ1Lprop + λ2Laction + λ3L2(W ),
where Lprop and Laction are the loss functions deﬁned for
proposal generation and actionness prediction respectively.
We empirically set λ1 = 10λ2, λ3 = 0.0005 for experi-
ments. To explain these loss functions in detail, we introduce
the label assignment for these two parts.

(9)

Label assignment. For anchor-based proposal prediction,
we tag a binary label for each anchor instance, similar to
YOLO (Redmon et al. 2016), that a positive label is assigned
to the one with highest Interaction-over-Union (IoU) with
corresponding ground-truth instance, otherwise negative. In
this way, a ground truth instance only can match one anchor
so that the boundary regression and IoU loss only considers
positive samples. Due to this label assignment, it is imbal-
anced that the ratio between positive and negative training
samples. Thus we adopt a screening strategy to ignore some
negative instances for conﬁdence loss. A negative instance
will be ignored if the highest IoU overlap between ground-
truth instances with all proposal predictions is larger than a
threshold θiou, empirically 0.5. For actionness generation,
we follow the way in BSN (Lin et al. 2018) and expand the
action instance length by a ratio η = 0.1. For a ground truth
instance φ = [ts, te], the label of each temporal location ly-
ing in the expanded region [ts − dη, te + dη] will be set to 1,
where d = te − ts.

∆ins

ijk fconf (ˆpjk

conf , pjk

conf )

Figure 3: The scheme of boundary adjusting and proposal
ranking

Proposal generation losses. Our RapNet predicts multi-
ple bounding boxes per temporal grid cell. When training,
we only want one anchor to be responsible for each action
instance so that we only calculate the one which has the
highest current IoU with the ground truth in label assign-
ment. Hence, we optimize the following loss function Lprop:

λconf [

1
Npos

+

1
Nneg

N −1
(cid:88)

T
2i
(cid:88)

M
(cid:88)

i=0

j=0

k=0

N −1
(cid:88)

T
2i
(cid:88)

M
(cid:88)

i=0

j=0

k=0

ijk fconf (ˆpjk
Λins

conf , pjk

conf )]

+λc

1
Npos

+λw

1
Npos

+λiou

1
Npos

N −1
(cid:88)

T
2i
(cid:88)

M
(cid:88)

i=0

j=0

k=0

N −1
(cid:88)

T
2i
(cid:88)

M
(cid:88)

i=0

j=0

k=0

N −1
(cid:88)

T
2i
(cid:88)

M
(cid:88)

i=0

j=0

k=0

∆ins

ijk fc(ˆpjk

c , pjk
c )

(10)

∆ins

ijk fw(ˆpjk

w , pjk
w )

∆ins

ijk (1 − ioujk),

where Npos and Nneg represent the number of positive ∆ins
ijk
and screened negative Λins
ijk training instances respectively
while pjk
conf is the binary label in label assignment, fconf (·)
and fc(·) are binary cross-entropy with logits loss functions.
fw(·) represents smooth-L1 loss and ioujk is the interaction-
over-union between a prediction with ground truth. We set
λconf = 0.2 and other weights as 1 for training RapNet.

Actionness prediction losses. Different from the way in
BSN (Lin et al. 2018), we only consider the actionness score
without the starting and ending probability prediction. A
head layer is used to take the output of GCE module as in-
put to predict action probabilities pi
a on each snippet ti of the
entire video T . Our actionness generation also captures the
long-range context to determine whether there is an action at
the current temporal location. Hence, the objective function
is deﬁned as:

Laction =

(∆ilog(pi

a) + (1 − ∆i)log(1 − pi

a)), (11)

1
T

T
(cid:88)

i=1

where T is the length of a video representation and ∆i indi-
cates the binary label assigned in label assignment.

Adjustment and Ranking
Due to the complementary characteristics between anchor-
based methods and actionness score based approaches, we
design a two-stage scheme to adjust boundaries of our
relation-aware proposals with tag candidates ﬁrstly and then
measure the conﬁdence score of reﬁned proposals with cor-
responding action probabilities. Finally, we suppress the re-
dundant proposals with Soft-NMS for retrieving
Boundary Adjustment We ﬁrst employ a TAG (Zhao et al.
2017) technique to generate another set of proposals Ptag

i in P ∗

tag ∗r +φs

tag ∗r +φe

for reﬁning proposal boundaries. Speciﬁcally, for each can-
didate in Prap we calculate its IoU with all that in Ptag. If the
maximum IoU is greater than a threshold, the boundaries of
our relation-aware proposal Prap will be rectiﬁed by the cor-
responding candidate with a ratio r. Thus a reﬁned candidate
prop ∗(1−r), φe
prop = [φs
φ∗
prop ∗(1−r)].
Proposal Ranking We seek another mechanism to evalu-
ate the conﬁdence score here. This double-check scheme
can bring improvements via a simple multilayer perception
model enhanced with our relation-aware module. For a re-
ﬁned instance φ∗
rap, we ﬁrst construct a proposal-level
feature with ﬁxed length and then estimate its overlap with
ground truth directly. This predicted value multiply the orig-
inal conﬁdence score to serve as the ﬁnal ranking score.
Proposal Suppression. For a ground truth action instance,
our RapNet will generate multiple candidates with different
temporal IoU, which cause a low recall performance. Thus,
we employ Soft-NMS (Bodla et al. 2017) to suppress re-
dundant proposals with a score decaying function by a pre-
deﬁned threshold. For the ranked proposals, the score of can-
didate φ∗ with the relatively low score will be decayed if its
overlap with the proposal with a higher score is greater than
the threshold.

Experiments

Datasets and Setup
THUMOS 2014. This dataset consists of 13320 trimmed
videos of 101 categories from UCF-101 for training, 1010
and 1574 untrimmed videos for validation and test set re-
spectively. It is challenging, and widely used for temporal
action detection task with 20 annotated sport categories. We
conduct experiments the same as (Xiong et al. 2017).
ActivityNet-v1.3. It contains 19994 videos labeled in 200
classes. it is divided into training, validation and test with a
ratio of 0.5, 0.25, 0.25 respectively. Due to the unavailability
of annotations on test split, we compare and report perfor-
mances of our approach and other state-of-the-art methods
on the validation set, unless otherwise stated.
Video representations. First, we extract RGB frames from
the original video and then adopt an ResNet-50 C3D (He
et al. 2016; Tran et al. 2015) to encode the visual context.
In order to obtain compact features, we compose snippets
sequence Ω = {ωi}T (cid:48)
i=1 of a given video, where each snip-
pet ωi with L frames and T (cid:48) is the number of snippets .
Our Residual C3D network takes this sequence as input to
generate encoded representations f (ω) ∈ RT (cid:48)×C of a given
video. This net is ﬁrst trained on Kinetics (Carreira and Zis-

Table 1: Comparison between our method with other state-
of-the-art methods on ActivityNet-v1.3 in terms of AR@AN

Table 2: Comparison between our RapNet with other state-
of-the-art proposal generation methods on THUMOS14

Method AR@100 AUC (val) AUC (test)
SSAD+

73.01

64.40

64.80

CTAP

BSN

MGG

RapNet

73.17

74.16
75.61*

74.54

76.71
78.63*

65.72

66.17
67.47*

66.43

67.63
69.93*

-

66.26
67.54*

66.47

67.72
70.07*

+ the proposal generation part in (Lin, Zhao, and Shou 2017)
∗ results are reported based on our ResNet50-C3D features

serman 2017) and then ﬁne-tuned on ActivityNet-v1.3 and
THUMOS14. Speciﬁcally, we add another fully connected
layer for dimension reduction. Due to the different temporal
length between videos, we resize each video encoding to a
ﬁxed temporal length so that we have a T × C feature map,
e.g.T = 128, C = 256 in ActivityNet-v1.3.
Implementation. During generating snippet-level features,
we set the clip interval as 16 and 5 for ActivityNet-v1.3 and
THUMOS14 respectively. We also rescale the feature se-
quence of each video to a shape 128×256 for the former. For
proposal generation, we train our RapNet with batch size of
16 and initialize learning rate as 0.005 with Cosine Decline
Learning Strategy for 18 epochs, which is warmed up four
epochs in a linear growth mode. We set N = 6, M = 2 for
almost experiments, and also explore the effect of pyramid
level N and anchor number per location M on the perfor-
mance in ablation study. Different from previous works, we
use K-means algorithm to cluster N ∗ M anchor boxes.
Evaluation metric. We use the area under the average recall
vs. average number of proposals per video curve (AUC), de-
noted as AR@AN. A proposal is a true positive if its tem-
poral intersection over union (tIoU) with a ground-truth seg-
ment is not less than a given threshold (e.g., tIoU ≥ 0.5).
AR is deﬁned as the mean of all recall values using tIoU
between 0.5 and 0.9(inclusive) in ActivityNet-v1.3, while
between 0.5 and 1.0 in THUMOS 2014, with a step size of
0.05. AN is deﬁned as the total number of proposals divided
by the number of videos in the testing subset. Speciﬁcally,
AN ranges from 0 to 100 in ActivityNet-v1.3.

Temporal Proposal Generation
In this section, we compare our relation-aware propos-
als generated from RapNet with other existing state-of-
the-art methods on both ActivityNet-v1.3 and THUMOS14
datasets. For fair comparisons, we adopt the two-stream and
C3D features provided by BSN (Lin et al. 2018) to conduct
experiments in considering that the effect of different feature
representations. However, we use our C3D features, a better
one, to exploit the ablation study in ActivityNet-v1.3 avoid-
ing the insufﬁcient video representations, which can mea-
sure the maximum performance of our RapNet.

Feature

Method

@50

@100 @200 @500 @1000

C3D
C3D
C3D
C3D
C3D
C3D

C3D

Flow
2-Stream
2-stream
2-Stream
2-Stream

DAPs
SCNN
SST
TURN
BSN
MGG

TURN
TAG
CTAP
BSN
MGG

13.56
17.22
19.90
19.63
29.58
29.11

21.86
18.55
32.49
37.46
39.93

23.83
26.17
28.36
27.96
37.38
36.31

31.89
29.00
42.61
46.06
47.75

33.96
37.01
37.90
38.34
45.55
44.32

43.02
39.61
51.97
53.21
54.65

49.29
51.57
51.58
53.52
54.67
54.95

57.63
-
-
60.64
61.36

57.64
58.20
60.27
60.75
59.48
60.98

64.17
-
-
64.52
64.06

RapNet

29.72

37.53

45.61

55.26

61.32

2-Stream

RapNet

40.35

48.23

54.92

61.41

64.47

Tab. 1 illustrates the AR@AN performances on the val-
idation set of ActivityNet-v1.3 between our RapNet and
other state-of-the-art methods, including MSRA (Yao et al.
2017), Prop-SSAD(Lin, Zhao, and Shou 2017), CTAP(Gao,
Chen, and Nevatia 2018), BSN(Lin et al. 2018), MGG(Liu
et al. 2019). No matter in terms of AUC or AR@100, it is
observed that our RapNet outperforms all of them. With the
same feature, relation-aware proposal achieves 67.72 in test,
around 1.3 higher than the state-of-the-art method MGG.
Speciﬁcally, our approach improves the AR@100 on valida-
tion set from 75.61 of BSN to 78.63 with our ResNet50-C3D
video representations, while the improvement is smaller
when using the same two-stream features as BSN. It indi-
cates that our RapNet is more suitable for C3D features.

Tab. 2 explicates the performance comparison on the test-
ing set of THUMOS14, where we adopt the same repre-
sentations as BSN. Our approach consistently improves the
AR@AN performances from 50 to 1000 in both C3D fea-
tures and 2-stream features. These results demonstrate the
effectiveness of our RapNet for accurate temporal action
proposal generation method, especially for the small aver-
age number of proposals per video.

Ablation Study

How deep? We conduct experiments to exploit the perfor-
mance with different depths of pyramid network. First, we
ﬁx the anchor number M = 2 and generate candidates
only via the pyramid network without relation-aware mod-
ule and actionness score prediction. Finally, we evaluate its
performance on the ActivityNet-v1.3 validation set in terms
of AR@AN. The detailed results are shown in Tab.3. It is
observed that the AUC is increased sharply as the network
deepens, while the gain effect is getting smaller. When the
depth N increases from 3 to 4, it improves the AUC by
around 2.5, but this improvement decreases to 0.2 when N
from 5 to 6. It indicates the effectiveness and necessity of
detecting long action instances and short ones at different
temporal scales.

Table 3: Comparison performance on ActivityNet-v1.3 in
terms of AR@AN with different N , reported in percentage

Depth AUC @1

@5 @10 @100

3
4
5
6

64.54
67.07
68.16
68.35

23.79
30.07
33.55
33.55

42.52
46.06
48.32
48.48

50.70
54.02
55.67
55.79

74.28
76.43
77.18
77.01

Table 4: Comparison with different part of our relation-
aware module on ActivityNet-1.3 in terms of AR@AN

Module

AUC @1

@5 @10 @100

TPB
TPB*
GCE + TPB*

68.35
69.47
69.53

33.55
33.69
34.32

48.48
48.97
49.43

55.79
56.70
56.52

77.01
78.07
78.08

∗ The relation-aware-module enhanced temporal pyramid network

Why relation-aware module? We generate proposals
using a pyramid network with and without relation-aware
module (RAM) respectively for exploiting the effect of con-
text distilling. In Table 4, the top row is the result (68.35% in
AUC) of plain pyramid net without our RAM and actionness
prediction. The middle row is the performance of pyramid
net enhanced with our RAM. It achieves 69.47% in AUC,
1.1 higher than the plain counterpart. It demonstrates the
ability that relation-aware modules capture the global con-
text to augment local features for higher quality proposals.
Especially, for large AN, e.g.@10 or @100, the RAM helps
neural networks to focus on informative content rather than
background. Compared the last two rows, it displays that
additionally actionness prediction beneﬁts the proposal gen-
eration. When considering a few candidates per video, such
as AR@1 or AR@5 in Tab. 4, it is concluded that the Rap-
Net has better conﬁdence score than its counterpart without
actionness branch.

Illustrated in Fig.4, we explore the boundary precision be-
tween plain pyramid net and the relation-aware enhanced
one on different tIoU threshold. The proposed module im-
proves average recall by a great margin, especially in higher
tIoU. It can be attributed to more precise boundaries of pro-
posals beneﬁted from capturing global context at temporal
multi-scales to augment the localized information.

How many anchor boxes? We ﬁx the depth of pyramid
net as six and cluster different number (M = 1, 2, 3, 4) of
anchors for analyzing the effect of these predeﬁned anchor
boxes. Table 5 displays the comparison between different
anchors on the validation set of ActivityNet-v1.3 in terms
of AR@AN. When M = 2, RapNet achieves the best per-
formance in AUC. Combined with the results in Tab.3, it is
found that the corresponding performance improvement gets
limited when the total number of anchor is larger than 10.

Why proposal reﬁnement? We explore the two-stage
scheme to reﬁne generated proposals via boundary adjust-
ment and ranking. From Table 6, the gain effect of bound-

Figure 4: Comparisons on pyramid net with or wo relation-
aware module in terms of AR-AN curves of different tIoU

Table 5: Comparison with different numbers of anchor box
in our RapNet on ActivityNet-1.3 in terms of AR@AN

Numbers AUC @1

@5 @10 @100

6
12
18
24

68.02
69.53
69.24
69.19

33.75
34.32
33.61
33.88

49.64
49.43
49.64
49.42

57.62
56.52
56.94
56.20

75.41
78.08
77.81
78.55

ary adjustment and proposal ranking is 0.18 and 0.22,
respectively. Compared the considerable performance im-
provement in previous works(Gao, Chen, and Nevatia 2018;
Liu et al. 2019), it reveals that RapNet enhances the segmen-
tal proposal generation and narrows the gap between sliding-
window based and actionness score based approaches.

Table 6: Performance of two-stage boundary adjustment and
proposal ranking scheme on ActivityNet-1.3

Methods

AUC @1

@5 @10 @100

RapNet
+ adjustment
+ ranking∗

69.53
69.71
69.93
∗ ranking the proposals with reﬁned boundaries

34.32
34.61
34.96

49.43
50.24
50.27

56.52
57.66
57.43

78.08
78.60
78.63

Conclusion
In this work, a novel relation-aware-pyramid network is
proposed for temporal proposal generation. We introduce
a relation-aware module to captures long-range multi-scale
context to augment local features for extracting informative
contents and suppressing the backgrounds. A pyramid net-
work enhanced with our relation-aware module has achieved
state-of-the-art performance than other competitive methods
on ActivityNet-v1.3 and THUMOS14. However, the bound-
aries of the generated proposal and the scoring mechanism
are expected to be improved in future work.

In Proceedings
untrimmed videos via multi-stage cnns.
of the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), 1049–1058.
[Tran et al. 2015] Tran, D.; Bourdev, L.; Fergus, R.; Torre-
sani, L.; and Paluri, M. 2015. Learning spatiotemporal fea-
tures with 3d convolutional networks. In Proceedings of the
IEEE International Conference on Computer Vision (ICCV),
4489–4497.
[Wang et al. 2018a] Wang, B.; Ma, L.; Zhang, W.; and Liu,
W. 2018a. Reconstruction network for video captioning.
In Proceedings of the IEEE Conference on Computer Vision
and Pattern Recognition (CVPR), 7622–7631.
[Wang et al. 2018b] Wang, J.; Jiang, W.; Ma, L.; Liu, W.; and
Xu, Y. 2018b. Bidirectional attentive fusion with context
In Proceedings of the
gating for dense video captioning.
IEEE Conference on Computer Vision and Pattern Recogni-
tion (CVPR), 7190–7198.
[Wang et al. 2018c] Wang, X.; Girshick, R.; Gupta, A.; and
In Proceed-
He, K. 2018c. Non-local neural networks.
ings of the IEEE Conference on Computer Vision and Pat-
tern Recognition (CVPR), 7794–7803.
[Wu et al. 2019] Wu, C.-Y.; Feichtenhofer, C.; Fan, H.; He,
K.; Krahenbuhl, P.; and Girshick, R. 2019. Long-term fea-
In Proceed-
ture banks for detailed video understanding.
ings of the IEEE Conference on Computer Vision and Pat-
tern Recognition (CVPR), 284–293.
[Xiong et al. 2017] Xiong, Y.; Zhao, Y.; Wang, L.; Lin, D.;
and Tang, X. 2017. A pursuit of temporal accuracy in gen-
eral activity detection. arXiv preprint arXiv:1703.02716.
[Yao et al. 2017] Yao, T.; Li, Y.; Qiu, Z.; Long, F.; Pan, Y.;
Li, D.; and Mei, T. 2017. Msr asia msm at activitynet chal-
lenge 2017: Trimmed action recognition, temporal action
proposals and densecaptioning events in videos. In CVPR
ActivityNet Challenge Workshop.
[Yao, Mei, and Rui 2016] Yao, T.; Mei, T.; and Rui, Y. 2016.
Highlight detection with pairwise deep ranking for ﬁrst-
In Proceedings of the IEEE
person video summarization.
Conference on Computer Vision and Pattern Recognition
(CVPR), 982–990.
[Yuan et al. 2017] Yuan, Z.; Stroud, J. C.; Lu, T.; and Deng,
J. 2017. Temporal action localization by structured maximal
sums. In Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition (CVPR), 3684–3692.
[Zhao et al. 2017] Zhao, Y.; Xiong, Y.; Wang, L.; Wu, Z.;
Tang, X.; and Lin, D. 2017. Temporal action detection with
structured segment networks. In Proceedings of the IEEE In-
ternational Conference on Computer Vision (ICCV), 2914–
2923.

Acknowledgement
This work was performed when Jialin Gao was an intern in
CloudWalk Technology Co., Ltd. It was also partially sup-
ported by grant from the National Natural Science Foun-
dation of China (61772513). Shiming Ge is also supported
by the Youth Innovation Promotion Association, Chinese
Academy of Sciences.

References
[Bodla et al. 2017] Bodla, N.; Singh, B.; Chellappa, R.; and
Davis, L. S. 2017. Soft-nms–improving object detection
with one line of code. In Proceedings of the IEEE Interna-
tional Conference on Computer Vision (ICCV), 5561–5569.
[Carreira and Zisserman 2017] Carreira, J., and Zisserman,
A. 2017. Quo vadis, action recognition? a new model and
In Proceedings of the IEEE Confer-
the kinetics dataset.
ence on Computer Vision and Pattern Recognition (CVPR),
6299–6308.
[Gao, Chen, and Nevatia 2018] Gao, J.; Chen, K.; and Neva-
tia, R. 2018. Ctap: Complementary temporal action proposal
generation. In Proceedings of the European Conference on
Computer Vision (ECCV), 68–83.
[Gong et al. 2014] Gong, B.; Chao, W.-L.; Grauman, K.; and
Sha, F. 2014. Diverse sequential subset selection for super-
vised video summarization. In Advances in Neural Informa-
tion Processing Systems (NIPS), 2069–2077.
[He et al. 2016] He, K.; Zhang, X.; Ren, S.; and Sun, J. 2016.
Deep residual learning for image recognition. In Proceed-
ings of the IEEE Conference on Computer Vision and Pat-
tern Recognition (CVPR), 770–778.
[Lin et al. 2018] Lin, T.; Zhao, X.; Su, H.; Wang, C.; and
Yang, M. 2018. Bsn: Boundary sensitive network for tem-
poral action proposal generation. In Proceedings of the Eu-
ropean Conference on Computer Vision (ECCV), 3–19.
[Lin, Zhao, and Shou 2017] Lin, T.; Zhao, X.; and Shou, Z.
2017. Single shot temporal action detection. In Proceedings
of the 25th ACM International Conference on Multimedia,
988–996. ACM.
[Liu et al. 2019] Liu, Y.; Ma, L.; Zhang, Y.; Liu, W.; and
Chang, S.-F. 2019. Multi-granularity generator for temporal
action proposal. In Proceedings of the IEEE Conference on
Computer Vision and Pattern Recognition (CVPR), 3604–
3613.
[Redmon et al. 2016] Redmon, J.; Divvala, S.; Girshick, R.;
and Farhadi, A. 2016. You only look once: Uniﬁed, real-
time object detection. In Proceedings of the IEEE Confer-
ence on Computer Vision and Pattern Recognition (CVPR),
779–788.
[Shou et al. 2017] Shou, Z.; Chan,
J.; Zareian, A.;
Miyazawa, K.; and Chang, S.-F. 2017. Cdc: Convolutional-
de-convolutional networks for precise temporal action
In Proceedings of
localization in untrimmed videos.
the IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), 5734–5743.
[Shou, Wang, and Chang 2016] Shou, Z.; Wang, D.; and
Temporal action localization in
Chang, S.-F.

2016.

