7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

7
1
0
2
 
t
c
O
 
2
 
 
]

V
C
.
s
c
[
 
 
1
v
9
6
2
1
0
.
0
1
7
1
:
v
i
X
r
a

Spinal cord gray matter segmen-
tation using deep dilated convo-
lutions

Christian S. Perone1, Evan Calabrese2,3, Julien Cohen-Adad1,4

1

2

3

4

Polytechnique Montreal, Montreal, QC, Canada
Department of Radiology, Center for in Vivo Microscopy, Duke University Medical Center, Durham, North Carolina, USA
Department of Radiology & Biomedical Imaging, University of California San Francisco, San Francisco, California, USA
Functional Neuroimaging Unit, CRIUGM, Universit ´e de Montr ´eal, Montreal, QC, Canada

October 4, 2017
* Article under submission to Nature Scientiﬁc Reports.

Abstract

Gray matter (GM) tissue changes have been associ-
ated with a wide range of neurological disorders and
was also recently found relevant as a biomarker for
disability in amyotrophic lateral sclerosis. The ability
to automatically segment the GM is, therefore, an im-
portant task for modern studies of the spinal cord. In
this work, we devise a modern, simple and end-to-end
fully automated human spinal cord gray matter seg-
mentation method using Deep Learning, that works
both on in vivo and ex vivo MRI acquisitions. We evalu-
ate our method against six independently developed
methods on a GM segmentation challenge and report
state-of-the-art results in 8 out of 10 diﬀerent eval-
uation metrics as well as major network parameter
reduction when compared to the traditional medical
imaging architectures such as U-Nets.

1 Introduction

Gray matter (GM) and white matter (WM) tissue
changes in the spinal cord (SC) have been linked to
a large spectrum of neurological disorders [2]. For
example, using magnetic resonance imaging (MRI),
the involvement of the spinal cord gray matter (SCGM)
area in multiple sclerosis (MS) was found to be the
strongest correlate of disability in multivariate models

including brain GM and WM volumes, FLAIR lesion
load, T1-lesion load, SCWM area, number of spinal
cord T2 lesions, age, sex and disease duration [34].
Another study showed that SCGM atrophy is a rele-
vant biomarker for predicting disability in amyotrophic
lateral sclerosis [26].

The ability to automatically assess and characterize
these changes is, therefore, an important required step
[11] in the modern pipeline to study both the in vivo
and ex vivo SC. The segmentation outcome can also be
used for co-registration and spatial normalization to
a common space. Moreover, the fully-automated seg-
mentation is very useful for longitudinal studies, where
the delineation of gray matter is very time-consuming
[11].

While recent cervical cord cross-sectional area (CSA)
segmentation methods have achieved near-human per-
formance [9], the accurate segmentation of the GM is
still a remaining challenge [30]. The main properties
that make the GM area diﬃcult to segment are: incon-
sistent surrounding tissue intensities, image artifacts
and pathology-induced changes in the image contrast
[11].

Other factors also contribute to the complexity of
the GM segmentation task, such as lack of standard-
ized data sets, diﬀerences in MRI acquisition protocols,
diﬀerent pixel sizes, diﬀerent methods to acquire gold
standard segmentations and diﬀerent performance
metrics to assess segmentation results [30]. In Fig-

Spinal cord gray matter segmentation using deep dilated convolutions

ure 1, we show some MRI samples (axial slices) ac-
quired in diﬀerent centers, where we can visually see
the variability present in diﬀerent acquisitions.

However, despite these diﬃculties, the scientiﬁc com-
munity recently organized a joint collaboration eﬀort
called "Spinal Cord Gray Matter Segmentation Chal-
lenge" (SCGM Challenge) [30] to characterize the
state-of-the-art and compare six independent devel-
oped methods [29][5][8][13][4][28] on a public avail-
able standard data set created through the collabo-
ration of four internationally recognized spinal cord
imaging research groups (University College London,
Polytechnique Montreal, University of Zurich and Van-
derbilt University), providing therefore a ground basis
for method comparison that was previously unfeasible.
In the past few years, we witnessed the fast and
unprecedented development of Deep Learning [22]
methods, that not only achieved human-level perfor-
mance but also surpassed it [17], even in health domain
applications [31]. After the groundbreaking results
presented in the seminal paper of the AlexNet [21],
the community embraced the successful Deep Learning
approach for machine learning and consequently devel-
oped many methods that are nowadays state-of-the-art
and pervasive in many diﬀerent ﬁelds such as image
classiﬁcation [16], image segmentation [6], speech
recognition [1], natural language processing (NLP),
among others.

Deep Learning is characterized by a major shift from
the past traditional handcraft feature extraction to a
hierarchical representation learning approach where
multiple levels of automatically discovered representa-
tions are learned from raw data [22].

On a recent survey [24] that reviewed over 300 pa-
pers using Deep Learning techniques for medical image
analysis, the authors found that Deep Learning tech-
niques have spread throughout the entire ﬁeld of medi-
cal image analysis, with a rapid increase in the number
of published studies between the years of 2015 and
2016. The survey also found that Convolutional Neural
Networks (CNNs) were more prevalent in the medi-
cal image analysis, with Recurrent Neural Networks
(RNNs) gaining more popularity.

Although the enormous success of Deep Learning has
attracted a lot of attention of the research community,
some challenges in the medical imaging domain still
remain open:

• Data acquisition is usually very expensive and
require time-consuming specialist annotation to
create gold standards;

• Standardized data sets are still a major problem
due to variability in equipment from diﬀerent ven-
dors, acquisition protocols/parameters/contrasts,
especially in the MRI domain;

• Data availability is also limited due to pri-

vacy/ethics concerns or regulations [24];

In this work, we propose a new simple pipeline with
an end-to-end learning approach for fully automated

spinal cord gray matter segmentation using a novel
Deep Learning architecture based on the Atrous Spa-
tial Pyramid Pooling (ASPP) [7][6], where we achieved
state-of-the-art results on many metrics in an in vivo in-
dependent data set evaluation. We also show excellent
generalization on an ex vivo high-resolution acquisition
data set where only a few axial-slices were annotated
to accurate segment an MRI volume with more than
4000 axial slices.

We also provide an evaluation comparing our
method with the traditionally used U-Net [33] archi-
tecture and with other six independently developed
methods.

2 Related Work

Many methods for spinal cord segmentation were pro-
posed in the past. Regarding the presence or absence
of manual intervention, the segmentation methods can
be separated in two main categories: semi-automated
and fully-automated. In [11], the authors also clas-
sify spinal cord segmentation methods in the following
categories:

• Intensity-based: examples are threshold-based

or edge-detection methods;

• Surface-based: examples include deformable
models, active-contours and level-set methods;
• Image-based: examples include watershed and

template/atlas deformation methods;

In [4], they propose a probabilistic method for seg-
mentation called "Semi-supervised VBEM", where the
MRI signals are assumed to be observed data generated
by warping of an average shaped reference anatomy
[30]. The observed image intensities are modeled as
random variables drawn from a Gaussian mixture dis-
tribution, where the parameters are estimated using
a variational version of the Expectation-Maximization
(EM) [4] algorithm. The method can be used in a fully
unsupervised fashion or by incorporating training data
with manual labels, hence the semi-supervised scheme
[30].

The SCT (Spinal Cord Toolbox) segmentation
method [13], uses an atlas-based approach and was
built based on a previous work [3] but with additional
improvements such as the use of vertebral level infor-
mation and linear intensity normalization to accom-
modate multi-site data [13]. The SCT approach ﬁrst
builds a dictionary of images using manual WM/GM
segmentations after a pre-processing step, then the
target image is also pre-processed and normalized, af-
ter that, the target image is projected into the PCA
(Principal Component Analysis) space of the dictionary
images where the most similar dictionary slices are
selected using an arbitrary threshold, and ﬁnally, the
segmentation is done using label fusion between the
manual segmentations from the dictionary images that

Page 2 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 1: In vivo axial-slice samples from four centers (UCL, Montreal, Zurich, Vanderbilt) that collaborated to the SCGM
Segmentation Challenge [30]. Top row: original MRI images. Bottom row: crop of the spinal cord (green rectangle).

were selected [30]. The SCT method is freely available
as an open-source software1 package [10].

In [29], they propose a method called "Joint col-
laboration for spinal cord gray matter segmentation"
(JCSCS), where two existing label fusion segmentation
methods were combined. The method is based on a
multi-atlas segmentation propagation using registra-
tion and segmentation in 2D slice-wise space. In JCSCS,
the "Optimized PatchMatch Label Fusion" (OPAL) [14]
is used to detect the spinal cord, where the cord local-
ization is achieved by providing an external data set of
spinal cord volumes and their associated manual seg-
mentation [29], after that, the "Similarity and Truth
Estimation for Propagated Segmentations" (STEPS)
[19] is used to segment the GM in two steps, ﬁrst
the segmentation propagation, and then a consensus
segmentation is created by fusing best-deformed tem-
plates (based on locally normalized cross-correlation)
[29].

In [8], the Morphological Geodesic Active Contour
(MGAC) algorithm uses an external spinal cord segmen-
tation tool (Jim, from Xinapse Systems) to estimate
the spinal cord boundary as well as a morphological
geodesic active contour model to segment the gray
matter. The method has ﬁve steps: ﬁrst, the original
image spinal cord is segmented with the Jim software
and then a template is registered to the subject cord,
after that the same transformation is applied to the
GM template. The transformed gray matter template
is then used as an initial guess for the active contour
algorithm [8].

1https://github.com/neuropoly/spinalcordtoolbox

The "Gray matter Segmentation Based on Maximum
Entropy" (GSBME) algorithm [30] is a semi-automatic,
supervised segmentation method for the GM. The GS-
BME is comprised of three main stages. First, the image
is pre-processed, in this step the GSBME uses the SCT
[10] to segment the spinal cord using Propseg [9]
with manual initialization, after that the intensities are
normalized and denoised. In the second step, the im-
ages are slice-wise thresholded using a sliding window
where the optimal threshold is found by maximizing
the sum of the GM and WM intensity entropies. In the
third and last stage, an outlier detector discards seg-
mented intensities using morphological features such
as perimeter, eccentricity and Hu moments among oth-
ers [30].

In the Deepseg approach [28], built on top of [5],
they use a Deep Learning architecture similar to the
U-Net [33], where a CNN has a contracting and expand-
ing path. The contracting path aggregates information
while the expanding path upsamples the feature maps
in order to achieve a dense prediction output. To re-
cover spatial information loss, shortcuts are added be-
tween contracting/expanding paths of the network.
In Deepseg, instead of using upsampling layers like
in U-Net, they use an unpooling and "deconvolution"
approach such as in [40]. The network architecture
used has 11 layers and is pre-trained using 3 convolu-
tional restricted Boltzmann Machines [23]. Deepseg
also uses loss function with a weighted sum of two
diﬀerent terms, the mean square diﬀerences of the GM
and non-GM voxels, balancing sensitivity and speci-
ﬁcity [30]. Two models were trained (independently),

Page 3 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

called "dilated convolutions" [39]. We performed mod-
iﬁcations to improve the segmentation performance on
medical imaging by handling imbalanced data with a
diﬀerent loss function and also by extensively remov-
ing decimation operations from the network such as
pooling, trading depth (due to memory constraints) to
improve the translational equivariance of the network
and also parameter reduction.

Dilated convolutions allow us to exponentially grow
the receptive ﬁeld with linearly increasing number of
parameters, providing a signiﬁcant parameter reduc-
tion while increasing the eﬀective receptive ﬁeld. Di-
lated convolutions works by introducing "holes" [7] in
the kernel as illustrated in Figure 2. For an 1D signal
x[i], the y[i] output of a dilated convolution with the
dilation rate r and a ﬁlter w[s] with size S is formulated
as:

y[i] =

x[i + r

s]w[s].

·

S
(cid:88)

s=1

(1)

The dilation rate r can also be seen as the stride to
which the input signal is sampled [7]. Dilated con-
volutions, like standard convolutions, also have the
advantage of being translationally equivalent, which
means that translating the image will result in a trans-
lated version of the original input, as seen below:

f (g(x)) = g(f (x))

(2)

Where g(
·

) a con-
) is a translation operation and f (
·
volution operation. However, since we don’t need to
introduce pooling to capture multi-scale features when
using dilated convolutions, we can keep the transla-
tional equivariance property in the network, which is
very important for spatial dense prediction tasks.

one for the full spinal cord segmentation and another
for the GM segmentation.

We compare our method with all the aforementioned

methods on the SCGM Challenge [30] data set.

3 Methods and Materials

As we saw in the Related Work section, the majority of
the previously developed GM segmentation methods
usually rely on registered templates/atlases, arbitrary
distance and similarity metrics or complex pipelines
that aren’t optimized in an end-to-end fashion, neither
eﬃcient during inference time.

In this work, we focus on the development of a simple
Deep Learning method that can be trained in an end-
to-end fashion and that generalizes well even with a
small number of 2D labeled axial slices of a 3D MRI
volume.

3.1 Note on U-Nets

Many modern Deep Learning CNN classiﬁcation ar-
chitectures use alternating layers of convolutions and
subsampling operations to aggregate semantic informa-
tion and discard spatial information across the network,
leading to certain levels of translation and rotation
invariance that are important for classiﬁcation. How-
ever, in segmentation tasks, a dense full-resolution
output is required.
In medical imaging, the most
traditional architecture for segmentation is the well-
known U-Net [33], where two distinct paths (encoder-
decoder/contracting-expanding) are used to aggregate
semantic information and recover the spatial informa-
tion with the help of shortcut connections between the
paths.

The U-Net architecture, however, causes a major ex-
pansion of the parameter space due to the two distinct
paths that form the U-shape. We also found, such as
in [41], that the gradient ﬂow in the high-level layers
of the U-Nets (bottom of the U-shape) is problematic.
Since the ﬁnal low-level layers have access to the earlier
low-level features, the network optimization will ﬁnd
the shortest path to minimize the loss, thus reducing
the gradient ﬂow in the bottom of the network.

By visualizing feature maps from the U-Net using
techniques described in [38], we found that the fea-
tures extracted in the bottom of the network were very
noisy while the features extracted in the low-level lay-
ers were the only ones showing meaningful patterns.
By removing the bottom layers of the network, we
found that the network performed the same or some-
times better than the deeper network.

Figure 2: Dilated convolution. On the left, we have the dilated
convolution with dilation rate r = 1, equivalent to
the standard convolution. In the middle with have
a dilation r = 2 and in the right a dilation rate of
r = 3. All dilated convolutions have a 3x3 kernel
size and the same number of parameters.

3.2 Proposed method

Our method is based on the state-of-the-art segmenta-
tion architecture called "Atrous Spatial Pyramid Pool-
ing" (ASPP) [6] that uses "Atrous convolutions", also

The overall proposed architecture can be seen in
Figure 3. Our architecture works with 2D slice-wise
axial images and is composed of (a) two initial layers of
standard 3x3 convolutions, followed by (b) two layers
of dilated convolutions with rate r = 2, followed by

Page 4 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

(c) six parallel branches with two layers each of a 1x1
standard convolution, 4 diﬀerent dilated convolution
rates (6/12/18/24) and a global averaging pooling
that is repeated at every spatial position of the feature
map. After that, the feature maps from the six parallel
branches are concatenated and forwarded to (d) a
block of 2 layers with 1x1 convolutions in order to
produce the ﬁnal dense prediction probability map.
Each layer is followed by Batch Normalization [18]
and Dropout [36] layers.

Figure 4 illustrates the pipeline of our train-
ing/inference process. An initial resampling step down-
samples/upsamples the input axial slice images to a
common pixel size space, then a simple intensity nor-
malization is applied to the image, followed by the
network inference stage.

Contrary to the task of natural images segmentation,
the task of GM segmentation in medical imaging is
In our case, only a small
usually very unbalanced.
portion of the entire axial slice encompasses the GM
(the rest being comprised of other structures such as
the white matter, cerebrospinal ﬂuid, bones, muscles,
etc.). Due to this imbalance, we employed a surrogate
loss for the DSC (Dice Similarity Coeﬃcient) called the
Dice Loss, which is insensitive to imbalancing and was
employed by many works in medical imaging [25][12].
The Dice Loss can be formulated as:

L

−

(3)

(cid:80)N

dice =

n=1 rn + (cid:15)

n=1 pnrn + (cid:15)

2 (cid:80)N
n=1 pn + (cid:80)N
Where p and r are the predictions and gold stan-
dard respectively. The (cid:15) term is used to ensure the loss
stability by avoiding the numerical issues. We experi-
mentally found that the Dice Loss yielded better results
when compared to the weighted cross-entropy (WCE)
used by [33], which is more diﬃcult to optimize due
to the added weighting hyper-parameter.

Medical image data sets are usually smaller than
natural image data sets by many orders of magnitude,
therefore regularization and data augmentation is an
important step. In this work, the following data aug-
mentation strategies were applied: rotation, shifting,
scaling, ﬂipping, noise and elastic deformation.

tecture with [6], are the following:

Initial pooling/decimation: our network does not
use initial pooling layers as we found them detri-
mental to the segmentation of medical images;
Padding: we extensively employ padding across the
entire network to keep feature map sizes ﬁxed,
trading depth to reduce memory usage of the net-
work;

Dilation Rates: since we don’t use initial pooling, we
kept the parallel dilated convolution branch with
rate r = 24, as we found improvements by doing
so, due to the large feature map size that doesn’t
cause ﬁlter degeneration as seen in [6];

Table 1: Parameters of each compared method. Values repli-
cated from [30]. Time per slice are estimated values,
since diﬀerent hardware were employed by the diﬀer-
ent techniques.

Method

Init.
Auto.
JCSCS
DEEPSEG Auto.
Auto.
MGAC
Manual
GSBME
Auto.
SCT
Auto.
VBEM
Proposed Auto.

External data Time p/ slice
Training
Yes
No
No
Yes (4 h)
No
No
Yes (<1 m) No
Yes
No
No
No
No
Yes (19 h)

4-5 min
<1 s
1 s
5-80 s
8-10 s
5 s
<1 s

Loss: contrary to natural images, our task of GM seg-
mentation is very unbalanced, instead of tradi-
tional cross-entropy, we used the Dice Loss;
Data Augmentation: in this work we applied not only
scaling and ﬂipping as seen in [6] but also rotation,
shifting, added channel noise and elastic deforma-
tions [35].

Table 1 compares the setup parameters of our ap-
proach as well as the methods that participated in the
SCGM Segmentation Challenge [30].

3.2.1 U-Net architecture

For the U-Net [33] architecture model that was used for
comparison, we employed a 14-layers network using
standard 3x3 2D convolution ﬁlters with ReLU non-
linearity activations. For a fair comparison, we used the
same training protocol and loss function. For the data
augmentation strategy, we employed a more aggressive
augmentation due to overﬁtting issues with the U-Net
that we’ll discuss later. We also performed a extensive
architecture exploration, and used the best performing
U-Net model architecture.

3.3 Data sets

In this subsection, we present the data sets used for
evaluation in this work.

The Spinal Cord Gray Matter Challenge [30] (SCGM
Challenge) data set is comprised by 80 healthy sub-
jects (20 subjects from each center). The demograph-
ics ranges from a mean age of 28.3 up to 44.3 years
old. Three diﬀerent MRI systems were used (Philips
Achieva, Siemens Trio, Siemens Skyra) with diﬀerent
acquisition parameters. The voxel size resolution of
the data set ranges from 0.25x0.25x2.5 mm up to
0.5x0.5x5.0 mm. The data set is split between training
(40) and test (40) with the test set hidden. For each
labeled slice in the data set, 4 gold standard segmen-
tation masks were produced by 4 independent expert
raters (one per site).

Page 5 of 13

The main diﬀerences when we compare our archi-

3.3.1 Spinal Cord Gray Matter Challenge

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 3: Architecture overview of the proposed method. The MRI axial slice is fed to the ﬁrst block of 3x3 convolutions and then to
a block of dilated convolutions (rate 2). Then, six parallel modules with diﬀerent rates (6/,12/18/24), 1x1 convolution,
and a global average pooling are used. After the parallel modules, all feature maps are concatenated and then fed into
the ﬁnal block of 1x1 convolutions to produce the ﬁnal dense predictions.

Figure 4: Architecture pipeline overview. During the ﬁrst stage,
input axial slices are resampled to a common pixel
size space, then intensity is normalized, followed by
the network inference.

Examples of the data set for each center are shown

in the Figure 1.

During the development of this work, we found some
misclassiﬁed voxels in the training set, these issues
were reported, however for the sake of fair comparison,
all the evaluations done in this work used the original
pristine training data set.

3.3.2 Ex vivo high-resolution spinal cord

To evaluate our method on an ex vivo data set, we used
an MRI acquisition that was performed on an entire
human spinal cord, from the pyramidal decussation
to the cauda equina using a 7T horizontal-bore small
animal MRI system.

Although the acquisition was obtained from a de-
ceased adult male with no known history of neurologic
disease, the review of images revealed a clinically oc-
cult SC lesion close to the 6th thoracic nerve root level,
with imaging features suggestive of a chronic compres-

sive myelopathy or possible sequela of a previous viral
infection such as herpes zoster.

The volume is comprised by a total of 4676 axial
slices with 100 µm isotropic resolution and the acquisi-
tion time took approximately 120 hours.

3.4 Training Protocol

3.4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the training protocol for
the SCGM Challenge [30] data set experiments.

Resampling and Cropping: All volumes were resam-
pled to a voxel size of 0.25x0.25 mm, the highest
resolution found between acquisitions. All the ax-
ial slices were center-cropped to a 200x200 pixels
size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the train/validation split,
we used 8 subjects (2 from each site) for valida-
tion and the rest for training. The test set was
deﬁned by the challenge. We haven’t employed
any external data or used the vertebral informa-
tion from the provided dataset. Only the provided
GM masks were used for training/validation;
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;

Batch Normalization: We used a momentum φ = 0.1
for BatchNorm due to the small batch size;

Page 6 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(4)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 1000 epochs (w/

32 batches at each epoch);

Data augmentation: We applied the following data
augmentations: rotation, shift, scaling, channel
shift, ﬂipping and elastic deformation [35]. The
data augmentation parameters were chosen using
random search;

Contrary to the very smooth decision boundaries
that models trained using the traditional cross-entropy
present, the Dice Loss has the property of creating very
sharp decision boundaries and models with high recall
rate. We found experimentally that thresholding the
dense predictions with a threshold τ = 0.999 provided
a good compromise between precision/recall, however
no optimization was employed to choose the threshold
τ value for the output predictions.

Since the test data set is hidden from the challenge
participants, to evaluate our model we sent our pro-
duced test predictions to the challenge website2. Re-
sults are presented in Table 2 on the column "Proposed
Method", along with the other six previously developed
methods and 10 diﬀerent metrics.

The training time on a single NVIDIA P100 GPU took
approximately3 19 hours. While inference time took
less than 1 second per subject.

3.4.2 Inter-rater variability as label smoothing

regularization

The training data set provided by the SCGM Challenge
is comprised of 4 diﬀerent masks that were manually
and independently created by raters for each axial slice.
As in [5], we used all the diﬀerent masks as our gold
standard. We also found that this approach shares the
same principle of using label smoothing as seen in [37].
Label smoothing is a mechanism that make the
model be less conﬁdent by preventing the network
from assigning a full probability to a single class, usu-
ally an evidence of overﬁtting. In [27], they also found
a link between label smoothing and conﬁdence penalty
through the direction of the Kullback–Leibler diver-
gence.

Since the diﬀerent gold standard masks for the same
axial slices diverges usually only in the border of the
GM, it is easy to see that this has a label smoothing

eﬀect on the contour of the GM, encouraging the model
to be less conﬁdent in the contour prediction of the
GM, a kind of “contour smoothing”.

This interpretation suggests that one could also in-
corporate this contour smoothing by artiﬁcially adding
label smoothing on the contours of the target anatomy,
where raters usually disagree on the manual segmenta-
tion, leading to potentially better model generalization
on many diﬀerent medical segmentation tasks where
the contours are usually the region of raters disagree-
ment.

We leave the exploration of this contour smoothing

to future work.

3.4.3 Ex vivo high-resolution spinal cord

In this subsection we show the training protocol for
the ex vivo high-resolution spinal cord data set.

Cropping: All the slices were center-cropped to a

200x200 pixels size;

Normalization: We performed only mean centering
and standard deviation normalization of the vol-
ume intensities;

Train/validation split: For the training set we se-
lected only 15 evenly spaced axial slices out of
4676 total slices from the volume. For the valida-
tion set, we selected 7 (evenly spaced) axial slices
and our test set was comprised of 8 axial slices
(also evenly distributed across the entire volume);
Batch size: We used a small batch size of only 11 sam-

ples;

Optimization: We used Adam [20] optimizer with a

small learning rate η = 0.001;
Dropout: We used a dropout rate of 0.4;
Learning Rate Scheduling: Similar to [6], we used
the "poly" learning rate policy where the learning
rate is deﬁned by:

η = ηt0 ∗

(1

−

n
N

)p

(5)

Where ηt0
is the initial learning rate, N is the
number of epochs, n the current epoch and p the
power with p = 0.9;

Iterations: We trained the model for 600 epochs (w/

32 batches at each epoch);

Data augmentation: For this dataset, we used the fol-
lowing aforementioned augmentations: rotation,
shift, scaling, channel shift, ﬂipping and elastic
deformation [35]. We didn’t employed random
search to avoid overﬁtting due to the data set size;

Like in the SCGM Segmentation task, we used a
threshold τ = 0.999 to binarize the prediction mask.
The training time on a single NVIDIA P100 GPU
took approximately4 2 hours. While inference time
took approximately 25 seconds to segment 4676 axial
slices.

Page 7 of 13

2http://cmictig.cs.ucl.ac.uk/niftyweb
3Using single-precision ﬂoating-point (fp32) and TensorFlow

1.3.0 framework with cuDNN 6

4See footnote 3.

Spinal cord gray matter segmentation using deep dilated convolutions

4 Results

In this section, we discuss the experimental evaluation
of the method in the presented data sets.

4.1 Spinal Cord Gray Matter Challenge

In this subsection we show the evaluation on the SCGM
Challenge [30] data set.

4.1.1 Qualitative Evaluation

In Figure 5, we show the segmentation output of our
model in four diﬀerent subjects from acquisitions of
four diﬀerent centers on the test set of the SCGM Seg-
mentation Challenge. The majority voting segmenta-
tion was taken from [30]. As we can see in Figure 5,
our approach was able to capture many properties of
the GM anatomy, providing good segmentations even
in presence of blur as seen in the samples from the Site
1 and Site 3.

When compared with the segmentation results from
Deepseg [28], that uses a U-Net like structure with
pre-training and 3D-wise training, we can see that our
method doesn’t fail to segment the gray commissure
of the GM structure as seen in the Figure 4 of [30].

4.1.2 Quantitative Evaluation

As we can see in Table 2, our approach achieved state-
of-the-art results in 8 out of 10 diﬀerent metrics and
surpassed 4 out of 6 previously developed methods on
all metrics.

We can also see that the Dice Loss is not only an
excellent surrogate for the Dice Similarity Coeﬃcient
(DSC) but also a surrogate for distance metrics, as can
we note that our model not only achieved state-of-the-
art results on overlap metrics (i.e. DSC) but also on
distance and statistical metrics.

The True Negative Rate (TNR) and Positive Predic-
tive Value (PPV) or precision, were the ones where the
model didn’t achieve the best results, however we note
that the TNR was very close to the other methods re-
sults. We also hypothesize that the suboptimal results
of the precision (PPV) are an eﬀect of the sharp deci-
sion boundary produced by our model due to the Dice
Loss. We believe that prediction threshold optimiza-
tion can certainly yield better results, however this cost
optimization would require further investigations.

When compared to Deepseg [28] method, the only
method using Deep Learning in the challenge, where
an U-Net based architecture was employed, our pro-
posed approach performed better in 8 out of 10 metrics,
even though our method didn’t employed 3D convo-
lutions, pre-training or threshold optimization as in
Deepseg [28].

4.2 Ex vivo high-resolution spinal cord

In this subsection we show the evaluation on the ex
vivo high-resolution spinal cord data set.

4.2.1 Qualitative Evaluation

In the Figure 8, we show a qualitative evaluation of
the segmentations produced by our method and the
U-Net model, contrasting the segmentations against
the original and gold standard images.

As can be seen in the test sample depicted in the
ﬁrst column of Figure 8, the predictions of the U-Net
“leaked” the gray matter segmentation up to the cere-
brospinal ﬂuid (CSF) close to the dorsal horn (see
green rectangle on ﬁrst column), while our proposed
segmentation was much more contained on the gray
matter region only.

Also, in the third column of the Figure 8, the U-Net
signiﬁcantly oversegmented a large portion of the gray
matter region, extending the segmentation up to the
white matter close to the right lateral horn of the gray
matter anatomy (see the green rectangle), while our
proposed method performed well.

We also provide in Figure 7 a 3D rendered represen-
tation of the segmented gray matter using our method.

4.2.2 Quantitative Evaluation

As we can see in Table 3, where we show the quanti-
tative results of our approach, our method achieved
better results on 6 out of 8 diﬀerent metrics. One of
the main advantages that we can see from these results
is that our method uses 6x less parameters than the
U-Net architecture, leading to less chance of overﬁtting
and potentially better generalization.

During the training of the two architectures (U-Net
and our method), we noticed that even with a high
dropout rate of 0.4, the U-Net was still overﬁtting, forc-
ing us to use a more aggressive data augmentation
strategy to achieve better results, especially for the
shifting parameters of the data augmentation; we hy-
pothesize that this is an eﬀect of the decimation on the
contracting path of the U-Net, that disturbs the trans-
lational equivariance property of the network, leading
to a poor performance on segmentation tasks.

5 Discussion

In this work, we devise a simple, but eﬃcient and end-
to-end method that achieves state-of-the-art results in
many metrics when compared to six independently
developed methods, as detailed in Table 2. To the best
of our knowledge, our approach is the ﬁrst to achieve
better results in 8 out of 10 metrics evaluated in the
SCGM Segmentation Challenge [30].

One of the main diﬀerences with other methods
from the challenge is that our method employs an

Page 8 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 5: Qualitative evaluation of our proposed approach on the same axial slice for subject 11 of each site. From top to bottom
row: input image, majority voting segmentation gold standard and the result of our segmentation method. Adapted
from [30].

Figure 6: Test set evaluation results from the SCGM segmentation challenge [30] for each evaluated metric. Our method is shown

as "Proposed". Best viewed in color.

Page 9 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Figure 7: Lumbosacral region 3D rendered view of the ex vivo high-resolution spinal cord data set segmented using the proposed
method. The gray matter is depicted in orange color while the white matter and other tissues are represented in
transparent gray color.

Figure 8: Qualitative evaluation of the U-Net and our proposed method on the ex vivo high-resolution spinal cord data set. Each
column represents a random sample of the test set (regions from left to right: sacral, thoracic, cervical). Green rectangles
shows oversegmentation made by the U-Net model.

Page 10 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

Table 2: Comparison of diﬀerent segmentation methods that participated in the SCGM Segmentation Challenge [30] against each
of the four manual segmentation masks of the test set, reported here in the format: mean (std). For of fair comparison, the
metrics are the same as used in [30] and the results from other methods are replicated here, where we have: Dice similarity
coeﬃcient (DSC), mean surface distance (MSD), Hausdorﬀ surface distance (HSD), skeletonized Hausdorﬀ distance
(SHD), skeletonized median distance (SMD), true positive rate (TPR), true negative rate (TNR), positive predictive value
(PPV), Jaccard index (JI) and conformity coeﬃcient (CC). In bold font, we represent the best-obtained results on each
metric. We also note that MSD, HSD, SHD and SMD metrics are in millimeters and that lower values mean better results.

JCSCS
DSC
0.79 (0.04)
MSD 0.39 (0.44)
HSD 2.65 (3.40)
SHD 1.00 (0.35)
SMD 0.37 (0.18)
TPR
TNR
PPV
JI
CC

77.98 (4.88)
99.98 (0.03)
81.06 (5.97)
0.66 (0.05)
47.17 (11.87)

DEEPSEG
0.80 (0.06)
0.46 (0.48)
4.07 (3.27)
1.26 (0.65)
0.45 (0.20)
78.89 (10.33)
99.97 (0.04)
82.78 (5.19)
0.68 (0.08)
49.52 (20.29)

MGAC
0.75 (0.07)
0.70 (0.79)
3.56 (1.34)
1.07 (0.37)
0.39 (0.17)
87.51 (6.65)
99.94 (0.08)
65.60 (9.01)
0.60 (0.08)
29.36 (29.53)

GSBME
0.76 (0.06)
0.62 (0.64)
4.92 (3.30)
1.86 (0.85)
0.61 (0.35)
75.69 (8.08)
99.97 (0.05)
76.26 (7.41)
0.61 (0.08)
33.69 (24.23)

SCT
0.69 (0.07)
0.69 (0.76)
3.26 (1.35)
1.12 (0.41)
0.39 (0.16)
70.29 (6.76)
99.95 (0.06)
67.87 (8.62)
0.53 (0.08)
6.46 (30.59)

VBEM
0.61 (0.13)
1.04 (1.14)
5.34 (15.35)
2.77 (8.10)
0.54 (0.25)
65.66 (14.39)
99.93 (0.09)
59.07 (13.69)
0.45 (0.13)
-44.25 (90.61)

Proposed Method
0.85 (0.04)
0.36 (0.34)
2.61 (2.15)
0.85 (0.32)
0.36 (0.17)
94.97 (3.50)
99.95 (0.06)
77.29 (6.46)
0.74 (0.06)
64.24 (10.83)

Table 3: Quantitative metric results comparing a U-Net archi-
tecture and our proposed approach on the ex vivo
high-resolution spinal cord data set.

Metric name

U-Net
776,321
Num. of Params.
0.9027 (0.07)
Dice
0.9626 (0.02)
Mean Accuracy
0.9952 (0.01)
Pixel Accuracy
0.9287 (0.05)
Recall
0.8831 (0.10)
Precision
Freq. Weighted IU 0.9913 (0.01)
0.9121 (0.06)
Mean IU

Proposed

124,769
0.9226 (0.04)
0.9561 (0.03)
0.9968 (0.00)
0.9135 (0.06)
0.9335 (0.04)
0.9938 (0.00)
0.9280 (0.04)

end-to-end learning approach, where the entire predic-
tion pipeline is optimized using backpropagation and
gradient descent, contrasting with the other methods
that usually employ separate registrations, external
atlases/templates data and label fusion stages.

As we can also see in Table 3, when we compare our
method to the most traditionally used method (U-Net)
for medical image segmentation, our method provides
not only better results in many metrics but also a major
parameter reduction (more than 6 times).

In the lens of Minimum Description Length (MDL)
theory [32], that describes models as languages for
describing properties of the data and sees inductive
inference as ﬁnding regularity in the data [15], when
two competing explanations for the data explains the
data well, MDL will prefer the one that provides a
shorter description of the data. As we can see, our
approach using dilated ﬁlters provides more than 6x
parameter reduction than U-Nets, but is also able to
outperform other methods in many metrics, an evi-
dence that the model is parameter-eﬃcient and can
capture a more compact description of the data reg-
ularities when compared with more complex models
such as U-Nets.

Our approach is limited to 2D slices, however, the
model doesn’t restrict the use of 3D dilated convolu-
tions and we believe that incorporating 3D context
information into the model would certainly improve
the segmentation results, however, at the expense of
increased memory consumption.

We also believe that our method can be expanded to
take leverage of semi-supervised learning approaches
due to the strong smoothness assumption that holds
for axial slices in most volumes, especially in ex vivo
high-resolution spinal cord MRI.

6 Acknowledgments

We acknowledge NVIDIA Corporation for the dona-
tion of a GPU Titan X board, Compute Canada for
the GPU cluster, Zhuoqiong Ren for the help with gray
matter gold standard, organizers of the SCGM Segmen-
tation Challenge and participant teams that invested
so much eﬀort in this challenge. We also acknowledge
United States National Institutes of Health awards P41
EB015897 and 1S10OD010683-01 for funding the ex
vivo study.

7 Author Contributions

C.S.P conceived the method, conducted the experi-
ments, manual segmentations and wrote the paper.
J.C.A. provided expert guidance and wrote the paper.
E.C. provided the volume and information for the high-
resolution ex vivo dataset. All authors reviewed the
paper.

8 Additional Information

Competing ﬁnancial interests: C.S.P., E.C. and J.C.A.
declare no competing ﬁnancial interests.

Page 11 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

References

[1] Dario Amodei et al. “Deep-speech 2: End-to-end
speech recognition in English and Mandarin”.
In: Jmlr W&Cp 48 (2015), p. 28. arXiv: 1512.
02595.

[2] Shalini A Amukotuwa and Mark J Cook. “Spinal
Disease: Neoplastic, Degenerative, and Infective
Spinal Cord Diseases and Spinal Cord Compres-
sion”. In: Clinical Gate (2007), pp. 511–538.

[3] Andrew J. Asman et al. “Groupwise multi-atlas
segmentation of the spinal cord’s internal struc-
ture”. In: Medical Image Analysis 18.3 (2014),
pp. 460–471.

[4] Claudia Blaiotta et al. “A probabilistic frame-
work to learn average shaped tissue templates
and its application to spinal cord image seg-
mentation”. In: Proceedings of the 24th Annual
Meeting of ISMRM, Singapore 1449 (2016).
[5] Tom Brosch et al. “Deep 3D Convolutional En-
coder Networks With Shortcuts for Multiscale
Feature Integration Applied to Multiple Sclerosis
Lesion Segmentation”. In: IEEE Transactions on
Medical Imaging 35.5 (2016), pp. 1229–1239.
[6] Liang-Chieh Chen et al. “Rethinking Atrous Con-
volution for Semantic Image Segmentation”. In:
arXiv preprint (2017). arXiv: 1706.05587.
[7] Liang-Chieh Chen et al. “Semantic Image Seg-
mentation with Deep Convolutional Nets and
Fully Connected CRFs”. In: Iclr (2014), pp. 1–
14. arXiv: 1412.7062.

[8] Esha Datta et al. “Gray matter segmentation
of the spinal cord with active contours in MR
images”. In: NeuroImage 147 (2017), pp. 788–
799.

[9] Benjamin De Leener, Samuel Kadoury, and
Julien Cohen-Adad. “Robust, accurate and fast
automatic segmentation of the spinal cord”. In:
NeuroImage 98 (2014), pp. 528–536.
[10] Benjamin De Leener et al. “SCT: Spinal Cord
Toolbox, an open-source software for process-
ing spinal cord MRI data”. In: NeuroImage 145
(2017), pp. 24–43.

[11] Benjamin De Leener et al. “Segmentation of
the human spinal cord”. In: Magnetic Resonance
Materials in Physics, Biology and Medicine 29.2
(2016), pp. 125–153.

[12] Michal Drozdzal et al. “Learning Normalized
Inputs for Iterative Estimation in Medical Image
Segmentation”. In: arXiv preprint (2017). arXiv:
1702.05174.

[13] Sara M. Dupont et al. “Fully-integrated frame-
work for the segmentation and registration of
the spinal cord white and gray matter”. In: Neu-
roImage 150 (2017), pp. 358–372.

[14] Rémi Giraud et al. “An Optimized PatchMatch
for multi-scale and multi-feature label fusion”.
In: NeuroImage 124 (2016), pp. 770–782.
[15] Peter D Grünwald. Learning, Regularity and

Compression. 2007, pp. 3–40.

[16] Kaiming He et al. “Deep Residual Learning
for Image Recognition”. In: 2016 IEEE Confer-
ence on Computer Vision and Pattern Recognition
(CVPR). 2016, pp. 770–778. arXiv: 1512.03385.
[17] Kaiming He et al. “Delving deep into rectiﬁers:
Surpassing human-level performance on ima-
genet classiﬁcation”. In: Proceedings of the IEEE
International Conference on Computer Vision 11-
18-Dece (2016), pp. 1026–1034. arXiv: 1502.
01852.

[18] Sergey Ioﬀe and Christian Szegedy. “Batch Nor-
malization: Accelerating Deep Network Train-
ing by Reducing Internal Covariate Shift”. In:
arXiv preprint (2015). arXiv: 1502.03167.
[19] M. Jorge Cardoso et al. “STEPS: Similarity and
Truth Estimation for Propagated Segmentations
and its application to hippocampal segmenta-
tion and brain parcelation”. In: Medical Image
Analysis 17.6 (2013), pp. 671–684.

[20] Diederik P. Kingma and Jimmy Lei Ba. “Adam: a
Method for Stochastic Optimization”. In: Inter-
national Conference on Learning Representations
2015 (2015), pp. 1–15. arXiv: 1412.6980v9.

[21] Alex Krizhevsky, Ilya Sutskever, and Geoﬀrey
E Hinton. “ImageNet Classiﬁcation with Deep
Convolutional Neural Networks”. In: Advances
In Neural Information Processing Systems (2012),
pp. 1–9. arXiv: 1102.0183.

[22] Yann LeCun et al. “Deep learning”. In: Nature
521.7553 (2015), pp. 436–444. arXiv: 1312 .
6184v5.

[23] By Honglak Lee et al. “Unsupervised learning of
hierarchical representations with convolutional
deep belief networks”. In: Proceedings of the
26th Annual International Conference on Ma-
chine Learning. 2009, pp. 95–103.

[24] Geert Litjens et al. “A Survey on Deep Learning
in Medical Image Analysis”. In: arXiv preprint
1702.05747 (2017), pp. 1–34. arXiv: 1702 .
05747.

[25] Fausto Milletari, Nassir Navab, and Seyed-
Ahmad Ahmadi. “V-Net: Fully Convolutional
Neural Networks for Volumetric Medical Image
Segmentation”. In: arXiv preprint (2016), pp. 1–
11. arXiv: 1606.04797.

[26] Marie-Eve Paquin et al. “Spinal cord gray mat-
ter atrophy in amyotrophic lateral sclerosis”. In:
American Journal of Neuroradiology, manuscript
(2017).

Page 12 of 13

Spinal cord gray matter segmentation using deep dilated convolutions

[40] Matthew D. Zeiler, Graham W. Taylor, and Rob
Fergus. “Adaptive deconvolutional networks for
mid and high level feature learning”. In: Pro-
ceedings of the IEEE International Conference on
Computer Vision (2011), pp. 2018–2025. arXiv:
1505.04366.

[41] Lvmin Zhang, Yi Ji, and Xin Lin. “Style Trans-
fer for Anime Sketches with Enhanced Residual
U-net and Auxiliary Classiﬁer GAN”. In: arXiv
preprint (2017). arXiv: 1706.03319.

[27] Gabriel Pereyra et al. “Regularizing Neural Net-
works by Penalizing Conﬁdent Output Distri-
butions”. In: arXiv preprint (2017), pp. 1–12.
arXiv: 1701.06548.

[28] Adam Porisky et al. Deep Learning in Medical Im-
age Analysis and Multimodal Learning for Clinical
Decision Support. Vol. 10553. 2017.

[29] Ferran Prados et al. “Fully automated grey and
white matter spinal cord segmentation”. In: Sci-
entiﬁc Reports 6.June (2016), p. 36151.
[30] Ferran Prados et al. “Spinal cord grey matter
segmentation challenge”. In: NeuroImage 152
(2017), pp. 312–329.

[32]

[31] Pranav Rajpurkar et al. “Cardiologist-Level Ar-
rhythmia Detection with Convolutional Neu-
ral Networks”. In: arXiv preprint (2017). arXiv:
1707.01836.
Jorma Rissanen. “A universal prior for integers
and estimation by minimum description length”.
In: The Annals of statistics (1983), pp. 416–431.
[33] Olaf Ronneberger, Philipp Fischer, and Thomas
Brox. “U-net: Convolutional networks for
biomedical image segmentation”. In: Lecture
Notes in Computer Science (including subseries
Lecture Notes in Artiﬁcial Intelligence and Lecture
Notes in Bioinformatics) 9351 (2015), pp. 234–
241. arXiv: 1505.04597.

[34] Regina Schlaeger et al. “Spinal cord gray matter
atrophy correlates with multiple sclerosis dis-
ability”. In: Annals of Neurology 76.4 (2014),
pp. 568–580.

[35] P.Y. Simard, Dave Steinkraus, and J.C. Platt.
“Best practices for convolutional neural net-
works applied to visual document analysis”. In:
Seventh International Conference on Document
Analysis and Recognition, 2003. Proceedings. 1.Ic-
dar (2003), pp. 958–963.

[36] Nitish Srivastava et al. “Dropout: A Simple Way
to Prevent Neural Networks from Overﬁtting”.
In: Journal of Machine Learning Research 15
(2014), pp. 1929–1958. arXiv: 1102.4807.
[37] Christian Szegedy et al. “Rethinking the Incep-
tion Architecture for Computer Vision”. In: arXiv
preprint (2015). arXiv: 1512.00567.
Jason Yosinski et al. “Understanding Neural Net-
works Through Deep Visualization”. In: arXiv
preprint (2015). arXiv: 1506.06579.

[38]

[39] Fisher Yu and Vladlen Koltun. “Multi-Scale Con-
text Aggregation by Dilated Convolutions”. In:
Iclr (2016), pp. 1–9. arXiv: 1511.07122.

Page 13 of 13

