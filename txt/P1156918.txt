Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

1 + (1

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

39.71

39.61

43.71

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

39.71

39.61

42.95

43.71

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

Hansards

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

Hansards

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

Hansards

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

39.71

42.95

43.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

Hansards

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

1 + (1

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

Hansards

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

34.25
35.98
37.29
35.29
35.44
34.55
38.38

38.34
39.81
41.15
40.11
39.83
40.37
42.32

-
-
-
-
40.12
39.65
-

31.14

42.95

39.71

43.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

Hansards

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

Hansards

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

39.71

39.61

43.71

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

Simplifying Neural Machine Translation with Addition-Subtraction
Twin-Gated Recurrent Networks

Biao Zhang1, Deyi Xiong2, Jinsong Su1

∗, Qian Lin1 and Huiji Zhang3

Xiamen University, Xiamen, China1
Soochow University, Suzhou, China2
Xiamen Meiya Pico information Co.,Ltd. Xiamen, China3

@stu.xmu.edu.cn, dyxiong@suda.edu.cn, jssu@xmu.edu.cn

zhanghj@300188.cn

zb,qianl
}

{

Abstract

In this paper, we propose an addition-
subtraction twin-gated recurrent network
(ATR) to simplify neural machine translation.
The recurrent units of ATR are heavily
simpliﬁed to have the smallest number of
weight matrices among units of all existing
gated RNNs. With the simple addition
and subtraction operation, we introduce a
twin-gated mechanism to build input and
forget gates which are highly correlated.
Despite this
the essential
simpliﬁcation,
non-linearities and capability of modeling
long-distance dependencies are preserved.
the proposed ATR is more
Additionally,
transparent
than LSTM/GRU due to the
simpliﬁcation. Forward self-attention can be
easily established in ATR, which makes the
proposed network interpretable. Experiments
on WMT14 translation tasks demonstrate that
ATR-based neural machine translation can
yield competitive performance on English-
German and English-French language pairs in
terms of both translation quality and speed.
Further experiments on NIST Chinese-English
translation, natural
language inference and
Chinese word segmentation verify the gen-
erality and applicability of ATR on different
natural language processing tasks.1

1

Introduction

Neural machine translation (NMT),
typically
with an attention-based encoder-decoder frame-
work (Bahdanau et al., 2015), has recently be-
come the dominant approach to machine transla-
tion and already been deployed for online trans-
lation services (Wu et al., 2016). Recurrent neu-
ral networks (RNN), e.g., LSTMs (Hochreiter
and Schmidhuber, 1997) or GRUs (Chung et al.,

∗Corresponding author.
1Source

is
https://github.com/bzhangGo/ATR
https://github.com/bzhangGo/zero

code

available

at:
and

2014), are widely used as the encoder and de-
coder for NMT. In order to alleviate the gradient
vanishing issue found in simple recurrent neural
networks (SRNN) (Elman, 1990), recurrent units
in LSTMs or GRUs normally introduce different
gates to create shotcuts for gradient information to
pass through.

Notwithstanding the capability of these gated
recurrent networks in learning long-distance de-
pendencies,
they use remarkably more ma-
trix transformations (i.e., more parameters) than
SRNN. And with many non-linear functions mod-
eling inputs, hidden states and outputs, they are
also less transparent than SRNN. These make
NMT which is based on these gated RNNs suffer
from not only inefﬁciency in training and infer-
ence due to recurrency and heavy computation in
recurrent units (Vaswani et al., 2017) but also difﬁ-
culty in producing interpretable models (Lee et al.,
2017). These also hinder the deployment of NMT
models particularly on memory- and computation-
limited devices.

In this paper, our key interest is to simplify re-
current units in RNN-based NMT. In doing so,
we want to investigate how further we can ad-
vance RNN-based NMT in terms of the number
of parameters (i.e., memory consumption), run-
ning speed and interpretability. This simpliﬁcation
shall preserve the capability of modeling long-
distance dependencies in LSTMs/GRUs and the
expressive power of recurrent non-linearities in
SRNN. The simpliﬁcation shall also reduce com-
putation load and physical memory consumption
in recurrent units on the one hand and allow us to
take a good look into the inner workings of RNNs
on the other hand.

In order to achieve this goal, we propose an
addition-subtraction twin-gated recurrent network
(ATR) for NMT. In the recurrent units of ATR,
we only keep the very essential weight matrices:

8
1
0
2
 
t
c
O
 
0
3
 
 
]
L
C
.
s
c
[
 
 
1
v
6
4
5
2
1
.
0
1
8
1
:
v
i
X
r
a

one over the input and the other over the his-
tory (similar to SRNN). Comparing with previous
RNN variants (e.g., LSTM or GRU), we have the
smallest number of weight matrices. This will re-
duce the computation load of matrix multiplica-
tion. ATR also uses gates to bypass the vanishing
gradient problem so as to capture long-range de-
pendencies. Speciﬁcally, we use the addition and
subtraction operations between the weighted his-
tory and input to estimate an input and forget gate
respectively. These add-sub operations not only
distinguish the two gates so that we do not need to
have different weight matrices for them, but also
make the two gates dynamically correlate to each
other. Finally, we remove some non-linearities in
recurrent units.

Due to these simpliﬁcations, we can easily show
that each new state in ATR is an unnormalized
weighted sum of previous inputs, similar to re-
current additive networks (Lee et al., 2017). This
property not only allows us to trace each state back
to those inputs which contribute more but also es-
tablishes unnormalized forward self-attention be-
tween the current state and all its previous inputs.
The self-attention mechanism has already proved
very useful in non-recurrent NMT (Vaswani et al.,
2017).

We build our NMT systems on the proposed
ATR with a single-layer encoder and decoder.
Experiments on WMT14 English-German and
English-French translation tasks show that our
model yields competitive results compared with
GRU/LSTM-based NMT. When we integrate an
orthogonal context-aware encoder
(still single
layer) into ATR-based NMT, our model (yield-
ing 24.97 and 39.06 BLEU on English-German
and English-French translation respectively) is
even comparable to deep RNN and non-RNN
NMT models which are all with multiple en-
coder/decoder layers.
In-depth analyses demon-
strate that ATR is more efﬁcient than LSTM/GRU
in terms of NMT training and decoding speed.

We adapt our model to other language transla-
tion and natural language processing tasks, includ-
ing NIST Chinese-English translation, natural lan-
guage inference and Chinese word segmentation.
Our conclusions still hold on all these tasks.

2 Related Work

The most widely used RNN models
are
LSTM (Hochreiter and Schmidhuber, 1997)

and GRU (Chung et al., 2014), both of which are
good at handling gradient vanishing problem, a
notorious bottleneck of the simple RNN (Elman,
1990). The design of gates in our model follows
the gate philosophy in LSTM/GRU.

Our work is closely related to the recurrent
additive network (RAN) proposed by Lee et al.
(2017). They empirically demonstrate that many
non-linearities commonly used in RNN transition
dynamics can be removed, and that recurrent hid-
den states computed as purely the weighted sum
of input vectors can be quite efﬁcient in lan-
guage modeling. Our work follows the same spirit
of simplifying recurrent units as they do. But
our proposed ATR is signiﬁcantly different from
RAN in three aspects. First, ATR is simpler than
RAN with even fewer parameters. There are only
two weight matrices in ATR while four different
weight matrices in the simplest version of RAN
(two for each gate in RAN). Second, since the only
difference between the input and forget gate in
ATR is the addition/subtraction operation between
the history and input, the two gates can be learned
to be highly correlated as shown in our analysis.
Finally, although RAN is veriﬁed effective in lan-
guage modeling, our experiments show that ATR
is better than RAN in machine translation in terms
of both speed and translation quality.

To speed up RNN models, a line of work has
attempted to remove recurrent connections. For
example, Bradbury et al. (2016) propose the quasi-
recurrent neural network (QRNN) which uses con-
volutional layers and a minimalist recurrent pool-
ing function to improve parallelism. Very recently,
Lei and Zhang (2017) propose a simple recurrent
unit (SRU). With the cuDNN optimization, their
RNN model can be trained as fast as CNNs. How-
ever, to obtain promising results, QRNN and SRU
have to use deep architectures. In practice, 4-layer
QRNN encoder and decoder are used to gain trans-
lation quality that is comparable to that of single-
layer LSTM/GRU NMT. In particular, our one-
layer model achieves signiﬁcantly higher perfor-
mance than a 10-layer SRU system.

Finally, our work is also related to the efforts
in developing alternative architectures for NMT
models. Zhou et al. (2016) introduce fast-forward
connections between adjacent stacked RNN layers
to ease gradient propagation. Wang et al. (2017a)
propose a linear associate unit to reduce the gradi-
ent propagation length along layers in deep NMT.

(a) LSTM

(b) GRU

(c) ATR

Figure 1: Architecture for LSTM, GRU and ATR. c
∗
network. x

denote the input and output hidden states respectively.

and h

indicates the memory cell speciﬁc to the LSTM

∗

∗

Gehring et al. (2017b) and Vaswani et al. (2017)
explore purely convolutional and attentional archi-
tectures as alternatives to RNNs for neural transla-
tion. With careful conﬁgurations, their deep mod-
els achieve state-of-the-art performance on various
datasets.

3 Addition-Subtraction Twin-Gated

Recurrent Network

Given a sequence x =
{
dates the hidden state ht recurrently as follows:

x1, x2,. . . , xT }

, RNN up-

ht = φ(ht

1, xt)

−

(1)

−

where ht
1 is the previous hidden state, which is
considered to store information from all previous
inputs, and xt is the current input. The function
) is a non-linear recurrent function, abstracting
φ(
·
away from details in recurrent units.

GRU can be considered as a simpliﬁed version
of LSTM. In this paper, theoretically, we use GRU
as our benchmark and propose a new recurrent unit
to further simplify it. The GRU function is deﬁned
as follows (see Figure 1b):

(2)

(3)

(4)

zt = σ(Wzxt + Uzht
rt = σ(Wrxt + Urht
˜ht = tanh(Whxt + Uh(rt (cid:12)
ht
zt)
ht
−

1 + (1

−

1)
1)

−
1))
˜ht

−

−

(cid:12)

(cid:12)

(5)

ht = zt (cid:12)
where
denotes an element-wise multiplication.
The reset gate rt and update gate zt enable man-
ageable information ﬂow from the history and the
current input to the new state respectively. Despite
the success of these two gates in handling gradient
ﬂow, they consume extensive matrix transforma-
tions and weight parameters.

We argue that many of these matrix transfor-
mations are not essential. We therefore propose
an addition-subtraction twin-gated recurrent unit

(ATR), formulated as follows (see Figure 1c):

qt = Whht

1, pt = Wxxt
−
it = σ(pt + qt)
qt)
ft = σ(pt −
ht
pt + ft (cid:12)

−

1

ht = it (cid:12)

(6)

(7)

(8)

(9)

The hidden state ht in ATR is a weighted mixture
of both the current input pt and the history ht
1
−
controlled by an input gate it and a forget gate ft
respectively. Notice that we use the transformed
representation pt for the current input rather than
the raw vector xt due to the potential mismatch in
dimensions between ht and xt.

Similar to GRU, we use gates, especially the
forget gate, to control the back-propagated gradi-
ent ﬂow to make sure gradients will neither vanish
nor explode. We also preserve the non-linearities
of SRNN in ATR but only in the two gates.

There are three signiﬁcant differences of ATR
from GRU. Some of these differences are due to
the simpliﬁcations introduced in ATR. First, we
squeeze the number of weight matrices in gate cal-
culation from four to two (see Equation (2&3) and
(7&8)).
In all existing gated RNNs, the inputs
to gates are weighted sum of the previous hid-
den state and input. In order to distinguish these
gates, the weight matrices over the previous hid-
den state and the current input should be different
for different gates. The number of different weight
in previ-
matrices in gates is therefore 2
ous gated RNNs. Different from them, ATR intro-
duces different operations (i.e., addition and sub-
traction) between the weighted history and input
to distinguish the input and forget gate. Therefore,
the weight matrices over the previous state/input
in the two gates can be the same in ATR. Second,
we keep the very essential non-linearities, only in
In ATR, the role of pt is similar
the two gates.
to that of ˜ht in GRU (see Equation (4)). However,
we completely wipe out the recurrent non-linearity

#gates
|
|

Model
LSTM
GRU
RAN
ATR

# WM # MT

8
6
4
2

8
6
4
2

Table 1: Comparison of LSTM, GRU, RAN and
ATR in terms of the number of weight matrices
(WM) and matrix transformations (MT).

and forget gates, the twin-gated mechanism has
the potential to automatically seek suitable regions
in Figure 2 to control its preference between the
new and past information. We argue that the in-
put and forget gates are negatively correlated after
training, and empirically show their actual corre-
lation in Section 5.1.

3.2 Computation Analysis

Here we provide a systematical comparison of
computations in LSTM, GRU, RAN and our ATR
with respect to the number of weight matrices and
matrix transformations. Notice that all these units
are building blocks of RNNs so that the total com-
putational complexity and the minimum number
of sequential operations required are unchanged,
i.e.
(n) respectively where n is
the sequence length and d is the dimensionality of
hidden states. However, the actual number of ma-
trix transformations in the unit indeed signiﬁcantly
affects the running speed of RNN in practice.

d2) and

(n

O

O

·

We summarize the results in Table 1. LSTM
contains three different gates and a cell state, in-
cluding 4 different neural layers with 8 weight ma-
trices and transformations. GRU simpliﬁes LSTM
by removing a gate, but still involves two gates
and a candidate hidden state. It includes 3 differ-
ent neural layers with 6 weight matrices and trans-
formations. RAN further simpliﬁes GRU by re-
moving the non-linearity in the state transition and
therefore contains 4 weight matrices in its sim-
plest version. Although our ATR also has two
gates, however, there are only 2 weight matrices
and transformations, accounting for only a third
and a quarter of those in GRU and LSTM respec-
tively. To the best of our knowledge, ATR has the
smallest number of weight transformations in ex-
isting gated RNN units. We provide a detailed and
empirical analysis on the speed in Section 5.2.

Figure 2: Visualization of the difference between
y) (the forget
σ(x + y) (the input gate) and σ(x
5, 5].
gate). Here, we set x, y

−

[
−

∈

of ˜ht in pt (i.e., pt = Wxxt). Lee et al. (2017)
show that this non-linearity is not necessary in lan-
guage modeling. We further empirically demon-
strate that it is neither essential in machine trans-
lation. Third, in GRU the gates for ˜ht and ht
1
−
are coupled and normalized to 1 while we do not
explicitly associate the two gates in ATR. Instead,
they can be learned to be correlated in an implicit
way, as shown in the next subsection and our em-
pirical analyis in Section 5.1.

3.1 Twin-Gated Mechanism

Unlike GRU, we use an addition and subtraction
operation over the transformed current input pt
and history qt to differentiate the two gates in
ATR. As the two gates have the same weights for
their input components with only a single differ-
ence in the operation between the input compo-
nents, they act like twins. We term the two gates
in ATR as twin gates and the procedure, shown
in Equation (7&8), as the twin-gated mechanism.
This mechanism endows our model with the fol-
lowing two advantages: 1) Both addition and sub-
traction operations are completely linear so that
fast computation can be expected; and 2) No other
weight parameters are introduced for gates so that
our model is more memory-compact.

A practical question for the twin-gated mech-
anism is whether twin gates are really capable of
dynamically weighting the input and history infor-
mation. To this end, we plot the surface of one-
dimensional σ(x + y)
y) in Figure 2. It
−
is clear that both gates are highly non-linearly cor-
related, and that there are regions where σ(x + y)
is equal to, greater or smaller than σ(x
y). In
other words, by adapting the distribution of input

σ(x

−

−

3.3

Interpretability Analysis of Hidden States

An appealing property of the proposed ATR is
its interpretability. This can be demonstrated by
rolling out Equation (9) as follows:

ht = it (cid:12)
= it (cid:12)

pt + ft (cid:12)
Wxxt +

1

ht
−
1
t
(cid:88)
−

(cid:32)t

k
(cid:89)
−

(cid:33)

ik (cid:12)

fk+l

Wxxk

(cid:12)

k=1

l=1

t
(cid:88)

k=1

≈

gk (cid:12)

Wxxk

(10)

where gk can be considered as an approximate
weight assigned to the k-th input. Similar to the
RAN model (Lee et al., 2017), the hidden state
in ATR is a component-wise weighted sum of the
inputs. This not only enables ATR to build up
essential dependencies between preceding inputs
and the current hidden state, but also allows us
to easily detect which previous words have the
promising impacts on the current state. This de-
sirable property obviously makes ATR highly in-
terpretable.

Additionally, this form of weighted sum is also
related to self-attention (Vaswani et al., 2017). It
can be considered as a forward unnormalized self-
attention where each hidden state attends to all its
previous positions. As the self-attention mech-
anism has proved very useful in NMT (Vaswani
et al., 2017), we conjecture that such property of
ATR partially contributes to its success in machine
translation as shown in our experiments. We visu-
alize the dependencies captured by Equation (10)
in Section 5.3.

4 Experiments

4.1 Setup

We conducted our main experiments on WMT14
English-German and English-French translation
tasks. Translation quality is measured by case-
sensitive BLEU-4 metric (Papineni et al., 2002).
Details about each dataset are as follows:

English-German To compare with previous re-
ported results (Luong et al., 2015b; Jean
et al., 2015; Zhou et al., 2016; Wang et al.,
2017a), we used the same training data of
WMT 2014, which consist of 4.5M sentence
pairs. We used the newstest2013 as our dev
set, and the newstest2014 as our test set.

English-French We used the WMT 2014 train-
ing data. This corpora contain 12M selected
sentence pairs. We used the concatenation
of newstest2012 and newstest2013 as our dev
set, and the newstest2014 as our test set.

The used NMT system is an attention-based
encoder-decoder system, which employs a bidi-
rectional recurrent network as its encoder and
a two-layer hierarchical unidirectional recurrent
network as its decoder, companied with an addi-
tive attention mechanism (Bahdanau et al., 2015).
We replaced the recurrent unit with our proposed
ATR model. More details are given in Ap-
pendix A.1.

We also conducted experiments on Chinese-
language inference
English translation, natural
and Chinese word segmentation. Details and ex-
periment results are provided in Appendix A.2.

4.2 Training

We set the maximum length of training instances
to 80 words for both English-German and English-
French task. We used the byte pair encoding com-
pression algorithm (Sennrich et al., 2016) to re-
duce the vocabulary size as well as to deal with the
issue of rich morphology. We set the vocabulary
size of both source and target languages to 40K for
all translation tasks. All out-of-vocabulary words
were replaced with a token “unk”.

We used 1000 hidden units for both encoder and
decoder. All word embeddings had dimensional-
ity 620. We initialized all model parameters ran-
domly according to a uniform distribution ranging
from -0.08 to 0.08. These tunable parameters were
then optimized using Adam algorithm (Kingma
and Ba, 2015) with the two momentum parame-
ters set to 0.9 and 0.999 respectively. Gradient
clipping 5.0 was applied to avoid the gradient ex-
plosion problem. We trained all models with a
4 and batch size 80. We decayed
learning rate 5e−
the learning rate with a factor of 0.5 between each
training epoch. Translations were generated by
a beam search algorithm that was based on log-
likelihood scores normalized by sentence length.
We used a beam size of 10 in all the experiments.
We also applied dropout for English-German and
English-French tasks on the output layer to avoid
over-ﬁtting, and the dropout rate was set to 0.2.

To train deep NMT models, we adopted the
GNMT architecture (Wu et al., 2016). We kept
all the above settings, except the dimensionality

System
Buck et al. (2014)

Zhou et al. (2016)
Lei and Zhang (2017)
Antonino and Federico (2018)
Wang et al. (2017a)
Wang et al. (2017a)
Wu et al. (2016)
Wu et al. (2016)
Vaswani et al. (2017)

Architecture
WMT14 winner system phrase-based + large LM

Vocab
-

Existing deep NMT systems (perhaps different tokenization)
160K
50K
32K
80K
80K
32K
80K
37K

LSTM with 16 layers + F-F connections
SRU with 10 layers
SR-NMT with 4 layers
GRU with 4 layers + LAU + PosUnk
GRU with 4 layers + LAU + PosUnk + ensemble
LSTM with 8 layers + RL-reﬁned WPM
LSTM with 8 layers + RL-reﬁned ensemble
Transformer with 6 layers + base model

Comparable NMT systems (the same tokenization)

Luong et al. (2015a)
Zhang et al. (2017a)
Gehring et al. (2017b)
Gehring et al. (2017b)
Zhang et al. (2018a)

this work

LSTM with 4 layers + local att. + unk replace
GRU with gated attention + BPE
CNN with 15 layers + BPE
CNN with 15 layers + BPE + ensemble
Transformer with 6 layers + aan + base model

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + RAN + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

50K
40K
40K
40K
32K

40K
40K
40K
40K
40K
40K
40K

tok BLEU detok BLEU

-

20.70

20.60
20.70
23.32
23.80
26.10
24.61
26.30
27.30

20.90
23.84
25.16
26.43
26.31

22.54
22.96
22.14
22.48
23.31
24.16
24.97

-
-
-
-
-
-
-
-

-
-
-
-
-

22.06
22.39
21.40
21.99
22.70
23.59
24.33

Table 2: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
German translation task. “unk replace” and “PosUnk” denotes the approach of handling rare words
in Jean et al. (2015) and Luong et al. (2015a) respectively. “RL” and “WPM” is the reinforcement
learning optimization and word piece model used in Wu et al. (2016). “CA” is the context-aware recurrent
encoder (Zhang et al., 2017b). “LAU” and “F-F” denote the linear associative unit and the fast-forward
architecture proposed by Wang et al. (2017a) and Zhou et al. (2016) respectively. “aan” denotes the
average attention network proposed by Zhang et al. (2018a).

of word embedding and hidden state which we set
to be 512.

4.3 Results on English-German Translation

The translation results are shown in Table 2.
We also provide results of several existing sys-
tems that are trained with comparable experimen-
tal settings to ours.
In particular, our single
model yields a detokenized BLEU score of 21.99.
In order to show that the proposed model can
be orthogonal to previous methods that improve
LSTM/GRU-based NMT, we integrate a single-
layer context-aware (CA) encoder (Zhang et al.,
2017b) into our system. The ATR+CA system fur-
ther reaches 22.7 BLEU, outperforming the win-
ner system (Buck et al., 2014) by a substantial im-
provement of 2 BLEU points. Enhanced with the
deep GNMT architecture, the GNMT+ATR sys-
tem yields a gain of 0.89 BLEU points over the
RNNSearch+ATR+CA and 1.6 BLEU points over
the RNNSearch + ATR. Notice that different from
our system which was trained on the parallel cor-
pus alone, the winner system used a huge mono-

lingual text to enhance its language model.

Compared with the existing LSTM-based (Lu-
ong et al., 2015a) deep NMT system, our shal-
low/deep model achieves a gain of 2.41/3.26 to-
kenized BLEU points respectively. Under the
same training condition, our ATR outperforms
RAN by a margin of 0.34 tokenized BLEU
points, and achieves competitive results against
its GRU/LSTM counterpart. This suggests that
although our ATR is much simpler than GRU,
LSTM and RAN, it still possesses strong model-
ing capacity.

In comparison to several advanced deep NMT
models, such as the Google NMT (8 layers,
24.61 tokenized BLEU) (Wu et al., 2016) and the
LAU-connected NMT (4 layers, 23.80 tokenized
BLEU) (Wang et al., 2017a), the performance of
our shallow model (23.31) is competitive. Par-
ticularly, when replacing LSTM in the Google
NMT with our ATR model, the GNMT+ATR sys-
tem achieves a BLEU score of 24.16, merely 0.45
BLEU points lower. Notice that although all sys-
tems use the same training data of WMT14, the

System

Architecture

Vocab

tok BLEU detok BLEU

Jean et al. (2015)
Luong et al. (2015b)
Sutskever et al. (2014)
Shen et al. (2016)
Zhou et al. (2016)
Wu et al. (2016)
Wang et al. (2017a)
Gehring et al. (2017a)
Vaswani et al. (2017)
Gehring et al. (2017b)
Vaswani et al. (2017)
Wu et al. (2016)

this work

Existing end-to-end NMT systems

RNNSearch (GRU) + unk replace + large vocab
LSTM with 6 layers + PosUnk
LSTM with 4 layers
RNNSearch (GRU) + MRT + PosUnk
LSTM with 16 layers + F-F connections + 36M data
LSTM with 8 layers + RL-reﬁned WPM + 36M data
RNNSearch (GRU) with 4 layers + LAU
Deep Convolutional Encoder 20 layers with kernel width 5
Transformer with 6 layers + 36M data + base model
ConvS2S with 15 layers + 36M data
Transformer with 6 layers + 36M data + big model
LSTM with 8 layers + RL WPM + 36M data + ensemble

Our end-to-end NMT systems

RNNSearch + GRU + BPE
RNNSearch + LSTM + BPE
RNNSearch + ATR + BPE
RNNSearch + ATR + CA + BPE
GNMT + ATR + BPE
RNNSearch + ATR + CA + BPE + ensemble

500K
40K
80K
30K
80K
32K
30K
30K
32K
40K
32K
32K

40K
40K
40K
40K
40K
40K

34.11
32.70
30.59
34.23
37.70
38.95
35.10
35.70
38.10
40.46
41.80
41.16

35.89
36.95
36.89
37.88
38.59
39.06

-
-
-
-
-
-
-
-
-
-
-
-

33.41
34.15
34.00
34.96
35.67
36.06

Table 3: Tokenized (tok) and detokenized (detok) case-sensitive BLEU scores on the WMT14 English-
French translation task. “12M data” indicates the same training data as ours, while “36M data” is a
signiﬁcant larger dataset that contains the 12M data.

tokenization of these work might be different from
ours. However, the overall results can indicate the
competitive strength of our model.
In addition,
SRU (Lei and Zhang, 2017), a recent proposed
efﬁcient recurrent unit, obtains a BLEU score of
20.70 with 10 layers, far more behind ATR’s.

We further ensemble eight likelihood-trained
models with different random initializations for
the ATR+CA system. The variance in the tok-
enized BLEU scores of these models is 0.07. As
can be seen from Table 2, the ensemble system
achieves a tokenized and detokenized BLEU score
of 24.97 and 24.33 respectively, obtaining a gain
of 1.66 and 1.63 BLEU points over the single
model. The ﬁnal result of the ensemble system, to
the best of our knowledge, is a very promising re-
sult that can be reached by single-layer NMT sys-
tems on WMT14 English-German translation.

4.4 Results on English-French Translation

Unlike the above translation task, the WMT14
English-French translation task provides a signiﬁ-
cant larger dataset. The full training data have ap-
proximately 36M sentence pairs, from which we
only used 12M instances for experiments follow-
ing previous work (Jean et al., 2015; Gehring et al.,
2017a; Luong et al., 2015b; Wang et al., 2017a).
We show the results in Table 3.

with the CA encoder, outperforming almost all
the listed systems, except the Google NMT (Wu
et al., 2016), the ConvS2S (Gehring et al., 2017b)
and the Transformer (Vaswani et al., 2017). En-
hanced with the deep GNMT architecture,
the
GNMT+ATR system reaches a BLEU score of
38.59, which beats the base model version of the
Transformer by a margin of 0.49 BLEU points.
When we use four ensemble models (the variance
in the tokenized BLEU scores of these ensemble
models is 0.16), the ATR+CA system obtains an-
other gain of 0.47 BLEU points, reaching a tok-
enized BLEU score of 39.06, which is comparable
with several state-of-the-art systems.

5 Analysis

5.1 Analysis on Twin-Gated Mechanism

We provide an illustration of the actual relation be-
tween the learned input and forget gate in Figure
3. Clearly, these two gates show strong negative
correlation. When the input gate opens with high
values, the forget gate prefer to be close. Quantita-
tively, on the whole test set, the Pearson’s r of the
input and forget gate is -0.9819, indicating a high
correlation.

5.2 Analysis on Speed and Model Parameters

Our shallow model achieves a tokenized BLEU
score of 36.89 and 37.88 when it is equipped

As mentioned in Section 3.2, ATR has much fewer
model parameters and matrix transformations. We

Model
RNNSearch+GRU
RNNSearch+LSTM
RNNSearch+RAN
DeepRNNSearch
Transformer
RNNSearch+ATR
RNNSearch+ATR+CA

Train
#PMs
1996
83.5M
1919
93.3M
79.5M
2192
143.0M 894
4961
70.2M
2518
67.8M
3993
63.1M

Test
168 (0.133)
167 (0.139)
170 (0.129)
70 (0.318)
44 (0.485)
177 (0.123)
186 (0.118)

Table 4: Comparison on the training and decoding
speed and the number of model parameters of dif-
ferent NMT models on WMT14 English-German
translation task with beam size 1. #PMs: the num-
ber of model parameters. Train/Test: the number
of words in one second processed during train-
ing/testing. The number in bracket indicates the
average decoding time per source sentence (in sec-
onds).

based systems must generate translation one word
after another. Therefore the parallelization advan-
tage of the Transformer disappears. In comparison
to DeepRNNSearch, the Transformer spends extra
time on performing self-attention over all previous
hidden states.

Our model with the CA structure, using only
63.1M parameters, processes 3993 words per sec-
ond during training and generates 186 words per
second during decoding, which yields substantial
speed improvements over the GRU- and LSTM-
equipped RNNSearch. This is due to the light ma-
trix computation in recurrent units of ATR. No-
tice that the speed increase of ATR over GRU
and LSTM does not reach 3x.
This is be-
cause at each decoding step, there are mainly two
types of computation: recurrent unit and softmax
layer. The latter consumes the most calculation,
which, however, is the same for different models
(LSTM/GRU/ATR).

5.3 Analysis on Dependency Modeling

As shown in Section 3.3, a hidden state in our ATR
can be formulated as a weighted sum of the previ-
ous inputs. In this section, we quantitatively ana-
lyze the weights gk in Equation (10) induced from
Equation (13). Inspired by Lee et al. (2017), we
visualize the captured dependencies of an exam-
ple in Figure 4 where we connect each word to
the corresponding previous word with the highest
weight gk.

Obviously, our model can discover strong
local dependencies.
the to-
ken “ungl¨uck@@” and “lichen” should be a

For example,

(cid:80)

(cid:80)

i it,i/ 1
dh

Figure 3: Visualization of correlation between
the input and forget gate learned in Equation
(13). For each gate, we record its mean value
( 1
i ft,i) with its position on new-
dh
stest2014, and then average all gate values for each
position over all test sentences. This ﬁgure illus-
trates the position-wise input and forget gate val-
ues.

provide more details in this section by comparing
against the following two NMT systems:

•

•

DeepRNNSearch (GRU): a deep GRU-
(Wu et al.,
equipped RNNSearch model
2016) with 5 layers. We set the dimension
of word embedding and hidden state to 620
and 1000 respectively.

Transformer:
a purely attentional transla-
tor (Vaswani et al., 2017). We set the di-
mension of word embedding and ﬁlter size to
512 and 2048 respectively. The model was
trained with a minibatch size of 256.

We also compare with the GRU and LSTM-based
RNNSearch. Without speciﬁc mention, all other
experimental settings for all these models are the
same as for our model. We implement all these
models using the Theano library, and test the speed
on one GeForce GTX TITAN X GPU card. We
show the results on Table 4.

We observe that the Transformer achieves the
best training speed, processing 4961 words per
second. This is reasonable since the Transformer
can be trained in full parallelization. On the con-
trary, DeepRNNSearch is the slowest system. As
RNN performs sequentially, stacking more lay-
ers of RNNs inevitably reduces the training efﬁ-
ciency. However, this situation becomes the re-
verse when it comes to the decoding procedure.
The Transformer merely generates 44 words per
second while DeepRNNSearch reaches 70. This
is because during decoding, all these beam search-

Figure 4: Visualization of dependencies on a target (German) sentence (selected from newstest2014).
“@@” indicates a separator that splits one token into two pieces of sub-words.

Our model successfully asso-
single word.
ciates “ungl¨uck@@” closely to the generation
of “lichen” during decoding.
In addition, our
model can also detect non-consecutive long-
distance dependencies. Particularly, the predic-
tion of “Parteien” relies heavily on the token
“ungl¨ucklichen”, which actually entails an amod
linguistic dependency relationship. These cap-
tured dependencies make our model more inter-
pretable than LSTM/GRU.

6 Conclusion and Future Work

This paper has presented a twin-gated recurrent
network (ATR) to simplify neural machine trans-
lation. There are only two weight matrices and
matrix transformations in recurrent units of ATR,
making it efﬁcient in physical memory usage and
running speed. To avoid the gradient vanishing
problem, ATR introduces a twin-gated mechanism
to generate an input gate and forget gate through
linear addition and subtraction operation respec-
tively, without introducing any additional param-
eters. The simpliﬁcations allow ATR to produce
interpretable results.

Experiments on English-German and English-
French translation tasks demonstrate the effective-
ness of our model. They also show that ATR
can be orthogonal to and applied with methods
that improve LSTM/GRU-based NMT, indicated
by the promising performance of the ATR+CA
system. Further analyses reveal that ATR can be
trained more efﬁciently than GRU. It is also able to
transparently model long-distance dependencies.

We also adapt our ATR to other natural lan-
guage processing tasks. Experiments show en-
couraging performance of our model on Chinese-
language inference
English translation, natural
and Chinese word segmentation, demonstrating its
generality and applicability on various NLP tasks.
In the future, we will continue to examine the
effectiveness of ATR on different neural models
for NMT, such as the hierarchical NMT model (Su
et al., 2018b) as well as the generative NMT

model (Su et al., 2018a). We are also interested
in adapting our ATR to summarization, semantic
parsing etc.

Acknowledgments

The authors were supported by National Nat-
ural Science Foundation of China (Grants No.
61672440, 61622209 and 61861130364), the Fun-
damental Research Funds for the Central Universi-
ties (Grant No. ZK1024), and Scientiﬁc Research
Project of National Language Committee of China
(Grant No. YB135-49). Biao Zhang greatly ac-
knowledges the support of the Baidu Scholarship.
We also thank the reviewers for their insightful
comments.

References

M. Antonino and M. Federico. 2018. Deep Neural
Machine Translation with Weakly-Recurrent Units.
ArXiv e-prints.

Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-
gio. 2015. Neural machine translation by jointly
learning to align and translate. In Proc. of ICLR.

Samuel R. Bowman, Gabor Angeli, Christopher Potts,
and Christopher D. Manning. 2015. A large anno-
tated corpus for learning natural language inference.
In Proc. of EMNLP. Association for Computational
Linguistics.

Samuel R. Bowman, Jon Gauthier, Abhinav Ras-
togi, Raghav Gupta, Christopher D. Manning, and
Christopher Potts. 2016. A fast uniﬁed model for
In Proc. of
parsing and sentence understanding.
ACL, pages 1466–1477.

James Bradbury, Stephen Merity, Caiming Xiong, and
Richard Socher. 2016. Quasi-recurrent neural net-
works. CoRR, abs/1611.01576.

Christian Buck, Kenneth Heaﬁeld, and Bas van Ooyen.
2014. N-gram counts and language models from
the common crawl. In Proc. of LREC, pages 3579–
3584, Reykjavik, Iceland.

Xinchi Chen, Xipeng Qiu, Chenxi Zhu, Pengfei Liu,
and Xuanjing Huang. 2015. Long short-term mem-
ory neural networks for chinese word segmentation.
In Proc. of EMNLP, pages 1197–1206.

Jianpeng Cheng, Li Dong, and Mirella Lapata. 2016.
Long short-term memory-networks for machine
reading. In Proc. of EMNLP, pages 551–561.

Junyoung Chung, C¸ aglar G¨ulc¸ehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. CoRR.

Jeffrey L Elman. 1990. Finding structure in time. Cog-

nitive science, 14(2):179–211.

Jonas Gehring, Michael Auli, David Grangier, and
Yann N. Dauphin. 2017a. A convolutional encoder
In Proc. of
model for neural machine translation.
ACL, pages 123–135.

Jonas Gehring, Michael Auli, David Grangier, Denis
Yarats, and Yann N. Dauphin. 2017b. Convolutional
sequence to sequence learning.

Sepp Hochreiter and J¨urgen Schmidhuber. 1997. Long
short-term memory. Neural Comput., 9:1735–1780.

S´ebastien Jean, Kyunghyun Cho, Roland Memisevic,
and Yoshua Bengio. 2015. On using very large tar-
get vocabulary for neural machine translation.
In
Proc. of ACL-IJCNLP, pages 1–10.

Diederik P. Kingma and Jimmy Ba. 2015. Adam: A
method for stochastic optimization. Proc. of ICLR.

Kenton Lee, Omer Levy, and Luke Zettlemoyer.
CoRR,
Recurrent additive networks.

2017.
abs/1705.07393.

T. Lei and Y. Zhang. 2017. Training RNNs as Fast as

CNNs. ArXiv e-prints.

Yang Liu, Chengjie Sun, Lei Lin, and Xiaolong Wang.
2016.
language inference us-
ing bidirectional LSTM model and inner-attention.
CoRR, abs/1605.09090.

Learning natural

Thang Luong, Hieu Pham, and Christopher D. Man-
Effective approaches to attention-
In Proc. of

ning. 2015a.
based neural machine translation.
EMNLP, pages 1412–1421.

Thang Luong, Ilya Sutskever, Quoc Le, Oriol Vinyals,
and Wojciech Zaremba. 2015b. Addressing the rare
In
word problem in neural machine translation.
Proc. of ACL-IJCNLP, pages 11–19.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proc. of ACL, pages
311–318.

Wenzhe Pei, Tao Ge, and Baobao Chang. 2014. Max-
margin tensor neural network for chinese word seg-
In Proc. of ACL, pages 293–303, Bal-
mentation.
timore, Maryland. Association for Computational
Linguistics.

Jeffrey Pennington, Richard Socher, and Christo-
pher D. Manning. 2014. Glove: Global vectors for
In Proc. of EMNLP, pages
word representation.
1532–1543.

Tim Rockt¨aschel, Edward Grefenstette, Karl Moritz
Hermann, Tomas Kocisky, and Phil Blunsom. 2016.
Reasoning about entailment with neural attention.
In Proc. of ICLR.

Rico Sennrich, Barry Haddow, and Alexandra Birch.
2016. Neural machine translation of rare words with
subword units. In Proc. of ACL, pages 1715–1725.

Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua
Wu, Maosong Sun, and Yang Liu. 2016. Minimum
risk training for neural machine translation. In Proc.
of ACL, pages 1683–1692, Berlin, Germany. Asso-
ciation for Computational Linguistics.

Richard Sproat and Thomas Emerson. 2003.

The
ﬁrst international chinese word segmentation bake-
In Proceedings of the Second SIGHAN Work-
off.
shop on Chinese Language Processing - Volume 17,
SIGHAN ’03, pages 133–143.

Jinsong Su, Shan Wu, Deyi Xiong, Yaojie Lu, Xian-
pei Han, and Biao Zhang. 2018a. Variational re-
current neural machine translation. arXiv preprint
arXiv:1801.05119.

Jinsong Su, Jiali Zeng, Deyi Xiong, Yang Liu, Mingx-
uan Wang, and Jun Xie. 2018b. A hierarchy-
to-sequence attentional neural machine translation
model. IEEE/ACM Transactions on Audio, Speech
and Language Processing (TASLP), 26(3):623–632.

Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014.
Sequence to sequence learning with neural net-
works.
In Z. Ghahramani, M. Welling, C. Cortes,
N. D. Lawrence, and K. Q. Weinberger, editors, Ad-
vances in Neural Information Processing Systems
27, pages 3104–3112. Curran Associates, Inc.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob
Uszkoreit, Llion Jones, Aidan N Gomez, Ł ukasz
Kaiser, and Illia Polosukhin. 2017. Attention is all
you need. In I. Guyon, U. V. Luxburg, S. Bengio,
H. Wallach, R. Fergus, S. Vishwanathan, and R. Gar-
nett, editors, Advances in Neural Information Pro-
cessing Systems 30, pages 5998–6008. Curran As-
sociates, Inc.

Ivan Vendrov, Ryan Kiros, Sanja Fidler, and Raquel
Urtasun. 2015. Order-embeddings of images and
language. CoRR, abs/1511.06361.

M. Wang, Z. Lu, J. Zhou, and Q. Liu. 2017. Deep
Neural Machine Translation with Linear Associative
Unit. ArXiv e-prints.

Mingxuan Wang, Zhengdong Lu, Jie Zhou, and Qun
Liu. 2017a. Deep neural machine translation with
linear associative unit. In Proc. of ACL, pages 136–
145, Vancouver, Canada.

Shuohang Wang and Jing Jiang. 2016. Learning nat-
In Proc. of

ural language inference with lstm.
NAACL, pages 1442–1451.

Zhiguo Wang, Wael Hamza, and Radu Florian. 2017b.
Bilateral multi-perspective matching for natural lan-
guage sentences. CoRR, abs/1702.03814.

Yonghui Wu, Mike Schuster, Zhifeng Chen, Quoc V.
Le, Mohammad Norouzi, Wolfgang Macherey,
Maxim Krikun, Yuan Cao, Qin Gao, Klaus
Macherey, Jeff Klingner, Apurva Shah, Melvin
Johnson, Xiaobing Liu, Lukasz Kaiser, Stephan
Gouws, Yoshikiyo Kato, Taku Kudo, Hideto
Kazawa, Keith Stevens, George Kurian, Nishant
Patil, Wei Wang, Cliff Young, Jason Smith, Jason
Riesa, Alex Rudnick, Oriol Vinyals, Greg Corrado,
Macduff Hughes, and Jeffrey Dean. 2016. Google’s
neural machine translation system: Bridging the gap
between human and machine translation. CoRR,
abs/1609.08144.

Naiwen Xue, Fei Xia, Fu-dong Chiou, and Marta
Palmer. 2005. The penn chinese treebank: Phrase
structure annotation of a large corpus. Nat. Lang.
Eng., 11(2):207–238.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2017a. A
gru-gated attention model for neural machine trans-
lation. CoRR, abs/1704.08430.

Biao Zhang, Deyi Xiong, and Jinsong Su. 2018a. Ac-
celerating neural transformer via an average atten-
In Proc of ACL, pages 1789–1798.
tion network.
Association for Computational Linguistics.

Biao Zhang, Deyi Xiong, Jinsong Su, and Hong Duan.
2017b. A context-aware recurrent encoder for
IEEE/ACM Transac-
neural machine translation.
tions on Audio, Speech, and Language Processing,
PP(99):1–1.

Jinchao Zhang, Mingxuan Wang, Qun Liu, and Jie
Zhou. 2017c. Incorporating word reordering knowl-
edge into attention-based neural machine transla-
tion. In Proc. of ACL, pages 1524–1534, Vancouver,
Canada. Association for Computational Linguistics.

Xiangwen Zhang, Jinsong Su, Yue Qin, Yang Liu, Ron-
grong Ji, and Hongji Wang. 2018b. Asynchronous
bidirectional decoding for neural machine transla-
tion. CoRR, abs/1801.05122.

Xiaoqing Zheng, Hanyang Chen, and Tianyu Xu. 2013.
Deep learning for chinese word segmentation and
pos tagging. In Pro. of EMNLP, pages 647–657.

Zaixiang Zheng, Hao Zhou, Shujian Huang, Lili Mou,
Xinyu Dai, Jiajun Chen, and Zhaopeng Tu. 2017.
Modeling past and future for neural machine trans-
lation. CoRR, abs/1711.09502.

Jie Zhou, Ying Cao, Xuguang Wang, Peng Li, and Wei
Xu. 2016. Deep recurrent models with fast-forward
connections for neural machine translation. Trans-
actions of the Association for Computational Lin-
guistics, 4:371–383.

A Appendix

A.1 Neural Machine Translation with ATR

We replace LSTM/GRU with our proposed ATR
to build NMT models under the attention-based
framework (Bahdanau et al.,
encoder-decoder
2015). The encoder that reads a source sentence is
a bidirectional recurrent network. Formally, given
a source sentence x =
, the en-
coder is formulated as follows:

x1, x2, . . . , xn}

{

−→h i = ATR(−→h i

1, xi), ←−h i = ATR(←−h i+1, xi)

−

(11)

where ATR(
) is deﬁned by Equation (6&9). The
·
forward −→h i and backward ←−h i hidden states are
concatenated together to represent the i-th word:
hi = [−→h i; ←−h i].

The decoder is a conditional language model
that predicts the j-th target word via a multilayer
perception:

−

x, y<j) = softmax(g(yj

1, tanh(sj), cj))
p(yj|
(12)
where y<j
is the
is a partial translation.
translation-sensitive semantic vector computed via
the attention mechanism (Bahdanau et al., 2015)
n
i=1 and in-
based on the source states
ternal target state (cid:101)sj, and sj is the j-th target-side
hidden state calculated through a two-level hierar-
chy:

tanh(hi)
}
{

cj

(cid:101)sj = ATR(sj

1, yj

−

−

1), sj = ATR((cid:101)sj, cj)

(13)

A.2 Additional Experiments

A.2.1 Experiments on Chinese-English

Translation

Our training data consists of 1.25M sentence pairs
including 27.9M Chinese words and 34.5M En-
glish words respectively.2 We used the NIST 2005
dataset as our dev set, and the NIST 2002, 2003,
2004, 2006 and 2008 datasets as our test sets.
Unlike WMT14 translation tasks, we used word-
based vocabulary for Chinese-English, preserving
top-30K most frequent source and target words in
the vocabulary. Case-insensitive BLEU-4 metric
was used to evaluate the translation quality.
Translation Results

2This corpora contain LDC2002E18, LDC2003E07,
LDC2004T07,

portion

of

LDC2003E14,
LDC2004T08 and LDC2005T06.

Hansards

We compare our model against several ad-

vanced models on the same dataset, including:

•

•

•

•

•

•

•

Coverage (Wang et al., 2017): an attention-
based NMT system enhanced with a coverage
mechanism to handle the over-translation and
under-translation problem.

MemDec (Wang et al., 2017): an attention-
based NMT system that replaces the vanilla
decoder with a memory-enhanced decoder
to better capture important information for
translation.

DeepLAU (Wang et al., 2017):
a deep
attention-based NMT system integrated with
linear associative units that deals better with
gradient propagation.

Distortion (Zhang et al., 2017c):
an
attention-based NMT system that incorpo-
rates word reordering knowledge to encour-
age more accurate attention.

CAEncoder (Zhang et al., 2017b): the same
as our model but uses GRU unit.

FPNMT (Zheng et al., 2017): an attention-
based NMT system that leverages past and
future information to improve the attention
model and the decoder states, also using ad-
dition and subtraction operations.

ASDBNMT (Zhang et al., 2018b):
an
attention-based NMT system that is equipped
with a backward decoder to explore bidirec-
tional decoding.

Table 5 summarizes the results. Although our
model does not involve any sub-networks for mod-
eling the coverage, distortion, memory and future
context, our model clearly outperforms all these
advanced models, achieving an average BLEU
score of 39.82 on all test sets. This strongly
suggests that 1) shallow models are also capable
of generating extremely high-quality translations,
and 2) our ATR model indeed has the ability in
capturing translation correspondence in spite of its
simplicity.

A.2.2 Experiments on Natural Language

Inference

Given two sentences, namely a premise and a hy-
pothesis, this task aims at recognizing whether
the premise can entail the hypothesis. We used

System

Coverage (Wang et al., 2017)
MemDec (Wang et al., 2017)
DeepLAU (Wang et al., 2017)
Distortion (Zhang et al., 2017c)
CAEncoder (Zhang et al., 2017b)
FPNMT (Zheng et al., 2017)
ASDBNMT (Zhang et al., 2018b)

this work

MT05 MT02 MT03 MT04 MT06 MT08
Existing Systems
34.91
35.91
38.07
36.71
36.44
36.75
38.84

34.49
36.16
39.35
38.33
37.63
37.90
40.02
Our end-to-end NMT systems
41.71

-
-
-
-
27.34
-
-

38.34
39.81
41.15
40.11
39.83
40.37
42.32

34.25
35.98
37.29
35.29
35.44
34.55
38.38

-
-
-
-
40.12
39.65
-

31.14

42.95

43.71

39.71

39.61

Table 5: Case-insensitive BLEU scores of advanced systems on the Chinese-English translation tasks.
“

” indicates that no result is provided in the original paper.

−

We

employed

attentional

the Stanford Natural Language Inference Corpus
(SNLI) (Bowman et al., 2015) for this experi-
ment, which involves a collection of 570k human-
written English sentence pairs manually labeled
for balanced classiﬁcation with the labels entail-
ment, contradiction, and neutral. We formulated
this problem as a three-way classiﬁcation task.
the

architec-
ture (Rockt¨aschel et al., 2016) as our basic
model, and replaced its recurrent unit with our
ATR model. We ﬁxed word embedding initialized
with the pre-trained 300-D Glove vector (Pen-
nington et al., 2014). The hidden size of ATR was
also set to 300. We optimized model parameters
using the Adam method (Kingma and Ba, 2015)
with hyperparameters β1 = 0.9 and β2 = 0.999.
The learning rate was ﬁxed at 0.0005. The mini-
batch size was set to 128. Dropout was applied on
both word embedding layer and pre-classiﬁcation
layer to avoid overﬁtting, with a rate of 0.15. The
maximum training epoch was set to 20.
Classiﬁcation Results

Table 6 shows the results. The GRU equipped
model in our implementation achieves a test ac-
curacy of 84.6% with about 3.2m trainable model
parameters, outperforming the LSTM-enhanced
counterpart (Rockt¨aschel et al., 2016) by a margin
of 1.1%. By contrast, the same architecture with
ATR model yields a test accuracy of 85.6%, with
merely 1.5m model parameters. In other words,
using fewer parameters, our ATR model gains a
signiﬁcant improvement of 1.0%, reaching a com-
parable performance against some deep architec-
tures (Cheng et al., 2016).

A.2.3 Experiments on Chinese Word

Segmentation

Chinese word segmentation (CWS) is a fundamen-
tal preprocessing step for Chinese-related NLP

tasks. Unlike other languages, Chinese sentences
are recorded without explicit delimiters. There-
fore, before performing in-depth modeling, re-
searchers need to segment the whole sentence into
a sequence of tokens, which is exactly the goal of
CWS.

{

B, M, E, S

Following previous work (Chen et al., 2015),
we formulate CWS as a sequence labeling task.
Each character in a sentence is assigned with a
, where
unique label from the set
}
indicate Begin, Middle, End of a multi-
B, M, E
{
}
character word respectively, and S denotes a Sin-
gle character word. Given a sequence of char-
acters, we ﬁrst embed them individually through
a character embedding layer, followed by a bidi-
rectional RNN layer to generate context-sensitive
representation for each character. The output rep-
resentations are then passed through a CRF infer-
ence layer to capture dependencies among charac-
ter labels. The whole model is optimized using a
max-margin objective towards minimizing the dif-
ferences between predicted sequences and gold la-
bel sequences.

We used the MSRA and CTB6 datasets to
The former is provided
evaluate our model.
by the second International Chinese Word Seg-
mentation Bakeoff (Sproat and Emerson, 2003),
and the latter
is from Chinese TreeBank6.0
(LDC2007T36) (Xue et al., 2005). For MSRA
dataset, we split the ﬁrst 90% sentences of the
training data as the training set and the rest as the
development set. For CTB6 dataset, we divided
the training, development and test sets in the same
way as in (Chen et al., 2015). Precision, recall,
F1-score and out-of-vocabulary (OOV) word re-
call calculated by the standard back-off scoring
program were used for evaluation.

We set the dimensionality of both character

Model
LSTM encoders (Bowman et al., 2016)
GRU encoders w/ pretraining (Vendrov et al., 2015)
BiLSTM encoders with intra-attention (Liu et al., 2016)
LSTMs w/ word-by-word attention (Rockt¨aschel et al., 2016)
mLSTM word-by-word attention model (Wang and Jiang, 2016)
LSTMN with deep attention fusion (Cheng et al., 2016)
BiMPM (Wang et al., 2017b)
this work with GRU
this work with ATR

d
300
1024
600
100
300
450
100
300
300

#Params Train
83.9
98.8
84.5
85.3
92.0
88.5
90.9
91.0
90.9

3.0m
15m
2.8m
250k
1.9m
3.4m
1.6m
3.2m
1.5m

Test
80.6
81.4
84.2
83.5
86.1
86.3
87.5
84.6
85.6

Table 6: Classiﬁcation results on the SNLI task. For comparison, we provide the model dimension (d),
the parameter amount (# Params), the training accuracy (Train) and the test accuracy (Test). m: million.
We also provide results of several existing RNN models from the SNLI ofﬁcial website.

Model

(Zheng et al., 2013)
(Pei et al., 2014)
(Chen et al., 2015)
this work + LSTM
this work + GRU
this work + ATR

MSRA
R
93.6
94.2
96.2
94.9
95.1
95.1

F
93.3
94.4
96.4
95.2
95.1
95.2

P
92.9
94.6
96.7
95.5
95.2
95.3

CTB6
R
93.1
93.4
94.8
93.1
93.0
93.9

P
94.0
94.4
95.0
93.3
93.3
94.0

F
93.6
93.9
94.9
93.2
93.2
94.0

Table 7: Model performance on MSRA and CTB6 datasets. We report precision (P), recall (R) and
F1-score (F).

embedding and RNN hidden state to be 300.
Model parameters were tuned by Adam algo-
rithm (Kingma and Ba, 2015) with default hyper-
parameters (β1 = 0.9, β2 = 0.999) and mini-
batch size 128. Gradient was clipped when its
norm exceeds 1.0 to avoid gradient explosion.
We applied dropout on both character embedding
layer and pre-CRF layer with a rate of 0.2. The
discount parameter in max-margin objective was
set to 0.2. The maximum training epoch was set to
50. Learning rate was initially set to 0.0005, and
halved after each epoch.
Model Performance

Table 7 shows the overall performance. We
observe that our ATR model performs as ef-
ﬁcient as both GRU and LSTM on this task.
ATR yields a F1-score of 95.2% and 94.0% on
MSRA and CTB6 dataset respectively, almost the
same as that of GRU (95.1%/93.2%) and LSTM
(95.2%/93.2%). Particularly, ATR achieves better
results on CTB6, with a gain of 0.8% F1 points
over GRU and LSTM. This further demonstrates
the effectiveness of the proposed ATR model.

