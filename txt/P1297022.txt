This is the accepted manuscript for: 

https://doi.org/10.1016/j.neuroimage.2018.07.070 

© 2018. This manuscript version is made available under the CC-BY-NC-ND 4.0 license 

TractSeg - Fast and accurate white matter tract segmentation 

Jakob Wasserthal 

a,b

a
​, Klaus H. Maier-Hein 
​, Peter Neher 

a, c 

 

a
​ Division of Medical Image Computing (MIC), German Cancer Research Center (DKFZ), Heidelberg, Germany 
b
​ Medical Faculty Heidelberg, University of Heidelberg, Heidelberg, Germany 
c
​ Section for Automated Image Analysis, Heidelberg University Hospital, Heidelberg, Germany 
{j.wasserthal,  p.neher, k.maier-hein}@dkfz.de 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 
 

characteristics
 
 
 

Abstract
. The individual course of white matter fiber tracts is an important factor for
 
 
 
 
 
in healthy and diseased brains.
analysis of white matter
 
 
 
 
 
 
 
tractography in combination with region-based or
Diffusion-weighted MRI
clustering-based selection of streamlines is a unique combination of tools which
 
 
 
 
 
enables the in-vivo delineation and analysis of anatomically well-known tracts. This,
 
however, currently requires complex, computationally intensive processing pipelines
 
which take a lot of time to set up. TractSeg is a novel convolutional neural
network-based approach that directly segments tracts in the field of fiber orientation
 
 
distribution function (fODF) peaks without using tractography, image registration or
parcellation. We demonstrate that the proposed approach is much faster than existing
 
 
methods while providing unprecedented accuracy, using a population of 105 subjects
from the Human Connectome Project. We also show initial evidence that TractSeg is
 
 
 
 
 
 
able to generalize to differently acquired data sets for most of the bundles. The code
https://github.com/MIC-DKFZ/TractSeg/ and
and data are openly available at
 
 
, respectively. 
https://doi.org/10.5281/zenodo.1088277

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 
 

1. Introduction 
 
White matter fiber tract segmentation enables detailed analysis of individual white matter tracts. It
helps to characterise the healthy brain and identify areas containing abnormal morphology in diseased
 
 
brains (Bells et al., 2011, Yendiki et al., 2011, Yeatman et al., 2012, Dayan et al., 2016). Such
 
 
 
 
tractometry analyses are inherently dependent on the quality of the underlying tract segmentation, and
thus require accurate delineation. 
 
 
Currently, the most commonly employed approach for segmenting white matter tracts is
 
virtual
 
 
: streamlines that correspond to anatomically well-defined tracts are manually extracted
dissection
 
​
 
from a tractogram using combinations of inclusion and exclusion of regions-of-interest (ROIs) (Wang
 
 
 
 
et al., 2007, Stieltjes et al., 2013, Thiebaut de Schotten et al., 2011). This is a very time-consuming
process that has limited reproducibility due to the subjectivity in the human interaction. Therefore, a
 
 
 
variety of automatic approaches for white matter segmentation have been proposed. They can be
 
 
 
grouped into three categories:
 
 
direct
 
. 
segmentation
​
 

 
 
 
 
 
,
ROI-based segmentation
​

 
clustering-based segmentation

 
 
and
​

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

   

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
 
 

 
 
 

 
ROI-based segmentation approaches typically use information from a common atlas space that is
 
registered to the subject in order to extract ROIs in the cortex (parcellation) or in the white matter.
 
 
 
Streamlines are then filtered according to their spatial relation to these ROIs (Cook et al., 2005).
 
Yendiki et al. (2011) used cortical and white matter tract atlases (binary maps) to specify the
morphology of tracts. Wassermann et al. (2016) used a Freesurfer parcellation to characterize different
 
tracts. Yeatman et al. (2012) used ROIs and a probabilistic white matter tract atlas (probability maps). 
 
 
 
Clustering-based segmentation approaches group streamlines into anatomically (Siless et al., 2018) or
spatially coherent clusters. These clusters are either manually (O'Donnell et al., 2016) or automatically
 
 
 
(e.g. using prior knowledge in form of streamline atlases) assigned to anatomically meaningful fiber
 
 
tracts (Jin et al., 2014). Garyfallidis et al. proposed an alternative approach wherein the streamline
 
atlas can be directly incorporated into the clustering process (Garyfallidis et al., 2017). Clayden et al.
and Labra et al. also used streamline atlases in combination with a tract similarity measure to segment
 
tracts (Clayden et al., 2007, Clayden et al., 2009, Labra et al., 2017).  
 
ROI- and clustering-based methods involve whole series of processing steps for atlas registration,
 
tractography, parcellation or clustering. The resulting pipelines are rather complex, computationally
 
 
expensive and tedious to fine-tune. For example, most methods base their inter-subject consistency on
 
a registration between subject and atlas. This in itself is a non trivial task that requires quality
 
 
checking and that might introduce subtle errors which are then propagated through all further
 
 
 
processing steps.  
 
 
Direct segmentation
thus
 
 
 
simplifying the processing chain by directly producing complete tract segmentations from the input
images. A variety of direct methods has already been presented, employing techniques such as
 
 
template matching (Eckstein et al., 2009), Markov Random Field optimization (Bazin et al., 2011),
geometric flow-based segmentation (Guo et al., 2008, Jonasson et al., 2005), surface evolution
 
 
 
 
(Lenglet et al., 2006, Descoteaux et al., 2009) and k-NN based classification (Ratnarajah et al., 2014).
However, the segmentation quality currently reached by these approaches is limited, which in turn has
 
forced recent research to focus on ROI- and clustering-based approaches. 
 
 
 
 
We propose TractSeg as a novel approach to direct white matter tract segmentation that provides
 
is easy to set up, fast to run and does not require
complete and accurate segmentations, yet
 
 
 
 
 
registration, parcellation, tractography or clustering. This is achieved via a fully convolutional neural
 
network (FCNN) that directly segments white matter tracts in fields of fiber orientation distribution
function (fODF) peaks. We used a semi-automatic approach to segment reference segmentations of 72
 
 
anatomically well-describe tracts in a cohort of 105 subjects selected from the Human Connectome
 
 
 
 
Project (HCP) (Van Essen et al., 2013) to train and evaluate our approach. We compared our model to
six other state-of-the-art tract segmentation methods. 

the intermediate generation of streamlines,
 
 
 

 
approaches circumvent
 
​

 
 
 
 

   
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2. Materials and Methods 

An encoder-decoder FCNN that processes the data and generates tract probability maps form the core 
of our method. Figure 1 gives an overview of the proposed segmentation workflow.  

 

Figure 1: TractSeg segmentation pipeline. Constrained Spherical Deconvolution is used to extract the three dominant 
diffusion directions in each voxel. A 2D encoder-decoder FCNN then produces one tract probability image for each 
orientation (coronal, axial, sagittal) and for each tract. The tract probability images from the three orientations are then 
concatenated in the channel dimension resulting in a 3D image with 216 channels. This is used as input for a second FCNN 
which again runs three times. The three outputs per tract from the second FCNN are merged using the 
 to generate the 
Mean
​
final segmentation. The final segmentation is a 72-channel image, wherein each channel contains the voxel probabilities for 
one tract. 

 

2.1. Preprocessing 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
While raw image values could have been used as input for our method, this would have restricted the
 
method to the MRI acquisition used, not even allowing for slight variations in the acquisition setup
 
 
without a complete retraining of the method. Moreover, for high angular resolution datasets, it would
 
have resulted in an input image with a huge number of channels, creating high memory demand and
slow file input/output during training. A more condensed representation of the data was chosen to
 
 
mitigate this problem: TractSeg expects to receive the three principal fiber directions per voxel as
 
input, thus requiring nine different input channels (three per principal direction). In this study, the
 
 
 
 
principal directions were extracted using the multi-shell multi-tissue constrained spherical
 
deconvolution (CSD) and peak extraction available in MRtrix (Jeurissen et al., 2014, Tournier et al.,
 
 
 
2007) with a maximum number of three peaks per voxel. If a voxel contained only one fiber direction
 
 
 
e.g. voxels in the corpus callosum, then the second and third peak are set to zero. The HCP images
have a spatial resolution of 145x174x145 voxels. We cropped them to 144x144x144 without
 
 
removing any brain tissue to make them fit to our network input size. 

 
 
 

 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2.2. Convolutional Neural Network 

 

 

 

 
The proposed 2D encoder-decoder FCNN architecture was inspired by the U-Net encoder-decoder
 
 
 
 
architecture previously proposed by Ronneberger et al. (Ronneberger et al., 2015). Figure 2 details the
proposed network setup. 
 
 

   

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

   

   

   

 
 

 
 

 
 

 
 

 
 
 

 
Figure 2: Proposed TractSeg FCNN architecture. Blue boxes represent multi-channel feature maps. White boxes show
copied feature maps. The gray number on top of each box gives the number of channels, the x-y-size is given at lower left
 
 
corner of each box. Network operations are represented by differently colored arrows. 
 
 
 
The input for the proposed network is a 2D image at 144x144 voxels and 9 channels corresponding to
the 3 peaks per voxel (each peak is represented by a 3D vector). The output is a multi-channel image
 
 
(72 channels) with spatial dimensions of 144x144 voxels, where each channel contains the voxel
 
 
 
probabilities for one tract. These probabilities were converted to binary segmentations by thresholding
 
 
at 0.5. The approach enables for multi-label segmentations with several tracts sharing one voxel. This
 
means that one network can learn all of the tracts simultaneously. To enable this, the softmax
 
 
 
 
activation in the last
 
layer was replaced by a sigmoid activation, which does not require the
probabilities of all classes to sum to one. To avoid a downsized output in comparison to the input we
 
 
padded with half the filter size (rounded down) on both sides. Given a filter size of 3 the padding was
 
 
set to 1. This is also referred to as SAME padding (Dumoulin et al., 2016). 
 
 
While in principle the U-Net architecture allows extensions to 3D image segmentation (Çiçek et al.,
2016), we propose that 2D slices be used as input to boost memory efficiency and enable the data to
 
 
 
be processed at the original HCP resolution. To still leverage the additional information provided by
 
the third dimension, we randomly sampled 2D slices in three different orientations during training:
axial, coronal and sagittal. This meant that our model learned to work with all three of these
 
 
 
orientations. During inference three predictions per voxel per tract were generated, one for each
 
orientation, resulting in an image with dimensions of 144x144x144x72x3 (after running our model
 
144*3 times) and, if we concatenate it along the last 2 dimensions, we get 144x144x144x216 (a 3D
 
 
image with 216 channels). A second FCNN with three input channels per tract (i.e. 3*72=216 input
 
 
 
channels) was trained to optimally merge the three predictions per voxel. However, as the second
 
FCNN also works on 2D slices we can sample in three different orientations (axial, coronal, sagittal)
 

 
 
 
 

 
 
 
 

 
 
 

 
 
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

   

 
 

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
again here. The second FCNN was thus also ran three times, once for every orientation, giving three
 
predictions per voxel per tract. We simply took the mean to merge those to one final segmentation.
The second FCNN is optional. We could have directly used the mean to merge the outputs from the
 
 
first FCNN, but using the second FCNN allows a second network to learn which combination of slice
orientations yields the best prediction for each tract or part of tract individually, thus further
 
 
increasing segmentation quality. 
 

 
 
 

 
 
 

 
 
 

 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2.3. Training 

 
We trained our network using the binary cross-entropy loss. For a given target
 
 
 
 
 
 number of classes, the loss was calculated as follows: 
n
 and 
o
network 
​
​

 

 

 

 

 

 

 

 
an output of the
 
t,
​

 

 

 

l

t = n
oss(o, )  −  

(t[i] 

*  

log(o[i]) 

+   − t
(1

[i]) 

log(1

− o

[i]))

 
.

*  

n
1 ∑
i=0

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
We used rectified linear units (ReLU) as nonlinearity (Nair and Hinton, 2010). Sigmoid activation
 
functions were only used in the last layer. Sigmoid activation paired with binary cross-entropy enables
 
multilabel segmentations. A learning rate of 0.002 was used and Adamax (Kingma and Ba, 2014) was
 
 
   
 
implemented as an optimizer. The batch size was 56. We used dropout (Srivastava et al., 2014) with a
 
probability of 0.4. All hyperparameters were optimized on a validation dataset independent of the
final test dataset. The network weights of the epoch with the highest Dice score during validation were
 
 
 
used for testing. 
 
 
To improve the generalizability of TractSeg, we applied heavy data augmentation to the peak images
during training . The following transformations were applied to each training sample. The intensity of
 
 
each transformation was varied randomly. 
 

 
 
 

 
 

 
 

 
1

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

● Rotation by angle φ  ∼ U [− /4,

  x
● Elastic deformation with alpha and sigma
 

  y

π

π

 

 

/4], φ  ∼ U [− /4,

π

z

 

π

π

π

/4], φ  ∼ U [− /4,
/4]
) ∼ (U [90, 20], U [9, 1])
 

1

1

 

 

 

 

  

 
. A displacement
 

 

 
vector is sampled for each voxel

 

 

 

 

 
, which is then smoothed by a Gaussian filter

 

 

 

 

( σ

  α,
 
 ∼ U [− , ]
d
and finally scaled by 

1 1  

 

 

(

α  
.

1 1

with standard deviation 

 σ
● Displacement by  Δx, y) ∼ (U [− 0, 0], U [− 0, 0]) 
Δ
 ∼ U [0.9,
● Zooming by a factor 
λ
 ∼ U [0.5, ] 
● Resampling (to simulate lower image resolution) with factor 
1  
λ
) ∼ (0, U [0.05]) 
● Gaussian Noise with mean and variance  μ,
 
 
● Contrast augmentation  
* β +  
X augmented = ( − a
 
 ∼ U [0.7,
γ
X augmented = X * γ

● Brightness augmentation 

vg(X)) 

avg(X)

 with 

 with 

1 1

1
.5] 

1
.3] 

( σ

X

β

 

 

 

 ∼ U [0.7,

1
.3] 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 
When training our network on peaks generated by the MRtrix multi-shell multi-tissue CSD method,
 
we found that it did not work well on peaks generated by the standard MRtrix CSD method. In order
 
 
 
to ensure our model worked well with all types of MRtrix peaks, we generated three peak images: (1)
 
2
multi-shell multi-tissue CSD using all gradient directions, (2) standard CSD using only b=1000 s/mm
 
2
​. During
gradient directions, (3) standard CSD using only 12 gradient directions at b=1000 s/mm
 
 
 
 
training, we randomly sampled from these three peak images, thus ensuring that our network worked
 
 
well with all of them. 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

1 https://github.com/MIC-DKFZ/batchgenerators 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
We trained for 500 epochs with each epoch corresponding to 162 batches. This means that over the
 
 
course of the entire training, the network has seen 4,536,000 slices which have been randomly
 
sampled from axial, coronal and sagittal orientations, randomly sampled from three different peak
types and randomly permutated by the data augmentation transformations. 
 
The results presented in section 3 were obtained using an implementation of the proposed method in
 
 
Lasagne (Dieleman et al., 2015). Additionally we provide a Pytorch (pytorch.org) implementation. 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2.4. Reference Segmentations 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

105 subjects from the Human Connectome Project (HCP) were used for the following experiments.
 
The corresponding dMRI images have 1.25mm isotropic resolution and 270 gradient directions with 3
   
 
 
2
 
 
​) and 18 b=0 images (Sotiropoulos et al., 2013). We used the HCP
 
b-values (1000, 2000, 3000 s/mm
 
data that had already been processed by the minimal preprocessing pipeline (e.g. distortion correction,
motion correction, registration to MNI space and brain extraction had already been completed)
 
(Glasser et al., 2013). 
 
We semi-automatically generated binary reference segmentations for 72 major white matter tracts for
 
 
each subject (figure 3). Those reference segmentations are used as labels for training and validating
 
 
our network. We used a series of 5 processing steps (figure 4) to generate these reference
segmentations: 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
Figure 3: Overview of all 72 tracts. For tracts which exist in the left and the right hemisphere only the right one is shown.
 
 
 
The following tracts are included: Arcuate fascicle (AF), Anterior thalamic radiation (ATR), Commissure anterior (CA),

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
Corpus callosum (Rostrum (CC 1), Genu (CC 2), Rostral body (CC 3), Anterior midbody (CC 4), Posterior midbody (CC 5),
 
Isthmus (CC 6), Splenium (CC 7)), Cingulum (CG), Corticospinal tract (CST), Middle longitudinal fascicle (MLF),
 
 
Fronto-pontine tract (FPT), Fornix (FX), Inferior cerebellar peduncle (ICP), Inferior occipito-frontal fascicle (IFO), Inferior
longitudinal fascicle (ILF), Middle cerebellar peduncle (MCP), Optic radiation (OR), Parieto-occipital pontine (POPT),
 
 
Superior cerebellar peduncle (SCP), Superior longitudinal fascicle I (SLF I), Superior longitudinal fascicle II (SLF II),
 
Superior longitudinal fascicle III (SLF III), Superior thalamic radiation (STR), Uncinate fascicle (UF), Thalamo-prefrontal
 
(T_POSTC),
(T_PREF),
 
 
 
Thalamo-parietal (T_PAR), Thalamo-occipital (T_OCC), Striato-fronto-orbital (ST_FO), Striato-prefrontal (ST_PREF),
 
 
Striato-premotor (ST_PREM), Striato-precentral (ST_PREC), Striato-postcentral (ST_POSTC), Striato-parietal (ST_PAR),
Striato-occipital (ST_OCC) 
 

 
Thalamo-postcentral

Thalamo-precentral
 
 

 
 
Thalamo-premotor

 
 
 
(T_PREC),

 
(T_PREM),
 

 
 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
 
 

Figure 4: Examplary depiction of the semi-automatic dissection pipeline of a total of 72 reference tracts in a cohort of 105
 
 
subjects. Images show the left CST of subject 898176. 
 
Step 1 - Tractography. Multi-shell multi-tissue constrained spherical deconvolution was used to
 
 
 
extract the fODF and anatomically constrained probabilistic tractography (iFOD2) for the whole brain
 
was performed using MRtrix (Tournier et al., 2010) to generate 10 million fibers with a minimum
length of 40mm. By generating such a large number of fibers, we were able to reconstruct difficult
 
tracts like the anterior commissure (CA) or the lateral projections of the corticospinal tract (CST) with
 
high completeness in a majority of the subjects. Extracting the fibers that run completely from the left
 
 
cortex through the CA to the right cortex is difficult if a smaller number of fibers is used. The high
fiber count, however, comes at the cost of many false positives which we eliminated using the
 
following steps. Seeds were randomly placed within the brain mask coming with the HCP data.
 
Streamlines were cropped at the gray-matter-white-matter interface. 
Anatomically constrained tractography yielded adequate results for the majority of tracts. However,
 
 
the anatomical constraints did not work well for tracts containing very thin passages like the CA,
 
 
 
uncinate fascicle (UF) or inferior occipito-frontal fascicle (IFO). They are based on a gray matter
segmentation which is based on the T1 image and as a result they do not necessarily fit perfectly to the
 
 
 
 
diffusion weighted image. If a tract is only a few voxels wide and the gray matter segmentation is not
perfect, some critical parts of the tract will be cut off because they are counted as gray matter.
 
 
 
Therefore we used tracking without anatomical constraints for the CA, UF and IFO. 
 
Step 2 - Initial tract extraction. We applied TractQuerier (Wassermann et al., 2016) to extract a first
 
 
approximation of each tract and to make sure streamlines end in the correct cortex regions. Our
 
queries are based on the queries provided by Wassermann et al. (2016) with minor adaptations for

 
   

   
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

   

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
better results with our dataset. The queries used in this work are available online . As was the case in
 
Wassermann et al. (2016), the FreeSurfer cortical parcellations were used. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
   

 
 
 

 
 
 

 
 
The results of TractQuerier contained a considerable amount of false
 
Step 3 - Tract refinement.
positives (see figure 4). This meant that further filtering was needed. We manually defined exclusion
 
 
 
and inclusion ROIs to exclude false positives (Stieltjes et al., 2013). These ROIs s were transferred
 
 
 
between subjects using diffeomorphic registration of the fractional anisotropy (FA) maps.  
 
 
 
We also removed streamlines that run back and forth in the target volume, making 180 degree turns
 
within a length of less than 30 mm. More spurious fibers were filtered by running QuickBundles
clustering (Garyfallidis et al., 2012) and removing clusters that only contained a small number of
 
 
fibers, according to thresholds which varied for each tract. This approach was used very cautiously as
it also tends to remove valid structures such as the lateral projections of the CST, which are rather
 
sparse in streamline space and therefore typically consist of small clusters. Finally, we removed all
 
 
streamlines that run through voxels with low streamline density (threshold differs for each tract).  
 
 
Step 4 - Manual quality control, clean-up. The described steps for automated tract refinement
occasionally removed some of the valid parts of a tract. We manually inspected the results of all
 
 
 
 
filtering steps in all subjects and skipped some of the filters if they removed too many valid fibers.
 
After this process was complete, there were streamlines still remaining which could only be filtered
 
by drawing individual exclusion ROIs manually (Stieltjes et al., 2013). The UF, for example, tended
 
to contain parts of the CA. As a result of inaccurate Freesurfer parcellations, those could not be
properly excluded in all subjects with TractQuerier. The necessary exclusion ROI had to be drawn
 
around the valid part of the UF with minimal margins. Since this required a highly accurate
 
 
 
 
placement, the ROI had to be drawn manually for each subject instead of using the same ROI for all
subjects. 
 
Step 5 - Mask Generation. This semi-automatic process resulted in high quality dissections of a total
 
 
of 72 tracts in in a cohort of 105 subjects. From the final sets of streamlines, we created binary tract
 
masks. These binary masks were analyzed for connected regions and only the biggest connected
 
 
 
regions were retained, thus filtering out
 
single voxels and small groups of voxels that were not
 
connected to the rest. 
 
These binary masks now serve as reference segmentations and are used for training and testing of the
 
proposed segmentation approach. 
 

 
 
 
 

   
 

 
 
 

 
 
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2.5. Reference methods 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

The following automatic tract segmentation methods were used as a benchmark. All these methods are
 
openly available and do not need any proprietary software to run. The methods include
 
clustering-based as well as ROI-based approaches. We give an outline of how they work (1.) and how
 
 
we applied them (2.) here. 
 
 
in a reference subject, RecoBundles
RecoBundles
 
 
 
(Garyfallidis et al., 2017) can be used to find the corresponding streamlines in a new subject. 2. We
 

 
: 1. Given streamlines of a reference tract
 

   
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2 

https://github.com/MIC-DKFZ/TractSeg/blob/master/examples/resources/WMQL_Queries.qry 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
 
 

 
 
 

 
   

 
 
 
 

 
randomly picked 5 reference subjects from the HCP data (each containing the 72 reference tracts we
 
had previously extracted (see 2.4)). Due to the long runtime for RecoBundles, a higher number of
reference subjects was not feasible. Then we ran RecoBundles 5 times for the new subject (once for
 
 
 
each reference subject) using the default RecoBundles parameters. This resulted in 5 extractions of
each tract in the new subject. To get a final segmentation, we took the mean of those 5 extractions. 
 
TRACULA
 
: 1. TRACULA (Yendiki et al., 2011) uses probabilistic tracking and an atlas of the
 
 
 
 
underlying anatomy to segment tracts. 2.Running TRACULA for each subject produced a probability
map for each tract. We selected all voxels with a probability of greater than 0 to create a binary
 
 
 
segmentation. The original paper created a binary segmentation by masking out all values below 20%
 
 
 
of the maximum. However, this leaves only the very core of every tract, thus creating many false
 
 
negatives. Segmenting all values with probability greater than 0 gives better results compared to our
 
reference tracts. TRACULA does not support all of the 72 tracts that we use; it only supports 18. Out
 
 
 
 
of the 18, only 8 tracts match our 72 tracts exactly. Quantitative comparison was therefore only
performed on these 8 tracts. A GPU implementation is available for
 
which is part of the
 
 
bedpost,
​
TRACULA pipeline which we used (Hernandez et al., 2013).  
 
 
 
: 1. WMA (O’Donnell et al., 2012; O’Donnell and Westin, 2007)
WhiteMatterAnalysis (WMA)
clusters streamlines across subjects and generates a cluster atlas out of these. Clusters in the atlas are
 
 
then assigned to certain anatomical tracts. Automated tract delineation is made possible by registering
 
 
new subjects to this atlas. 2. WMA comes with a pre-trained cluster atlas (800 clusters) and
 
predefined mapping of clusters to anatomical tracts (O’Donnell et al., 2016). However, this mapping
 
only includes 10 of the 72 tracts we use. We manually optimized these predefined mappings to better
 
 
 
align them with our reference tracts and added the CA to the mapping. During this process, we were
inherently limited by the finite set of distinct clusters offered by the atlas. We chose not to extend the
 
 
mapping to the remaining 61 tracts as it would have required considerable manual effort, given the
amount of clusters and tracts. Evaluation was therefore only carried out on these 11 tracts. WMA is
 
 
 
very memory intensive. Clustering a tractogram with 1 million fibers requires around 60GB of
memory. Therefore we were not able to use our 10 million fiber tractogram directly, but instead used a
   
 
subset with 500,000 fibers. This reduced the memory consumption to around 30GB. The outlier
 
removal provided by WMA was used to remove spurious fibers. 
 
 
 
: 1. TractQuerier (Wassermann et al., 2016) extracts tracts based on the regions the
 
TractQuerier
 
 
 
 
 
streamlines have to start at, end at and (not) run through. 2. We compared our method to the output
 
from TractQuerier
 
(step 2 from the reference tract extraction pipeline) without any further
 
 
post-processing. 
 
 
In addition to these openly available reference methods, we implemented two additional reference
 
methods in order to provide further insights into the performance of TractSeg:  
 
 
: 1. Several subjects can be averaged to an atlas which can then be
 
 
Atlas registration (Atlas)
registered to new subjects to segment structures. 2. We split our reference data (see 2.4) into training
 
 
 
 
 
 
 
 
and testing data, using the same 5-fold cross-validation as used for the evaluation of our proposed
 
 
 
method. The training data was used to create a tract atlas. Firstly, we registered all subjects to a
 
random subject using symmetric diffeomorphic registration implemented in DIPY (Avants et al.,
 
 
2009, Garyfallidis et al., 2014). Registration was performed based on the FA maps of each image.

 
 
 

 
 
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
After registration, the FA maps of all images were averaged. Then, in a second iteration all images
 
were registered to this mean FA image. This two-stage approach limits the bias introduced by the
initial subject choice in the first iteration. The tract atlas thus contained the tract masks for all 72
 
 
reference tracts (see 2.4). For each tract, we took the mean over all subjects, which produced a
probability map. We thresholded the probability map at 0.5 to create a final binary atlas. During test
 
time, the atlas was registered to the subjects of interest, yielding a binary mask for each tract in
 
 
subject space. 
 
: 1. Using an atlas can blur some of the details as it is
Multiple mask registration (Multi-Mask)
 
 
 
 
based on group averages. The blurring can be reduced to some extent by registering the masks of
 
 
 
 
single training subjects to a test subject instead of an averaged atlas. 2. The same 5 reference subjects
 
as those selected for RecoBundles were used. To segment the tracts in a new subject, we registered
 
each of the 5 reference subjects to the new subject (symmetric diffeomorphic registration of the FA
 
 
maps) and averaged the tract masks (from the reference tracts) of all 5 reference subjects. Finally, we
 
thresholded this average at 0.5 to produce a binary mask for each tract in the space of the new subject.
 
Atlas registration method in that the reference subjects are directly registered to
 
This differs from the
 
 
 
 
subject space and are merged (1 registration) instead of first being registered to atlas space, then
 
 
 
 
 
merging and being registered to subject space (2 registrations needed). Moreover,
 
 
 
Atlas Registration
uses 63 subjects while 
 only uses 5. 
Multi-Mask
​
 

   
 

 
   

 
 
 

 
 
 

 
 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

3. Experiments and results 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
) was used in order to extract the best possible reference
 
 
The high quality HCP data (
HCP Quality
​
tracts. However, in clinical routine, faster MRI protocols are used which result in lower quality data.
 
 
 
 
 
To test how TractSeg performs on clinical quality data, we downsampled the HCP data to 2.5mm
 
 
 
 
2
isotropic resolution and removed all but 32 weighted volumes at b=1000 s/mm
 
 
​. The reference tracts
 
 
 
 
 
 
 
 
 
 
 
 
from the
dataset were reused as our reference tracts here. This provides high quality
HCP Quality
​
Clinical
reference tracts for the low quality data, thus allowing proper evaluation. We call this dataset
 
 
 
 
 
 
 
 
. As this dataset only has one b-value shell, we can not use multi-shell CSD as we did for the
Quality
 
 
 
 
 
 
 
 
​
   
 
 
 
HCP Quality
data. Instead MRtrix standard CSD was employed to generate the peaks of the fODF. 5
​
fold cross validation was used, i.e. 63 training subjects, 21 validation subjects (best epoch selection)
 
and 21 test subjects per fold.  
 
We used the Dice score (Taha et al., 2015) as our evaluation metric, which is one of the most popular
 
measures for evaluating segmentation performance. We calculated the Dice for each subject between
 
 
each of the 72 reference tracts and the respective prediction of either our proposed method or one of
 
the reference methods (e.g. RecoBundles). Then we averaged the Dice results for all 72 tracts to get
 
 
one final Dice score per subject per method.  
The Wilcoxon signed-rank test (Wilcoxon, 1945) was used to test for statistical significance. For
 
 
 
 
 
multiple testing, we applied the Bonferroni correction. Moreover, we evaluated the runtime of the
 
 
 
 
the influence of different orientation fusion strategies and how TractSeg
 
different methods,
 
generalizes to non-HCP data. 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

3.1. Quantitative evaluation 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
HCP Quality

data, looking at the mean Dice score over all 72 reference tracts, TractSeg
On the
 
 
 
 
 
 
​
 
 
 
 
significantly (p<0.001) outperformed the second best method by 9 Dice points and on average
 
 
Clinical Quality
performed 19 Dice points better than the other reference methods (figure 5a). On the
 
 
 
 
 
 
data, TractSeg significantly (p<0.001) outperformed the second best method by 14 Dice points and
 
 
 
performed 22 Dice points better than the reference methods on average (figure 5b). In general,
 
TractSeg was less affected by the quality loss in the clinical data than the reference methods. Please
 
 
 
 
 
 
 
only provide segmentations for a subset of the 72 tracts. The reported
TRACULA
and
WMA
note that
 
 
 
 
 
 
 
 
​
​
are restricted to this subset. 
TRACULA 
and 
WMA 
scores for 
​
​
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

   

   

 
 

 
 
Figure 5: Results on (a) the
 
 
 
 
dataset with a gray dot per subject (mean over
 
 
 
 
dataset and (b) the
 
HCP Quality
Clinical Quality
​
​
 
all tracts) and a colored dot for the mean over
 
 
 
 
 
: Multiple mask registration;
 
 
: Our method;
 
 
all subjects.
 
 
Multi-Mask
Proposed
​
​
: WhiteMatterAnalysis.  
WMA
: Atlas registration; 
Atlas
​
​
*:
do not provide segmentations for all tracts, only for a subset. The score is the mean over
 
 
 
 
 
 
the tracts in
TRACULA
WMA
 
and
 
 
​
​
the subset 
 
 
 
 
Figure 6 shows the segmentation performance for all methods for each individual tract. TractSeg
 
showed quite consistent performance. All tracts had a Dice score over 0.75, except for the fornix (FX)
 
and CA. For these two tracts, the Dice score was noticeably reduced, which is probably caused by the
 
thin and therefore hard to reconstruct shape of these tracts. Moreover, due to limited sensitivity of the
initial tractograms, the CA and FX were not perfectly reconstructed in the reference tracts for some
 
subjects but our model managed to generate a segmentation which was better than the reference
 
 
segmentation (see section 3.2). Therefore good segmentations also received bad Dice scores if the
reference segmentation was incomplete. The reference methods showed a similar accuracy gap
 
between the FX and CA and the remaining tracts. Overall, TractSeg clearly outperformed the
 
 
reference methods. 

 
 
 

 
   

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 
Figure 6: Dice scores for all 72 tracts on the
sorted by score. The full name of each tract can be seen in figure 3. 

 

 

 

 

 

 

 

 
Clinical Quality dataset for our proposed method and all reference methods

 

 

 

 

 

 

 

 

 

 

3.2. Qualitative evaluation 

 

 

 

 

 

 

 
 

For the qualitative evaluation, one subject (623844) was selected from the test set. We chose a subject
 
 
 
whose Dice scores were closest to the mean Dice scores for the entire datasets to make the subject
 
 
representative for the entire dataset. Since the scope of this manuscript does not allow us to show
results for all 72 tracts, we selected three tracts that represent the different degrees of reconstruction
 
 
difficulty (Maier-Hein et al., 2017): the IFO, CST and CA (results for all tracts can be accessed online

   
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

3

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
 
 

 
). The IFO is a tract that is fairly easy to reconstruct, which is reflected by its consistently good
scores for all methods. The CST is more difficult to reconstruct. Its beginning at the brain stem is easy
 
 
 
to reconstruct but as the fibers get closer to the cortex, they start to fan out. Finding these lateral
 
 
 
projections is more difficult. Finally, the CA is tract that is difficult to reconstruct. Due to its very thin
body, it is hard to find fibers that run the entire way from the right to the left temporal lobe. The CA is
 
 
one of the tracts with the lowest performance out of all of the methods. 
 
 
 
Proposed method yielded adequate reconstructions on all three tracts.
 
 
As can be seen in Figure 7, the
 
Multi-Mask registration also produced convincing results on all tracts. Atlas registration results looked
 
 
 
 
 
convincing on the 3D image but included segments passing gray matter and also exiting the brain
 
 
 
 
RecoBundles oversegmented the CST to neighbouring gyri and did
mask, which is obviously wrong.
 
 
not manage to reconstruct the CA completely but showed good results for the IFO.
did
 
TractQuerier
 
 
​
not properly segment any of the example tracts. As it defines tracts mainly by their endpoints, it leaves
 
 
 
 
 
 
 
 
extracts a lot of false
 
TractQuerier
 
much room for wrong turns between the start and end points.
​
positives, especially when using probabilistic tracking. The CA cannot be properly reconstructed with
 
 
 
 
 
 
 
TractQuerier as the default Freesurfer parcellation is not precise enough for the small parts of the CA.
 
 
 
 
yielded a good reconstruction of the stem of the CST, but missed the lateral projections.
 
 
TRACULA
 
 
 
​
 
 
 
 
CA and IFO are not supported by
 
 
. White Matter Analysis (WMA) kept a lot of false
TRACULA
​
positives in the CST and CA but showed good results for the IFO.  
 
 
Clinical Quality dataset (figure 8), as expected, all
 
In a similar comparison of results on the
approaches yielded segmentations of lower quality compared to the respective segmentation on the
 
 
HCP Quality data, to varying extents, as can be seen in figure 8. The registration-based approaches
 
 
 
also tended to segment gray matter or regions outside of the brain while the streamline based
 
approaches suffered from an increased number of false positives. TractSeg seems to be less affected
 
by the lower image quality than most of the benchmark methods, as shown by the quantitative
 
analysis. 
 
 
In general, it can be observed that tracts tend to look good on 3D image but show significant
 
shortcomings on a detailed 2D image. Unfortunately, many of the relevant publications only show
 
 
qualitative results using single 3D images. The segmentations of all methods and all tracts of this
3
​. 
subject are available online

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

https://doi.org/10.5281/zenodo.1154877 

3 

 

 

 

 

 

 

Figure 7: Qualitative comparison of results on
 
commissure anterior (CA) and right inferior occipito-frontal fascicle (IFO) on one random subject.
 
reference tract and 
 
 

 
 
shows the segmentation of the respective method. 
Red 
​

HCP Quality test set: reconstruction of right corticospinal tract (CST),
 
 
 
 
Green shows the

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
Clinical Quality test set: reconstruction of right corticospinal tract (CST),
 
Green shows the
 

 
 
 shows the segmentation of the respective method.  
Red
​

 
Figure 8: Qualitative comparison of results on
commissure anterior (CA) and right inferior occipito-frontal fascicle (IFO) on one random subject.
 
 
reference tract and 
 
 
In some of the reference subjects, some of the more difficult tracts, such as the CA and the lateral
 
projections of the CST, were incompletely reconstructed. The original tractogram contained a few
sparse fibers for those regions, indicating the presence of the tract, however, when applying further
 
 
 
constraints (ending in the correct cortex regions, angular threshold, fiber density) those sparse fibers
 
 
were completely removed. Despite this noise in the training data, the proposed method managed to
learn a complete representation of each tract. This enabled our model to completely segment these
 
 
tracts, even on subjects in whom the reference tracts are incomplete (see figure 9). 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
Figure 9: The proposed method creates anatomically reasonable segmentations even on subjects where the reference
 
 
segmentations are incomplete due to limitations in the extraction pipeline. The presented examples are from the
 
 
 
HCP Quality
dataset (subjects 979984 and 959574). 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

3.3. Transferability between scanners and acquisition settings 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

To test the capability of TractSeg to generalize beyond HCP, which it was trained on, we applied
 
TractSeg to nine differently acquired datasets (see table 1). These nine datasets represent a wide
 
variety of data: Different scanners, different spatial resolutions, different b-values, different number of
 
 
 
gradients, healthy and diseased, normal und abnormal brain anatomy.  
 
Table 1: Acquisition parameters of additional non-HCP test datasets. 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Project 

Pathology 

b-Values 

Preprocessing 

Resolution 
(isotropic) 

Scanner field 
strength 

TRACED  4

healthy 

2.5mm 

2 
3x b=0mm/s
2 
20x b=1000mm/s
2 
48x b=2000mm/s

denoising,  
eddy current and 
motion correction 

3T 

4 

https://my.vanderbilt.edu/ismrmtraced2017/ 

 

Internal (Healthy) 

healthy 

2.5mm 

2 
64x b=3000mm/s

2 
1x b=0mm/s
2 
81x b=1000mm/s
2 
81x b=2000mm/s
2 
81x b=3000mm/s

2 
5x b=0mm/s
2 
30x b=800mm/s

2 
1x b=0mm/s
2 
64x b=1000mm/s
2 
64x b=2000mm/s
2 
64x b=3500mm/s

healthy 

2.0mm 

BrainGluSchi 
(Bustillo
 
 
et
2016) 

 
al.,

Stanford_hardi 
(Rokem et al., 2013) 

healthy 

2.0mm 

2 
10x b=0mm/s
2 
150x b=2000mm/s

Sherbrooke_3shell  5

healthy 

2.5mm 

COBRE 
(Çetin et al., 2014) 

schizophrenia, 
enlarged 
ventricles 

2.0mm 

2 
5x b=0mm/s
2 
30x b=800mm/s

SoftSigns 
(Hirjak et al., 2017) 

neurological 
soft signs 

2.5mm 

2 
1x b=0mm/s
2 
81x b=1000mm/s

Internal (Autism) 

2.5mm 

autism 
spectrum 
disorder 

Internal 
(Schizophrenia) 

schizophrenia 

1.7mm 

2 
5x b=0mm/s
2 
60x b=1000mm/s

2 
3x b=0mm/s
2 
60x b=1500mm/s

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

3T 

3T 

3T 

3T 

3T 

3T 

3T 

3T 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 
 
 
An expert manually dissected the three tracts already shown in the above qualitative evaluation (CST,
 
 
CA and IFO) from one randomly chosen subject from each dataset shown in Table 1 (from the
COBRE dataset we choose 3 subjects: one healthy, one with schizophrenia and one with
 
 
schizophrenia and enlarged ventricles). Visual comparisons were performed between manual
 
 
 
 
 
 
dissections and TractSeg as well as the previously introduced reference methods
 
 
 
Multi-Mask, Atlas,
 
,
Atlas
Multi-Mask
TractSeg
 
. Methods depending on reference data (
TractQuerier
 
RecoBundles and
 
 
,
 
,
 
 
 
 
 
​
​
​
​
 
) were provided with our HCP reference data. All subjects were rigidly registered to MNI
RecoBundles
 
 
 
 
 
 
 
 
 
​
space. This is not required for TractSeg to work. TractSeg only requires that the left/right, front/back
 
 
 
 
 
 
 
 
 
 
 
 
and up/down orientation of the images are the same as for the HCP data (i.e. images are not
 
).
mirrored
​
Rigid registration to MNI space is an easy way to ensure this. 
 
 
TractSeg showed anatomically plausible results for all subjects and most of the tracts. Only the CA
 
 
and the Fornix (FX) were not completely reconstructed in around half of the subjects. We observed
partly incomplete manual reference dissections in these areas as well, indicating that the size of these
 
 
very thin structures is reaching the resolution limit of the underlying imaging acquisition. More
 
 
complete results could also be achieved by lowering the threshold for converting the CA and FX

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

http://nipy.org/dipy/reference/dipy.data.html#fetch-sherbrooke-3shell 

5 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
probability maps, which are generated by TractSeg, to binary maps. This would increase sensitivity at
the cost of specificity. Figures 10 and 11 show exemplary results for two of the subjects. The other
 
nine subjects can be found in the supplementary materials. 
 
Figure 10 shows the results for one healthy subject from the COBRE dataset (2mm isotropic
2
 
​). For the CST and IFO TractSeg yielded segmentations similar to the
resolution, 30x b=800mm/s
 
 
manual dissection. For the CA TractSeg missed parts but also the manual dissection was not able to
 
 
 
 
TractQuerier showed more complete results
Multi-Mask, Atlas
 
reconstruct the CA completely.
 
 
 
and
 
 
​
 
 
 
 
however this comes at the price of severe over-segmentation (false positives). For the CST and IFO,
Multi-Mask and Atlas even segmented non-brain areas and for the CA they segment major areas
 
 
 
around the CA. The CA was not
 
 
 
also
​
over-segmented the CST, but missed parts of the CA and IFO. 

 
 
 
 
reconstructed at all by

 
 
 
.
TractQuerier
​

 
 
 
RecoBundles

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

Figure 10: Qualitative comparison of results on one healthy subject from the COBRE dataset while being trained on the HCP
 
dataset: reconstruction of right corticospinal tract (CST), commissure anterior (CA) and right inferior occipito-frontal
 
 
fascicle (IFO). 
 
 
Figure 11 shows the results for a schizophrenia patient with abnormally large ventricles from the
 
 
COBRE dataset. Even though TractSeg has only seen healthy subjects with normally sized ventricles
 
during training it managed to properly segment the main pathway of the CST. It missed small parts of
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 
the lateral projections of the CST but the same is true for the manual dissection.
results but again at the cost of heavy over-segmentation even of parts of the ventricles. 

 

 

 

 

 

 

 

 

 

 

 

 

 
Atlas shows complete

 

 

 

Figure 11: Qualitative comparison of results on one subject with schizophrenia and enlarged ventricles: reconstruction of
 
 
right corticospinal tract (CST). 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

3.3. Fusion strategies 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
As described in section 2, we ran our model once for each orientation (axial, sagittal and coronal).
This results in 3 predictions for each test image, which was merged into one final segmentation using
 
 
 
a second FCNN. However, using two FCNNs instead of just one requires more resources during
 
 
 
 
 
 
 
Therefore, also two simpler fusion strategies were
training and increases the runtime for inference.
 
also evaluated: Taking the 
 and 
Mean
​
 
 
HCP
 
. On
 
 
Majority Voting
 
 
Figure 12 shows the results:
 
​
 
 
 
 
Quality,
Second FCNN approach (0.2 Dice
 
 
 
 
Second
 
points). However, on
 
 
Clinical Quality, Mean performed significantly worse (p<0.001) than the
 
 
 
 
(1.9 Dice points). Thus, in practical applications, the benefits of improved training and
FCNN
 
 
 
​
 
 
Mean fusion strategy may outweigh the gains in performance achieved
 
inference performance of the
by the 
. 
Second FCNN
​
 

 
 
 
 
Mean even worked slightly better (p<0.001) than the
 
 

 
Mean worked slightly better (p<0.001) than
 
 

 instead of running the 
Majority Voting
​

. 
Second FCNN
​

 
 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
: The mean taken;
 
Mean
​

 
 
 
: Majority voting;
 
Majority
​

: Second FCNN that received predictions from 3 slice orientations as
FCNN
 
 
 
​
 
 
: No fusion, only the respective
 
X,Y,Z
​

Figure 12: Results of different fusion strategies:
 
 
 
 
input and produced the final output;
 
 
slice orientation.  
Results show the mean Dice score over all tracts. Each subject is represented by one gray dot. The mean over all subjects is
 
 
 
shown by the colored dot and the colored number. 
 
Figure 13 shows the results of the different fusion strategies for all 72 tracts on the
 
 
 
dataset. Second FCNN consistently outperforms the simpler
 
 
FX. 

 
Clinical Quality
 
 
 
Mean fusion strategy, especially on the

 
 for the individual orientations. 
Z
​

 constantly performs better than 
Y
​

 or 
X
​

 
 

 
 

   

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

Clinical Quality datasets using different fusion strategies
Figure 13: Mean Dice scores over all subjects for 72 tracts on the
 
 
 
 
(sorted by score). Gray dots show Dice scores for each subject for the
 
 
 
 
Second FCNN fusion strategy. The full name of each
tract can be seen in figure 3. 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

3.6. Runtime 
 
Runtime experiments were performed using a server with 48 2GHz Intel Xeon cores, or an NVIDIA
 
Titan X for the GPU-based approaches (TRACULA and our proposed method). Table 2 shows the
 
 
 
results for each method when segmenting all tracts in a previously unseen subject. On average, our

 
 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
   
/
​

 
Clinical

and
 
​
 

 
Atlas
 
 

 
HCP Quality

 
and 535x faster for
 
 
HCP Quality
​

and
TractQuerier
 
 
​
 
 
 
 
and
TractQuerier
​

 
were not included in the table since they only served as simple baseline
 
​
 
   
Clinical

 
method was 81x faster than the reference methods for
 
 
Quality. 
Multi-Mask
 
 
estimation and are not openly available. Runtimes were 10.4 / 3.5 minutes (
 
 
Quality
) and 3 / 0.4 minutes respectively. 
​
 
WhiteMatterAnalysis
RecoBundles
had runtimes above 950 minutes as they depend
 
 
 
,
​
​
 
on tractography, meaning that all the following processing steps had to be performed on thousands of
 
 
 
 
 
 
streamlines.
also require cortical Freesurfer parcellation, which runs for
TRACULA
​
several hours. 
For TractSeg, the processing step with the longest runtime was the peak extraction using the CSD,
 
 
 
 
 
 
 
). The
HCP Quality
which was responsible for about 95% of the complete processing time (
 
​
fusion only 0.5min). We
segmentation itself was quite fast, timed at about 1 minute (with
 
 
 
 
 
 
Mean
 
​
Clinical Quality
 
employed single-shell CSD (without the multi-shell multi-tissue feature) on the
 
 
 
 
 
 
 
 
datasets, as only one shell is available here. This significantly decreased the computational burden and
enabled much shorter runtimes on lower quality data for the proposed method. 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Table 2: Runtime in minutes for segmenting all tracts (supported by the respective method)  in a new subject using the 
respective method. 

HCP Quality 

Clinical Quality 

 

Proposed 

RecoBundles (Garyfallidis et al., 2017) 

TractQuerier (Wassermann et al., 2016) 

WhiteMatterAnalysis (O`Donnell et al., 2012) 

TRACULA (Yendiki et al., 2011) 

20.1 

1831 

1704 

1052 

1936 

2.2 

1811 

956 

1042 

910 

3.7. Binary mask to tractogram 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 
TractSeg only generates binary tract masks. Should streamlines be needed, these masks make it easy
to generate streamlines for a certain tract. Seeding inside of the mask and only retaining the fibers
 
 
 
 
 
which never leave the mask and end in either the cortex or brainstem, results in good tract
delineations, as can be seen in figure 14. For difficult tracts like the CA, many seeds may be needed to
 
 
find streamlines which cover the full length of the tract. However, as we only seed inside of the tract
 
 
 
mask, we can use a high number of seeds without it becoming computationally infeasible. 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figure 14: Using the binary mask generated by TractSeg to delineate the CST. Only fibers which never leave the mask and
 
 
end in either the cortex or the brain stem were kept. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4. Discussion and Conclusion 

4.1. Overview 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
TractSeg is a novel direct white matter tract segmentation method based on encoder-decoder FCNNs
which has various advantages over the existing diffusion-weighted MR analysis pipelines. It was
 
 
 
evaluated by segmenting a total of 72 tracts in a cohort of 105 HCP subjects in original high quality
 
and also on reduced quality, more clinical-like datasets. Six tract segmentation methods were used as
a benchmark. Our experiments demonstrate that TractSeg achieves yet unprecedented accuracy while
 
 
being less affected by the reduction in resolution in the clinical quality data
 

 
 
 

 
 

 
 

 
 

.  

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.2. Reference data 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

Regarding the reference data, although we applied extensive efforts to mitigate the limitations of
 
 
 
ground truth
tractography, our tracts do not represent a real
 
. While some remaining false positives
 
 
 
​
 
 
 
 
cannot be excluded, difficult parts like the CA or the lateral projections of the CST are examples for
 
incomplete (false negative) reconstructions in some of the subjects (see section 3.2). Moreover the
 
reference tracts are subject to slight variations in the detailed anatomical definition of tracts, e.g. when
 
 
 
it comes to exact start and end regions. Despite these limitations, to the best of our knowledge, the
 
employed data set represents one of the best existing in-vivo approximations of known white matter
 
anatomy in a cohort of that size. Moreover, as shown in section 3.2, TractSeg can deal with a certain
level of inconsistency in the training data and produces accurate results in areas where the reference
 
tracts are incomplete. 
 

 
   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.3. Reference methods 

 

Selecting appropriate reference methods for a fair comparison was not easy as all methods have
 
slightly different approaches and requirements. The comparison with our selected reference methods
 
 
is also subject to some limitations:  

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
. 
WMA
​

 
TractQuerier was used both during the creation of the reference and during validation, inducing a
 
 
 
potential positive bias for the method. 
 
 
WMA evaluation was only available for 11 out of 72 tracts, which is not necessarily comparable.
 
 
 
 
However, the margin between
 
WMA and the proposed method remains, though, when restricting to
these same 11 tracts. Moreover the mapping of clusters to anatomical tracts did not completely align
 
 
 
with our reference tracts, as the finite set of distinct clusters offered by the atlas inherently limits a
 
 
precise mapping. Due to the huge memory requirements of WMA for 10 million streamlines
 
 
 
 
(>100GB) we had to restrict the analysis for
 
WMA to 500k streamlines, which required approx. 30GB
of RAM. This also benefited the quality of the result: cleaner clusters were created by 
RecoBundles we were only able to use 5 reference subjects due to the long runtime of
For
 
 
 
 
 
 
 
. Using all 63 training subjects would have been computationally infeasible for 72 tracts
 
RecoBundles
 
​
Multi-Mask
and tractograms with 10 million streamlines. Moreover, as suggested by our
 
 
 
experiments, averaging more subjects, does not necessarily increase accuracy as small details become
 
 
 
 
 
blurred. Using 5 reference subjects therefore provides a good estimation of the performance of
RecoBundles
. 
​
 
 
TRACULA uses its own tract definitions, which may differ from our definitions to some degree,
 
introducing a negative bias. However, for very well defined tracts like the CST, this bias is minor and
 
 
a meaningful comparison is still possible. 
Our results suggested that clustering based approaches (
 
TractQuerier
, which is in line with the findings of Zhang et al. (2017). 
​
 
MultiMask method produced significantly better results
 
It should be noted that the straightforward
 
 
 
RecoBundles
. Both used 5 reference subjects and were based on the
than the more sophisticated
 
 
 
 
​
RecoBundles works in
reference tracts, avoiding any bias induced by different tract definitions. As
 
 
 
 
 
 
 
 
 
streamline space it has to deal with the large number of false positives. Clustering helps to remove the
majority of those, but not all of them. Moreover, we used the default
 
RecoBundles settings.
 
 
 
Optimising those might improve the results to some degree. 
 
As we have shown, our comparison to the reference methods has some limitations. However, those
 
 
limitations alone can not explain the large accuracy gap between our method and all reference
methods, indicating that TractSeg has great potential. 
 

 
 
Atlas and
 
 
 
 

 
WMA, RecoBundles) perform better than
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.4. Fusion of orientations 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

The high robustness of TractSeg with respect to handling different image resolution levels is likely
 
 
 
 
due to the heavy data augmentation, the ensembling of multiple views and the general ability of CNNs
to handle noisy data. We evaluated three different strategies to fuse the three predictions of our
 
 
 
 
Majority
network for axial, sagittal and coronal input slices: Aggregation by
 
 
 
 
 
 
Second FCNN to aggregate the three predictions into one final one. On the
 
Voting and training a
 
 
 
approach showed a clear performance increase on the
Second FCNN
Clinical Quality data our
Mean
 
 
 
 
 
 
​
approach, especially on the more difficult tracts (FX, CA). This confirms our assumption that a more
   
 
 
 
 
 
 
complex fusion model can extract additional information from the different orientations. A 3D FCNN
architecture would make those fusion methods obsolete, but requires more memory, prompting us to
 
opt for a 2D architecture. Further research on 3D architecture could, however, open up promising
 
 
 
avenues. 
 

 
 
, aggregation by
Mean
 
 
​
 
 

 
 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.5. Supervised Learning 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 
 

 
TractSeg is based on supervised learning, bearing the inherent limitation of depending on the
 
 
 
 
,
 
RecoBundles
MultiMask and
availability and quality of training data. This is similar to
​
TRACULA which also require reference tracts or atlases. Using scanners and acquisition sequences
 
 
 
 
different from the training data introduces a domain shift, reducing performance. By using heavy data
 
 
 
augmentation during training this domain shift can be reduced. 
Our initial experiments on unseen datasets with and without pathologies are very promising and show
 
 
that TractSeg is able to still produce anatomically plausible results for the vast majority of bundles.
 
 
Future work could aim at adapting methods from the field of domain adaptation to further improve the
results and perform more detailed evaluations on non-HCP data. 
 

 
 
,
WMA
​
 
 

 
 
,
Atlas
​

 
 

 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.6. Complex pipelines 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

Most existing pipelines are based on several steps. For example TractQuerier first needs to perform
 
 
 
streamline tracking first, then cortical parcellation and finally the actual querying. All of these steps
 
come with their own pitfalls and inaccuracies which accumulate further down the pipeline. Moreover,
 
all of these steps require additional runtime and installation and setup of additional tools. Our
approach enables us to avoid steps such as atlas registration, tractography or parcellation, thereby
 
 
 
 
circumventing many of the pitfalls introduced by those steps, resulting in higher accuracy, shorter
runtime and an easier setup. A more complex pipeline and manual interaction was only required for
 
generating the training data. 
 

 
 
 
 

 
 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.7. Code and data availability 

 

 

 

 

 

 

 

 

 

 
 

 
Our dataset of 72 high quality tract dissections for 105 HCP subjects is openly available:
 
 
 
 
. Up until now, the majority of papers have used their own
https://doi.org/10.5281/zenodo.1088277
 
 
 
raters to extract reference tracts. This makes meaningful comparison between methods impossible.
 
 
 
 
 
 
We hope that this dataset can also help to standardize method evaluation. TractSeg is openly available
as an easy-to-use python package with pretrained weights: 
 
 

https://github.com/MIC-DKFZ/TractSeg/ 

 
 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Acknowledgments 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
HCP data were provided by the Human Connectome Project, WU-Minn Consortium (Principal
 
Investigators: David Van Essen and Kamil Ugurbil; 1U54MH091657) funded by the 16 NIH
 
Institutes and Centers that support
 
 
the NIH Blueprint for Neuroscience Research; and by the
McDonnell Center for Systems Neuroscience at Washington University. 
this article were obtained from the SchizConnect database
Data used in preparation for
 
 
 
 
(http://schizconnect.org). As such, the investigators within SchizConnect contributed to the design and
 
 
 
 
implementation of SchizConnect and/or provided data but did not participate in analysis or writing of
this report. Data collection and sharing for this project was funded by NIMH cooperative agreement
 
1U01 MH097435. 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 
(COINS;http://coins.mrn.org/dx) and data collection was

 
BrainGluSchi data was downloaded from the COllaborative Informatics and Neuroimaging Suite Data
 
Exchange tool
 
funded by NIMH
 
 
R01MH084898-01A1. 
 
COBRE data was downloaded from the COllaborative Informatics and Neuroimaging Suite Data
Exchange tool (COINS; http://coins.mrn.org/dx) and data collection was performed at the Mind
 
 
Research Network, and funded by a Center of Biomedical Research Excellence (COBRE) grant
 
 
5P20RR021938/P20GM103472 from the NIH to Dr. Vince Calhoun. 
 
This work was supported by the German Research Foundation (DFG) grant MA 6340/10-1 and grant
 
 
MA 6340/12-1. 
 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Supplementary Material 

 

 

 

 

 

 

 

 
 

 
 

 
Figure 1: Qualitative results of our proposed method on 5 healthy subjects from 5 different datasets (see table 1) while being
trained on the HCP dataset: reconstruction of right corticospinal tract (CST), commissure anterior (CA) and right inferior
 
 
occipito-frontal fascicle (IFO). 
 
 

   

   

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

Figure 2: Qualitative results of our proposed method on 4 subjects with pathologies from 4 different datasets (see table 1)
 
 
 
 
while being trained on the HCP dataset: reconstruction of right corticospinal tract (CST), commissure anterior (CA) and right
inferior occipito-frontal fascicle (IFO). 
 
 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

References 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
Avants, B.B., Epstein, C.L., Grossman, M., Gee, J.C., 2008. Symmetric diffeomorphic image
registration with cross-correlation: evaluating automated labeling of elderly and neurodegenerative
 
brain. Med. Image Anal. 12, 26–41. https://doi.org/10.1016/j.media.2007.06.004 
 
Bazin, P.-L., Ye, C., Bogovic, J.A., Shiee, N., Reich, D.S., Prince, J.L., Pham, D.L., 2011. Direct
 
 
 
Segmentation of the Major White Matter Tracts in Diffusion Tensor Images. NeuroImage 58,
458–468. https://doi.org/10.1016/j.neuroimage.2011.06.020 
 
Bells, S., Cercignani, M., Deoni, S., Assaf, Y., Pasternak, O., Evans, C., Leemans, A., Jones, D., 
2011. Tractometry–comprehensive multi-modal quantitative assessment of white matter along specific 
tracts. In: Proc. ISMRM, vol. 678. 
 
Bustillo, J. et al. 2016. Glutamatergic and neuronal dysfunction in gray and white matter: a 
spectroscopic imaging study in a large schizophrenia sample Schizophr Bull. PubMed PMID: 
27550776. 
 
Çetin, M.S., Christensen, F., Abbott, C.C., Stephen, J.M., Mayer, A.R., Cañive, J.M., Bustillo, J.R., 
Pearlson, G.D., Calhoun, V.D., 2014. Thalamus and posterior temporal lobe show greater 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

https://doi.org/10.1007/978-3-319-46723-8_49 

https://doi.org/10.1016/j.neuroimage.2014.04.009 

 
J.D., Storkey, A.J., Maniega, S.M., Bastin, M.E., 2009. Reproducibility of

inter-network connectivity at rest and across sensory paradigms in schizophrenia. Neuroimage 97, 
117–126. 
 
 
Çiçek, Ö., Abdulkadir, A., Lienkamp, S.S., Brox, T., Ronneberger, O., 2016. 3D U-Net: Learning
 
 
Dense Volumetric Segmentation from Sparse Annotation,
in: Medical Image Computing and
 
 
Computer-Assisted Intervention – MICCAI 2016, Lecture Notes in Computer Science. Presented at
 
the International Conference on Medical Image Computing and Computer-Assisted Intervention,
 
 
 
Springer, Cham, pp. 424–432. 
 
Clayden, J.D., Storkey, A.J., Bastin, M.E., 2007. A Probabilistic Model-Based Approach to
 
 
 
Consistent White Matter Tract Segmentation. IEEE Transactions on Medical Imaging 26, 1555–1561.
https://doi.org/10.1109/TMI.2007.905826 
 
 
tract
 
 
Clayden,
segmentation between sessions using an unsupervised modelling-based approach. NeuroImage 45,
 
 
377–385. https://doi.org/10.1016/j.neuroimage.2008.12.010 
 
 
Cook, P.A., Zhang, H., Avants, B.B., Yushkevich, P., Alexander, D.C., Gee, J.C., Ciccarelli, O.,
 
Thompson, A.J., 2005. An Automated Approach to Connectivity-Based Partitioning of Brain
Structures, in: Medical Image Computing and Computer-Assisted Intervention – MICCAI 2005,
 
 
 
Lecture Notes in Computer Science. Presented at the International Conference on Medical Image
Computing and Computer-Assisted Intervention, Springer, Berlin, Heidelberg, pp. 164–171.
 
https://doi.org/10.1007/11566465_21 
 
Dayan, M., Monohan, E., Pandya, S., Kuceyeski, A., Nguyen, T.D., Raj, A., Gauthier, S.A., 2016. 
Profilometry: a new statistical framework for the characterization of white matter pathways, with 
application to multiple sclerosis. Hum. Brain Mapp. 37 (3), 989–1004. 
 
Descoteaux, M., Deriche, R., 2009. High Angular Resolution Diffusion MRI Segmentation Using 
Region-Based Statistical Surface Evolution. J Math Imaging Vis 33, 239–252. 
https://doi.org/10.1007/s10851-008-0071-8 
 
 
Dieleman, S., Schlüter, J., Raffel, C., Olson, E., Sønderby, S.K., Nouri, D., Maturana, D., Thoma, M.,
 
Battenberg, E., Kelly, J., Fauw, J.D., Heilman, M., Almeida, D.M. de, McFee, B., Weideman, H.,
Takács, G., Rivaz, P. de, Crall, J., Sanders, G., Rasul, K., Liu, C., French, G., Degrave, J., 2015.
 
 
 
Lasagne: First release. https://doi.org/10.5281/zenodo.27878 
 
 
Dumoulin V., Visin F., 2016. A guide to convolution arithmetic for deep learning. ArXiv160307285
Stat. 
 
 
Eckstein, I., Shattuck, D.W., Stein, J.L., McMahon, K.L., de Zubicaray, G., Wright, M.J., Thompson,
P.M., Toga, A.W., 2009. Active fibers: matching deformable tract templates to diffusion tensor
 
images. NeuroImage 47 Suppl 2, T82-89. https://doi.org/10.1016/j.neuroimage.2009.01.065 
 
Garyfallidis, E., Brett, M., Correia, M.M., Williams, G.B., Nimmo-Smith, I., 2012. QuickBundles, a
Method for Tractography Simplification. Front. Neurosci. 6. https://doi.org/10.3389/fnins.2012.00175 
 

 
 
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
Eng

 
366,

 
Phys

 
 
A

 
 
Sci

 
 
Trans

 
 
Philos

 
 
Resonance

 
Garyfallidis, E., Brett, M., Correia, M.M., Williams, G.B., Nimmo-Smith, I., 2012. QuickBundles, a
 
Method for Tractography Simplification. Front Neurosci 6. https://doi.org/10.3389/fnins.2012.00175 
 
 
Garyfallidis, E., Brett, M., Amirbekian, B., Rokem, A., Van Der Walt, S., Descoteaux, M.,
Nimmo-Smith, I., 2014. Dipy, a library for the analysis of diffusion MRI data. Front. Neuroinform. 8.
 
 
https://doi.org/10.3389/fninf.2014.00008 
 
 
Garyfallidis, E., Côté, M.-A., Rheault, F., Sidhu, J., Hau, J., Petit, L., Fortin, D., Cunanne, S.,
Descoteaux, M., 2017. Recognition of white matter bundles using local and global streamline-based
 
 
registration and clustering. NeuroImage. https://doi.org/10.1016/j.neuroimage.2017.07.015 
 
 
Glasser, M.F., Sotiropoulos, S.N., Wilson, J.A., Coalson, T.S., Fischl, B., Andersson, J.L., Xu, J.,
 
Jbabdi, S., Webster, M., Polimeni, J.R., Van Essen, D.C., Jenkinson, M., WU-Minn HCP Consortium,
 
 
 
2013. The minimal preprocessing pipelines for the Human Connectome Project. Neuroimage 80,
105–124. https://doi.org/10.1016/j.neuroimage.2013.04.127 
 
 
Guo, W., Chen, Y., Zeng, Q., 2008. A geometric flow-based approach for diffusion tensor image
 
 
 
 
segmentation.
2279–2292.
Math
https://doi.org/10.1098/rsta.2008.0042 
 
 
 
Hernández, M., Guerrero, G.D., Cecilia, J.M., García, J.M., Inuggi, A., Jbabdi, S., Behrens, T.E.J.,
Sotiropoulos, S.N., 2013. Accelerating fiber Orientation Estimation from Diffusion Weighted
 
 
Magnetic
 
 
 
e61892.
Using
https://doi.org/10.1371/journal.pone.0061892 
 
Hirjak, D., Thomann, P.A., Wolf, R.C., Kubera, K.M., Goch, C., Hering, J., Maier-Hein, K.H., 2017. 
White matter microstructure variations contribute to neurological soft signs in healthy adults. Hum. 
Brain Mapp. 
 
 
Jeurissen, B., Tournier, J.-D., Dhollander, T., Connelly, A., Sijbers, J., 2014. Multi-tissue constrained
 
 
spherical deconvolution for improved analysis of multi-shell diffusion MRI data. NeuroImage 103,
411–426. https://doi.org/10.1016/j.neuroimage.2014.07.061 
 
 
Jin, Y., Shi, Y., Zhan, L., Gutman, B.A., de Zubicaray, G.I., McMahon, K.L., Wright, M.J., Toga,
A.W., Thompson, P.M., 2014. Automatic clustering of white matter fibers in brain diffusion MRI with
 
 
an application to genetics. NeuroImage 100, 75–90. https://doi.org/10.1016/j.neuroimage.2014.04.048 
 
 
 
Jonasson, L., Bresson, X., Hagmann, P., Cuisenaire, O., Meuli, R., Thiran, J.-P., 2005. White matter
fiber
 
tract segmentation in DT-MRI using geometric flows. Med Image Anal 9, 223–236.
 
https://doi.org/10.1016/j.media.2004.07.004 
 
Kingma, D.P., Ba, J., 2014. Adam: A Method for Stochastic Optimization. ArXiv14126980 Cs. 
 
 
Labra, N., Guevara, P., Duclap, D., Houenou, J., Poupon, C., Mangin, J.-F., Figueroa, M., 2017. Fast
Automatic Segmentation of White Matter Streamlines Based on a Multi-Subject Bundle Atlas.
 
Neuroinform 15, 71–86. https://doi.org/10.1007/s12021-016-9316-7 

https://doi.org/10.1002/hbm.23609 

 
 
GPUs.

 
 
ONE

 
Imaging

 
PLOS

 
 

 
 

 
 

 
 

 
8,

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 
 

 
 
 

 
 
 
 

 
Lenglet, C., Rousson, M., Deriche, R., 2006. DTI segmentation by statistical surface evolution. IEEE
 
 
Trans. Med. Imaging 25, 685–700. 
 
Maier-Hein, K.H., Neher, P.F., Houde, J.-C., Côté, M.-A., Garyfallidis, E., Zhong, J., Chamberland,
 
 
M., Yeh, F.-C., Lin, Y.-C., Ji, Q., Reddick, W.E., Glass, J.O., Chen, D.Q., Feng, Y., Gao, C., Wu, Y.,
 
Ma, J., Renjie, H., Li, Q., Westin, C.-F., Deslauriers-Gauthier, S., González, J.O.O., Paquette, M.,
 
 
 
St-Jean, S., Girard, G., Rheault, F., Sidhu, J., Tax, C.M.W., Guo, F., Mesri, H.Y., Dávid, S., Froeling,
M., Heemskerk, A.M., Leemans, A., Boré, A., Pinsard, B., Bedetti, C., Desrosiers, M., Brambati, S.,
 
Doyon, J., Sarica, A., Vasta, R., Cerasa, A., Quattrone, A., Yeatman, J., Khan, A.R., Hodges, W.,
 
 
Alexander, S., Romascano, D., Barakovic, M., Auría, A., Esteban, O., Lemkaddem, A., Thiran, J.-P.,
Cetingul, H.E., Odry, B.L., Mailhe, B., Nadar, M.S., Pizzagalli, F., Prasad, G., Villalon-Reina, J.E.,
 
Galvis, J., Thompson, P.M., Requejo, F.D.S., Laguna, P.L., Lacerda, L.M., Barrett, R., Dell’Acqua,
 
 
F., Catani, M., Petit, L., Caruyer, E., Daducci, A., Dyrby, T.B., Holland-Letz, T., Hilgetag, C.C.,
Stieltjes, B., Descoteaux, M., 2017. The challenge of mapping the human connectome based on
 
diffusion tractography. Nature Communications 8, 1349. https://doi.org/10.1038/s41467-017-01285-x 
 
Nair, V., Hinton, G., 2010. Rectified Linear Units Improve Restricted Boltzmann Machines. ICML. 
 
 
O’Donnell, L.J., Suter, Y., Rigolo, L., Kahali, P., Zhang, F., Norton, I., Albi, A., Olubiyi, O., Meola,
 
 
 
A., Essayed, W.I., Unadkat, P., Ciris, P.A., Wells, W.M., Rathi, Y., Westin, C.-F., Golby, A.J., 2016.
Automated white matter fiber tract identification in patients with brain tumors. NeuroImage Clin. 13,
 
 
138–153. https://doi.org/10.1016/j.nicl.2016.11.023 
 
O’Donnell, L.J., Wells, W.M., Golby, A.J., Westin, C.-F., 2012. Unbiased groupwise registration of
 
white matter tractography. Med. Image Comput. Comput.-Assist. Interv. MICCAI Int. Conf. Med.
 
 
 
Image Comput. Comput.-Assist. Interv. 15, 123–130. 
 
 
O’Donnell, L.J., Westin, C.-F., 2007. Automatic tractography segmentation using a high-dimensional
 
white
 
 
 
1562–1575.
Trans.
https://doi.org/10.1109/TMI.2007.906785 
 
Ratnarajah, N., Qiu, A., 2014. Multi-label segmentation of white matter structures: application to
 
neonatal brains. NeuroImage 102 Pt 2, 913–922. https://doi.org/10.1016/j.neuroimage.2014.08.001 
 
Ronneberger, O., Fischer, P., Brox, T., 2015. U-Net: Convolutional Networks for Biomedical Image
 
 
 
Segmentation. ArXiv150504597 Cs. 
 
Rokem, A.,Yeatman, J., Pestilli, F., Wandell, B., 2013. High angular resolution diffusion MRI. 
Stanford Digital Repository. Available at: 
 
Siless, V., Chang, K., Fischl, B., Yendiki, A., 2018. AnatomiCuts: Hierarchical clustering of
 
 
 
 
 
tractography
 
 
anatomical
 
32–45.
https://doi.org/10.1016/j.neuroimage.2017.10.058 
 

 
 
similarity. NeuroImage

http://purl.stanford.edu/yx282xq2090 

 
 
Imaging

 
 
 
matter

 
 
based

 
 
IEEE

 
 
Med.

 
 
atlas.

 
 
166,

 
streamlines

   
 
26,

 
on

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
80,

 
 
the Connectome

 
 
Project. NeuroImage, Mapping

 
Sotiropoulos, S.N., Jbabdi, S., Xu, J., Andersson, J.L., Moeller, S., Auerbach, E.J., Glasser, M.F.,
 
 
Hernandez, M., Sapiro, G., Jenkinson, M., Feinberg, D.A., Yacoub, E., Lenglet, C., Van Essen, D.C.,
Ugurbil, K., Behrens, T.E.J., 2013. Advances in diffusion MRI acquisition and processing in the
 
 
 
 
 
 
 
Human Connectome
125–143.
https://doi.org/10.1016/j.neuroimage.2013.05.057 
 
Srivastava, N., Hinton, G.E., Krizhevsky, A., Sutskever, I., Salakhutdinov, R., 2014. Dropout: a
 
simple way to prevent neural networks from overfitting. J. Mach. Learn. Res. 15, 1929–1958. 
 
Stieltjes, B., Brunner, R., Maier-Hein, K., Laun, F., 2013. Diffusion tensor imaging: introduction and
 
atlas. 
 
Taha, A.A., Hanbury, A., 2015. Metrics for evaluating 3D medical image segmentation: analysis,
 
 
selection, and tool. BMC Med Imaging 15. https://doi.org/10.1186/s12880-015-0068-x 
 
 
Thiebaut de Schotten, M., ffytche, D.H., Bizzi, A., Dell’Acqua, F., Allin, M., Walshe, M., Murray, R.,
 
 
Williams, S.C., Murphy, D.G.M., Catani, M., 2011. Atlasing location, asymmetry and inter-subject
 
 
variability of white matter tracts in the human brain with MR diffusion tractography. NeuroImage 54,
49–59. https://doi.org/10.1016/j.neuroimage.2010.07.055 
 
 
Tournier, J.-D., Calamante, F., Connelly, A., 2010. Improved probabilistic streamlines tractography
by 2nd order integration over fiber orientation distributions. Proc Intl Soc Mag Reson Med ISMRM
 
 
18. 
 
 
Tournier, J.-D., Calamante, F., Connelly, A., 2007. Robust determination of the fiber orientation
distribution in diffusion MRI: non-negativity constrained super-resolved spherical deconvolution.
 
NeuroImage 35, 1459–1472. https://doi.org/10.1016/j.neuroimage.2007.02.016 
 
 
 
Van Essen, D.C., Smith, S.M., Barch, D.M., Behrens, T.E.J., Yacoub, E., Ugurbil, K., 2013. The
WU-Minn Human Connectome Project: An overview. NeuroImage, Mapping the Connectome 80,
 
 
62–79. https://doi.org/10.1016/j.neuroimage.2013.05.041 
 
Wang, R., Benner, T., Sorensen, A.G., Wedeen, V.J., 2007. Diffusion toolkit: a software package for
 
diffusion imaging data processing and tractography. Proc Intl Soc Mag Reson Med 15. 
 
 
Wassermann, D., Makris, N., Rathi, Y., Shenton, M., Kikinis, R., Kubicki, M., Westin, C.-F., 2016.
 
The white matter query language: a novel approach for describing human white matter anatomy. Brain
 
 
Struct. Funct. 221, 4705–4721. 
 
Wilcoxon, F., 1945.
 
 
 
https://doi.org/10.2307/3001968 
 
Yeatman, J.D., Dougherty, R.F., Myall, N.J., Wandell, B.A., Feldman, H.M., 2012. Tract profiles of
 
 
 
 
 
 
 
 
properties:
 
e49790.
fiber-tract
white matter
https://doi.org/10.1371/journal.pone.0049790 
 

 
Individual Comparisons by Ranking Methods. Biom. Bull. 1, 80–83.
 

 
 
quantification.

 
PloS One
 

 
automating

 
 
7,

 
 

 
 

 
 

   

   

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
Yendiki, A., Panneck, P., Srinivasan, P., Stevens, A., Zöllei, L., Augustinack, J., Wang, R., Salat, D.,
 
Ehrlich, S., Behrens, T., Jbabdi, S., Gollub, R., Fischl, B., 2011. Automated Probabilistic
 
 
Reconstruction of White-Matter Pathways in Health and Disease Using an Atlas of the Underlying
 
 
Anatomy. Front. Neuroinformatics 5. 
 
Zhang, F., Norton, I., Cai, W., Song, Y., Wells, W.M., O’Donnell, L.J., 2017. Comparison between 
two white matter segmentation strategies: An investigation into white matter segmentation 
consistency, In: 2017 IEEE 14th International Symposium on Biomedical Imaging (ISBI 2017), pp. 
796–799. 
 
 
 

https://doi.org/10.1109/ISBI.2017.7950638 

 

 

 

 

 

 

This is the accepted manuscript for: 

https://doi.org/10.1016/j.neuroimage.2018.07.070 

© 2018. This manuscript version is made available under the CC-BY-NC-ND 4.0 license 

TractSeg - Fast and accurate white matter tract segmentation 

Jakob Wasserthal 

a,b

a
​, Klaus H. Maier-Hein 
​, Peter Neher 

a, c 

 

a
​ Division of Medical Image Computing (MIC), German Cancer Research Center (DKFZ), Heidelberg, Germany 
b
​ Medical Faculty Heidelberg, University of Heidelberg, Heidelberg, Germany 
c
​ Section for Automated Image Analysis, Heidelberg University Hospital, Heidelberg, Germany 
{j.wasserthal,  p.neher, k.maier-hein}@dkfz.de 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 
 

characteristics
 
 
 

Abstract
. The individual course of white matter fiber tracts is an important factor for
 
 
 
 
 
in healthy and diseased brains.
analysis of white matter
 
 
 
 
 
 
 
tractography in combination with region-based or
Diffusion-weighted MRI
clustering-based selection of streamlines is a unique combination of tools which
 
 
 
 
 
enables the in-vivo delineation and analysis of anatomically well-known tracts. This,
 
however, currently requires complex, computationally intensive processing pipelines
 
which take a lot of time to set up. TractSeg is a novel convolutional neural
network-based approach that directly segments tracts in the field of fiber orientation
 
 
distribution function (fODF) peaks without using tractography, image registration or
parcellation. We demonstrate that the proposed approach is much faster than existing
 
 
methods while providing unprecedented accuracy, using a population of 105 subjects
from the Human Connectome Project. We also show initial evidence that TractSeg is
 
 
 
 
 
 
able to generalize to differently acquired data sets for most of the bundles. The code
https://github.com/MIC-DKFZ/TractSeg/ and
and data are openly available at
 
 
, respectively. 
https://doi.org/10.5281/zenodo.1088277

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 
 

1. Introduction 
 
White matter fiber tract segmentation enables detailed analysis of individual white matter tracts. It
helps to characterise the healthy brain and identify areas containing abnormal morphology in diseased
 
 
brains (Bells et al., 2011, Yendiki et al., 2011, Yeatman et al., 2012, Dayan et al., 2016). Such
 
 
 
 
tractometry analyses are inherently dependent on the quality of the underlying tract segmentation, and
thus require accurate delineation. 
 
 
Currently, the most commonly employed approach for segmenting white matter tracts is
 
virtual
 
 
: streamlines that correspond to anatomically well-defined tracts are manually extracted
dissection
 
​
 
from a tractogram using combinations of inclusion and exclusion of regions-of-interest (ROIs) (Wang
 
 
 
 
et al., 2007, Stieltjes et al., 2013, Thiebaut de Schotten et al., 2011). This is a very time-consuming
process that has limited reproducibility due to the subjectivity in the human interaction. Therefore, a
 
 
 
variety of automatic approaches for white matter segmentation have been proposed. They can be
 
 
 
grouped into three categories:
 
 
direct
 
. 
segmentation
​
 

 
 
 
 
 
,
ROI-based segmentation
​

 
clustering-based segmentation

 
 
and
​

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

   

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
 
 

 
 
 

 
ROI-based segmentation approaches typically use information from a common atlas space that is
 
registered to the subject in order to extract ROIs in the cortex (parcellation) or in the white matter.
 
 
 
Streamlines are then filtered according to their spatial relation to these ROIs (Cook et al., 2005).
 
Yendiki et al. (2011) used cortical and white matter tract atlases (binary maps) to specify the
morphology of tracts. Wassermann et al. (2016) used a Freesurfer parcellation to characterize different
 
tracts. Yeatman et al. (2012) used ROIs and a probabilistic white matter tract atlas (probability maps). 
 
 
 
Clustering-based segmentation approaches group streamlines into anatomically (Siless et al., 2018) or
spatially coherent clusters. These clusters are either manually (O'Donnell et al., 2016) or automatically
 
 
 
(e.g. using prior knowledge in form of streamline atlases) assigned to anatomically meaningful fiber
 
 
tracts (Jin et al., 2014). Garyfallidis et al. proposed an alternative approach wherein the streamline
 
atlas can be directly incorporated into the clustering process (Garyfallidis et al., 2017). Clayden et al.
and Labra et al. also used streamline atlases in combination with a tract similarity measure to segment
 
tracts (Clayden et al., 2007, Clayden et al., 2009, Labra et al., 2017).  
 
ROI- and clustering-based methods involve whole series of processing steps for atlas registration,
 
tractography, parcellation or clustering. The resulting pipelines are rather complex, computationally
 
 
expensive and tedious to fine-tune. For example, most methods base their inter-subject consistency on
 
a registration between subject and atlas. This in itself is a non trivial task that requires quality
 
 
checking and that might introduce subtle errors which are then propagated through all further
 
 
 
processing steps.  
 
 
Direct segmentation
thus
 
 
 
simplifying the processing chain by directly producing complete tract segmentations from the input
images. A variety of direct methods has already been presented, employing techniques such as
 
 
template matching (Eckstein et al., 2009), Markov Random Field optimization (Bazin et al., 2011),
geometric flow-based segmentation (Guo et al., 2008, Jonasson et al., 2005), surface evolution
 
 
 
 
(Lenglet et al., 2006, Descoteaux et al., 2009) and k-NN based classification (Ratnarajah et al., 2014).
However, the segmentation quality currently reached by these approaches is limited, which in turn has
 
forced recent research to focus on ROI- and clustering-based approaches. 
 
 
 
 
We propose TractSeg as a novel approach to direct white matter tract segmentation that provides
 
is easy to set up, fast to run and does not require
complete and accurate segmentations, yet
 
 
 
 
 
registration, parcellation, tractography or clustering. This is achieved via a fully convolutional neural
 
network (FCNN) that directly segments white matter tracts in fields of fiber orientation distribution
function (fODF) peaks. We used a semi-automatic approach to segment reference segmentations of 72
 
 
anatomically well-describe tracts in a cohort of 105 subjects selected from the Human Connectome
 
 
 
 
Project (HCP) (Van Essen et al., 2013) to train and evaluate our approach. We compared our model to
six other state-of-the-art tract segmentation methods. 

the intermediate generation of streamlines,
 
 
 

 
approaches circumvent
 
​

 
 
 
 

   
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2. Materials and Methods 

An encoder-decoder FCNN that processes the data and generates tract probability maps form the core 
of our method. Figure 1 gives an overview of the proposed segmentation workflow.  

 

Figure 1: TractSeg segmentation pipeline. Constrained Spherical Deconvolution is used to extract the three dominant 
diffusion directions in each voxel. A 2D encoder-decoder FCNN then produces one tract probability image for each 
orientation (coronal, axial, sagittal) and for each tract. The tract probability images from the three orientations are then 
concatenated in the channel dimension resulting in a 3D image with 216 channels. This is used as input for a second FCNN 
which again runs three times. The three outputs per tract from the second FCNN are merged using the 
 to generate the 
Mean
​
final segmentation. The final segmentation is a 72-channel image, wherein each channel contains the voxel probabilities for 
one tract. 

 

2.1. Preprocessing 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
While raw image values could have been used as input for our method, this would have restricted the
 
method to the MRI acquisition used, not even allowing for slight variations in the acquisition setup
 
 
without a complete retraining of the method. Moreover, for high angular resolution datasets, it would
 
have resulted in an input image with a huge number of channels, creating high memory demand and
slow file input/output during training. A more condensed representation of the data was chosen to
 
 
mitigate this problem: TractSeg expects to receive the three principal fiber directions per voxel as
 
input, thus requiring nine different input channels (three per principal direction). In this study, the
 
 
 
 
principal directions were extracted using the multi-shell multi-tissue constrained spherical
 
deconvolution (CSD) and peak extraction available in MRtrix (Jeurissen et al., 2014, Tournier et al.,
 
 
 
2007) with a maximum number of three peaks per voxel. If a voxel contained only one fiber direction
 
 
 
e.g. voxels in the corpus callosum, then the second and third peak are set to zero. The HCP images
have a spatial resolution of 145x174x145 voxels. We cropped them to 144x144x144 without
 
 
removing any brain tissue to make them fit to our network input size. 

 
 
 

 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2.2. Convolutional Neural Network 

 

 

 

 
The proposed 2D encoder-decoder FCNN architecture was inspired by the U-Net encoder-decoder
 
 
 
 
architecture previously proposed by Ronneberger et al. (Ronneberger et al., 2015). Figure 2 details the
proposed network setup. 
 
 

   

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

   

   

   

 
 

 
 

 
 

 
 

 
 
 

 
Figure 2: Proposed TractSeg FCNN architecture. Blue boxes represent multi-channel feature maps. White boxes show
copied feature maps. The gray number on top of each box gives the number of channels, the x-y-size is given at lower left
 
 
corner of each box. Network operations are represented by differently colored arrows. 
 
 
 
The input for the proposed network is a 2D image at 144x144 voxels and 9 channels corresponding to
the 3 peaks per voxel (each peak is represented by a 3D vector). The output is a multi-channel image
 
 
(72 channels) with spatial dimensions of 144x144 voxels, where each channel contains the voxel
 
 
 
probabilities for one tract. These probabilities were converted to binary segmentations by thresholding
 
 
at 0.5. The approach enables for multi-label segmentations with several tracts sharing one voxel. This
 
means that one network can learn all of the tracts simultaneously. To enable this, the softmax
 
 
 
 
activation in the last
 
layer was replaced by a sigmoid activation, which does not require the
probabilities of all classes to sum to one. To avoid a downsized output in comparison to the input we
 
 
padded with half the filter size (rounded down) on both sides. Given a filter size of 3 the padding was
 
 
set to 1. This is also referred to as SAME padding (Dumoulin et al., 2016). 
 
 
While in principle the U-Net architecture allows extensions to 3D image segmentation (Çiçek et al.,
2016), we propose that 2D slices be used as input to boost memory efficiency and enable the data to
 
 
 
be processed at the original HCP resolution. To still leverage the additional information provided by
 
the third dimension, we randomly sampled 2D slices in three different orientations during training:
axial, coronal and sagittal. This meant that our model learned to work with all three of these
 
 
 
orientations. During inference three predictions per voxel per tract were generated, one for each
 
orientation, resulting in an image with dimensions of 144x144x144x72x3 (after running our model
 
144*3 times) and, if we concatenate it along the last 2 dimensions, we get 144x144x144x216 (a 3D
 
 
image with 216 channels). A second FCNN with three input channels per tract (i.e. 3*72=216 input
 
 
 
channels) was trained to optimally merge the three predictions per voxel. However, as the second
 
FCNN also works on 2D slices we can sample in three different orientations (axial, coronal, sagittal)
 

 
 
 
 

 
 
 
 

 
 
 

 
 
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

   

 
 

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
again here. The second FCNN was thus also ran three times, once for every orientation, giving three
 
predictions per voxel per tract. We simply took the mean to merge those to one final segmentation.
The second FCNN is optional. We could have directly used the mean to merge the outputs from the
 
 
first FCNN, but using the second FCNN allows a second network to learn which combination of slice
orientations yields the best prediction for each tract or part of tract individually, thus further
 
 
increasing segmentation quality. 
 

 
 
 

 
 
 

 
 
 

 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2.3. Training 

 
We trained our network using the binary cross-entropy loss. For a given target
 
 
 
 
 
 number of classes, the loss was calculated as follows: 
n
 and 
o
network 
​
​

 

 

 

 

 

 

 

 
an output of the
 
t,
​

 

 

 

l

t = n
oss(o, )  −  

(t[i] 

*  

log(o[i]) 

+   − t
(1

[i]) 

log(1

− o

[i]))

 
.

*  

n
1 ∑
i=0

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
We used rectified linear units (ReLU) as nonlinearity (Nair and Hinton, 2010). Sigmoid activation
 
functions were only used in the last layer. Sigmoid activation paired with binary cross-entropy enables
 
multilabel segmentations. A learning rate of 0.002 was used and Adamax (Kingma and Ba, 2014) was
 
 
   
 
implemented as an optimizer. The batch size was 56. We used dropout (Srivastava et al., 2014) with a
 
probability of 0.4. All hyperparameters were optimized on a validation dataset independent of the
final test dataset. The network weights of the epoch with the highest Dice score during validation were
 
 
 
used for testing. 
 
 
To improve the generalizability of TractSeg, we applied heavy data augmentation to the peak images
during training . The following transformations were applied to each training sample. The intensity of
 
 
each transformation was varied randomly. 
 

 
 
 

 
 

 
 

 
1

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

● Rotation by angle φ  ∼ U [− /4,

  x
● Elastic deformation with alpha and sigma
 

  y

π

π

 

 

/4], φ  ∼ U [− /4,

π

z

 

π

π

π

/4], φ  ∼ U [− /4,
/4]
) ∼ (U [90, 20], U [9, 1])
 

1

1

 

 

  

 
. A displacement
 

 

 
vector is sampled for each voxel

 

 

 

 

 
, which is then smoothed by a Gaussian filter

 

 

 

 

 

 

( σ

  α,
 
 ∼ U [− , ]
d
and finally scaled by 

1 1  

 

 

(

α  
.

1 1

with standard deviation 

 σ
● Displacement by  Δx, y) ∼ (U [− 0, 0], U [− 0, 0]) 
Δ
 ∼ U [0.9,
● Zooming by a factor 
λ
 ∼ U [0.5, ] 
● Resampling (to simulate lower image resolution) with factor 
1  
λ
) ∼ (0, U [0.05]) 
● Gaussian Noise with mean and variance  μ,
 
 
● Contrast augmentation  
* β +  
X augmented = ( − a
 
 ∼ U [0.7,
γ
X augmented = X * γ

● Brightness augmentation 

vg(X)) 

avg(X)

 with 

 with 

1 1

1
.5] 

1
.3] 

( σ

X

β

 

 

 

 ∼ U [0.7,

1
.3] 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 
When training our network on peaks generated by the MRtrix multi-shell multi-tissue CSD method,
 
we found that it did not work well on peaks generated by the standard MRtrix CSD method. In order
 
 
 
to ensure our model worked well with all types of MRtrix peaks, we generated three peak images: (1)
 
2
multi-shell multi-tissue CSD using all gradient directions, (2) standard CSD using only b=1000 s/mm
 
2
​. During
gradient directions, (3) standard CSD using only 12 gradient directions at b=1000 s/mm
 
 
 
 
training, we randomly sampled from these three peak images, thus ensuring that our network worked
 
 
well with all of them. 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

1 https://github.com/MIC-DKFZ/batchgenerators 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
We trained for 500 epochs with each epoch corresponding to 162 batches. This means that over the
 
 
course of the entire training, the network has seen 4,536,000 slices which have been randomly
 
sampled from axial, coronal and sagittal orientations, randomly sampled from three different peak
types and randomly permutated by the data augmentation transformations. 
 
The results presented in section 3 were obtained using an implementation of the proposed method in
 
 
Lasagne (Dieleman et al., 2015). Additionally we provide a Pytorch (pytorch.org) implementation. 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2.4. Reference Segmentations 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

105 subjects from the Human Connectome Project (HCP) were used for the following experiments.
 
The corresponding dMRI images have 1.25mm isotropic resolution and 270 gradient directions with 3
   
 
 
2
 
 
​) and 18 b=0 images (Sotiropoulos et al., 2013). We used the HCP
 
b-values (1000, 2000, 3000 s/mm
 
data that had already been processed by the minimal preprocessing pipeline (e.g. distortion correction,
motion correction, registration to MNI space and brain extraction had already been completed)
 
(Glasser et al., 2013). 
 
We semi-automatically generated binary reference segmentations for 72 major white matter tracts for
 
 
each subject (figure 3). Those reference segmentations are used as labels for training and validating
 
 
our network. We used a series of 5 processing steps (figure 4) to generate these reference
segmentations: 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
Figure 3: Overview of all 72 tracts. For tracts which exist in the left and the right hemisphere only the right one is shown.
 
 
 
The following tracts are included: Arcuate fascicle (AF), Anterior thalamic radiation (ATR), Commissure anterior (CA),

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
Corpus callosum (Rostrum (CC 1), Genu (CC 2), Rostral body (CC 3), Anterior midbody (CC 4), Posterior midbody (CC 5),
 
Isthmus (CC 6), Splenium (CC 7)), Cingulum (CG), Corticospinal tract (CST), Middle longitudinal fascicle (MLF),
 
 
Fronto-pontine tract (FPT), Fornix (FX), Inferior cerebellar peduncle (ICP), Inferior occipito-frontal fascicle (IFO), Inferior
longitudinal fascicle (ILF), Middle cerebellar peduncle (MCP), Optic radiation (OR), Parieto-occipital pontine (POPT),
 
 
Superior cerebellar peduncle (SCP), Superior longitudinal fascicle I (SLF I), Superior longitudinal fascicle II (SLF II),
 
Superior longitudinal fascicle III (SLF III), Superior thalamic radiation (STR), Uncinate fascicle (UF), Thalamo-prefrontal
 
(T_POSTC),
(T_PREF),
 
 
 
Thalamo-parietal (T_PAR), Thalamo-occipital (T_OCC), Striato-fronto-orbital (ST_FO), Striato-prefrontal (ST_PREF),
 
 
Striato-premotor (ST_PREM), Striato-precentral (ST_PREC), Striato-postcentral (ST_POSTC), Striato-parietal (ST_PAR),
Striato-occipital (ST_OCC) 
 

 
Thalamo-postcentral

Thalamo-precentral
 
 

 
 
Thalamo-premotor

 
 
 
(T_PREC),

 
(T_PREM),
 

 
 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
 
 

Figure 4: Examplary depiction of the semi-automatic dissection pipeline of a total of 72 reference tracts in a cohort of 105
 
 
subjects. Images show the left CST of subject 898176. 
 
Step 1 - Tractography. Multi-shell multi-tissue constrained spherical deconvolution was used to
 
 
 
extract the fODF and anatomically constrained probabilistic tractography (iFOD2) for the whole brain
 
was performed using MRtrix (Tournier et al., 2010) to generate 10 million fibers with a minimum
length of 40mm. By generating such a large number of fibers, we were able to reconstruct difficult
 
tracts like the anterior commissure (CA) or the lateral projections of the corticospinal tract (CST) with
 
high completeness in a majority of the subjects. Extracting the fibers that run completely from the left
 
 
cortex through the CA to the right cortex is difficult if a smaller number of fibers is used. The high
fiber count, however, comes at the cost of many false positives which we eliminated using the
 
following steps. Seeds were randomly placed within the brain mask coming with the HCP data.
 
Streamlines were cropped at the gray-matter-white-matter interface. 
Anatomically constrained tractography yielded adequate results for the majority of tracts. However,
 
 
the anatomical constraints did not work well for tracts containing very thin passages like the CA,
 
 
 
uncinate fascicle (UF) or inferior occipito-frontal fascicle (IFO). They are based on a gray matter
segmentation which is based on the T1 image and as a result they do not necessarily fit perfectly to the
 
 
 
 
diffusion weighted image. If a tract is only a few voxels wide and the gray matter segmentation is not
perfect, some critical parts of the tract will be cut off because they are counted as gray matter.
 
 
 
Therefore we used tracking without anatomical constraints for the CA, UF and IFO. 
 
Step 2 - Initial tract extraction. We applied TractQuerier (Wassermann et al., 2016) to extract a first
 
 
approximation of each tract and to make sure streamlines end in the correct cortex regions. Our
 
queries are based on the queries provided by Wassermann et al. (2016) with minor adaptations for

 
   

   
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

   

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
better results with our dataset. The queries used in this work are available online . As was the case in
 
Wassermann et al. (2016), the FreeSurfer cortical parcellations were used. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
   

 
 
 

 
 
 

 
 
The results of TractQuerier contained a considerable amount of false
 
Step 3 - Tract refinement.
positives (see figure 4). This meant that further filtering was needed. We manually defined exclusion
 
 
 
and inclusion ROIs to exclude false positives (Stieltjes et al., 2013). These ROIs s were transferred
 
 
 
between subjects using diffeomorphic registration of the fractional anisotropy (FA) maps.  
 
 
 
We also removed streamlines that run back and forth in the target volume, making 180 degree turns
 
within a length of less than 30 mm. More spurious fibers were filtered by running QuickBundles
clustering (Garyfallidis et al., 2012) and removing clusters that only contained a small number of
 
 
fibers, according to thresholds which varied for each tract. This approach was used very cautiously as
it also tends to remove valid structures such as the lateral projections of the CST, which are rather
 
sparse in streamline space and therefore typically consist of small clusters. Finally, we removed all
 
 
streamlines that run through voxels with low streamline density (threshold differs for each tract).  
 
 
Step 4 - Manual quality control, clean-up. The described steps for automated tract refinement
occasionally removed some of the valid parts of a tract. We manually inspected the results of all
 
 
 
 
filtering steps in all subjects and skipped some of the filters if they removed too many valid fibers.
 
After this process was complete, there were streamlines still remaining which could only be filtered
 
by drawing individual exclusion ROIs manually (Stieltjes et al., 2013). The UF, for example, tended
 
to contain parts of the CA. As a result of inaccurate Freesurfer parcellations, those could not be
properly excluded in all subjects with TractQuerier. The necessary exclusion ROI had to be drawn
 
around the valid part of the UF with minimal margins. Since this required a highly accurate
 
 
 
 
placement, the ROI had to be drawn manually for each subject instead of using the same ROI for all
subjects. 
 
Step 5 - Mask Generation. This semi-automatic process resulted in high quality dissections of a total
 
 
of 72 tracts in in a cohort of 105 subjects. From the final sets of streamlines, we created binary tract
 
masks. These binary masks were analyzed for connected regions and only the biggest connected
 
 
 
regions were retained, thus filtering out
 
single voxels and small groups of voxels that were not
 
connected to the rest. 
 
These binary masks now serve as reference segmentations and are used for training and testing of the
 
proposed segmentation approach. 
 

 
 
 
 

   
 

 
 
 

 
 
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2.5. Reference methods 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

The following automatic tract segmentation methods were used as a benchmark. All these methods are
 
openly available and do not need any proprietary software to run. The methods include
 
clustering-based as well as ROI-based approaches. We give an outline of how they work (1.) and how
 
 
we applied them (2.) here. 
 
 
in a reference subject, RecoBundles
RecoBundles
 
 
 
(Garyfallidis et al., 2017) can be used to find the corresponding streamlines in a new subject. 2. We
 

 
: 1. Given streamlines of a reference tract
 

   
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

2 

https://github.com/MIC-DKFZ/TractSeg/blob/master/examples/resources/WMQL_Queries.qry 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
 
 

 
 
 

 
   

 
 
 
 

 
randomly picked 5 reference subjects from the HCP data (each containing the 72 reference tracts we
 
had previously extracted (see 2.4)). Due to the long runtime for RecoBundles, a higher number of
reference subjects was not feasible. Then we ran RecoBundles 5 times for the new subject (once for
 
 
 
each reference subject) using the default RecoBundles parameters. This resulted in 5 extractions of
each tract in the new subject. To get a final segmentation, we took the mean of those 5 extractions. 
 
TRACULA
 
: 1. TRACULA (Yendiki et al., 2011) uses probabilistic tracking and an atlas of the
 
 
 
 
underlying anatomy to segment tracts. 2.Running TRACULA for each subject produced a probability
map for each tract. We selected all voxels with a probability of greater than 0 to create a binary
 
 
 
segmentation. The original paper created a binary segmentation by masking out all values below 20%
 
 
 
of the maximum. However, this leaves only the very core of every tract, thus creating many false
 
 
negatives. Segmenting all values with probability greater than 0 gives better results compared to our
 
reference tracts. TRACULA does not support all of the 72 tracts that we use; it only supports 18. Out
 
 
 
 
of the 18, only 8 tracts match our 72 tracts exactly. Quantitative comparison was therefore only
performed on these 8 tracts. A GPU implementation is available for
 
which is part of the
 
 
bedpost,
​
TRACULA pipeline which we used (Hernandez et al., 2013).  
 
 
 
: 1. WMA (O’Donnell et al., 2012; O’Donnell and Westin, 2007)
WhiteMatterAnalysis (WMA)
clusters streamlines across subjects and generates a cluster atlas out of these. Clusters in the atlas are
 
 
then assigned to certain anatomical tracts. Automated tract delineation is made possible by registering
 
 
new subjects to this atlas. 2. WMA comes with a pre-trained cluster atlas (800 clusters) and
 
predefined mapping of clusters to anatomical tracts (O’Donnell et al., 2016). However, this mapping
 
only includes 10 of the 72 tracts we use. We manually optimized these predefined mappings to better
 
 
 
align them with our reference tracts and added the CA to the mapping. During this process, we were
inherently limited by the finite set of distinct clusters offered by the atlas. We chose not to extend the
 
 
mapping to the remaining 61 tracts as it would have required considerable manual effort, given the
amount of clusters and tracts. Evaluation was therefore only carried out on these 11 tracts. WMA is
 
 
 
very memory intensive. Clustering a tractogram with 1 million fibers requires around 60GB of
memory. Therefore we were not able to use our 10 million fiber tractogram directly, but instead used a
   
 
subset with 500,000 fibers. This reduced the memory consumption to around 30GB. The outlier
 
removal provided by WMA was used to remove spurious fibers. 
 
 
 
: 1. TractQuerier (Wassermann et al., 2016) extracts tracts based on the regions the
 
TractQuerier
 
 
 
 
 
streamlines have to start at, end at and (not) run through. 2. We compared our method to the output
 
from TractQuerier
 
(step 2 from the reference tract extraction pipeline) without any further
 
 
post-processing. 
 
 
In addition to these openly available reference methods, we implemented two additional reference
 
methods in order to provide further insights into the performance of TractSeg:  
 
 
: 1. Several subjects can be averaged to an atlas which can then be
 
 
Atlas registration (Atlas)
registered to new subjects to segment structures. 2. We split our reference data (see 2.4) into training
 
 
 
 
 
 
 
 
and testing data, using the same 5-fold cross-validation as used for the evaluation of our proposed
 
 
 
method. The training data was used to create a tract atlas. Firstly, we registered all subjects to a
 
random subject using symmetric diffeomorphic registration implemented in DIPY (Avants et al.,
 
 
2009, Garyfallidis et al., 2014). Registration was performed based on the FA maps of each image.

 
 
 

 
 
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
After registration, the FA maps of all images were averaged. Then, in a second iteration all images
 
were registered to this mean FA image. This two-stage approach limits the bias introduced by the
initial subject choice in the first iteration. The tract atlas thus contained the tract masks for all 72
 
 
reference tracts (see 2.4). For each tract, we took the mean over all subjects, which produced a
probability map. We thresholded the probability map at 0.5 to create a final binary atlas. During test
 
time, the atlas was registered to the subjects of interest, yielding a binary mask for each tract in
 
 
subject space. 
 
: 1. Using an atlas can blur some of the details as it is
Multiple mask registration (Multi-Mask)
 
 
 
 
based on group averages. The blurring can be reduced to some extent by registering the masks of
 
 
 
 
single training subjects to a test subject instead of an averaged atlas. 2. The same 5 reference subjects
 
as those selected for RecoBundles were used. To segment the tracts in a new subject, we registered
 
each of the 5 reference subjects to the new subject (symmetric diffeomorphic registration of the FA
 
 
maps) and averaged the tract masks (from the reference tracts) of all 5 reference subjects. Finally, we
 
thresholded this average at 0.5 to produce a binary mask for each tract in the space of the new subject.
 
Atlas registration method in that the reference subjects are directly registered to
 
This differs from the
 
 
 
 
subject space and are merged (1 registration) instead of first being registered to atlas space, then
 
 
 
 
 
merging and being registered to subject space (2 registrations needed). Moreover,
 
 
 
Atlas Registration
uses 63 subjects while 
 only uses 5. 
Multi-Mask
​
 

   
 

 
   

 
 
 

 
 
 

 
 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

3. Experiments and results 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
) was used in order to extract the best possible reference
 
 
The high quality HCP data (
HCP Quality
​
tracts. However, in clinical routine, faster MRI protocols are used which result in lower quality data.
 
 
 
 
 
To test how TractSeg performs on clinical quality data, we downsampled the HCP data to 2.5mm
 
 
 
 
2
isotropic resolution and removed all but 32 weighted volumes at b=1000 s/mm
 
 
​. The reference tracts
 
 
 
 
 
 
 
 
 
 
 
 
from the
dataset were reused as our reference tracts here. This provides high quality
HCP Quality
​
Clinical
reference tracts for the low quality data, thus allowing proper evaluation. We call this dataset
 
 
 
 
 
 
 
 
. As this dataset only has one b-value shell, we can not use multi-shell CSD as we did for the
Quality
 
 
 
 
 
 
 
 
​
   
 
 
 
HCP Quality
data. Instead MRtrix standard CSD was employed to generate the peaks of the fODF. 5
​
fold cross validation was used, i.e. 63 training subjects, 21 validation subjects (best epoch selection)
 
and 21 test subjects per fold.  
 
We used the Dice score (Taha et al., 2015) as our evaluation metric, which is one of the most popular
 
measures for evaluating segmentation performance. We calculated the Dice for each subject between
 
 
each of the 72 reference tracts and the respective prediction of either our proposed method or one of
 
the reference methods (e.g. RecoBundles). Then we averaged the Dice results for all 72 tracts to get
 
 
one final Dice score per subject per method.  
The Wilcoxon signed-rank test (Wilcoxon, 1945) was used to test for statistical significance. For
 
 
 
 
 
multiple testing, we applied the Bonferroni correction. Moreover, we evaluated the runtime of the
 
 
 
 
the influence of different orientation fusion strategies and how TractSeg
 
different methods,
 
generalizes to non-HCP data. 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

3.1. Quantitative evaluation 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
HCP Quality

data, looking at the mean Dice score over all 72 reference tracts, TractSeg
On the
 
 
 
 
 
 
​
 
 
 
 
significantly (p<0.001) outperformed the second best method by 9 Dice points and on average
 
 
Clinical Quality
performed 19 Dice points better than the other reference methods (figure 5a). On the
 
 
 
 
 
 
data, TractSeg significantly (p<0.001) outperformed the second best method by 14 Dice points and
 
 
 
performed 22 Dice points better than the reference methods on average (figure 5b). In general,
 
TractSeg was less affected by the quality loss in the clinical data than the reference methods. Please
 
 
 
 
 
 
 
only provide segmentations for a subset of the 72 tracts. The reported
TRACULA
and
WMA
note that
 
 
 
 
 
 
 
 
​
​
are restricted to this subset. 
TRACULA 
and 
WMA 
scores for 
​
​
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

   

   

 
 

 
 
Figure 5: Results on (a) the
 
 
 
 
dataset with a gray dot per subject (mean over
 
 
 
 
dataset and (b) the
 
HCP Quality
Clinical Quality
​
​
 
all tracts) and a colored dot for the mean over
 
 
 
 
 
: Multiple mask registration;
 
 
: Our method;
 
 
all subjects.
 
 
Multi-Mask
Proposed
​
​
: WhiteMatterAnalysis.  
WMA
: Atlas registration; 
Atlas
​
​
*:
do not provide segmentations for all tracts, only for a subset. The score is the mean over
 
 
 
 
 
 
the tracts in
TRACULA
WMA
 
and
 
 
​
​
the subset 
 
 
 
 
Figure 6 shows the segmentation performance for all methods for each individual tract. TractSeg
 
showed quite consistent performance. All tracts had a Dice score over 0.75, except for the fornix (FX)
 
and CA. For these two tracts, the Dice score was noticeably reduced, which is probably caused by the
 
thin and therefore hard to reconstruct shape of these tracts. Moreover, due to limited sensitivity of the
initial tractograms, the CA and FX were not perfectly reconstructed in the reference tracts for some
 
subjects but our model managed to generate a segmentation which was better than the reference
 
 
segmentation (see section 3.2). Therefore good segmentations also received bad Dice scores if the
reference segmentation was incomplete. The reference methods showed a similar accuracy gap
 
between the FX and CA and the remaining tracts. Overall, TractSeg clearly outperformed the
 
 
reference methods. 

 
 
 

 
   

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 
Figure 6: Dice scores for all 72 tracts on the
sorted by score. The full name of each tract can be seen in figure 3. 

 

 

 

 

 

 

 

 

 
Clinical Quality dataset for our proposed method and all reference methods

 

 

 

 

 

 

 

 

 

3.2. Qualitative evaluation 

 

 

 

 

 

 

 
 

For the qualitative evaluation, one subject (623844) was selected from the test set. We chose a subject
 
 
 
whose Dice scores were closest to the mean Dice scores for the entire datasets to make the subject
 
 
representative for the entire dataset. Since the scope of this manuscript does not allow us to show
results for all 72 tracts, we selected three tracts that represent the different degrees of reconstruction
 
 
difficulty (Maier-Hein et al., 2017): the IFO, CST and CA (results for all tracts can be accessed online

   
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

3

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
 
 

 
). The IFO is a tract that is fairly easy to reconstruct, which is reflected by its consistently good
scores for all methods. The CST is more difficult to reconstruct. Its beginning at the brain stem is easy
 
 
 
to reconstruct but as the fibers get closer to the cortex, they start to fan out. Finding these lateral
 
 
 
projections is more difficult. Finally, the CA is tract that is difficult to reconstruct. Due to its very thin
body, it is hard to find fibers that run the entire way from the right to the left temporal lobe. The CA is
 
 
one of the tracts with the lowest performance out of all of the methods. 
 
 
 
Proposed method yielded adequate reconstructions on all three tracts.
 
 
As can be seen in Figure 7, the
 
Multi-Mask registration also produced convincing results on all tracts. Atlas registration results looked
 
 
 
 
 
convincing on the 3D image but included segments passing gray matter and also exiting the brain
 
 
 
 
RecoBundles oversegmented the CST to neighbouring gyri and did
mask, which is obviously wrong.
 
 
not manage to reconstruct the CA completely but showed good results for the IFO.
did
 
TractQuerier
 
 
​
not properly segment any of the example tracts. As it defines tracts mainly by their endpoints, it leaves
 
 
 
 
 
 
 
 
extracts a lot of false
 
TractQuerier
 
much room for wrong turns between the start and end points.
​
positives, especially when using probabilistic tracking. The CA cannot be properly reconstructed with
 
 
 
 
 
 
 
TractQuerier as the default Freesurfer parcellation is not precise enough for the small parts of the CA.
 
 
 
 
yielded a good reconstruction of the stem of the CST, but missed the lateral projections.
 
 
TRACULA
 
 
 
​
 
 
 
 
CA and IFO are not supported by
 
 
. White Matter Analysis (WMA) kept a lot of false
TRACULA
​
positives in the CST and CA but showed good results for the IFO.  
 
 
Clinical Quality dataset (figure 8), as expected, all
 
In a similar comparison of results on the
approaches yielded segmentations of lower quality compared to the respective segmentation on the
 
 
HCP Quality data, to varying extents, as can be seen in figure 8. The registration-based approaches
 
 
 
also tended to segment gray matter or regions outside of the brain while the streamline based
 
approaches suffered from an increased number of false positives. TractSeg seems to be less affected
 
by the lower image quality than most of the benchmark methods, as shown by the quantitative
 
analysis. 
 
 
In general, it can be observed that tracts tend to look good on 3D image but show significant
 
shortcomings on a detailed 2D image. Unfortunately, many of the relevant publications only show
 
 
qualitative results using single 3D images. The segmentations of all methods and all tracts of this
3
​. 
subject are available online

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

https://doi.org/10.5281/zenodo.1154877 

3 

 

 

 

 

 

 

Figure 7: Qualitative comparison of results on
 
commissure anterior (CA) and right inferior occipito-frontal fascicle (IFO) on one random subject.
 
reference tract and 
 
 

 
 
shows the segmentation of the respective method. 
Red 
​

HCP Quality test set: reconstruction of right corticospinal tract (CST),
 
 
 
 
Green shows the

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
Clinical Quality test set: reconstruction of right corticospinal tract (CST),
 
Green shows the
 

 
 
 shows the segmentation of the respective method.  
Red
​

 
Figure 8: Qualitative comparison of results on
commissure anterior (CA) and right inferior occipito-frontal fascicle (IFO) on one random subject.
 
 
reference tract and 
 
 
In some of the reference subjects, some of the more difficult tracts, such as the CA and the lateral
 
projections of the CST, were incompletely reconstructed. The original tractogram contained a few
sparse fibers for those regions, indicating the presence of the tract, however, when applying further
 
 
 
constraints (ending in the correct cortex regions, angular threshold, fiber density) those sparse fibers
 
 
were completely removed. Despite this noise in the training data, the proposed method managed to
learn a complete representation of each tract. This enabled our model to completely segment these
 
 
tracts, even on subjects in whom the reference tracts are incomplete (see figure 9). 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
Figure 9: The proposed method creates anatomically reasonable segmentations even on subjects where the reference
 
 
segmentations are incomplete due to limitations in the extraction pipeline. The presented examples are from the
 
 
 
HCP Quality
dataset (subjects 979984 and 959574). 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

3.3. Transferability between scanners and acquisition settings 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

To test the capability of TractSeg to generalize beyond HCP, which it was trained on, we applied
 
TractSeg to nine differently acquired datasets (see table 1). These nine datasets represent a wide
 
variety of data: Different scanners, different spatial resolutions, different b-values, different number of
 
 
 
gradients, healthy and diseased, normal und abnormal brain anatomy.  
 
Table 1: Acquisition parameters of additional non-HCP test datasets. 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Project 

Pathology 

b-Values 

Preprocessing 

Resolution 
(isotropic) 

Scanner field 
strength 

TRACED  4

healthy 

2.5mm 

2 
3x b=0mm/s
2 
20x b=1000mm/s
2 
48x b=2000mm/s

denoising,  
eddy current and 
motion correction 

3T 

4 

https://my.vanderbilt.edu/ismrmtraced2017/ 

 

Internal (Healthy) 

healthy 

2.5mm 

2 
64x b=3000mm/s

2 
1x b=0mm/s
2 
81x b=1000mm/s
2 
81x b=2000mm/s
2 
81x b=3000mm/s

2 
5x b=0mm/s
2 
30x b=800mm/s

2 
1x b=0mm/s
2 
64x b=1000mm/s
2 
64x b=2000mm/s
2 
64x b=3500mm/s

healthy 

2.0mm 

BrainGluSchi 
(Bustillo
 
 
et
2016) 

 
al.,

Stanford_hardi 
(Rokem et al., 2013) 

healthy 

2.0mm 

2 
10x b=0mm/s
2 
150x b=2000mm/s

Sherbrooke_3shell  5

healthy 

2.5mm 

COBRE 
(Çetin et al., 2014) 

schizophrenia, 
enlarged 
ventricles 

2.0mm 

2 
5x b=0mm/s
2 
30x b=800mm/s

SoftSigns 
(Hirjak et al., 2017) 

neurological 
soft signs 

2.5mm 

2 
1x b=0mm/s
2 
81x b=1000mm/s

Internal (Autism) 

2.5mm 

autism 
spectrum 
disorder 

Internal 
(Schizophrenia) 

schizophrenia 

1.7mm 

2 
5x b=0mm/s
2 
60x b=1000mm/s

2 
3x b=0mm/s
2 
60x b=1500mm/s

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

denoising,  
eddy current and 
motion correction 

3T 

3T 

3T 

3T 

3T 

3T 

3T 

3T 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 
 
 
An expert manually dissected the three tracts already shown in the above qualitative evaluation (CST,
 
 
CA and IFO) from one randomly chosen subject from each dataset shown in Table 1 (from the
COBRE dataset we choose 3 subjects: one healthy, one with schizophrenia and one with
 
 
schizophrenia and enlarged ventricles). Visual comparisons were performed between manual
 
 
 
 
 
 
dissections and TractSeg as well as the previously introduced reference methods
 
 
 
Multi-Mask, Atlas,
 
,
Atlas
Multi-Mask
TractSeg
 
. Methods depending on reference data (
TractQuerier
 
RecoBundles and
 
 
,
 
,
 
 
 
 
 
​
​
​
​
 
) were provided with our HCP reference data. All subjects were rigidly registered to MNI
RecoBundles
 
 
 
 
 
 
 
 
 
​
space. This is not required for TractSeg to work. TractSeg only requires that the left/right, front/back
 
 
 
 
 
 
 
 
 
 
 
 
and up/down orientation of the images are the same as for the HCP data (i.e. images are not
 
).
mirrored
​
Rigid registration to MNI space is an easy way to ensure this. 
 
 
TractSeg showed anatomically plausible results for all subjects and most of the tracts. Only the CA
 
 
and the Fornix (FX) were not completely reconstructed in around half of the subjects. We observed
partly incomplete manual reference dissections in these areas as well, indicating that the size of these
 
 
very thin structures is reaching the resolution limit of the underlying imaging acquisition. More
 
 
complete results could also be achieved by lowering the threshold for converting the CA and FX

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

http://nipy.org/dipy/reference/dipy.data.html#fetch-sherbrooke-3shell 

5 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
probability maps, which are generated by TractSeg, to binary maps. This would increase sensitivity at
the cost of specificity. Figures 10 and 11 show exemplary results for two of the subjects. The other
 
nine subjects can be found in the supplementary materials. 
 
Figure 10 shows the results for one healthy subject from the COBRE dataset (2mm isotropic
2
 
​). For the CST and IFO TractSeg yielded segmentations similar to the
resolution, 30x b=800mm/s
 
 
manual dissection. For the CA TractSeg missed parts but also the manual dissection was not able to
 
 
 
 
TractQuerier showed more complete results
Multi-Mask, Atlas
 
reconstruct the CA completely.
 
 
 
and
 
 
​
 
 
 
 
however this comes at the price of severe over-segmentation (false positives). For the CST and IFO,
Multi-Mask and Atlas even segmented non-brain areas and for the CA they segment major areas
 
 
 
around the CA. The CA was not
 
 
 
also
​
over-segmented the CST, but missed parts of the CA and IFO. 

 
 
 
 
reconstructed at all by

 
 
 
.
TractQuerier
​

 
 
 
RecoBundles

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

Figure 10: Qualitative comparison of results on one healthy subject from the COBRE dataset while being trained on the HCP
 
dataset: reconstruction of right corticospinal tract (CST), commissure anterior (CA) and right inferior occipito-frontal
 
 
fascicle (IFO). 
 
 
Figure 11 shows the results for a schizophrenia patient with abnormally large ventricles from the
 
 
COBRE dataset. Even though TractSeg has only seen healthy subjects with normally sized ventricles
 
during training it managed to properly segment the main pathway of the CST. It missed small parts of
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 
the lateral projections of the CST but the same is true for the manual dissection.
results but again at the cost of heavy over-segmentation even of parts of the ventricles. 

 

 

 

 

 

 

 

 

 

 

 

 

 
Atlas shows complete

 

 

 

Figure 11: Qualitative comparison of results on one subject with schizophrenia and enlarged ventricles: reconstruction of
 
 
right corticospinal tract (CST). 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

3.3. Fusion strategies 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
As described in section 2, we ran our model once for each orientation (axial, sagittal and coronal).
This results in 3 predictions for each test image, which was merged into one final segmentation using
 
 
 
a second FCNN. However, using two FCNNs instead of just one requires more resources during
 
 
 
 
 
 
 
Therefore, also two simpler fusion strategies were
training and increases the runtime for inference.
 
also evaluated: Taking the 
 and 
Mean
​
 
 
HCP
 
. On
 
 
Majority Voting
 
 
Figure 12 shows the results:
 
​
 
 
 
 
Quality,
Second FCNN approach (0.2 Dice
 
 
 
 
Second
 
points). However, on
 
 
Clinical Quality, Mean performed significantly worse (p<0.001) than the
 
 
 
 
(1.9 Dice points). Thus, in practical applications, the benefits of improved training and
FCNN
 
 
 
​
 
 
Mean fusion strategy may outweigh the gains in performance achieved
 
inference performance of the
by the 
. 
Second FCNN
​
 

 
 
 
 
Mean even worked slightly better (p<0.001) than the
 
 

 
Mean worked slightly better (p<0.001) than
 
 

 instead of running the 
Majority Voting
​

. 
Second FCNN
​

 
 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
: The mean taken;
 
Mean
​

 
 
 
: Majority voting;
 
Majority
​

: Second FCNN that received predictions from 3 slice orientations as
FCNN
 
 
 
​
 
 
: No fusion, only the respective
 
X,Y,Z
​

Figure 12: Results of different fusion strategies:
 
 
 
 
input and produced the final output;
 
 
slice orientation.  
Results show the mean Dice score over all tracts. Each subject is represented by one gray dot. The mean over all subjects is
 
 
 
shown by the colored dot and the colored number. 
 
Figure 13 shows the results of the different fusion strategies for all 72 tracts on the
 
 
 
dataset. Second FCNN consistently outperforms the simpler
 
 
FX. 

 
Clinical Quality
 
 
 
Mean fusion strategy, especially on the

 
 for the individual orientations. 
Z
​

 constantly performs better than 
Y
​

 or 
X
​

 
 

 
 

   

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

Clinical Quality datasets using different fusion strategies
Figure 13: Mean Dice scores over all subjects for 72 tracts on the
 
 
 
 
(sorted by score). Gray dots show Dice scores for each subject for the
 
 
 
 
Second FCNN fusion strategy. The full name of each
tract can be seen in figure 3. 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

3.6. Runtime 
 
Runtime experiments were performed using a server with 48 2GHz Intel Xeon cores, or an NVIDIA
 
Titan X for the GPU-based approaches (TRACULA and our proposed method). Table 2 shows the
 
 
 
results for each method when segmenting all tracts in a previously unseen subject. On average, our

 
 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
   
/
​

 
Clinical

and
 
​
 

 
Atlas
 
 

 
HCP Quality

 
and 535x faster for
 
 
HCP Quality
​

and
TractQuerier
 
 
​
 
 
 
 
and
TractQuerier
​

 
were not included in the table since they only served as simple baseline
 
​
 
   
Clinical

 
method was 81x faster than the reference methods for
 
 
Quality. 
Multi-Mask
 
 
estimation and are not openly available. Runtimes were 10.4 / 3.5 minutes (
 
 
Quality
) and 3 / 0.4 minutes respectively. 
​
 
WhiteMatterAnalysis
RecoBundles
had runtimes above 950 minutes as they depend
 
 
 
,
​
​
 
on tractography, meaning that all the following processing steps had to be performed on thousands of
 
 
 
 
 
 
streamlines.
also require cortical Freesurfer parcellation, which runs for
TRACULA
​
several hours. 
For TractSeg, the processing step with the longest runtime was the peak extraction using the CSD,
 
 
 
 
 
 
 
). The
HCP Quality
which was responsible for about 95% of the complete processing time (
 
​
fusion only 0.5min). We
segmentation itself was quite fast, timed at about 1 minute (with
 
 
 
 
 
 
Mean
 
​
Clinical Quality
 
employed single-shell CSD (without the multi-shell multi-tissue feature) on the
 
 
 
 
 
 
 
 
datasets, as only one shell is available here. This significantly decreased the computational burden and
enabled much shorter runtimes on lower quality data for the proposed method. 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Table 2: Runtime in minutes for segmenting all tracts (supported by the respective method)  in a new subject using the 
respective method. 

HCP Quality 

Clinical Quality 

 

Proposed 

RecoBundles (Garyfallidis et al., 2017) 

TractQuerier (Wassermann et al., 2016) 

WhiteMatterAnalysis (O`Donnell et al., 2012) 

TRACULA (Yendiki et al., 2011) 

20.1 

1831 

1704 

1052 

1936 

2.2 

1811 

956 

1042 

910 

3.7. Binary mask to tractogram 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 
TractSeg only generates binary tract masks. Should streamlines be needed, these masks make it easy
to generate streamlines for a certain tract. Seeding inside of the mask and only retaining the fibers
 
 
 
 
 
which never leave the mask and end in either the cortex or brainstem, results in good tract
delineations, as can be seen in figure 14. For difficult tracts like the CA, many seeds may be needed to
 
 
find streamlines which cover the full length of the tract. However, as we only seed inside of the tract
 
 
 
mask, we can use a high number of seeds without it becoming computationally infeasible. 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figure 14: Using the binary mask generated by TractSeg to delineate the CST. Only fibers which never leave the mask and
 
 
end in either the cortex or the brain stem were kept. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4. Discussion and Conclusion 

4.1. Overview 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
TractSeg is a novel direct white matter tract segmentation method based on encoder-decoder FCNNs
which has various advantages over the existing diffusion-weighted MR analysis pipelines. It was
 
 
 
evaluated by segmenting a total of 72 tracts in a cohort of 105 HCP subjects in original high quality
 
and also on reduced quality, more clinical-like datasets. Six tract segmentation methods were used as
a benchmark. Our experiments demonstrate that TractSeg achieves yet unprecedented accuracy while
 
 
being less affected by the reduction in resolution in the clinical quality data
 

 
 
 

 
 

 
 

 
 

.  

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.2. Reference data 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

Regarding the reference data, although we applied extensive efforts to mitigate the limitations of
 
 
 
ground truth
tractography, our tracts do not represent a real
 
. While some remaining false positives
 
 
 
​
 
 
 
 
cannot be excluded, difficult parts like the CA or the lateral projections of the CST are examples for
 
incomplete (false negative) reconstructions in some of the subjects (see section 3.2). Moreover the
 
reference tracts are subject to slight variations in the detailed anatomical definition of tracts, e.g. when
 
 
 
it comes to exact start and end regions. Despite these limitations, to the best of our knowledge, the
 
employed data set represents one of the best existing in-vivo approximations of known white matter
 
anatomy in a cohort of that size. Moreover, as shown in section 3.2, TractSeg can deal with a certain
level of inconsistency in the training data and produces accurate results in areas where the reference
 
tracts are incomplete. 
 

 
   

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.3. Reference methods 

 

Selecting appropriate reference methods for a fair comparison was not easy as all methods have
 
slightly different approaches and requirements. The comparison with our selected reference methods
 
 
is also subject to some limitations:  

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 

 
. 
WMA
​

 
TractQuerier was used both during the creation of the reference and during validation, inducing a
 
 
 
potential positive bias for the method. 
 
 
WMA evaluation was only available for 11 out of 72 tracts, which is not necessarily comparable.
 
 
 
 
However, the margin between
 
WMA and the proposed method remains, though, when restricting to
these same 11 tracts. Moreover the mapping of clusters to anatomical tracts did not completely align
 
 
 
with our reference tracts, as the finite set of distinct clusters offered by the atlas inherently limits a
 
 
precise mapping. Due to the huge memory requirements of WMA for 10 million streamlines
 
 
 
 
(>100GB) we had to restrict the analysis for
 
WMA to 500k streamlines, which required approx. 30GB
of RAM. This also benefited the quality of the result: cleaner clusters were created by 
RecoBundles we were only able to use 5 reference subjects due to the long runtime of
For
 
 
 
 
 
 
 
. Using all 63 training subjects would have been computationally infeasible for 72 tracts
 
RecoBundles
 
​
Multi-Mask
and tractograms with 10 million streamlines. Moreover, as suggested by our
 
 
 
experiments, averaging more subjects, does not necessarily increase accuracy as small details become
 
 
 
 
 
blurred. Using 5 reference subjects therefore provides a good estimation of the performance of
RecoBundles
. 
​
 
 
TRACULA uses its own tract definitions, which may differ from our definitions to some degree,
 
introducing a negative bias. However, for very well defined tracts like the CST, this bias is minor and
 
 
a meaningful comparison is still possible. 
Our results suggested that clustering based approaches (
 
TractQuerier
, which is in line with the findings of Zhang et al. (2017). 
​
 
MultiMask method produced significantly better results
 
It should be noted that the straightforward
 
 
 
RecoBundles
. Both used 5 reference subjects and were based on the
than the more sophisticated
 
 
 
 
​
RecoBundles works in
reference tracts, avoiding any bias induced by different tract definitions. As
 
 
 
 
 
 
 
 
 
streamline space it has to deal with the large number of false positives. Clustering helps to remove the
majority of those, but not all of them. Moreover, we used the default
 
RecoBundles settings.
 
 
 
Optimising those might improve the results to some degree. 
 
As we have shown, our comparison to the reference methods has some limitations. However, those
 
 
limitations alone can not explain the large accuracy gap between our method and all reference
methods, indicating that TractSeg has great potential. 
 

 
 
Atlas and
 
 
 
 

 
WMA, RecoBundles) perform better than
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.4. Fusion of orientations 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

The high robustness of TractSeg with respect to handling different image resolution levels is likely
 
 
 
 
due to the heavy data augmentation, the ensembling of multiple views and the general ability of CNNs
to handle noisy data. We evaluated three different strategies to fuse the three predictions of our
 
 
 
 
Majority
network for axial, sagittal and coronal input slices: Aggregation by
 
 
 
 
 
 
Second FCNN to aggregate the three predictions into one final one. On the
 
Voting and training a
 
 
 
approach showed a clear performance increase on the
Second FCNN
Clinical Quality data our
Mean
 
 
 
 
 
 
​
approach, especially on the more difficult tracts (FX, CA). This confirms our assumption that a more
   
 
 
 
 
 
 
complex fusion model can extract additional information from the different orientations. A 3D FCNN
architecture would make those fusion methods obsolete, but requires more memory, prompting us to
 
opt for a 2D architecture. Further research on 3D architecture could, however, open up promising
 
 
 
avenues. 
 

 
 
, aggregation by
Mean
 
 
​
 
 

 
 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.5. Supervised Learning 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 
 

 
TractSeg is based on supervised learning, bearing the inherent limitation of depending on the
 
 
 
 
,
 
RecoBundles
MultiMask and
availability and quality of training data. This is similar to
​
TRACULA which also require reference tracts or atlases. Using scanners and acquisition sequences
 
 
 
 
different from the training data introduces a domain shift, reducing performance. By using heavy data
 
 
 
augmentation during training this domain shift can be reduced. 
Our initial experiments on unseen datasets with and without pathologies are very promising and show
 
 
that TractSeg is able to still produce anatomically plausible results for the vast majority of bundles.
 
 
Future work could aim at adapting methods from the field of domain adaptation to further improve the
results and perform more detailed evaluations on non-HCP data. 
 

 
 
,
WMA
​
 
 

 
 
,
Atlas
​

 
 

 
 

 
 

 
 

   

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.6. Complex pipelines 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

Most existing pipelines are based on several steps. For example TractQuerier first needs to perform
 
 
 
streamline tracking first, then cortical parcellation and finally the actual querying. All of these steps
 
come with their own pitfalls and inaccuracies which accumulate further down the pipeline. Moreover,
 
all of these steps require additional runtime and installation and setup of additional tools. Our
approach enables us to avoid steps such as atlas registration, tractography or parcellation, thereby
 
 
 
 
circumventing many of the pitfalls introduced by those steps, resulting in higher accuracy, shorter
runtime and an easier setup. A more complex pipeline and manual interaction was only required for
 
generating the training data. 
 

 
 
 
 

 
 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4.7. Code and data availability 

 

 

 

 

 

 

 

 

 

 
 

 
Our dataset of 72 high quality tract dissections for 105 HCP subjects is openly available:
 
 
 
 
. Up until now, the majority of papers have used their own
https://doi.org/10.5281/zenodo.1088277
 
 
 
raters to extract reference tracts. This makes meaningful comparison between methods impossible.
 
 
 
 
 
 
We hope that this dataset can also help to standardize method evaluation. TractSeg is openly available
as an easy-to-use python package with pretrained weights: 
 
 

https://github.com/MIC-DKFZ/TractSeg/ 

 
 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Acknowledgments 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
HCP data were provided by the Human Connectome Project, WU-Minn Consortium (Principal
 
Investigators: David Van Essen and Kamil Ugurbil; 1U54MH091657) funded by the 16 NIH
 
Institutes and Centers that support
 
 
the NIH Blueprint for Neuroscience Research; and by the
McDonnell Center for Systems Neuroscience at Washington University. 
this article were obtained from the SchizConnect database
Data used in preparation for
 
 
 
 
(http://schizconnect.org). As such, the investigators within SchizConnect contributed to the design and
 
 
 
 
implementation of SchizConnect and/or provided data but did not participate in analysis or writing of
this report. Data collection and sharing for this project was funded by NIMH cooperative agreement
 
1U01 MH097435. 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 
(COINS;http://coins.mrn.org/dx) and data collection was

 
BrainGluSchi data was downloaded from the COllaborative Informatics and Neuroimaging Suite Data
 
Exchange tool
 
funded by NIMH
 
 
R01MH084898-01A1. 
 
COBRE data was downloaded from the COllaborative Informatics and Neuroimaging Suite Data
Exchange tool (COINS; http://coins.mrn.org/dx) and data collection was performed at the Mind
 
 
Research Network, and funded by a Center of Biomedical Research Excellence (COBRE) grant
 
 
5P20RR021938/P20GM103472 from the NIH to Dr. Vince Calhoun. 
 
This work was supported by the German Research Foundation (DFG) grant MA 6340/10-1 and grant
 
 
MA 6340/12-1. 
 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Supplementary Material 

 

 

 

 

 

 

 

 
 

 
 

 
Figure 1: Qualitative results of our proposed method on 5 healthy subjects from 5 different datasets (see table 1) while being
trained on the HCP dataset: reconstruction of right corticospinal tract (CST), commissure anterior (CA) and right inferior
 
 
occipito-frontal fascicle (IFO). 
 
 

   

   

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

Figure 2: Qualitative results of our proposed method on 4 subjects with pathologies from 4 different datasets (see table 1)
 
 
 
 
while being trained on the HCP dataset: reconstruction of right corticospinal tract (CST), commissure anterior (CA) and right
inferior occipito-frontal fascicle (IFO). 
 
 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

References 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
Avants, B.B., Epstein, C.L., Grossman, M., Gee, J.C., 2008. Symmetric diffeomorphic image
registration with cross-correlation: evaluating automated labeling of elderly and neurodegenerative
 
brain. Med. Image Anal. 12, 26–41. https://doi.org/10.1016/j.media.2007.06.004 
 
Bazin, P.-L., Ye, C., Bogovic, J.A., Shiee, N., Reich, D.S., Prince, J.L., Pham, D.L., 2011. Direct
 
 
 
Segmentation of the Major White Matter Tracts in Diffusion Tensor Images. NeuroImage 58,
458–468. https://doi.org/10.1016/j.neuroimage.2011.06.020 
 
Bells, S., Cercignani, M., Deoni, S., Assaf, Y., Pasternak, O., Evans, C., Leemans, A., Jones, D., 
2011. Tractometry–comprehensive multi-modal quantitative assessment of white matter along specific 
tracts. In: Proc. ISMRM, vol. 678. 
 
Bustillo, J. et al. 2016. Glutamatergic and neuronal dysfunction in gray and white matter: a 
spectroscopic imaging study in a large schizophrenia sample Schizophr Bull. PubMed PMID: 
27550776. 
 
Çetin, M.S., Christensen, F., Abbott, C.C., Stephen, J.M., Mayer, A.R., Cañive, J.M., Bustillo, J.R., 
Pearlson, G.D., Calhoun, V.D., 2014. Thalamus and posterior temporal lobe show greater 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

https://doi.org/10.1007/978-3-319-46723-8_49 

https://doi.org/10.1016/j.neuroimage.2014.04.009 

 
J.D., Storkey, A.J., Maniega, S.M., Bastin, M.E., 2009. Reproducibility of

inter-network connectivity at rest and across sensory paradigms in schizophrenia. Neuroimage 97, 
117–126. 
 
 
Çiçek, Ö., Abdulkadir, A., Lienkamp, S.S., Brox, T., Ronneberger, O., 2016. 3D U-Net: Learning
 
 
Dense Volumetric Segmentation from Sparse Annotation,
in: Medical Image Computing and
 
 
Computer-Assisted Intervention – MICCAI 2016, Lecture Notes in Computer Science. Presented at
 
the International Conference on Medical Image Computing and Computer-Assisted Intervention,
 
 
 
Springer, Cham, pp. 424–432. 
 
Clayden, J.D., Storkey, A.J., Bastin, M.E., 2007. A Probabilistic Model-Based Approach to
 
 
 
Consistent White Matter Tract Segmentation. IEEE Transactions on Medical Imaging 26, 1555–1561.
https://doi.org/10.1109/TMI.2007.905826 
 
 
tract
 
 
Clayden,
segmentation between sessions using an unsupervised modelling-based approach. NeuroImage 45,
 
 
377–385. https://doi.org/10.1016/j.neuroimage.2008.12.010 
 
 
Cook, P.A., Zhang, H., Avants, B.B., Yushkevich, P., Alexander, D.C., Gee, J.C., Ciccarelli, O.,
 
Thompson, A.J., 2005. An Automated Approach to Connectivity-Based Partitioning of Brain
Structures, in: Medical Image Computing and Computer-Assisted Intervention – MICCAI 2005,
 
 
 
Lecture Notes in Computer Science. Presented at the International Conference on Medical Image
Computing and Computer-Assisted Intervention, Springer, Berlin, Heidelberg, pp. 164–171.
 
https://doi.org/10.1007/11566465_21 
 
Dayan, M., Monohan, E., Pandya, S., Kuceyeski, A., Nguyen, T.D., Raj, A., Gauthier, S.A., 2016. 
Profilometry: a new statistical framework for the characterization of white matter pathways, with 
application to multiple sclerosis. Hum. Brain Mapp. 37 (3), 989–1004. 
 
Descoteaux, M., Deriche, R., 2009. High Angular Resolution Diffusion MRI Segmentation Using 
Region-Based Statistical Surface Evolution. J Math Imaging Vis 33, 239–252. 
https://doi.org/10.1007/s10851-008-0071-8 
 
 
Dieleman, S., Schlüter, J., Raffel, C., Olson, E., Sønderby, S.K., Nouri, D., Maturana, D., Thoma, M.,
 
Battenberg, E., Kelly, J., Fauw, J.D., Heilman, M., Almeida, D.M. de, McFee, B., Weideman, H.,
Takács, G., Rivaz, P. de, Crall, J., Sanders, G., Rasul, K., Liu, C., French, G., Degrave, J., 2015.
 
 
 
Lasagne: First release. https://doi.org/10.5281/zenodo.27878 
 
 
Dumoulin V., Visin F., 2016. A guide to convolution arithmetic for deep learning. ArXiv160307285
Stat. 
 
 
Eckstein, I., Shattuck, D.W., Stein, J.L., McMahon, K.L., de Zubicaray, G., Wright, M.J., Thompson,
P.M., Toga, A.W., 2009. Active fibers: matching deformable tract templates to diffusion tensor
 
images. NeuroImage 47 Suppl 2, T82-89. https://doi.org/10.1016/j.neuroimage.2009.01.065 
 
Garyfallidis, E., Brett, M., Correia, M.M., Williams, G.B., Nimmo-Smith, I., 2012. QuickBundles, a
Method for Tractography Simplification. Front. Neurosci. 6. https://doi.org/10.3389/fnins.2012.00175 
 

 
 
 

 
 
 

 
 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
Eng

 
366,

 
Phys

 
 
A

 
 
Sci

 
 
Trans

 
 
Philos

 
 
Resonance

 
Garyfallidis, E., Brett, M., Correia, M.M., Williams, G.B., Nimmo-Smith, I., 2012. QuickBundles, a
 
Method for Tractography Simplification. Front Neurosci 6. https://doi.org/10.3389/fnins.2012.00175 
 
 
Garyfallidis, E., Brett, M., Amirbekian, B., Rokem, A., Van Der Walt, S., Descoteaux, M.,
Nimmo-Smith, I., 2014. Dipy, a library for the analysis of diffusion MRI data. Front. Neuroinform. 8.
 
 
https://doi.org/10.3389/fninf.2014.00008 
 
 
Garyfallidis, E., Côté, M.-A., Rheault, F., Sidhu, J., Hau, J., Petit, L., Fortin, D., Cunanne, S.,
Descoteaux, M., 2017. Recognition of white matter bundles using local and global streamline-based
 
 
registration and clustering. NeuroImage. https://doi.org/10.1016/j.neuroimage.2017.07.015 
 
 
Glasser, M.F., Sotiropoulos, S.N., Wilson, J.A., Coalson, T.S., Fischl, B., Andersson, J.L., Xu, J.,
 
Jbabdi, S., Webster, M., Polimeni, J.R., Van Essen, D.C., Jenkinson, M., WU-Minn HCP Consortium,
 
 
 
2013. The minimal preprocessing pipelines for the Human Connectome Project. Neuroimage 80,
105–124. https://doi.org/10.1016/j.neuroimage.2013.04.127 
 
 
Guo, W., Chen, Y., Zeng, Q., 2008. A geometric flow-based approach for diffusion tensor image
 
 
 
 
segmentation.
2279–2292.
Math
https://doi.org/10.1098/rsta.2008.0042 
 
 
 
Hernández, M., Guerrero, G.D., Cecilia, J.M., García, J.M., Inuggi, A., Jbabdi, S., Behrens, T.E.J.,
Sotiropoulos, S.N., 2013. Accelerating fiber Orientation Estimation from Diffusion Weighted
 
 
Magnetic
 
 
 
e61892.
Using
https://doi.org/10.1371/journal.pone.0061892 
 
Hirjak, D., Thomann, P.A., Wolf, R.C., Kubera, K.M., Goch, C., Hering, J., Maier-Hein, K.H., 2017. 
White matter microstructure variations contribute to neurological soft signs in healthy adults. Hum. 
Brain Mapp. 
 
 
Jeurissen, B., Tournier, J.-D., Dhollander, T., Connelly, A., Sijbers, J., 2014. Multi-tissue constrained
 
 
spherical deconvolution for improved analysis of multi-shell diffusion MRI data. NeuroImage 103,
411–426. https://doi.org/10.1016/j.neuroimage.2014.07.061 
 
 
Jin, Y., Shi, Y., Zhan, L., Gutman, B.A., de Zubicaray, G.I., McMahon, K.L., Wright, M.J., Toga,
A.W., Thompson, P.M., 2014. Automatic clustering of white matter fibers in brain diffusion MRI with
 
 
an application to genetics. NeuroImage 100, 75–90. https://doi.org/10.1016/j.neuroimage.2014.04.048 
 
 
 
Jonasson, L., Bresson, X., Hagmann, P., Cuisenaire, O., Meuli, R., Thiran, J.-P., 2005. White matter
fiber
 
tract segmentation in DT-MRI using geometric flows. Med Image Anal 9, 223–236.
 
https://doi.org/10.1016/j.media.2004.07.004 
 
Kingma, D.P., Ba, J., 2014. Adam: A Method for Stochastic Optimization. ArXiv14126980 Cs. 
 
 
Labra, N., Guevara, P., Duclap, D., Houenou, J., Poupon, C., Mangin, J.-F., Figueroa, M., 2017. Fast
Automatic Segmentation of White Matter Streamlines Based on a Multi-Subject Bundle Atlas.
 
Neuroinform 15, 71–86. https://doi.org/10.1007/s12021-016-9316-7 

https://doi.org/10.1002/hbm.23609 

 
 
GPUs.

 
 
ONE

 
Imaging

 
PLOS

 
 

 
 

 
 

 
 

 
8,

 
 

 
 

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
 
 
 

 
 
 

 
 
 
 

 
Lenglet, C., Rousson, M., Deriche, R., 2006. DTI segmentation by statistical surface evolution. IEEE
 
 
Trans. Med. Imaging 25, 685–700. 
 
Maier-Hein, K.H., Neher, P.F., Houde, J.-C., Côté, M.-A., Garyfallidis, E., Zhong, J., Chamberland,
 
 
M., Yeh, F.-C., Lin, Y.-C., Ji, Q., Reddick, W.E., Glass, J.O., Chen, D.Q., Feng, Y., Gao, C., Wu, Y.,
 
Ma, J., Renjie, H., Li, Q., Westin, C.-F., Deslauriers-Gauthier, S., González, J.O.O., Paquette, M.,
 
 
 
St-Jean, S., Girard, G., Rheault, F., Sidhu, J., Tax, C.M.W., Guo, F., Mesri, H.Y., Dávid, S., Froeling,
M., Heemskerk, A.M., Leemans, A., Boré, A., Pinsard, B., Bedetti, C., Desrosiers, M., Brambati, S.,
 
Doyon, J., Sarica, A., Vasta, R., Cerasa, A., Quattrone, A., Yeatman, J., Khan, A.R., Hodges, W.,
 
 
Alexander, S., Romascano, D., Barakovic, M., Auría, A., Esteban, O., Lemkaddem, A., Thiran, J.-P.,
Cetingul, H.E., Odry, B.L., Mailhe, B., Nadar, M.S., Pizzagalli, F., Prasad, G., Villalon-Reina, J.E.,
 
Galvis, J., Thompson, P.M., Requejo, F.D.S., Laguna, P.L., Lacerda, L.M., Barrett, R., Dell’Acqua,
 
 
F., Catani, M., Petit, L., Caruyer, E., Daducci, A., Dyrby, T.B., Holland-Letz, T., Hilgetag, C.C.,
Stieltjes, B., Descoteaux, M., 2017. The challenge of mapping the human connectome based on
 
diffusion tractography. Nature Communications 8, 1349. https://doi.org/10.1038/s41467-017-01285-x 
 
Nair, V., Hinton, G., 2010. Rectified Linear Units Improve Restricted Boltzmann Machines. ICML. 
 
 
O’Donnell, L.J., Suter, Y., Rigolo, L., Kahali, P., Zhang, F., Norton, I., Albi, A., Olubiyi, O., Meola,
 
 
 
A., Essayed, W.I., Unadkat, P., Ciris, P.A., Wells, W.M., Rathi, Y., Westin, C.-F., Golby, A.J., 2016.
Automated white matter fiber tract identification in patients with brain tumors. NeuroImage Clin. 13,
 
 
138–153. https://doi.org/10.1016/j.nicl.2016.11.023 
 
O’Donnell, L.J., Wells, W.M., Golby, A.J., Westin, C.-F., 2012. Unbiased groupwise registration of
 
white matter tractography. Med. Image Comput. Comput.-Assist. Interv. MICCAI Int. Conf. Med.
 
 
 
Image Comput. Comput.-Assist. Interv. 15, 123–130. 
 
 
O’Donnell, L.J., Westin, C.-F., 2007. Automatic tractography segmentation using a high-dimensional
 
white
 
 
 
1562–1575.
Trans.
https://doi.org/10.1109/TMI.2007.906785 
 
Ratnarajah, N., Qiu, A., 2014. Multi-label segmentation of white matter structures: application to
 
neonatal brains. NeuroImage 102 Pt 2, 913–922. https://doi.org/10.1016/j.neuroimage.2014.08.001 
 
Ronneberger, O., Fischer, P., Brox, T., 2015. U-Net: Convolutional Networks for Biomedical Image
 
 
 
Segmentation. ArXiv150504597 Cs. 
 
Rokem, A.,Yeatman, J., Pestilli, F., Wandell, B., 2013. High angular resolution diffusion MRI. 
Stanford Digital Repository. Available at: 
 
Siless, V., Chang, K., Fischl, B., Yendiki, A., 2018. AnatomiCuts: Hierarchical clustering of
 
 
 
 
 
tractography
 
 
anatomical
 
32–45.
https://doi.org/10.1016/j.neuroimage.2017.10.058 
 

 
 
similarity. NeuroImage

http://purl.stanford.edu/yx282xq2090 

 
 
Imaging

 
 
 
matter

 
 
based

 
 
IEEE

 
 
Med.

 
 
atlas.

 
 
166,

 
streamlines

   
 
26,

 
on

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
 

 
 

 
 

 
 

 
 

 
 
 

 
80,

 
 
the Connectome

 
 
Project. NeuroImage, Mapping

 
Sotiropoulos, S.N., Jbabdi, S., Xu, J., Andersson, J.L., Moeller, S., Auerbach, E.J., Glasser, M.F.,
 
 
Hernandez, M., Sapiro, G., Jenkinson, M., Feinberg, D.A., Yacoub, E., Lenglet, C., Van Essen, D.C.,
Ugurbil, K., Behrens, T.E.J., 2013. Advances in diffusion MRI acquisition and processing in the
 
 
 
 
 
 
 
Human Connectome
125–143.
https://doi.org/10.1016/j.neuroimage.2013.05.057 
 
Srivastava, N., Hinton, G.E., Krizhevsky, A., Sutskever, I., Salakhutdinov, R., 2014. Dropout: a
 
simple way to prevent neural networks from overfitting. J. Mach. Learn. Res. 15, 1929–1958. 
 
Stieltjes, B., Brunner, R., Maier-Hein, K., Laun, F., 2013. Diffusion tensor imaging: introduction and
 
atlas. 
 
Taha, A.A., Hanbury, A., 2015. Metrics for evaluating 3D medical image segmentation: analysis,
 
 
selection, and tool. BMC Med Imaging 15. https://doi.org/10.1186/s12880-015-0068-x 
 
 
Thiebaut de Schotten, M., ffytche, D.H., Bizzi, A., Dell’Acqua, F., Allin, M., Walshe, M., Murray, R.,
 
 
Williams, S.C., Murphy, D.G.M., Catani, M., 2011. Atlasing location, asymmetry and inter-subject
 
 
variability of white matter tracts in the human brain with MR diffusion tractography. NeuroImage 54,
49–59. https://doi.org/10.1016/j.neuroimage.2010.07.055 
 
 
Tournier, J.-D., Calamante, F., Connelly, A., 2010. Improved probabilistic streamlines tractography
by 2nd order integration over fiber orientation distributions. Proc Intl Soc Mag Reson Med ISMRM
 
 
18. 
 
 
Tournier, J.-D., Calamante, F., Connelly, A., 2007. Robust determination of the fiber orientation
distribution in diffusion MRI: non-negativity constrained super-resolved spherical deconvolution.
 
NeuroImage 35, 1459–1472. https://doi.org/10.1016/j.neuroimage.2007.02.016 
 
 
 
Van Essen, D.C., Smith, S.M., Barch, D.M., Behrens, T.E.J., Yacoub, E., Ugurbil, K., 2013. The
WU-Minn Human Connectome Project: An overview. NeuroImage, Mapping the Connectome 80,
 
 
62–79. https://doi.org/10.1016/j.neuroimage.2013.05.041 
 
Wang, R., Benner, T., Sorensen, A.G., Wedeen, V.J., 2007. Diffusion toolkit: a software package for
 
diffusion imaging data processing and tractography. Proc Intl Soc Mag Reson Med 15. 
 
 
Wassermann, D., Makris, N., Rathi, Y., Shenton, M., Kikinis, R., Kubicki, M., Westin, C.-F., 2016.
 
The white matter query language: a novel approach for describing human white matter anatomy. Brain
 
 
Struct. Funct. 221, 4705–4721. 
 
Wilcoxon, F., 1945.
 
 
 
https://doi.org/10.2307/3001968 
 
Yeatman, J.D., Dougherty, R.F., Myall, N.J., Wandell, B.A., Feldman, H.M., 2012. Tract profiles of
 
 
 
 
 
 
 
 
properties:
 
e49790.
fiber-tract
white matter
https://doi.org/10.1371/journal.pone.0049790 
 

 
Individual Comparisons by Ranking Methods. Biom. Bull. 1, 80–83.
 

 
 
quantification.

 
PloS One
 

 
automating

 
 
7,

 
 

 
 

 
 

   

   

 
 

 
 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 

 
 

 
Yendiki, A., Panneck, P., Srinivasan, P., Stevens, A., Zöllei, L., Augustinack, J., Wang, R., Salat, D.,
 
Ehrlich, S., Behrens, T., Jbabdi, S., Gollub, R., Fischl, B., 2011. Automated Probabilistic
 
 
Reconstruction of White-Matter Pathways in Health and Disease Using an Atlas of the Underlying
 
 
Anatomy. Front. Neuroinformatics 5. 
 
Zhang, F., Norton, I., Cai, W., Song, Y., Wells, W.M., O’Donnell, L.J., 2017. Comparison between 
two white matter segmentation strategies: An investigation into white matter segmentation 
consistency, In: 2017 IEEE 14th International Symposium on Biomedical Imaging (ISBI 2017), pp. 
796–799. 
 
 
 

https://doi.org/10.1109/ISBI.2017.7950638 

 

 

 

 

 

 

