Watch What You Just Said:
Image Captioning with Text-Conditional Attention

Luowei Zhou1, Chenliang Xu2, Parker Koch3, and Jason J. Corso3

1Robotics Institute, University of Michigan
2Department of Computer Science, University of Rochester
3Electrical and Computer Engineering, University of Michigan
{luozhou, pakoch}@umich.edu, chenliang.xu@rochester.edu, jjcorso@eecs.umich.edu

6
1
0
2
 
v
o
N
 
4
2
 
 
]

V
C
.
s
c
[
 
 
3
v
1
2
6
4
0
.
6
0
6
1
:
v
i
X
r
a

Abstract

Attention mechanisms have attracted considerable inter-
est in image captioning due to its powerful performance.
However, existing methods use only visual content as atten-
tion and whether textual context can improve attention in
image captioning remains unsolved. To explore this prob-
lem, we propose a novel attention mechanism, called text-
conditional attention, which allows the caption generator to
focus on certain image features given previously generated
text. To obtain text-related image features for our atten-
tion model, we adopt the guiding Long Short-Term Mem-
ory (gLSTM) captioning architecture with CNN ﬁne-tuning.
Our proposed method allows joint learning of the image
embedding, text embedding, text-conditional attention and
language model with one network architecture in an end-
to-end manner. We perform extensive experiments on the
MS-COCO dataset. The experimental results show that our
method outperforms state-of-the-art captioning methods on
various quantitative metrics as well as in human evaluation,
which supports the use of our text-conditional attention in
image captioning.

1. Introduction

Image captioning is drawing increasing interest in com-
puter vision and machine learning [20, 25, 36, 33]. Ba-
sically, it requires machines to automatically describe the
content of an image using an English sentence. While this
task seems obvious for human-beings, it is complicated for
machines since it requires the language model to capture
various semantic information within an image, such as ob-
jects’ motions and actions. Another challenge for image
captioning, especially for generative models, is that the gen-
erated output should be human-like natural sentences.

Figure 1: We can barely see the sofa from the image on the
left, and we can only see a corner of the TV in the image
on the right, but we can infer them from the textual context
even with the weak visual evidences

Recent literature in image captioning is dominated by
neural network-based methods [6, 31, 36, 15]. The idea
originates from the encoder-decoder architecture in Neu-
ral Machine Translation [2], where a convolutional neural
network (CNN) is adopted to encode the input image into
a feature vector, and a sequence modeling approach (e.g.,
Long Short-Term Memory (LSTM) [14]) decodes the fea-
ture vector into a sequence of words [31]. Most recent work
in image captioning relies on this structure, and leverages
image guidance [15], attributes [36] or region attention [34]
as the extra input to LSTM decoder for better performance.
The intuition comes from visual attention, which has been
known in Psychology and Neuroscience for a long time [5].
For image captioning, this means the image guidance to the
language model should change over time according to the
context.

However, these methods using attention lack considera-
tion from the following two aspects. First, attending to the
image is only half of the story; watching what you just said
comprises the other half. In other words, visual evidence
can be inferred and interpreted by textual context, espe-

1

cially when the visual evidence is ambiguous. For example,
in the sentence “After dinner, John is comfortably lying on
the sofa and watching TV”, the objects “sofa” and “TV” are
naturally inferred even with weak visual evidences (see Fig-
ure 1, image credits: http://www.mirror.co.uk/
and http://newyork.cbslocal.com/). Despite its
importance, textual context was not a topic of focus in
attention models. Existing attention based methods such
as [36, 33, 34] have used implicit text-guiding from an
LSTM hidden layer to determine which of the image re-
gions or attributes to attend on. However, as we mentioned
in the previous example, the object for attention might be
only partially observable, so the attention input could be
misleading. This is not the case for our attention model
since the textual features are tightly coupled with the image
features to compensate for one another. While Jia et al. [15]
use joint embedding of the text and image as the guidance
for the LSTM, their approach has pre-speciﬁed guidance
that is ﬁxed over time and has a linear form. In contrast,
our method systematically incorporates the time-dependent
text-conditional attention, from 1-gram to n-gram and even
to the sentence level.

Second, existing attention based methods separate CNN
feature learning (trained for a different task, i.e. image clas-
siﬁcation) from the LSTM text generation. This leads to
a representational disconnect between features learned and
text generated. For instance, the attention model proposed
by You et al. [36] uses weighted-sum visual attributes to
guide the image captioning, while the attributes proposed
by the speciﬁc predictor are separated from the language
model. This makes the attributes guidance lack the ability
to adapt to the textual context, which ultimately compro-
mises the end-to-end learning ability the paper claimed.

To overcome the above limitations, we propose a
new text-conditional attention model based on the time-
dependent gLSTM. Our model has the ability to interpret
image features based on textual context and it is end-to-
end trainable. The model learns a text-conditional embed-
ding matrix between CNN image features and previously
generated text. Given a target image, the proposed model
generates LSTM guidance by directly conditioning the im-
age features on the current textual context. The model
hence learns how to interpret image features given the tex-
tual content it has recently generated. If it conditions the
image features on one previous word, it is a 1-gram word-
conditional model. If it is on previous two words, we get a
2-gram word-conditional model. Similarly we can construct
an n-gram word-conditional model. The extreme version
of our text-conditional model is the sentence-conditional
model, which takes advantage of all the previously gener-
ated words.

We implement our model 1 based on NeuralTalk2, an

1https://github.com/LuoweiZhou/e2e-gLSTM-sc

open-source implementation of Google NIC [31]. We com-
pare our methods with state-of-the-art methods on the com-
monly used MS-COCO dataset [23] with publicly available
splits [17] of training, validation and testing sets. We eval-
uate methods on standard metrics as well as human evalu-
ation. Our proposed methods outperform the state-of-the-
art approaches across different evaluation metrics and yield
reasonable attention outputs.

The main contributions of our paper are as follows. First,
we propose text-conditional attention which allows the lan-
guage model to learn text-speciﬁed semantic guidance au-
tomatically. The proposed attention model learns how to fo-
cus on parts of the image feature given the textual content it
has generated. Second, the proposed method demonstrates
a less complicated way to achieve end-to-end training of
attention-based captioning model, whereas state-of-the-art
methods [15, 34, 36] involve LSTM hidden states or image
attributes for attention, which compromises the possibility
of end-to-end optimization.

2. Related Work

Recent successes of deep neural networks in machine
translation [29, 3] catalyze the adoption of neural networks
in solving image captioning problems. Early works of
neural network-based image captioning include the multi-
modal RNN [18] and LSTM [31]. In these methods, neu-
ral networks are used for both image-text embedding and
sentence generating. Various methods have shown to im-
prove performance with region-level information [8, 16],
external knowledge [1], and even from question-answering
[24]. Our method differs from them by considering atten-
tion from textual context in caption generating.

Attention mechanism has recently attracted considerable
interest in LSTM-based image captioning [34, 15, 36, 33].
Xu et al. [34] propose a model that integrates visual at-
tention through the hidden state of LSTM model. You et
al. [36] and Wu et al. [33] tackle the semantic attention
problem by fusing visual attributes extracted from images
with the input or the output of LSTM. Even though these
approaches achieve state-of-the-art performance, the perfor-
mances rely heavily upon the quality of the pre-speciﬁed
visual attributes, i.e., better attributes usually lead to bet-
ter results. Our method also uses attention mechanism, but
we consider the explicit time-dependent text attention and
is comprised a clean architecture for the ease of end-to-end
learning.

in image

Early works

captioning focus on ei-
ther template-based methods or transfer-based methods.
Template-based methods [20, 22, 35, 26, 7, 12] specify tem-
plates and ﬁll them with detected visual evidences from tar-
get images. In Kulkarni et al. [20], visual detections are
ﬁrst put into a graphical model with higher order poten-
tials from text corpora to reduce noise, then converted to

language descriptions based on pre-speciﬁed templates. In
Yang et al.
[35], a quadruplet consisting of noun, verb,
scene and preposition is used to describe an image. The
drawback of these methods is that the descriptions are not
vivid and human-crafted templates do not work for all im-
ages. Transfer-based methods [9, 21, 4] rely on image re-
trieval to assign the target image with descriptions of similar
images in the training set. A common issue is that they are
less robustness to unseen images.

2.1. Background

The generated sentences by the LSTM model may lose
track of the original image content since it only accesses
the image content once at the beginning of the learning pro-
cess, and forgets the image after even a short period of time.
Therefore, Jia et al. [15] propose an extension of the LSTM
model, named the guiding LSTM (gLSTM), which extracts
semantic information from the target image and feeds it into
the LSTM model every time step as extra information. The
basic gLSTM unit is shown in Fig. 2. Its memory cell and
gates are deﬁned as follows:

it = σ(Wixxt + Wimmt−1 + Wiqg)
ft = σ(Wf xxt + Wf mmt−1 + Wf qg)
ot = σ(Woxxt + Wommt−1 + Woqg)
ct = ft (cid:12) ct−1 + it (cid:12) h(Wcxxt + Wcmmt−1 + Wcqg)
mt = ot (cid:12) ct ,

(1)

where W s denote weights, (cid:12) represents element-wise mul-
tiplication, σ(·) is the sigmoid function, h(·) is the hyper-
bolic tangent function, xt stands for input, it for the input
gate, ft for the forget gate, ot for the output gate, ct for state
of the memory cell, mt for the hidden state (also output for
one-layer LSTM), and g represents guidance information,
which is time-invariant. The subscripts denote time: t is the
current time step and t − 1 is the previous time step.

3. Methods

Our text-conditional attention model is based on a time-
dependent gLSTM (td-gLSTM). We ﬁrst describe the td-
gLSTM in Sec. 3.1 and show how to obtain semantic guid-
ance through this structure. Then, we introduce our text-
conditional attention model and its variants, e.g. n-gram
word- and sentence-conditional models, in Sec. 3.2.

3.1. Time-Dependent gLSTM (td-gLSTM)

The gLSTM described in Sec. 2.1 has a time-invariant
guidance. In Jia et al. [15], they show three ways of using
such guidance, including an embedding of the joint image-
text feature by linear CCA. However, the textual context
in a sentence is constantly changing while the caption gen-
erator is generating the sentence. Obviously, we need the

Figure 2: Shown in black is the gLSTM node [15]. The red
subscript of gt represents our td-gLSTM guidance. Figure
modiﬁed from [11]. Best viewed in color.

guidance to evolve over time, and hence we propose td-
gLSTM. Notice that, despite its simple change in structure,
the td-gLSTM is much more ﬂexible in the way it incorpo-
rates guidance, e.g. a time-series dynamic guidance such
as tracking and actions in a video. Also, notice that the
gLSTM is a sepcial case of the td-gLSTM, when the guid-
ance is set as gt = gt−1.

Our proposed td-gLSTM consists of three parts: 1) im-
age embedding; 2) text embedding; and 3) LSTM language
model. Figure 3 shows an overview for using td-gLSTM
for captioning. First, image feature vector I is extracted us-
ing CNN and each word in the caption is represented by a
one-hot vector St, where t indicates the index of the word
in the sentence. We use the text embedding matrix We to
embed text feature St into a latent space, which is the in-
put xt of the LSTM language model. The text embedding
matrix is initialized from a zero-mean Gaussian distribution
with standard deviation 0.01. On the other hand, the text
feature is jointly embedded with the image feature, denoted
as gt = h(St, I), where gt is the time-dependent guidance.
Here, we do not specify the particular form of gt to make the
framework general, and its choices are discussed in Sec. 3.2.
Both the guidance gt and embedded text features xt =
WeSt are used as the inputs to td-gLSTM, which are shown
in Fig. 2 (including red) and formulated as follows:

it = σ(Wixxt + Wimmt−1 + Wiqgt)
ft = σ(Wf xxt + Wf mmt−1 + Wf qgt)
ot = σ(Woxxt + Wommt−1 + Woqgt)
ct = ft (cid:12) ct−1 + it (cid:12) h(Wcxxt + Wcmmt−1 + Wcqgt)
mt = ot (cid:12) ct .

(2)

We back-propagate error through guidance gt for ﬁne-

Figure 3: Text-conditional semantic attention. The text-conditional attention part are highlighted in bold. St indicates
the one-hot vector representation of the tth word in the sentence. We is word embedding matrix, We is text-conditional
embedding matrix, I is image feature and gt is time-dependent guidance. See text for more details.

tuning the CNN. One signiﬁcant beneﬁt of this is that the
model allows the guidance information to be more similar
to its corresponding text description. Note that the text-
conditional guidance gt keeps changing in each time step,
which is a time-dependent variable. The outputs of the lan-
guage model are the log likelihood of each word from the
target sentence, followed by a Softmax function for normal-
ization. We use the regularized cross-entropy loss function:

L(I, S) = −

log(pk(Sk)) +

||Wconv||2

2 ,

(3)

λ
2

N
(cid:88)

k=1

where I represents the image, S represents the sentence, Sk
denotes the kth word in the sentence, SN is the stop sign,
Wconv denotes all the weights in the convolutional net and λ
controls the importance of the regularization term. Finally,
we back-propagate the loss to LSTM language model, the
text embedding matrix and the image embedding CNN. The
training detail is described in Sec. 4.1.

3.2. Text-Conditional Attention

Recently, You et al. [36] use visual attributes as the se-
mantic attention to guide the image captioning. Their se-
mantic guidance consists of top visual attributes of the in-
put image, and the weight of each attribute is determined
by the current word, which is the previous output of RNN.
However, the attribute predictor adopted in their model
has no learning ability and is separated from the encoder-
decoder language model.
In contrast, following the td-
gLSTM model (see Sec. 3.1), we condition the guidance

information gt on the current word St (the one-hot vector
representation), and use the text-conditional image feature
as the semantic guidance. The beneﬁts are twofold: ﬁrst,
the model can learn which part of the semantic image fea-
ture should be focused on when seeing a speciﬁc word; sec-
ond, this structure is end-to-end tunable such that the CNNs
weights are tuned for captioning rather than for image clas-
siﬁcation [27]. For instance, when the caption generator
generated a sequence as “a woman is washing”, its atten-
tion on the image feature should be automatically switched
to objects that can be washed, such as clothes and dishes.

We ﬁrst consider modeling the text-conditional guidance
feature gt as the weighted-sum of the outer product of image
feature I and text feature St, therefore each entry in gt is
represented as:

gi
t =

WijkI jSk

t + bi ,

(4)

(cid:88)

j,k

where I j denotes the jth entry of the image feature, Sk
t de-
t is the ith entry
notes the kth entry of the text feature, and gi
of the text-conditional guidance feature. For each gi
t, the
corresponding weights Wi is a 2-D tensor, hence, the total
weights W for gt is a 3-D tensor. In this model, image fea-
ture is fully coupled with text feature though the 3-D tensor.
Despite Eq. 4 fully couples the two types of features,
it results in a huge amount of parameters, which prohibits
its use in practice. To overcome it, we introduce an em-
bedding matrix Wc, which contains various text-to-image
masks. Furthermore, in practice, adding one non-linear

transfer function layer after the image-text feature embed-
ding boosts the performance. Therefore, we model the text-
conditional feature gt as a text-based mask on image feature
I followed by a non-linear function:

Table 1: Results of n-gram word- and sentence-conditional
models with Tanh transfer function and 34-layer ResNet.
Top-2 scores for each metric are highlighted. All values are
reported as percentage (%).

gt = Φ(I (cid:12) WcSt) ,

(5)

BLEU@4 METEOR CIDEr

where Wc is the text-conditional embedding matrix and
Φ(·) is a non-linear transfer function. When Wc is a all-
one matrix, the conditioned feature I (cid:12) WcSt is identical to
I. We transfer the pre-trained model from gLSTM to ini-
tialize the CNN, language model and word embedding of
our attention model. For text-conditional matrix, we initial-
ize it with all ones. We show the sensitivity of our model to
various transfer functions in Sec. 4.2.

The above model is the 1-gram word-conditional seman-
tic attention owing to the guidance feature is merely condi-
tioned on the previous word. Similarly, we develop the 2-
gram word-conditional model, which utilizes previous two
words, or even n-gram word-conditional model. The ex-
treme version of the text-conditional model is the sentence-
condition model, which takes advantage of all the previ-
ously generated words:

gt = Φ(I (cid:12) Wc

(6)

t
(cid:88)

k=1

Sk−1
t

) .

One beneﬁt of the text-conditional model is that it allows
the language model to learn semantic attention automati-
cally though the back-propagation of the training loss while
attribute-based method, such as [36], represents semantic
guidance by some major components of an image, but other
semantic information, such as objects’ motions and loca-
tions, are discarded.

4. Experiments

We describe our experiment settings in Sec. 4.1, analyze
the variants of our model and attention in Sec. 4.2, and com-
pare our method with state-of-the-art methods in Sec. 4.3.

4.1. Experiment Setup

We use the MS-COCO dataset [23] with the commonly
adopted splits as described in [17]: 113,287 images for
training, 5,000 images for validation and 5,000 images for
testing. Three standard evaluation metrics, e.g. BLEU,
METEOR and CIDER, are used in addition to human
evaluation. We implement our model based on the Neu-
ralTalk2 [17], which is an open source implementation
of [31]. We use three different CNNs in our experiments,
e.g. 34-layer and 200-layer ResNets [13] and 16-layer VG-
GNet [28]. For a fair comparison, we use 34-layer ResNet
when analyzing the variants of our models in Table 1 and 2,
16-layer VGGNet when comparing to state-of-the-art meth-
ods in Table 5 and 6, and 200-layer ResNet for leadboard

1-gram
2-gram
3-gram
4-gram
sentence

29.5
30.2
29.9
30.3
30.6

24.6
24.8
24.9
24.9
25.0

94.6
97.3
96.1
97.0
98.1

Table 2: Results of different transfer functions on sentence-
conditional model (denoted as sc) with 34-layer ResNet.
Top scores for each metric are highlighted. All values are
reported as percentage (%).

BLEU@4 METEOR CIDEr

sc-relu
sc-tanh
sc-softmax
sc-sigmoid

30.5
30.6
30.2
30.1

25.0
25.0
24.9
24.8

98.1
98.1
97.1
96.2

competition in Table 7. The variation of performance re-
garding different CNNs are also evaluated in Table 3.

We train our model in three steps: 1) train time-invariant
gLSTM (ti-gLSTM) without CNN ﬁne-tuning for 100,000
iterations; 2) train ti-gLSTM with CNN ﬁne-tuning for
150,000 iterations; and 3) train td-gLSTM with initializd
text-conditional matrix but without CNN ﬁne-tuning for
150,000 iterations. The reason for this multiple-step train-
ing is described in Vinyals et al. [32]: jointly training the
system at the initial time causes noise in the initial gradi-
ents coming from LSTM that corrupts the CNN unrecov-
erably. For the hyper-parameters, we set the CNN weight
decay rate (λ in Eq. 3) to 10−3 to avoid overﬁtting. The
learning rate for CNN ﬁne-tuning is set to 10−5 and the
learing rate for language model is set to 4 × 10−4. We use
Adam optimizer [19] for updating weights with α = 0.8
and β = 0.999. We adopt 2 and 3 for beam sizes dur-
ing inference, as recommended by recent studies [32, 6].
The whole training process takes about one day on a single
NVIDIA TITAN X GPU.

4.2. Model Variants & Attention

N-gram v.s. Sentence. Table 1 shows results with n-gram
word- and sentence-conditional models. For conciseness,
we only use BLEU@4, METEOR and CIDEr as the eval-
uation metrics, since they are more correlated with human
judgments compared with low-level BLEU scores [30]. It
turns out generally, word-conditional models with higher
grams yield better results, especially for METEOR. Notice
that the 2, 3, 4-gram models achieve considerablely better

Table 3: The Impact of image encoding CNNs on caption-
ing performance. Tanh is used as transfer function. Top re-
sult for each column is highlighted. All values are reported
as percentage (%).

Methods BLEU@4 METEOR CIDEr
sc-vgg-16
sc-resnet-34
sc-resnet-200

24.7
25.0
25.1

30.1
30.6
31.4

97.0
98.1
97.7

is expected that similar words should have similar masks
(with some variations). To verify, we calculate the similar-
ities among masks using Euclidean distance. We show ﬁve
randomly sampled words w.r.t. different parts of speech
(noun, verb and adjective). Table 4 shows their top few
nearest words. Most of the neighbors are related to the orig-
inal word, and some of them are strongly related, such as
“cat” for “dog”, “blue” for “red”, “sits” for “sitting”, and
“woman” for “man”. This shows strong evidence that our
model is learning meaningful text-conditional attention.

Table 4: Top-6 nearest neighbors for randomly picked
words. The results are based on the text-conditional ma-
trix Wc of 1-gram word-conditional model. We highlight
similar words in semantics.

dog
banana
red
sitting
man

bear three woman cat girl person
it carrots
fruits six onto includes
UNK blue three several man yellow
standing next are sits dog woman
woman person his
three are dog

results than 1-gram model, which is reasonable as the 1-
gram has the least context that limits the attention perfor-
mance. Furthermore, the sentence-conditional model out-
performs all word-conditional models in all metrics, which
shows the importance of long-term word dependency in at-
tention modeling.
Transfer Function. We use a non-linear transfer function
Φ(·) in our attention model (see Eq. 5) and we test four dif-
In
ferent functions: Softmax, ReLU, Tanh and Sigmoid.
all cases, we initialize the text-conditional embedding ma-
trix with noises from one-mean Gaussian distribution with
standard deviation 0.001. We base our experiments on the
sentence-conditional model and conclude that the model
achieves best performance when Φ(·) is a Tanh or a ReLU
function (see Table 2). Notice that it is possible that other
transfer functions different than the four we tested may lead
to better results.
Image Encoding. We study the impact of image encoding
CNNs on captioning performance, as shown in Table 3. In
general, the more sophisticated image encoding architecture
the higher performance of the captioning.

4.2.1 Attention

It is essential to verify whether our learned text-conditional
attention is semantically meaningful. Each column in the
text-conditional matrix Wc is an attention mask for image
features, and it corresponds to a word in our dictionary. It

4.3. Compare to State-of-The-Art Methods

We use LSTM with time-invariant image guidance (img-
gLSTM) [15] and NeuralTalk2 [17], an implementation
of [31], as baselines. We also compare to a state-of-the-
art non-attention-based model—LSTM with semantic em-
bedding guidance (emb-gLSTM) [15]. Furthermore, we
compare our method to a set of state-of-the-art attention-
based methods including visual attention with soft- and
hard-attention [34], and semantic attention with visual at-
tributes (ATT-FCN) [36]. For fair comparison among dif-
ferent attention models, we report our results with 16-layer
VGGNet [28] since it is similar to the image encodings used
in other methods.

Table 5 shows the comparison results. Our methods,
both 1-gram word-conditional and sentence-conditional,
outperform our two baselines in all metrics by a large mar-
gin, ranging from 1% to 5%. The results are strong evidence
that 1) our td-gLSTM is better suited for captioning compar-
ing to time-invariant gLSTM; and 2) modeling textual con-
text is essential for image captioning. Also, our methods
yield much higher evaluation scores than emb-gLSTM [15]
showing the effectiveness of using textual content in our
model.

We further compare our text-conditional methods with
state-of-the-art attention-based methods. For 1-gram word-
conditional method, the attention on the image feature guid-
ance is merely determined by the previously generated
word. Apparently, this results in semantic information loss.
Even though, its performances are still on par with or bet-
ter than state-of-the-art attention-based methods, such as
Hard-Attention and ATT-FCN. We then upgrade the word-
conditional model to the sentence-conditional model, which
leads to improved performance in all metrics, and it out-
performs state-of-the-art methods in most metrics. It worth
noting that BLEU@1 score is related to single word accu-
racy, and highly affected by word vocabularies. This might
result in our relatively low BLEU@1 score compared with
hard-attention [34].

Table 5: Comparison to baselines and state-of-the-art methods. For some competing methods, we extract their performance
from the corresponding papers. For a fair comparison, we use 16-layer VGGNet for image encoding. Top-two scores for
each metric are highlighted. All values are reported as percentage (%).

img-gLSTM [15]
emb-gLSTM [15]
NeuralTalk2 [17]
Hard-Attention [34]
Soft-Attention [34]
ATT-FCN [36]
Our 1-gram-vgg-16
Our sc-vgg-16

Methods BLEU@1 BLEU@2 BLEU@3 BLEU@4 METEOR CIDEr
31.1
35.8
39.2
35.7
34.4
40.2
40.0
40.5

67.7
81.3
92.3
-
-
-
95.5
97.0

20.4
22.7
24.3
23.0
23.9
24.3
24.5
24.7

21.4
26.4
28.9
25.0
24.3
30.4
29.6
30.1

45.9
49.1
53.2
50.4
49.2
53.7
54.2
54.5

64.7
67.0
70.5
71.8
70.7
70.9
71.5
71.6

Table 6: Results of human evaluation. The higher the better
for both the content quality and the grammar scores. The
highest score for each column is highlighted.

4.3.2 Qualitative Results

Methods Content Grammar
1.56
1.94
2.00

img-gLSTM [15]
NeuralTalk2 [17]
Our sc-vgg-16

2.75
2.77
2.80

4.3.1 Human Evaluation

We choose three methods for human evaluation, Neu-
ralTalk2, img-gLSTM and our sentence-conditional atten-
tion model. A cohort of ﬁve well-trained human anno-
tators is performed the experiments. Each of the annota-
tors were shown 500 pairs of randomly selected images and
three corresponding generated captions. The annotators rate
the three captions from 0 to 3 regarding the content quality
and grammar (the higher the better). For content quality,
a score of 3 is given if the caption describes all the impor-
tant content, e.g. objects and actions, in the image; a score
of 0 is given if the caption is totally wrong or irrelevant.
For grammar, a score of 3 denotes human-level natural ex-
pression and a score of 0 means the caption is unreadable.
The results are shown in Table 6. Our proposed sentence-
conditional model lead the baseline img-gLSTM by a large
margin of 28.2% in the caption content quality, and 3.1%
compared to the baseline Neuraltalk2, showing the effec-
tiveness of our attention mechanism in captioning. As for
grammar, all the methods create human-like sentences with
a few grammar mistakes, and adding sentence-conditional
attention to LSTM yields a slightly higher grammar score,
due to the explicitly textual information contained in the
LSTM guidance input.

Figure 4 shows qualitative captioning results. The ﬁx im-
ages in the ﬁrst three rows are positive examples and the
last two are failed cases. Our proposed model can better
capture details in the target image, such as “yellow ﬁre hy-
drant” in the second image, and “soccer” in the ﬁfth im-
age. Also, the text-conditional attention discovers rich con-
text information in the image, such as the “preparing food”
followed by “kitchen” in the ﬁrst image, and the ‘in their
hand‘” followed by “holding” in the sixth image. However,
we also show the failed cases, where the objects are mistak-
enly inferred from the previous words. For the ﬁrst image,
when we feed in the word sequence “a man (is) sitting”, our
text-conditional attention is triggered by things can be sat
by a man; a sofa is a reasonable candidate according to the
training data. Similarly, for the second image, the model
is trained on some images with stuffed animal held by a
person, which in some sense biases the semantic attention
model.

4.3.3 Leaderboard Competition

We test our model on the MS-COCO leaderboard compe-
tition and summarize the results in Table 7. Our method
outperforms the baseline (NeuralTalk2 [17]) across all the
metrics and is on par with state-of-the-art methods. It worth
noting that our baseline is an open source implementation
of [31], shown as OriolVinyals in Tab. 7, but the latter
performs much better due to better CNNs, inference meth-
ods, and more careful engineering. Also, several methods
unreasonably outperform human-annotated captions, which
reveals the drawback of the existing evaluation metrics.

5. Conclusion

In this paper, we propose a semantic attention
mechanism for image caption generation, called text-

Table 7: Evaluation on MS-COCO leaderboard. We list state-of-the-art published results. We highlight our method and our
baseline method, NeuralTalk2. Notice that methods highly-ranked in learderboard use better CNNs, inference methods, and
more careful engineering than research publishes.

Methods
ATT VC [36]
OriolVinyals [32]
jeffdonahue [6]
SC-Tanh (ours)
Q.Wu [33]
Human
NeuralTalk2 [17]

BLEU-1

BLEU-2

BLEU-3

BLEU-4

c5
0.731
0.713
0.718
0.717
0.725
0.663
0.706

c40
0.900
0.895
0.895
0.887
0.892
0.880
0.877

c5
0.565
0.542
0.548
0.546
0.556
0.469
0.530

c40
0.815
0.802
0.804
0.794
0.803
0.744
0.776

c5
0.424
0.407
0.409
0.405
0.414
0.321
0.388

c40
0.709
0.694
0.695
0.682
0.694
0.603
0.657

c5
0.316
0.309
0.306
0.300
0.306
0.217
0.284

c40
0.599
0.587
0.585
0.569
0.582
0.471
0.541

METEOR
c5
0.250
0.254
0.247
0.248
0.246
0.252
0.238

c40
0.335
0.346
0.335
0.330
0.329
0.335
0.317

ROUGE-L
c40
c5
0.682
0.535
0.682
0.530
0.678
0.528
0.667
0.515
0.672
0.528
0.626
0.484
0.654
0.515

CIDEr-D
c5
0.943
0.943
0.921
0.923
0.911
0.854
0.858

c40
0.958
0.946
0.934
0.929
0.924
0.910
0.865

Figure 4: Qualitative results. We show both positive examples and failed cases of our method. NT2 indicates NeuralTalk2
and sc-tanh is our sentence-conditional model. Better viewed in color.

conditional semantic attention, which provides explicitly
text-conditioned image features for attention. We also im-
prove the existing gLSTM framework by introducing time-
dependent guidance, opening up a new way for further
boosting image captioning performance. We show in our
experiments that the proposed methods signiﬁcantly im-
prove the baseline method and outperform state-of-the-art
methods, which supports our argument of explicit consider-
ation of using text-conditional attention modeling.

Future Work. There are several ways in which we can fur-
ther improve our method. First, combining text-conditional

attention with region-based or attribute-based attention, so
that the model can learn to attend on regions in feature
maps or attributes extracted from the image. Second, one
common issue with supervised training is overﬁtting. As
Vinyals et al. [31] pointed out, we cannot access enough
training samples, even for the relatively huge dataset such
as MS-COCO. One possible solution is to combine weakly
annotated images with current dataset, such as [10]. We
keep those for our future work.

References

[1] L. Anne Hendricks, S. Venugopalan, M. Rohrbach,
R. Mooney, K. Saenko, and T. Darrell. Deep composi-
tional captioning: Describing novel object categories with-
out paired training data. In IEEE Conference on Computer
Vision and Pattern Recognition, 2016.

[2] D. Bahdanau, K. Cho, and Y. Bengio. Neural machine trans-
lation by jointly learning to align and translate. In Interna-
tional Conference on Learning Representations, 2015.
[3] K. Cho, B. Van Merri¨enboer, C. Gulcehre, D. Bahdanau,
F. Bougares, H. Schwenk, and Y. Bengio. Learning phrase
representations using rnn encoder-decoder for statistical ma-
In Empirical Methods in Natural Lan-
chine translation.
guage Processing, 2014.

[4] P. Das, R. K. Srihari, and J. J. Corso. Translating related
words to videos and back through latent topics. In WSDM,
2013.

[5] R. Desimone and J. Duncan. Neural mechanisms of selective
visual attention. Annual Review of Neuroscience, 18(1):193–
222, 1995.

[6] J. Donahue, L. Anne Hendricks,

S. Guadarrama,
M. Rohrbach, S. Venugopalan, K. Saenko, and T. Dar-
Long-term recurrent convolutional networks for
rell.
visual recognition and description. In IEEE Conference on
Computer Vision and Pattern Recognition, 2015.

[7] D. Elliott and F. Keller. Image description using visual de-
pendency representations. In Empirical Methods in Natural
Language Processing, 2013.

[8] H. Fang, S. Gupta, F. Iandola, R. K. Srivastava, L. Deng,
P. Doll´ar, J. Gao, X. He, M. Mitchell, J. C. Platt, et al. From
captions to visual concepts and back. In IEEE Conference
on Computer Vision and Pattern Recognition, 2015.

[9] A. Farhadi, M. Hejrati, M. Sadeghi, P. Young, C. Rashtchian,
J. Hockenmaier, and D. Forsyth. Every picture tells a story:
Generating sentences from images. In European Conference
on Computer Vision, 2010.

[10] Y. Gong, L. Wang, M. Hodosh, J. Hockenmaier, and
S. Lazebnik. Improving image-sentence embeddings using
large weakly annotated photo collections. In European Con-
ference on Computer Vision, 2014.

[11] A. Graves. Supervised sequence labelling with recurrent

neural networks. 2012.

[12] S. Guadarrama, N. Krishnamoorthy, G. Malkarnenkar,
S. Venugopalan, R. Mooney, T. Darrell, and K. Saenko.
Youtube2text: Recognizing and describing arbitrary activi-
ties using semantic hierarchies and zero-shot recognition. In
IEEE International Conference on Computer Vision, 2013.

[13] K. He, X. Zhang, S. Ren, and J. Sun. Deep residual learning
In IEEE Conference on Computer

for image recognition.
Vision and Pattern Recognition, 2016.

[14] S. Hochreiter and J. Schmidhuber. Long short-term memory.

Neural Computation, 9(8):1735–1780, 1997.

[15] X. Jia, E. Gavves, B. Fernando, and T. Tuytelaars. Guiding
the long-short term memory model for image caption genera-
tion. In IEEE International Conference on Computer Vision,
2015.

[16] J. Johnson, A. Karpathy, and L. Fei-Fei. Densecap: Fully
convolutional localization networks for dense captioning. In
IEEE Conference on Computer Vision and Pattern Recogni-
tion, 2016.

[17] A. Karpathy.

neuraltalk2.

https://github.com/

karpathy/neuraltalk2, 2015.

[18] A. Karpathy and L. Fei-Fei. Deep visual-semantic align-
ments for generating image descriptions. In IEEE Confer-
ence on Computer Vision and Pattern Recognition, 2015.
[19] D. Kingma and J. Ba. Adam: A method for stochastic opti-

mization. arXiv preprint arXiv:1412.6980, 2014.

[20] G. Kulkarni, V. Premraj, V. Ordonez, S. Dhar, S. Li, Y. Choi,
A. C. Berg, and T. L. Berg. Babytalk: Understanding and
IEEE Transactions
generating simple image descriptions.
on Pattern Analysis and Machine Intelligence, 35(12):2891–
2903, 2013.

[21] P. Kuznetsova, V. Ordonez, A. C. Berg, T. L. Berg, and
Y. Choi. Collective generation of natural image descriptions.
In Association for Computational Linguistics, 2012.

[22] S. Li, G. Kulkarni, T. L. Berg, A. C. Berg, and Y. Choi. Com-
posing simple image descriptions using web-scale n-grams.
In Computational Natural Language Learning, 2011.
[23] T.-Y. Lin, M. Maire, S. Belongie, J. Hays, P. Perona, D. Ra-
manan, P. Doll´ar, and C. L. Zitnick. Microsoft coco: Com-
mon objects in context. In European Conference on Com-
puter Vision, 2014.

[24] X. Lin and D. Parikh. Leveraging visual question answer-
ing for image-caption ranking. In European Conference on
Computer Vision, 2016.

[25] J. Mao, W. Xu, Y. Yang, J. Wang, Z. Huang, and A. Yuille.
Deep captioning with multimodal recurrent neural networks
(m-rnn). In International Conference on Learning Represen-
tations, 2015.

[26] M. Mitchell, X. Han, J. Dodge, A. Mensch, A. Goyal,
A. Berg, K. Yamaguchi, T. Berg, K. Stratos,
and
H. Daum´e III. Midge: Generating image descriptions from
computer vision detections. In EACL. Citeseer, 2012.
[27] O. Russakovsky, J. Deng, H. Su, J. Krause, S. Satheesh,
S. Ma, Z. Huang, A. Karpathy, A. Khosla, M. Bernstein,
et al.
Imagenet large scale visual recognition challenge.
International Journal of Computer Vision, 115(3):211–252,
2015.

[28] K. Simonyan and A. Zisserman. Very deep convolutional
networks for large-scale image recognition. In International
Conference on Learning Representations, 2015.

[29] I. Sutskever, O. Vinyals, and Q. V. Le. Sequence to sequence
learning with neural networks. In Advances in Neural Infor-
mation Processing Systems, 2014.

[30] R. Vedantam, C. Lawrence Zitnick, and D. Parikh. Cider:
Consensus-based image description evaluation. In Proceed-
ings of the IEEE Conference on Computer Vision and Pattern
Recognition, pages 4566–4575, 2015.

[31] O. Vinyals, A. Toshev, S. Bengio, and D. Erhan. Show and
tell: A neural image caption generator. In IEEE Conference
on Computer Vision and Pattern Recognition, 2015.

[32] O. Vinyals, A. Toshev, S. Bengio, and D. Erhan. Show and
tell: Lessons learned from the 2015 mscoco image caption-

ing challenge. IEEE Transactions on Pattern Analysis and
Machine Intelligence, 2016.

[33] Q. Wu, C. Shen, L. Liu, A. Dick, and A. v. d. Hengel. What
value do explicit high level concepts have in vision to lan-
guage problems? In IEEE Conference on Computer Vision
and Pattern Recognition, 2016.

[34] K. Xu, J. Ba, R. Kiros, K. Cho, A. Courville, R. Salakhut-
dinov, R. S. Zemel, and Y. Bengio. Show, attend and tell:
Neural image caption generation with visual attention.
In
International Conference on Machine Learning, 2015.
[35] Y. Yang, C. L. Teo, H. Daum´e III, and Y. Aloimonos.
Corpus-guided sentence generation of natural images.
In
Proceedings of the Conference on Empirical Methods in Nat-
ural Language Processing, pages 444–454. Association for
Computational Linguistics, 2011.

[36] Q. You, H. Jin, Z. Wang, C. Fang, and J. Luo. Image caption-
ing with semantic attention. In IEEE Conference on Com-
puter Vision and Pattern Recognition, 2016.

Watch What You Just Said:
Image Captioning with Text-Conditional Attention

Luowei Zhou1, Chenliang Xu2, Parker Koch3, and Jason J. Corso3

1Robotics Institute, University of Michigan
2Department of Computer Science, University of Rochester
3Electrical and Computer Engineering, University of Michigan
{luozhou, pakoch}@umich.edu, chenliang.xu@rochester.edu, jjcorso@eecs.umich.edu

6
1
0
2
 
v
o
N
 
4
2
 
 
]

V
C
.
s
c
[
 
 
3
v
1
2
6
4
0
.
6
0
6
1
:
v
i
X
r
a

Abstract

Attention mechanisms have attracted considerable inter-
est in image captioning due to its powerful performance.
However, existing methods use only visual content as atten-
tion and whether textual context can improve attention in
image captioning remains unsolved. To explore this prob-
lem, we propose a novel attention mechanism, called text-
conditional attention, which allows the caption generator to
focus on certain image features given previously generated
text. To obtain text-related image features for our atten-
tion model, we adopt the guiding Long Short-Term Mem-
ory (gLSTM) captioning architecture with CNN ﬁne-tuning.
Our proposed method allows joint learning of the image
embedding, text embedding, text-conditional attention and
language model with one network architecture in an end-
to-end manner. We perform extensive experiments on the
MS-COCO dataset. The experimental results show that our
method outperforms state-of-the-art captioning methods on
various quantitative metrics as well as in human evaluation,
which supports the use of our text-conditional attention in
image captioning.

1. Introduction

Image captioning is drawing increasing interest in com-
puter vision and machine learning [20, 25, 36, 33]. Ba-
sically, it requires machines to automatically describe the
content of an image using an English sentence. While this
task seems obvious for human-beings, it is complicated for
machines since it requires the language model to capture
various semantic information within an image, such as ob-
jects’ motions and actions. Another challenge for image
captioning, especially for generative models, is that the gen-
erated output should be human-like natural sentences.

Figure 1: We can barely see the sofa from the image on the
left, and we can only see a corner of the TV in the image
on the right, but we can infer them from the textual context
even with the weak visual evidences

Recent literature in image captioning is dominated by
neural network-based methods [6, 31, 36, 15]. The idea
originates from the encoder-decoder architecture in Neu-
ral Machine Translation [2], where a convolutional neural
network (CNN) is adopted to encode the input image into
a feature vector, and a sequence modeling approach (e.g.,
Long Short-Term Memory (LSTM) [14]) decodes the fea-
ture vector into a sequence of words [31]. Most recent work
in image captioning relies on this structure, and leverages
image guidance [15], attributes [36] or region attention [34]
as the extra input to LSTM decoder for better performance.
The intuition comes from visual attention, which has been
known in Psychology and Neuroscience for a long time [5].
For image captioning, this means the image guidance to the
language model should change over time according to the
context.

However, these methods using attention lack considera-
tion from the following two aspects. First, attending to the
image is only half of the story; watching what you just said
comprises the other half. In other words, visual evidence
can be inferred and interpreted by textual context, espe-

1

cially when the visual evidence is ambiguous. For example,
in the sentence “After dinner, John is comfortably lying on
the sofa and watching TV”, the objects “sofa” and “TV” are
naturally inferred even with weak visual evidences (see Fig-
ure 1, image credits: http://www.mirror.co.uk/
and http://newyork.cbslocal.com/). Despite its
importance, textual context was not a topic of focus in
attention models. Existing attention based methods such
as [36, 33, 34] have used implicit text-guiding from an
LSTM hidden layer to determine which of the image re-
gions or attributes to attend on. However, as we mentioned
in the previous example, the object for attention might be
only partially observable, so the attention input could be
misleading. This is not the case for our attention model
since the textual features are tightly coupled with the image
features to compensate for one another. While Jia et al. [15]
use joint embedding of the text and image as the guidance
for the LSTM, their approach has pre-speciﬁed guidance
that is ﬁxed over time and has a linear form. In contrast,
our method systematically incorporates the time-dependent
text-conditional attention, from 1-gram to n-gram and even
to the sentence level.

Second, existing attention based methods separate CNN
feature learning (trained for a different task, i.e. image clas-
siﬁcation) from the LSTM text generation. This leads to
a representational disconnect between features learned and
text generated. For instance, the attention model proposed
by You et al. [36] uses weighted-sum visual attributes to
guide the image captioning, while the attributes proposed
by the speciﬁc predictor are separated from the language
model. This makes the attributes guidance lack the ability
to adapt to the textual context, which ultimately compro-
mises the end-to-end learning ability the paper claimed.

To overcome the above limitations, we propose a
new text-conditional attention model based on the time-
dependent gLSTM. Our model has the ability to interpret
image features based on textual context and it is end-to-
end trainable. The model learns a text-conditional embed-
ding matrix between CNN image features and previously
generated text. Given a target image, the proposed model
generates LSTM guidance by directly conditioning the im-
age features on the current textual context. The model
hence learns how to interpret image features given the tex-
tual content it has recently generated. If it conditions the
image features on one previous word, it is a 1-gram word-
conditional model. If it is on previous two words, we get a
2-gram word-conditional model. Similarly we can construct
an n-gram word-conditional model. The extreme version
of our text-conditional model is the sentence-conditional
model, which takes advantage of all the previously gener-
ated words.

We implement our model 1 based on NeuralTalk2, an

1https://github.com/LuoweiZhou/e2e-gLSTM-sc

open-source implementation of Google NIC [31]. We com-
pare our methods with state-of-the-art methods on the com-
monly used MS-COCO dataset [23] with publicly available
splits [17] of training, validation and testing sets. We eval-
uate methods on standard metrics as well as human evalu-
ation. Our proposed methods outperform the state-of-the-
art approaches across different evaluation metrics and yield
reasonable attention outputs.

The main contributions of our paper are as follows. First,
we propose text-conditional attention which allows the lan-
guage model to learn text-speciﬁed semantic guidance au-
tomatically. The proposed attention model learns how to fo-
cus on parts of the image feature given the textual content it
has generated. Second, the proposed method demonstrates
a less complicated way to achieve end-to-end training of
attention-based captioning model, whereas state-of-the-art
methods [15, 34, 36] involve LSTM hidden states or image
attributes for attention, which compromises the possibility
of end-to-end optimization.

2. Related Work

Recent successes of deep neural networks in machine
translation [29, 3] catalyze the adoption of neural networks
in solving image captioning problems. Early works of
neural network-based image captioning include the multi-
modal RNN [18] and LSTM [31]. In these methods, neu-
ral networks are used for both image-text embedding and
sentence generating. Various methods have shown to im-
prove performance with region-level information [8, 16],
external knowledge [1], and even from question-answering
[24]. Our method differs from them by considering atten-
tion from textual context in caption generating.

Attention mechanism has recently attracted considerable
interest in LSTM-based image captioning [34, 15, 36, 33].
Xu et al. [34] propose a model that integrates visual at-
tention through the hidden state of LSTM model. You et
al. [36] and Wu et al. [33] tackle the semantic attention
problem by fusing visual attributes extracted from images
with the input or the output of LSTM. Even though these
approaches achieve state-of-the-art performance, the perfor-
mances rely heavily upon the quality of the pre-speciﬁed
visual attributes, i.e., better attributes usually lead to bet-
ter results. Our method also uses attention mechanism, but
we consider the explicit time-dependent text attention and
is comprised a clean architecture for the ease of end-to-end
learning.

in image

Early works

captioning focus on ei-
ther template-based methods or transfer-based methods.
Template-based methods [20, 22, 35, 26, 7, 12] specify tem-
plates and ﬁll them with detected visual evidences from tar-
get images. In Kulkarni et al. [20], visual detections are
ﬁrst put into a graphical model with higher order poten-
tials from text corpora to reduce noise, then converted to

language descriptions based on pre-speciﬁed templates. In
Yang et al.
[35], a quadruplet consisting of noun, verb,
scene and preposition is used to describe an image. The
drawback of these methods is that the descriptions are not
vivid and human-crafted templates do not work for all im-
ages. Transfer-based methods [9, 21, 4] rely on image re-
trieval to assign the target image with descriptions of similar
images in the training set. A common issue is that they are
less robustness to unseen images.

2.1. Background

The generated sentences by the LSTM model may lose
track of the original image content since it only accesses
the image content once at the beginning of the learning pro-
cess, and forgets the image after even a short period of time.
Therefore, Jia et al. [15] propose an extension of the LSTM
model, named the guiding LSTM (gLSTM), which extracts
semantic information from the target image and feeds it into
the LSTM model every time step as extra information. The
basic gLSTM unit is shown in Fig. 2. Its memory cell and
gates are deﬁned as follows:

it = σ(Wixxt + Wimmt−1 + Wiqg)
ft = σ(Wf xxt + Wf mmt−1 + Wf qg)
ot = σ(Woxxt + Wommt−1 + Woqg)
ct = ft (cid:12) ct−1 + it (cid:12) h(Wcxxt + Wcmmt−1 + Wcqg)
mt = ot (cid:12) ct ,

(1)

where W s denote weights, (cid:12) represents element-wise mul-
tiplication, σ(·) is the sigmoid function, h(·) is the hyper-
bolic tangent function, xt stands for input, it for the input
gate, ft for the forget gate, ot for the output gate, ct for state
of the memory cell, mt for the hidden state (also output for
one-layer LSTM), and g represents guidance information,
which is time-invariant. The subscripts denote time: t is the
current time step and t − 1 is the previous time step.

3. Methods

Our text-conditional attention model is based on a time-
dependent gLSTM (td-gLSTM). We ﬁrst describe the td-
gLSTM in Sec. 3.1 and show how to obtain semantic guid-
ance through this structure. Then, we introduce our text-
conditional attention model and its variants, e.g. n-gram
word- and sentence-conditional models, in Sec. 3.2.

3.1. Time-Dependent gLSTM (td-gLSTM)

The gLSTM described in Sec. 2.1 has a time-invariant
guidance. In Jia et al. [15], they show three ways of using
such guidance, including an embedding of the joint image-
text feature by linear CCA. However, the textual context
in a sentence is constantly changing while the caption gen-
erator is generating the sentence. Obviously, we need the

Figure 2: Shown in black is the gLSTM node [15]. The red
subscript of gt represents our td-gLSTM guidance. Figure
modiﬁed from [11]. Best viewed in color.

guidance to evolve over time, and hence we propose td-
gLSTM. Notice that, despite its simple change in structure,
the td-gLSTM is much more ﬂexible in the way it incorpo-
rates guidance, e.g. a time-series dynamic guidance such
as tracking and actions in a video. Also, notice that the
gLSTM is a sepcial case of the td-gLSTM, when the guid-
ance is set as gt = gt−1.

Our proposed td-gLSTM consists of three parts: 1) im-
age embedding; 2) text embedding; and 3) LSTM language
model. Figure 3 shows an overview for using td-gLSTM
for captioning. First, image feature vector I is extracted us-
ing CNN and each word in the caption is represented by a
one-hot vector St, where t indicates the index of the word
in the sentence. We use the text embedding matrix We to
embed text feature St into a latent space, which is the in-
put xt of the LSTM language model. The text embedding
matrix is initialized from a zero-mean Gaussian distribution
with standard deviation 0.01. On the other hand, the text
feature is jointly embedded with the image feature, denoted
as gt = h(St, I), where gt is the time-dependent guidance.
Here, we do not specify the particular form of gt to make the
framework general, and its choices are discussed in Sec. 3.2.
Both the guidance gt and embedded text features xt =
WeSt are used as the inputs to td-gLSTM, which are shown
in Fig. 2 (including red) and formulated as follows:

it = σ(Wixxt + Wimmt−1 + Wiqgt)
ft = σ(Wf xxt + Wf mmt−1 + Wf qgt)
ot = σ(Woxxt + Wommt−1 + Woqgt)
ct = ft (cid:12) ct−1 + it (cid:12) h(Wcxxt + Wcmmt−1 + Wcqgt)
mt = ot (cid:12) ct .

(2)

We back-propagate error through guidance gt for ﬁne-

Figure 3: Text-conditional semantic attention. The text-conditional attention part are highlighted in bold. St indicates
the one-hot vector representation of the tth word in the sentence. We is word embedding matrix, We is text-conditional
embedding matrix, I is image feature and gt is time-dependent guidance. See text for more details.

tuning the CNN. One signiﬁcant beneﬁt of this is that the
model allows the guidance information to be more similar
to its corresponding text description. Note that the text-
conditional guidance gt keeps changing in each time step,
which is a time-dependent variable. The outputs of the lan-
guage model are the log likelihood of each word from the
target sentence, followed by a Softmax function for normal-
ization. We use the regularized cross-entropy loss function:

L(I, S) = −

log(pk(Sk)) +

||Wconv||2

2 ,

(3)

λ
2

N
(cid:88)

k=1

where I represents the image, S represents the sentence, Sk
denotes the kth word in the sentence, SN is the stop sign,
Wconv denotes all the weights in the convolutional net and λ
controls the importance of the regularization term. Finally,
we back-propagate the loss to LSTM language model, the
text embedding matrix and the image embedding CNN. The
training detail is described in Sec. 4.1.

3.2. Text-Conditional Attention

Recently, You et al. [36] use visual attributes as the se-
mantic attention to guide the image captioning. Their se-
mantic guidance consists of top visual attributes of the in-
put image, and the weight of each attribute is determined
by the current word, which is the previous output of RNN.
However, the attribute predictor adopted in their model
has no learning ability and is separated from the encoder-
decoder language model.
In contrast, following the td-
gLSTM model (see Sec. 3.1), we condition the guidance

information gt on the current word St (the one-hot vector
representation), and use the text-conditional image feature
as the semantic guidance. The beneﬁts are twofold: ﬁrst,
the model can learn which part of the semantic image fea-
ture should be focused on when seeing a speciﬁc word; sec-
ond, this structure is end-to-end tunable such that the CNNs
weights are tuned for captioning rather than for image clas-
siﬁcation [27]. For instance, when the caption generator
generated a sequence as “a woman is washing”, its atten-
tion on the image feature should be automatically switched
to objects that can be washed, such as clothes and dishes.

We ﬁrst consider modeling the text-conditional guidance
feature gt as the weighted-sum of the outer product of image
feature I and text feature St, therefore each entry in gt is
represented as:

gi
t =

WijkI jSk

t + bi ,

(4)

(cid:88)

j,k

where I j denotes the jth entry of the image feature, Sk
t de-
t is the ith entry
notes the kth entry of the text feature, and gi
of the text-conditional guidance feature. For each gi
t, the
corresponding weights Wi is a 2-D tensor, hence, the total
weights W for gt is a 3-D tensor. In this model, image fea-
ture is fully coupled with text feature though the 3-D tensor.
Despite Eq. 4 fully couples the two types of features,
it results in a huge amount of parameters, which prohibits
its use in practice. To overcome it, we introduce an em-
bedding matrix Wc, which contains various text-to-image
masks. Furthermore, in practice, adding one non-linear

transfer function layer after the image-text feature embed-
ding boosts the performance. Therefore, we model the text-
conditional feature gt as a text-based mask on image feature
I followed by a non-linear function:

Table 1: Results of n-gram word- and sentence-conditional
models with Tanh transfer function and 34-layer ResNet.
Top-2 scores for each metric are highlighted. All values are
reported as percentage (%).

gt = Φ(I (cid:12) WcSt) ,

(5)

BLEU@4 METEOR CIDEr

where Wc is the text-conditional embedding matrix and
Φ(·) is a non-linear transfer function. When Wc is a all-
one matrix, the conditioned feature I (cid:12) WcSt is identical to
I. We transfer the pre-trained model from gLSTM to ini-
tialize the CNN, language model and word embedding of
our attention model. For text-conditional matrix, we initial-
ize it with all ones. We show the sensitivity of our model to
various transfer functions in Sec. 4.2.

The above model is the 1-gram word-conditional seman-
tic attention owing to the guidance feature is merely condi-
tioned on the previous word. Similarly, we develop the 2-
gram word-conditional model, which utilizes previous two
words, or even n-gram word-conditional model. The ex-
treme version of the text-conditional model is the sentence-
condition model, which takes advantage of all the previ-
ously generated words:

gt = Φ(I (cid:12) Wc

(6)

t
(cid:88)

k=1

Sk−1
t

) .

One beneﬁt of the text-conditional model is that it allows
the language model to learn semantic attention automati-
cally though the back-propagation of the training loss while
attribute-based method, such as [36], represents semantic
guidance by some major components of an image, but other
semantic information, such as objects’ motions and loca-
tions, are discarded.

4. Experiments

We describe our experiment settings in Sec. 4.1, analyze
the variants of our model and attention in Sec. 4.2, and com-
pare our method with state-of-the-art methods in Sec. 4.3.

4.1. Experiment Setup

We use the MS-COCO dataset [23] with the commonly
adopted splits as described in [17]: 113,287 images for
training, 5,000 images for validation and 5,000 images for
testing. Three standard evaluation metrics, e.g. BLEU,
METEOR and CIDER, are used in addition to human
evaluation. We implement our model based on the Neu-
ralTalk2 [17], which is an open source implementation
of [31]. We use three different CNNs in our experiments,
e.g. 34-layer and 200-layer ResNets [13] and 16-layer VG-
GNet [28]. For a fair comparison, we use 34-layer ResNet
when analyzing the variants of our models in Table 1 and 2,
16-layer VGGNet when comparing to state-of-the-art meth-
ods in Table 5 and 6, and 200-layer ResNet for leadboard

1-gram
2-gram
3-gram
4-gram
sentence

29.5
30.2
29.9
30.3
30.6

24.6
24.8
24.9
24.9
25.0

94.6
97.3
96.1
97.0
98.1

Table 2: Results of different transfer functions on sentence-
conditional model (denoted as sc) with 34-layer ResNet.
Top scores for each metric are highlighted. All values are
reported as percentage (%).

BLEU@4 METEOR CIDEr

sc-relu
sc-tanh
sc-softmax
sc-sigmoid

30.5
30.6
30.2
30.1

25.0
25.0
24.9
24.8

98.1
98.1
97.1
96.2

competition in Table 7. The variation of performance re-
garding different CNNs are also evaluated in Table 3.

We train our model in three steps: 1) train time-invariant
gLSTM (ti-gLSTM) without CNN ﬁne-tuning for 100,000
iterations; 2) train ti-gLSTM with CNN ﬁne-tuning for
150,000 iterations; and 3) train td-gLSTM with initializd
text-conditional matrix but without CNN ﬁne-tuning for
150,000 iterations. The reason for this multiple-step train-
ing is described in Vinyals et al. [32]: jointly training the
system at the initial time causes noise in the initial gradi-
ents coming from LSTM that corrupts the CNN unrecov-
erably. For the hyper-parameters, we set the CNN weight
decay rate (λ in Eq. 3) to 10−3 to avoid overﬁtting. The
learning rate for CNN ﬁne-tuning is set to 10−5 and the
learing rate for language model is set to 4 × 10−4. We use
Adam optimizer [19] for updating weights with α = 0.8
and β = 0.999. We adopt 2 and 3 for beam sizes dur-
ing inference, as recommended by recent studies [32, 6].
The whole training process takes about one day on a single
NVIDIA TITAN X GPU.

4.2. Model Variants & Attention

N-gram v.s. Sentence. Table 1 shows results with n-gram
word- and sentence-conditional models. For conciseness,
we only use BLEU@4, METEOR and CIDEr as the eval-
uation metrics, since they are more correlated with human
judgments compared with low-level BLEU scores [30]. It
turns out generally, word-conditional models with higher
grams yield better results, especially for METEOR. Notice
that the 2, 3, 4-gram models achieve considerablely better

Table 3: The Impact of image encoding CNNs on caption-
ing performance. Tanh is used as transfer function. Top re-
sult for each column is highlighted. All values are reported
as percentage (%).

Methods BLEU@4 METEOR CIDEr
sc-vgg-16
sc-resnet-34
sc-resnet-200

24.7
25.0
25.1

30.1
30.6
31.4

97.0
98.1
97.7

is expected that similar words should have similar masks
(with some variations). To verify, we calculate the similar-
ities among masks using Euclidean distance. We show ﬁve
randomly sampled words w.r.t. different parts of speech
(noun, verb and adjective). Table 4 shows their top few
nearest words. Most of the neighbors are related to the orig-
inal word, and some of them are strongly related, such as
“cat” for “dog”, “blue” for “red”, “sits” for “sitting”, and
“woman” for “man”. This shows strong evidence that our
model is learning meaningful text-conditional attention.

Table 4: Top-6 nearest neighbors for randomly picked
words. The results are based on the text-conditional ma-
trix Wc of 1-gram word-conditional model. We highlight
similar words in semantics.

dog
banana
red
sitting
man

bear three woman cat girl person
it carrots
fruits six onto includes
UNK blue three several man yellow
standing next are sits dog woman
woman person his
three are dog

results than 1-gram model, which is reasonable as the 1-
gram has the least context that limits the attention perfor-
mance. Furthermore, the sentence-conditional model out-
performs all word-conditional models in all metrics, which
shows the importance of long-term word dependency in at-
tention modeling.
Transfer Function. We use a non-linear transfer function
Φ(·) in our attention model (see Eq. 5) and we test four dif-
In
ferent functions: Softmax, ReLU, Tanh and Sigmoid.
all cases, we initialize the text-conditional embedding ma-
trix with noises from one-mean Gaussian distribution with
standard deviation 0.001. We base our experiments on the
sentence-conditional model and conclude that the model
achieves best performance when Φ(·) is a Tanh or a ReLU
function (see Table 2). Notice that it is possible that other
transfer functions different than the four we tested may lead
to better results.
Image Encoding. We study the impact of image encoding
CNNs on captioning performance, as shown in Table 3. In
general, the more sophisticated image encoding architecture
the higher performance of the captioning.

4.2.1 Attention

It is essential to verify whether our learned text-conditional
attention is semantically meaningful. Each column in the
text-conditional matrix Wc is an attention mask for image
features, and it corresponds to a word in our dictionary. It

4.3. Compare to State-of-The-Art Methods

We use LSTM with time-invariant image guidance (img-
gLSTM) [15] and NeuralTalk2 [17], an implementation
of [31], as baselines. We also compare to a state-of-the-
art non-attention-based model—LSTM with semantic em-
bedding guidance (emb-gLSTM) [15]. Furthermore, we
compare our method to a set of state-of-the-art attention-
based methods including visual attention with soft- and
hard-attention [34], and semantic attention with visual at-
tributes (ATT-FCN) [36]. For fair comparison among dif-
ferent attention models, we report our results with 16-layer
VGGNet [28] since it is similar to the image encodings used
in other methods.

Table 5 shows the comparison results. Our methods,
both 1-gram word-conditional and sentence-conditional,
outperform our two baselines in all metrics by a large mar-
gin, ranging from 1% to 5%. The results are strong evidence
that 1) our td-gLSTM is better suited for captioning compar-
ing to time-invariant gLSTM; and 2) modeling textual con-
text is essential for image captioning. Also, our methods
yield much higher evaluation scores than emb-gLSTM [15]
showing the effectiveness of using textual content in our
model.

We further compare our text-conditional methods with
state-of-the-art attention-based methods. For 1-gram word-
conditional method, the attention on the image feature guid-
ance is merely determined by the previously generated
word. Apparently, this results in semantic information loss.
Even though, its performances are still on par with or bet-
ter than state-of-the-art attention-based methods, such as
Hard-Attention and ATT-FCN. We then upgrade the word-
conditional model to the sentence-conditional model, which
leads to improved performance in all metrics, and it out-
performs state-of-the-art methods in most metrics. It worth
noting that BLEU@1 score is related to single word accu-
racy, and highly affected by word vocabularies. This might
result in our relatively low BLEU@1 score compared with
hard-attention [34].

Table 5: Comparison to baselines and state-of-the-art methods. For some competing methods, we extract their performance
from the corresponding papers. For a fair comparison, we use 16-layer VGGNet for image encoding. Top-two scores for
each metric are highlighted. All values are reported as percentage (%).

img-gLSTM [15]
emb-gLSTM [15]
NeuralTalk2 [17]
Hard-Attention [34]
Soft-Attention [34]
ATT-FCN [36]
Our 1-gram-vgg-16
Our sc-vgg-16

Methods BLEU@1 BLEU@2 BLEU@3 BLEU@4 METEOR CIDEr
31.1
35.8
39.2
35.7
34.4
40.2
40.0
40.5

67.7
81.3
92.3
-
-
-
95.5
97.0

20.4
22.7
24.3
23.0
23.9
24.3
24.5
24.7

21.4
26.4
28.9
25.0
24.3
30.4
29.6
30.1

45.9
49.1
53.2
50.4
49.2
53.7
54.2
54.5

64.7
67.0
70.5
71.8
70.7
70.9
71.5
71.6

Table 6: Results of human evaluation. The higher the better
for both the content quality and the grammar scores. The
highest score for each column is highlighted.

4.3.2 Qualitative Results

Methods Content Grammar
1.56
1.94
2.00

img-gLSTM [15]
NeuralTalk2 [17]
Our sc-vgg-16

2.75
2.77
2.80

4.3.1 Human Evaluation

We choose three methods for human evaluation, Neu-
ralTalk2, img-gLSTM and our sentence-conditional atten-
tion model. A cohort of ﬁve well-trained human anno-
tators is performed the experiments. Each of the annota-
tors were shown 500 pairs of randomly selected images and
three corresponding generated captions. The annotators rate
the three captions from 0 to 3 regarding the content quality
and grammar (the higher the better). For content quality,
a score of 3 is given if the caption describes all the impor-
tant content, e.g. objects and actions, in the image; a score
of 0 is given if the caption is totally wrong or irrelevant.
For grammar, a score of 3 denotes human-level natural ex-
pression and a score of 0 means the caption is unreadable.
The results are shown in Table 6. Our proposed sentence-
conditional model lead the baseline img-gLSTM by a large
margin of 28.2% in the caption content quality, and 3.1%
compared to the baseline Neuraltalk2, showing the effec-
tiveness of our attention mechanism in captioning. As for
grammar, all the methods create human-like sentences with
a few grammar mistakes, and adding sentence-conditional
attention to LSTM yields a slightly higher grammar score,
due to the explicitly textual information contained in the
LSTM guidance input.

Figure 4 shows qualitative captioning results. The ﬁx im-
ages in the ﬁrst three rows are positive examples and the
last two are failed cases. Our proposed model can better
capture details in the target image, such as “yellow ﬁre hy-
drant” in the second image, and “soccer” in the ﬁfth im-
age. Also, the text-conditional attention discovers rich con-
text information in the image, such as the “preparing food”
followed by “kitchen” in the ﬁrst image, and the ‘in their
hand‘” followed by “holding” in the sixth image. However,
we also show the failed cases, where the objects are mistak-
enly inferred from the previous words. For the ﬁrst image,
when we feed in the word sequence “a man (is) sitting”, our
text-conditional attention is triggered by things can be sat
by a man; a sofa is a reasonable candidate according to the
training data. Similarly, for the second image, the model
is trained on some images with stuffed animal held by a
person, which in some sense biases the semantic attention
model.

4.3.3 Leaderboard Competition

We test our model on the MS-COCO leaderboard compe-
tition and summarize the results in Table 7. Our method
outperforms the baseline (NeuralTalk2 [17]) across all the
metrics and is on par with state-of-the-art methods. It worth
noting that our baseline is an open source implementation
of [31], shown as OriolVinyals in Tab. 7, but the latter
performs much better due to better CNNs, inference meth-
ods, and more careful engineering. Also, several methods
unreasonably outperform human-annotated captions, which
reveals the drawback of the existing evaluation metrics.

5. Conclusion

In this paper, we propose a semantic attention
mechanism for image caption generation, called text-

Table 7: Evaluation on MS-COCO leaderboard. We list state-of-the-art published results. We highlight our method and our
baseline method, NeuralTalk2. Notice that methods highly-ranked in learderboard use better CNNs, inference methods, and
more careful engineering than research publishes.

Methods
ATT VC [36]
OriolVinyals [32]
jeffdonahue [6]
SC-Tanh (ours)
Q.Wu [33]
Human
NeuralTalk2 [17]

BLEU-1

BLEU-2

BLEU-3

BLEU-4

c5
0.731
0.713
0.718
0.717
0.725
0.663
0.706

c40
0.900
0.895
0.895
0.887
0.892
0.880
0.877

c5
0.565
0.542
0.548
0.546
0.556
0.469
0.530

c40
0.815
0.802
0.804
0.794
0.803
0.744
0.776

c5
0.424
0.407
0.409
0.405
0.414
0.321
0.388

c40
0.709
0.694
0.695
0.682
0.694
0.603
0.657

c5
0.316
0.309
0.306
0.300
0.306
0.217
0.284

c40
0.599
0.587
0.585
0.569
0.582
0.471
0.541

METEOR
c5
0.250
0.254
0.247
0.248
0.246
0.252
0.238

c40
0.335
0.346
0.335
0.330
0.329
0.335
0.317

ROUGE-L
c40
c5
0.682
0.535
0.682
0.530
0.678
0.528
0.667
0.515
0.672
0.528
0.626
0.484
0.654
0.515

CIDEr-D
c5
0.943
0.943
0.921
0.923
0.911
0.854
0.858

c40
0.958
0.946
0.934
0.929
0.924
0.910
0.865

Figure 4: Qualitative results. We show both positive examples and failed cases of our method. NT2 indicates NeuralTalk2
and sc-tanh is our sentence-conditional model. Better viewed in color.

conditional semantic attention, which provides explicitly
text-conditioned image features for attention. We also im-
prove the existing gLSTM framework by introducing time-
dependent guidance, opening up a new way for further
boosting image captioning performance. We show in our
experiments that the proposed methods signiﬁcantly im-
prove the baseline method and outperform state-of-the-art
methods, which supports our argument of explicit consider-
ation of using text-conditional attention modeling.

Future Work. There are several ways in which we can fur-
ther improve our method. First, combining text-conditional

attention with region-based or attribute-based attention, so
that the model can learn to attend on regions in feature
maps or attributes extracted from the image. Second, one
common issue with supervised training is overﬁtting. As
Vinyals et al. [31] pointed out, we cannot access enough
training samples, even for the relatively huge dataset such
as MS-COCO. One possible solution is to combine weakly
annotated images with current dataset, such as [10]. We
keep those for our future work.

References

[1] L. Anne Hendricks, S. Venugopalan, M. Rohrbach,
R. Mooney, K. Saenko, and T. Darrell. Deep composi-
tional captioning: Describing novel object categories with-
out paired training data. In IEEE Conference on Computer
Vision and Pattern Recognition, 2016.

[2] D. Bahdanau, K. Cho, and Y. Bengio. Neural machine trans-
lation by jointly learning to align and translate. In Interna-
tional Conference on Learning Representations, 2015.
[3] K. Cho, B. Van Merri¨enboer, C. Gulcehre, D. Bahdanau,
F. Bougares, H. Schwenk, and Y. Bengio. Learning phrase
representations using rnn encoder-decoder for statistical ma-
In Empirical Methods in Natural Lan-
chine translation.
guage Processing, 2014.

[4] P. Das, R. K. Srihari, and J. J. Corso. Translating related
words to videos and back through latent topics. In WSDM,
2013.

[5] R. Desimone and J. Duncan. Neural mechanisms of selective
visual attention. Annual Review of Neuroscience, 18(1):193–
222, 1995.

[6] J. Donahue, L. Anne Hendricks,

S. Guadarrama,
M. Rohrbach, S. Venugopalan, K. Saenko, and T. Dar-
Long-term recurrent convolutional networks for
rell.
visual recognition and description. In IEEE Conference on
Computer Vision and Pattern Recognition, 2015.

[7] D. Elliott and F. Keller. Image description using visual de-
pendency representations. In Empirical Methods in Natural
Language Processing, 2013.

[8] H. Fang, S. Gupta, F. Iandola, R. K. Srivastava, L. Deng,
P. Doll´ar, J. Gao, X. He, M. Mitchell, J. C. Platt, et al. From
captions to visual concepts and back. In IEEE Conference
on Computer Vision and Pattern Recognition, 2015.

[9] A. Farhadi, M. Hejrati, M. Sadeghi, P. Young, C. Rashtchian,
J. Hockenmaier, and D. Forsyth. Every picture tells a story:
Generating sentences from images. In European Conference
on Computer Vision, 2010.

[10] Y. Gong, L. Wang, M. Hodosh, J. Hockenmaier, and
S. Lazebnik. Improving image-sentence embeddings using
large weakly annotated photo collections. In European Con-
ference on Computer Vision, 2014.

[11] A. Graves. Supervised sequence labelling with recurrent

neural networks. 2012.

[12] S. Guadarrama, N. Krishnamoorthy, G. Malkarnenkar,
S. Venugopalan, R. Mooney, T. Darrell, and K. Saenko.
Youtube2text: Recognizing and describing arbitrary activi-
ties using semantic hierarchies and zero-shot recognition. In
IEEE International Conference on Computer Vision, 2013.

[13] K. He, X. Zhang, S. Ren, and J. Sun. Deep residual learning
In IEEE Conference on Computer

for image recognition.
Vision and Pattern Recognition, 2016.

[14] S. Hochreiter and J. Schmidhuber. Long short-term memory.

Neural Computation, 9(8):1735–1780, 1997.

[15] X. Jia, E. Gavves, B. Fernando, and T. Tuytelaars. Guiding
the long-short term memory model for image caption genera-
tion. In IEEE International Conference on Computer Vision,
2015.

[16] J. Johnson, A. Karpathy, and L. Fei-Fei. Densecap: Fully
convolutional localization networks for dense captioning. In
IEEE Conference on Computer Vision and Pattern Recogni-
tion, 2016.

[17] A. Karpathy.

neuraltalk2.

https://github.com/

karpathy/neuraltalk2, 2015.

[18] A. Karpathy and L. Fei-Fei. Deep visual-semantic align-
ments for generating image descriptions. In IEEE Confer-
ence on Computer Vision and Pattern Recognition, 2015.
[19] D. Kingma and J. Ba. Adam: A method for stochastic opti-

mization. arXiv preprint arXiv:1412.6980, 2014.

[20] G. Kulkarni, V. Premraj, V. Ordonez, S. Dhar, S. Li, Y. Choi,
A. C. Berg, and T. L. Berg. Babytalk: Understanding and
IEEE Transactions
generating simple image descriptions.
on Pattern Analysis and Machine Intelligence, 35(12):2891–
2903, 2013.

[21] P. Kuznetsova, V. Ordonez, A. C. Berg, T. L. Berg, and
Y. Choi. Collective generation of natural image descriptions.
In Association for Computational Linguistics, 2012.

[22] S. Li, G. Kulkarni, T. L. Berg, A. C. Berg, and Y. Choi. Com-
posing simple image descriptions using web-scale n-grams.
In Computational Natural Language Learning, 2011.
[23] T.-Y. Lin, M. Maire, S. Belongie, J. Hays, P. Perona, D. Ra-
manan, P. Doll´ar, and C. L. Zitnick. Microsoft coco: Com-
mon objects in context. In European Conference on Com-
puter Vision, 2014.

[24] X. Lin and D. Parikh. Leveraging visual question answer-
ing for image-caption ranking. In European Conference on
Computer Vision, 2016.

[25] J. Mao, W. Xu, Y. Yang, J. Wang, Z. Huang, and A. Yuille.
Deep captioning with multimodal recurrent neural networks
(m-rnn). In International Conference on Learning Represen-
tations, 2015.

[26] M. Mitchell, X. Han, J. Dodge, A. Mensch, A. Goyal,
A. Berg, K. Yamaguchi, T. Berg, K. Stratos,
and
H. Daum´e III. Midge: Generating image descriptions from
computer vision detections. In EACL. Citeseer, 2012.
[27] O. Russakovsky, J. Deng, H. Su, J. Krause, S. Satheesh,
S. Ma, Z. Huang, A. Karpathy, A. Khosla, M. Bernstein,
et al.
Imagenet large scale visual recognition challenge.
International Journal of Computer Vision, 115(3):211–252,
2015.

[28] K. Simonyan and A. Zisserman. Very deep convolutional
networks for large-scale image recognition. In International
Conference on Learning Representations, 2015.

[29] I. Sutskever, O. Vinyals, and Q. V. Le. Sequence to sequence
learning with neural networks. In Advances in Neural Infor-
mation Processing Systems, 2014.

[30] R. Vedantam, C. Lawrence Zitnick, and D. Parikh. Cider:
Consensus-based image description evaluation. In Proceed-
ings of the IEEE Conference on Computer Vision and Pattern
Recognition, pages 4566–4575, 2015.

[31] O. Vinyals, A. Toshev, S. Bengio, and D. Erhan. Show and
tell: A neural image caption generator. In IEEE Conference
on Computer Vision and Pattern Recognition, 2015.

[32] O. Vinyals, A. Toshev, S. Bengio, and D. Erhan. Show and
tell: Lessons learned from the 2015 mscoco image caption-

ing challenge. IEEE Transactions on Pattern Analysis and
Machine Intelligence, 2016.

[33] Q. Wu, C. Shen, L. Liu, A. Dick, and A. v. d. Hengel. What
value do explicit high level concepts have in vision to lan-
guage problems? In IEEE Conference on Computer Vision
and Pattern Recognition, 2016.

[34] K. Xu, J. Ba, R. Kiros, K. Cho, A. Courville, R. Salakhut-
dinov, R. S. Zemel, and Y. Bengio. Show, attend and tell:
Neural image caption generation with visual attention.
In
International Conference on Machine Learning, 2015.
[35] Y. Yang, C. L. Teo, H. Daum´e III, and Y. Aloimonos.
Corpus-guided sentence generation of natural images.
In
Proceedings of the Conference on Empirical Methods in Nat-
ural Language Processing, pages 444–454. Association for
Computational Linguistics, 2011.

[36] Q. You, H. Jin, Z. Wang, C. Fang, and J. Luo. Image caption-
ing with semantic attention. In IEEE Conference on Com-
puter Vision and Pattern Recognition, 2016.

