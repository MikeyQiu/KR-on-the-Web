6
1
0
2
 
n
u
J
 
6
2
 
 
]

V
C
.
s
c
[
 
 
2
v
4
0
9
5
0
.
1
1
5
1
:
v
i
X
r
a

Dense Human Body Correspondences Using Convolutional Networks

Lingyu Wei
University of Southern California
lingyu.wei@usc.edu

Qixing Huang
Toyota Technological Institute at Chicago
huangqx@ttic.edu

Duygu Ceylan
Adobe Research
ceylan@adobe.com

Etienne Vouga
University of Texas at Austin
evouga@cs.utexas.edu

Hao Li
University of Southern California
hao@hao-li.com

Figure 1: We introduce a deep learning framework for computing dense correspondences between human shapes in arbitrary,
complex poses, and wearing varying clothing. Our approach can handle full 3D models as well as partial scans generated
from a single depth map. The source and target shapes do not need to be the same subject, as highlighted in the left pair.

Abstract

1. Introduction

We propose a deep learning approach for ﬁnding dense
correspondences between 3D scans of people. Our method
requires only partial geometric information in the form of
two depth maps or partial reconstructed surfaces, works for
humans in arbitrary poses and wearing any clothing, does
not require the two people to be scanned from similar view-
points, and runs in real time. We use a deep convolutional
neural network to train a feature descriptor on depth map
pixels, but crucially, rather than training the network to
solve the shape correspondence problem directly, we train
it to solve a body region classiﬁcation problem, modiﬁed to
increase the smoothness of the learned descriptors near re-
gion boundaries. This approach ensures that nearby points
on the human body are nearby in feature space, and vice
versa, rendering the feature descriptor suitable for comput-
ing dense correspondences between the scans. We validate
our method on real and synthetic data for both clothed and
unclothed humans, and show that our correspondences are
more robust than is possible with state-of-the-art unsuper-
vised methods, and more accurate than those found using
methods that require full watertight 3D geometry.

The computation of correspondences between geomet-
ric shapes is a fundamental building block for many impor-
tant tasks in 3D computer vision, such as reconstruction,
tracking, analysis, and recognition. Temporally-coherent
sequences of partial scans of an object can be aligned
by ﬁrst ﬁnding corresponding points in overlapping re-
gions, then recovering the motion by tracking surface points
through a sequence of 3D data; semantics can be extracted
by ﬁtting a 3D template model to an unstructured input
scan. With the popularization of commodity 3D scanners
and recent advances in correspondence algorithms for de-
formable shapes, human bodies can now be easily digi-
tized [25, 30, 11] and their performances captured using a
single RGB-D sensor [23, 48].

Most techniques are based on robust non-rigid surface
registration methods that can handle complex skin and cloth
deformations, as well as large regions of missing data due to
occlusions. Because geometric features can be ambiguous
and difﬁcult to identify and match, the success of these tech-
niques generally relies on the deformation between source
and target shapes being reasonably small, with sufﬁcient
overlap. While local shape descriptors [37] can be used
to determine correspondences between surfaces that are far

1

apart, they are typically sparse and prone to false matches,
which require manual clean-up. Dense correspondences be-
tween shapes with larger deformations can be obtained reli-
ably using statistical models of human shapes [4, 7], but the
subject has to be naked [6]. For clothed bodies, the auto-
matic computation of dense mappings [20, 26, 35, 10] have
been demonstrated on full surfaces with signiﬁcant shape
variations, but are limited to compatible or zero-genus sur-
face topologies. Consequently, an automated method for
estimating accurate dense correspondence between partial
shapes, such as scans from a single RGB-D camera and ar-
bitrarily large deformations has not yet been proposed.

We introduce a deep neural network structure for com-
puting dense correspondences between shapes of clothed
subjects in arbitrary complex poses. The input surfaces can
be a full model, a partial scan, or a depth map, maximizing
the range of possible applications (see Figure 1). Our sys-
tem is trained with a large dataset of depth maps generated
from the human bodies of the SCAPE database [4], as well
as from clothed subjects of the Yobi3D [2] and MIT [50]
dataset. While all meshes in the SCAPE database are in full
correspondence, we manually labeled the clothed 3D body
models. We combined both training datasets and learned
a global feature descriptor using a network structure that
is well-suited for the uniﬁed treatment of different training
data (bodies, clothed subjects).

Similar

to the uniﬁed embedding approach of
FaceNet [42], we extend the AlexNet [21] classiﬁca-
tion network to learn distinctive feature vectors for
different subregions of the human body. Traditional classi-
ﬁcation neural networks tend to separate the embedding of
surface points lying in different but nearby classes. Thus,
using such learned feature descriptors for correspondence
matching between deformed surfaces often results in
In
signiﬁcant outliers at the segmentation boundaries.
this paper, we introduce a technique based on repeated
mesh segmentations to produce smoother embeddings into
feature space. This technique maps shape points that are
geodesically close on the surface of their corresponding 3D
model to nearby points in the feature space. As a result, not
only are outliers considerably reduced during deformable
shape matching, but we also show that the amount of
training data can be drastically reduced compared to
conventional learning methods. While the performance of
our dense correspondence computation is comparable to
state of the art techniques between two full models, we also
demonstrate that learning shape priors of clothed subjects
can yield highly accurate matches between partial-to-full
and partial-to-partial shapes. Our examples include fully
clothed individuals in a variety of complex poses.We also
demonstrate the effectiveness of our method on a template
based performance capture application that uses a single
RGB-D camera as input. Our contributions are as follows:

• Ours is the ﬁrst approach that ﬁnds accurate and dense

correspondences between clothed human body shapes
with partial input data and is considerably more efﬁ-
cient than traditional non-rigid registration techniques.

• We develop a new deep convolutional neural network
architecture that learns a smooth embedding using a
multi-segmentation technique on human shape priors.
We also show that this approach can signiﬁcantly re-
duce the amount of training data.

• We describe a uniﬁed learning framework that com-
bines training data sets from human body shapes in
different poses and a database of clothed subjects in
a canonical pose.

2. Related Work

Finding shape correspondences is a well-studied area
of geometry processing. However, the variation in human
clothing, pose, and topological changes induced by differ-
ent poses make applying existing methods very difﬁcult.

The main computational challenge is that the space of
possible correspondences between two surfaces is very
large: discretizing both surfaces using n points and attempt-
ing to naively match them is an O(n!) calculation. The
problem becomes tractable given enough prior knowledge
about the space of possible deformations; for instance if
the two surfaces are nearly-isometric, both surfaces can be
embedded in a higher-dimensional Euclidean space where
they can be aligned rigidly [12]. Other techniques can be
used if the mapping satisﬁes speciﬁc properties, e.g. be-
ing conformal [26, 19]. Kim et al [20] generalize this idea
by searching over a carefully-chosen polynomial space of
blended conformal maps, but this method does not extend
to matching partial surfaces or to surfaces of nonzero genus.
Another common approach is to formulate the corre-
spondence problem variationally: to deﬁne an energy func-
tion on the space of correspondences that measures their
quality, which is then maximized. One popular objective
is to measure preservation of pair-wise geodesic [9] or dif-
fusion [8] distances. Such global formulations often lead
to NP-hard combinatorial optimization problems for which
various relaxation schemes are used, including spectral re-
laxation [22], Markov random ﬁelds [3], and convex relax-
ation [53, 10]. These methods require that the two surfaces
are nearly-isometric, so that these distances are nearly-
preserved; this assumption is invalid for human motion in-
volving topological changes.

A second popular objective is to match selected subsets
of points on the two surfaces with similar feature descrip-
tors [38, 54, 27, 5]. However, ﬁnding descriptors that are
both invariant to typical human and clothing deformations
and also robust to topological changes remains a challenge.
Local geometric descriptors, such as spin images [18] or
curvature [34] have proven to be insufﬁcient for establish-
ing reliable correspondences as they are extrinsic and frag-

2

ile under deformations. A recent focus is on spectral shape
embedding and induced descriptors [17, 45, 31, 5, 29].
These descriptors are effective on shapes that undergo near-
isometric deformations. However, due to the sensitivity of
spectral operators to partial data and topological noise, they
are not applicable to partial 3D scans.

A natural idea is to replace ad-hoc geometric descrip-
tors with those learned from data.
Several recent pa-
pers [28, 15, 55, 14] have successfully used this idea for
ﬁnding correspondences between 2D images, and have
shown that descriptors learned from deep neural networks
are signiﬁcantly better than generic pixel-wise descriptors
in this context. Inspired by these methods, we propose to
use deep neural networks to compute correspondence be-
tween full/partial scans of clothed humans. In this manner,
our work is similar to Fischer et al [13], which applies deep
learning to the problem of solving for the optical ﬂows be-
tween images; unlike Fischer, however, our method ﬁnds
correspondences between two human shapes even if there
is little or no coherence between the two shapes. Regres-
sion forests [47, 33] can also be used to infer geometric lo-
cations from depth image, however such methods has not
yet achieve comparable accuracies with state-of-the-art reg-
istration method on full or partial data [10].

3. Problem Statement and Overview

We introduce a deep learning framework to compute
dense correspondences across full or partial human shapes.
We train our system using depth maps of humans in arbi-
trary pose and with varying clothing.

Given depth maps of two humans I1, I2, our goal is to
determine which two regions Ri ⊂ Ii of the depth maps
come from corresponding parts of the body, and to ﬁnd the
correspondence map φ : R1 → R2 between them. Our
strategy for doing so is to formulate the correspondence
problem ﬁrst as a classiﬁcation problem: we ﬁrst learn a
: I → Rd which maps each pixel
feature descriptor f
in a single depth image to a feature vector. We then uti-
lize these feature descriptors to establish correspondences
across depth maps (see Figure 2). We desire the feature
vector to satisfy two properties:

1. f depends only on the pixel’s location on the human
body, so that if two pixels are sampled from the same
anatomical location on depth scans of two different hu-
mans, their feature vector should be nearly identical,
irrespective of pose, clothing, body shape, and angle
from which the depth image was captured;

2. (cid:107)f (p) − f (q)(cid:107) is small when p and q represent nearby
points on the human body, and large for distant points.

The literature takes two different approaches to enforcing
these properties when learning descriptors using convolu-
tional neural networks. Direct methods include in their loss

functions terms penalizing failure of these properties (by us-
ing e.g. Siamese or triplet-loss energies). However, it is not
trivial how to sample a dense set of training pairs or triplets
Indirect methods
that can all contribute to training [42].
instead optimize the network architecture to perform clas-
siﬁcation. The network consists of a descriptor extraction
tower and a classiﬁcation layer, and peeling off the classiﬁ-
cation layer after training leaves the learned descriptor net-
work (for example, many applications use descriptors ex-
tracted from the second-to-last layer of the AlexNet.) This
approach works since classiﬁcation networks tend to assign
similar (dissimilar) descriptors to the input points belong-
ing to the same (different) class, and thus satisfy the above
properties implicitly. We take the indirect approach, as our
experiments suggest that an indirect method that uses an
ensemble of classiﬁcation tasks has better performance and
computational efﬁciency.

3.1. Descriptor learning as ensemble classiﬁcation

There are two challenges to learning a feature descrip-
tor for depth images of human models using this indirect
approach. First, the training data is heterogenous: between
different human models, it is only possible to obtain a sparse
set of key point correspondences, while for different poses
of the same person, we may have dense pixel-wise corre-
spondences (e.g., SCAPE [4]). Second, smoothness of de-
scriptors learned through classiﬁcation is not explicitly en-
forced. Even though some classes tend to be closer to each
other than the others in reality, the network treats all classes
equally.

To address both challenges, we learn per-pixel descrip-
tors for depth images by ﬁrst training a network to solve a
group of classiﬁcation problems, using a single feature ex-
traction tower shared by the different classiﬁcation tasks.
This strategy allows us to combine different types of train-
ing data as well as designing classiﬁcation tasks for vari-
ous objectives. Formally, suppose there are M classiﬁca-
tion problems Ci, 1 ≤ i ≤ M . Denote the parameters to be
learned in classiﬁcation problem Ci as (wi, w), where wi
and w are the parameters corresponding to the classiﬁca-
tion layer and descriptor extraction tower, respectively. We
deﬁne the descriptor learning as minimizing a combination
of loss functions of all classiﬁcation problems:

{w(cid:63)

i }, w(cid:63) = arg min
{wi},w

M
(cid:88)

i=1

l(wi, w).

(1)

After training, we take the optimized descriptor extraction
It is easy to see that when wi, w
tower as the output.
are given by convolutional neural networks, Eqn. 1 can
be effectively optimized using stochastic gradient descent
through back-propagation.

To address the challenge of heterogenous training sets,
we include two types of classiﬁcation tasks in our ensemble:
one for classifying key points, used for iter-subject training

3

Figure 2: We train a neural network which extracts a feature descriptor and predicts the corresponding segmentation label on
the human body surface for each point in the input depth maps. We generate per-vertex descriptors for 3D models by averag-
ing the feature descriptors in their rendered depth maps. We use the extracted features to compute dense correspondences.

per-pixel descriptors of the depth maps. We use these de-
scriptors to establish correspondences simply by a nearest
neighbor search in the feature space (see Figure 2).

For applications that require deforming one surface to
align with the other, we can ﬁt the correspondences de-
scribed in this paper into any existing deformation method
to generate the alignment. In this paper, we use the efﬁcient
as-rigid-as possible deformation model described in [23].

4. Implementation Details

We ﬁrst discuss how we generate the training data and

then describe the architecture of our network.

4.1. Training Data Generation

Collecting 3D Shapes. To generate the training data for
our network, we collected 3D models from three major re-
sources: the SCAPE [4], the MIT [50], and the Yobi3D [2]
data sets. The SCAPE database provides 71 registered
meshes of one person in different poses. The MIT dataset
contains the animation sequences of three different charac-
ters. Similar to SCAPE, the models of the same person have
dense ground truth correspondences. We used all the anima-
tion sequences except for the samba and swing ones, which
we reserve for evaluation. Yobi3D is an online repository
that contains a diverse set of 2000 digital characters with
varying clothing. Note that the Yobi3D dataset covers the
shape variability in local geometry, while the SCAPE and
the MIT datasets cover the variability in pose.
Simulated Scans. We render each model from 144 dif-
ferent viewpoints to generate training depth images. We
use a depth image resolution of 512 × 512 pixels, where
the rendered human character covers roughly half of the
height of the depth image. This setup is comparable to those
captured from commercial depth cameras; for instance, the
Kinect One (v2) camera provides a depth map with resolu-
tion 512×424, where a human of height 1.7 meters standing
2.5 meters away from the camera has a height of around 288

Figure 3: To ensure smooth descriptors, we deﬁne a clas-
siﬁcation problem for multiple segmentations of the human
body. Nearby points on the body are likely to be assigned
the samal label in at least one segmentation.

where only sparse ground-truth correspondences are avail-
able, and one for classifying dense pixel-wise labels, e.g.,
by segmenting models into patches (See Figure 3), used for
intra-subject training. Both contribute to the learning of the
descriptor extraction tower.

To ensure descriptor smoothness, instead of introducing
additional terms in the loss function, we propose a simple
yet effective strategy that randomizes the dense-label gen-
eration procedure. Speciﬁcally, as shown in Figure 3, we
consider multiple segmentations of the same person, and
introduce a classiﬁcation problem for each. Clearly, identi-
cal points will always be associated with the same label and
far-apart points will be associated with different labels. Yet
for other points, the number of times that they are associ-
ated with the same label is related to the distance between
them. Consequently, the similarity of the feature descrip-
tors are correlated to the distance between them on the hu-
man body resulting in a smooth embedding satisfying the
desired properties discussed in the beginning of the section.

3.2. Correspondence Computation

Our trained network can be used to extract per-pixel fea-
ture descriptors for depth maps. For full or partial 3D scans,
we ﬁrst render depth maps from multiple viewpoints and
compute a per-vertex feature descriptor by averaging the

4

layer
ﬁlter-stride
channel
activation
size
num

0
image
-
1
-
512
1

1

2

conv max
3-2
11-4
96
96
lrn
relu
64
128
4
1

3

4

conv max
3-2
5-1
256
256
lrn
relu
32
64
16
4

5
2×conv
3-1
384
relu
32
16

6

7

conv max
3-2
3-1
256
256
idn
relu
16
32
64
16

8
2×conv
1-1
4096
relu
16
64

9
int
-
4096
idn
128
1

10
conv
3-1
16
relu
512
1

Table 1: The end-to-end network architecture generates a per-pixel feature descriptor and a classiﬁcation label for all pixels
in a depth map simultaneously. From top to bottom in column: The ﬁlter size and the stride, the number of ﬁlters, the type of
the activation function, the size of the image after ﬁltering and the number of copies reserved for up-sampling.

is too expensive in our setting as we have to compute this
for dozens of thousands of patches per scan.

Our strategy is to design a network that takes the en-
tire depth image as input and simultaneously outputs a de-
scriptor for each pixel. Compared with the patch-based
strategy, the computation of patch descriptors are largely
shared among adjacent patches, making descriptor compu-
tation fairly efﬁcient in testing time.

Table 1 describes the proposed network architecture.
The ﬁrst 7 layers are adapted from the AlexNet architec-
ture. Speciﬁcally, the ﬁrst layer downsamples the input im-
age by a factor of 4. This downsampling not only makes
the computations faster and more memory efﬁcient, but also
removes salt-and-pepper noise which is typical in the out-
put from depth cameras. Moreover, we adapt the strategy
described in [43] to modify the pooling and inner product
layers so that we can recover the original image resolution
through upsampling. The ﬁnal layer performs upsampling
by using neighborhood information in a 3-by-3 window.
This upsampling implicitly performs linear smoothing be-
tween the descriptors of neighboring pixels. It is possible
to further smooth the descriptors of neighboring pixels in a
post-processing step, but as shown in our results, this is not
necessary since our network is capable of extracting smooth
and reliable descriptors.

Classiﬁcation module. The classiﬁcation module receives
the per-pixel descriptors and predicts a class for each anno-
tated pixel (i.e., either key points in the 33-class case or all
pixels in the 500-class case). Note that we introduce one
layer for each segmentation of each person in the SCAPE
and the MIT datasets and one shared layer for all the key
points. Similar to AlexNet, we employ softmax when deﬁn-
ing the loss function.

Training. The network is trained using a variant of stochas-
tic gradient descent. Speciﬁcally, we randomly pick a task
(i.e., key points or dense labels) for a random partial scan
and feed it into the network for training. If the task is dense
labels, we also randomly pick a segmentation among all
possible segmentations. We run 200,000 iterations when
tuning the network, with a batch size of 128 key points or
dense labels which may come from multiple datasets.

Figure 4: Sparse key point annotations of 33 landmarks
across clothed human models of different datasets.

pixels in the depth image.
Key-point annotations. We employ human experts to an-
notate 33 key points across the input models as shown in
Figure 4. These key points cover a rich set of salient points
that are shared by different human models (e.g. left shoul-
der, right shoulder, left hip, right hip etc.). Note that for
shapes in the SCAPE and MIT datasets, we only annotate
one rest-shape and use the ground-truth correspondences
to propagate annotations. The annotated key points are
then propagated to simulated scans, providing 33 classes
for training. The annotated data can be downloaded upon
request1.
500-patch segmentation generation. For each distinctive
model in our model collection, we divide it into multiple
500-patch segmentations. Each segmentation is generated
by randomly picking 10 points on each model, and then
adding the remaining points via furthest point-sampling. In
total we use 100 pre-computed segmentations. Each such
segmentation provides 500 classes for depth scans of the
same person (with different poses).

4.2. Network Design and Training

The neural network structure we use for training consists
of a descriptor extraction tower and a classiﬁcation module.

Extraction tower. The descriptor extraction tower takes a
depth image as input and extracts for each pixel a dimension
d (d = 16 in this paper) descriptor vector. A popular choice
is to let the network extract each pixel descriptor using a
neighboring patch (c.f.[15, 55]). However, such a strategy

1mail request to the ﬁrst author is preferred.

5

Figure 5: Our system can handle full-to-full, partial-to-full, and partial-to-partial matchings between full 3D models and
partial scans generated from a single depth map. We evaluate our method on various real and synthetic datasets. In addition
to correspondence colorizations for the source and target, we visualize the error relative to the synthetic ground truth.

5. Results

We evaluate our method extensively on various real and
synthetic datasets, naked and clothed subjects, as well as
full and partial matching for challenging examples as illus-

trated in Figure 5. The real capture data examples (last col-
umn) are obtained using a Kinect One (v2) RGB-D sen-
sor and demonstrate the effectiveness of our method for
real life scenarios. Each partial data is a single depth map
frame with 512 × 424 pixels and the full template model

6

is obtained using the non-rigid 3D reconstruction algorithm
of [25]. All examples include complex poses (side views
and bended postures), challenging garment (dresses and
vests), and props (backpacks and hats).

We use 4 different synthetic datasets to provide quanti-
tative error visualizations of our method using the ground
truth models. The 3D models from both SCAPE and MIT
databases are part of the training data of our neural network,
while the FAUST and Mixamo models [1] are not used for
training. The SCAPE and FAUST data sets are exclusively
naked human body models, while the MIT and Mixamo
models are clothed subjects. For all synthetic examples,
the partial scans are generated by rendering depth maps
from a single camera viewpoint. The Adobe Fuse and Mix-
amo softwares [1] were used to procedurally model real-
istic characters and generate complex animation sequences
through a motion library provided by the software.

The correspondence colorizations validate the accuracy,
smoothness, and consistency of our dense matching com-
putation for extreme situations, including topological varia-
tions between source and target. While the correspondences
are accurately determined in most surface regions, we often
observe larger errors on depth map boundaries, hands, and
feet, as the segmented clusters are slightly too large in those
areas. Notice how the correspondences between front and
back views are being correctly identiﬁed in the real capture
1 example for the full-to-partial matchings. Popular skele-
ton extraction methods from single-view 3D captures such
as [44, 52, 49] often have difﬁculties resolving this ambigu-
ity.

Comparisons. General surface matching techniques which
are not restricted to naked human body shapes are cur-
rently the most suitable solutions for handling subjects with
clothing. Though robust to partial input scans such as
single-view RGB-D data, cutting edge non-rigid registra-
tion techniques [16, 23] often fail to converge for large
scale deformations without additional manual guidance as
shown in Figure 6. When both source and target shapes
are full models, an automatic mapping between shapes
with considerable deformations becomes possible as shown
in [20, 26, 35, 10]. We compare our method with the recent
work of Chen et al. [10] and compute correspondences be-
tween pairs of scans sampled from the same (intra-subject)
and different (inter-subject) subjects. Chen et al. evalu-
ate a rich set of methods on randomly sampled pairs from
the FAUST database [7] and report the state of the art re-
sults for their method. For a fair comparison, we also eval-
uate our method on the same set of pairs. As shown in Ta-
ble 2, our method improves the average accuracy for both
the intra- and the inter-subject pairs. Note that by using
simple AlexNet structure, we can easily achieve an average
accuracy of 10 cm. However, if multiple segmentations are
not adapted to enforce smoothness, the worst average error

Chen et al.
our method

intra AE
4.49
2.00

intra WE
10.96
9.98

inter AE
5.95
2.35

inter WE
14.18
10.12

Table 2: We compare our method to the recent work of
Chen et al. [10] by computing correspondences for intra-
and inter-subject pairs from the FAUST data set. We pro-
vide the average error on all pairs (AE, in centimeters) and
average error on the worst pair for each technique (worst
AE, in centimeters). While our results may introduce worse
WE, overall accuracies are improved in both cases.

Figure 6: We compare our method to other non-rigid reg-
istration algorithms and show that larger deformations be-
tween a full template and a partial scan can be handled.

can be up to 30 cm in our experiments.

Application. We demonstrate the effectiveness our corrre-
spondence computation for a template based performance
capture application using a depth map sequence captured
from a single RGB-D sensor. The complete geometry and
motion is reconstructed in every sequence by deforming a
given template model to match the partial scans at each in-
coming frame of the performance. Unlike existing meth-
ods [46, 23, 51, 48] which track a template using the previ-
ous frame, we always deform the template model from its
canonical rest pose using the computed full-to-partial corre-
spondences in order to avoid potential drifts. Deformation
is achieved using the robust non-rigid registration algorithm
presented in Li et al. [23], where the closest point corre-
spondences are replaced with the ones obtained from the
presented method. Even though the correspondences are
computed independently in every frame, we observe a tem-
porally consistent matching during smooth motions with-
out enforcing temporal coherency as with existing perfor-
mance capture techniques as shown in Figure 7. Since our
deep learning framework does not require source and target
shapes to be close, we can effectively handle large and in-
stantenous motions. For the real capture data, we visualize
the reconstructed template model at every frame and for the
synthetic model we show the error to the ground truth.

Limitations. Like any supervised learning approach, our
framework cannot handle arbitrary shapes as our prior is en-
tirely based on the class of training data. Despite our supe-
rior performance compared to the state of the art, our current
implementation is far from perfect. For poses and clothings

7

putation with these feature descriptors varies between 0.5
and 1 s, depending on the resolution of our input data.

6. Conclusion

We have shown that a deep learning framework can be
particularly effective at establishing accurate and dense cor-
respondences between partial scans of clothed subjects in
arbitrary poses. The key insight is that a smooth embedding
needs to be learned to reduce misclassiﬁcation artifacts at
segmentation boundaries when using traditional classiﬁca-
tion networks. We have shown that a loss function based
on the integration of multiple random segmentations can be
used to enforce smoothness. This segmentation scheme also
signiﬁcantly decreases the amount of training data needed
as it eliminates an exhaustive pairwise distance computation
between the feature descriptors during training as apposed
to methods that work on pairs or triplets of samples. Com-
pared to existing classiﬁcation networks, we also present the
ﬁrst framework that uniﬁes the treatment of human body
shapes and clothed subjects. In addition to its remarkable
efﬁciency, our approach can handle both full models and
partial scans, such as depth maps captured from a single
view. While not as general as some state of the art shape
matching methods [20, 26, 35, 10], our technique signif-
icantly outperforms them for partial input shapes that are
human bodies with clothing.

Future Work. While a large number of poses were used
for training our neural network, we would like to explore the
performance of our system when the training data is aug-
mented with additional body shapes beyond the statistical
mean human included in the SCAPE database; and with ex-
amples that feature not only subject self-occlusion, but also
occlusion of the subject by large foreground objects (such
as passing cars). The size of the clothed training data set
is limited by the tedious need to manually annotate corre-
spondences; this limitation could be circumvented by sim-
ulating the draping of a variety of virtual garments and au-
tomatically extracting dense ground truth correspondences
between different poses. While our proposed method ex-
hibits few outliers, they are still difﬁcult to prune in some
cases, which negatively impacts any surface registration
technique. We believe that more sophisticated ﬁltering tech-
niques, larger training data sets, and a global treatment of
multiple input shapes can further improve the correspon-
dence computation of the presented technique.

Appendix I. Comparison

We show that our deep network structure for comput-
ing dense correspondences achieves state-of-the-art perfor-
mance on establishing correspondences between the intra-
and inter-subject pairs from the FAUST dataset [7]. For

Figure 7: We perform geometry and motion reconstruction
by deforming a template model to captured data at each
frame using the correspondences computed by our method.
Even though we do not enforce temporal coherency explic-
itly, we obtain faithful and smooth reconstructions. We
show examples both in real and synthetic data.

that are signiﬁcantly different than those from the training
data set, our method still produces wrong correspondences.
However, the outliers are often groupped together due to the
enforced smoothness of our embedding, which could be ad-
vantageous for outlier detection. Due to the limited memory
capacity of existing GPUs, our current approach requires
downsizing of the training input, and hence the correspon-
dence resolutions are limited to 512×512 depth map pixels.

Performance. We perform all our experiments on a 6-
core Intel Core i7-5930K Processor with 3.9 GHz and
16GB RAM. Both ofﬂine training and online correspon-
dence computation run on an NVIDIA GeForce TITAN X
(12GB GDDR5) GPU. While the complete training of our
neural network takes about 250 hours of computation, the
extraction of all the feature descriptors never exceeds 1 ms
for each depth map. The subsequent correspondence com-

8

each 3D scan in this dataset, we compute a per-vertex fea-
ture descriptor by ﬁrst rendering depth maps from mul-
tiple viewpoints and averaging the per-pixel feature de-
scriptors. Correspondences are then established by near-
est neighbor search in the feature space. The accuracy of
this direct method is already signiﬁcantly better than all ex-
isting global shape matching methods (that do not require
initial poses as input), and is comparable to the state-of-
the-art non-rigid registration method proposed by Chen et
al. [10], which uses the initial poses of the models to reﬁne
correspondences. To make a fair comparison with Chen et
al. [10], we use an out-of-the-shelf non-rigid registration al-
gorithm [24] to reﬁne our results. We initialize the regis-
tration algorithm with the correspondences established with
the nearest-neighbor search and reﬁne their positions after
non-rigid alignment. Results obtained with and without this
reﬁnement step are reported in Figure 8 and Table 3.
It
is worth mentioning that per-vertex feature descriptors for
each scan are pre-computed. Thus for each pair of scans,
we can obtain dense correspondences in less than a sec-
ond. Though our method is designed for clothed human
subjects, our algorithm is far more efﬁcient than all other
known methods which rely on local or global geometric
properties.

References

[1] 3d animation online services, 3d characters, and character
rigging - mixamo. https://www.mixamo.com/. Ac-
cessed: 2015-10-03.

[2] Yobi3d - free 3d model search engine. https://www.

yobi3d.com. Accessed: 2015-11-03.

[3] D. Anguelov, P. Srinivasan, H. cheung Pang, D. Koller,
S. Thrun, and J. Davis. The correlated correspondence al-
gorithm for unsupervised registration of nonrigid surfaces.
In NIPS, pages 33–40. MIT Press, 2004.

[4] D. Anguelov, P. Srinivasan, D. Koller, S. Thrun, J. Rodgers,
and J. Davis. Scape: Shape completion and animation of
people. In ACM TOG (Siggraph), pages 408–416, 2005.
[5] M. Aubry, U. Schlickewei, and D. Cremers. The wave kernel
signature: A quantum mechanical approach to shape analy-
sis. In IEEE ICCV Workshops, 2011.

[6] F. Bogo, M. J. Black, M. Loper, and J. Romero. Detailed
full-body reconstructions of moving people from monocular
RGB-D sequences. In IEEE ICCV, Dec. 2015.

[7] F. Bogo, J. Romero, M. Loper, and M. J. Black. FAUST:
In IEEE

Dataset and evaluation for 3D mesh registration.
CVPR, 2014.

[8] A. Bronstein, M. Bronstein, R. Kimmel, M. Mahmoudi, and
G. Sapiro. A gromov-hausdorff framework with diffusion
geometry for topologically-robust non-rigid shape matching.
Int. Journal on Computer Vision, 89(2-3):266–286, 2010.
[9] A. M. Bronstein, M. M. Bronstein, and R. Kimmel. General-
ized multidimensional scaling: A framework for isometry-
invariant partial surface matching. Proc. of the National
Academy of Science, pages 1168–1172, 2006.

[10] Q. Chen and V. Koltun. Robust nonrigid registration by con-

vex optimization. In IEEE ICCV, 2015.

[11] M. Dou, J. Taylor, H. Fuchs, A. Fitzgibbon, and S. Izadi. 3d
scanning deformable objects with a single rgbd sensor.
In
IEEE CVPR, 2015.

[12] A. Elad and R. Kimmel. On bending invariant signatures for

surfaces. IEEE PAMI, 25(10):1285–1295, 2003.

[13] P. Fischer, A. Dosovitskiy, E. Ilg, P. H¨ausser, C. Hazirbas,
V. Golkov, P. van der Smagt, D. Cremers, and T. Brox.
Flownet: Learning optical ﬂow with convolutional networks.
CoRR, abs/1504.06852, 2015.

[14] R. Girshick, J. Donahue, T. Darrell, and J. Malik. Rich fea-
ture hierarchies for accurate object detection and semantic
segmentation. In The IEEE Conference on Computer Vision
and Pattern Recognition (CVPR), June 2014.

[15] X. Han, T. Leung, Y. Jia, R. Sukthankar, and A. C. Berg.
Matchnet: Unifying feature and metric learning for patch-
based matching. 2015.

[16] Q.-X. Huang, B. Adams, M. Wicke, and L. J. Guibas. Non-
In CGF

rigid registration under isometric deformations.
(SGP), pages 1449–1457, 2008.

[17] V. Jain and H. Zhang. Robust 3d shape correspondence in the
spectral domain. In SMI, page 19. IEEE Computer Society,
2006.

[18] A. E. Johnson and M. Hebert. Using spin images for efﬁ-
cient object recognition in cluttered 3d scenes. IEEE PAMI,
21(5):433–449, May 1999.

[19] V. G. Kim, Y. Lipman, X. Chen, and T. Funkhouser. M¨obius
Transformations For Global Intrinsic Symmetry Analysis. In
CGF (SGP), 2010.

[20] V. G. Kim, Y. Lipman, and T. Funkhouser. Blended Intrinsic

Maps. In ACM TOG (Siggraph), volume 30, 2011.

[21] A. Krizhevsky, I. Sutskever, and G. E. Hinton.

classiﬁcation with deep convolutional neural networks.
NIPS, pages 1097–1105. 2012.

Imagenet
In

[22] M. Leordeanu and M. Hebert. A spectral technique for cor-
respondence problems using pairwise constraints. In IEEE
ICCV, pages 1482–1489, Washington, DC, USA, 2005.
[23] H. Li, B. Adams, L. J. Guibas, and M. Pauly. Robust single-
In ACM TOG

view geometry and motion reconstruction.
(Siggraph Asia), 2009.

[24] H. Li, R. W. Sumner, and M. Pauly. Global correspondence
optimization for non-rigid registration of depth scans. 2008.
[25] H. Li, E. Vouga, A. Gudym, L. Luo, J. T. Barron, and G. Gu-

sev. 3d self-portraits. In ACM TOG (Siggraph Asia), 2013.

[26] Y. Lipman and T. Funkhouser. M¨obius voting for surface cor-
respondence. In ACM TOG (Siggraph), pages 72:1–72:12,
2009.

[27] R. Litman and A. Bronstein. Learning spectral descrip-
IEEE PAMI,

tors for deformable shape correspondence.
36(1):171–180, 2014.

[28] J. L. Long, N. Zhang, and T. Darrell. Do convnets learn

correspondence? In NIPS, pages 1601–1609. 2014.

[29] J. Masci, D. Boscaini, M. M. Bronstein, and P. Van-
dergheynst. Geodesic convolutional neural networks on rie-
mannian manifolds. In The IEEE International Conference
on Computer Vision (ICCV) Workshops, December 2015.

9

(a) Cumulative error distribution, intra-subject

(b) Cumulative error distribution, inter-subject

(c) Average error for each intra-subject pair

(d) Average error for each inter-subject pair

Figure 8: Evaluation on the FAUST dataset. CNN is the result obtained by performing nearest neighbor search on descriptors
produced by our network. CNN-S is the result after non-rigid registration. Data for algorithms other than ours are provided
by Chen et al. [10]. Left: Results for intra-subject pairs. Right: Results for inter-subject pairs. Top: Cumulative error
distribution for each method, in centimeters. Bottom: Average error for each pair, sorted within each method independently.

[30] R. A. Newcombe, D. Fox, and S. M. Seitz. Dynamicfusion:
Reconstruction and tracking of non-rigid scenes in real-time.
In IEEE CVPR, 2015.

[31] M. Ovsjanikov, Q. M´erigot, F. M´emoli, and L. J. Guibas.
One point isometric matching with the heat kernel. CGF,
29(5):1555–1564, 2010.

[32] J. Pokrass, A. M. Bronstein, M. M. Bronstein, P. Sprech-
mann, and G. Sapiro. Sparse modeling of intrinsic cor-
In Computer Graphics Forum, volume 32,
respondences.
pages 459–468. Wiley Online Library, 2013.

[33] G. Pons-Moll, J. Taylor, J. Shotton, A. Hertzmann, and
A. Fitzgibbon. Metric regression forests for correspon-
dence estimation. International Journal of Computer Vision,
113(3):163–175, 2015.

[34] H. Pottmann, J. Wallner, Q.-X. Huang, and Y.-L. Yang. In-
tegral invariants for robust geometry processing. Computer
Aided Geometric Design, 26(1):37–60, 2009.

[35] E. Rodola, S. Rota Bulo, T. Windheuser, M. Vestner, and
D. Cremers. Dense non-rigid shape correspondence using

random forests. 2014.

[36] E. Rodola, A. Torsello, T. Harada, Y. Kuniyoshi, and D. Cre-
In Pro-
mers. Elastic net constraints for shape matching.
ceedings of the IEEE International Conference on Computer
Vision, pages 1169–1176, 2013.

[37] S. Rusinkiewicz, B. Brown, and M. Kazhdan. 3d scan match-
ing and registration. In ICCV 2005 Short Course, 2005.

[38] R. M. Rustamov. Laplace-beltrami eigenfunctions for defor-
mation invariant shape representation. In CGF (SGP), pages
225–233, 2007.

[39] Y. Sahillio˘glu and Y. Yemez. Coarse-to-ﬁne combinatorial
matching for dense isometric shape correspondence. In Com-
puter Graphics Forum, volume 30, pages 1461–1470. Wiley
Online Library, 2011.

[40] Y. Sahillio˘glu and Y. Yemez. Minimum-distortion iso-
metric shape correspondence using em algorithm. Pattern
Analysis and Machine Intelligence, IEEE Transactions on,
34(11):2203–2215, 2012.

10

AE (cm) worst AE 10cm-recall

AE (cm) worst AE 10cm-recall

method
CNN-S
CNN
CO[10]
RF[35]
BIM[20]
M¨obius[26]
ENC[36]
C2FSym[41]
EM[40]
C2F[39]
GMDS[9]
SM[32]

2.00
5.65
4.49
13.60
14.99
22.26
23.60
26.87
30.11
23.63
28.94
28.81

9.98
18.67
10.96
83.90
80.40
69.26
51.32
100.23
95.42
73.89
91.84
68.42

0.975
0.918
0.907
0.658
0.615
0.548
0.385
0.335
0.293
0.334
0.300
0.326

method
CNN-S
CNN
CO[10]
RF[35]
BIM[20]
M¨obius[26]
ENC[36]
C2FSym[41]
EM[40]
C2F[39]
GMDS[9]
SM[32]

2.35
5.73
5.95
17.36
30.58
26.92
29.29
25.89
31.25
25.51
35.06
32.66

10.12
18.03
14.18
86.76
70.02
79.43
57.28
96.46
90.74
90.62
91.21
75.38

0.972
0.917
0.858
0.539
0.300
0.435
0.303
0.359
0.235
0.277
0.188
0.240

(a) Accuracy on intra-subject pairs

(b) Accuracy on inter-subject pairs

Table 3: Evaluation on the FAUST dataset. CNN is the result obtained by performing nearest neighbor search on descriptors
produced by our network. CNN-S is the result after non-rigid registration. Data for algorithms other than ours are provided
by Chen et al. [10]. Left: Results for intra-subject pairs. Right: Results for inter-subject pairs. For each method we report
the average error on all pairs (AE, in centimeters), the worst average error among all pairs (worst AE), and the fraction of
correspondences that are within 10 centimeters of the ground truth (10cm-recall).

tional networks. ACM Transactions on Graphics (TOG),
33(5):169, 2014.

[50] D. Vlasic, I. Baran, W. Matusik, and J. Popovi´c. Articulated

mesh animation from multi-view silhouettes. 2008.

[51] M. Wand, B. Adams, M. Ovsjanikov, A. Berner, M. Bokeloh,
P. Jenke, L. Guibas, H.-P. Seidel, and A. Schilling. Efﬁcient
reconstruction of nonrigid shape and motion from real-time
3d scanner data. ACM TOG, 28(2), 2009.

[52] X. Wei, P. Zhang, and J. Chai. Accurate realtime full-body
motion capture using a single depth camera. ACM TOG,
31(6):188:1–188:12, Nov. 2012.

[53] T. Windheuser, U. Schlickewei, F. Schmidt, and D. Cremers.
Geometrically consistent elastic matching of 3d shapes: A
linear programming solution. In IEEE ICCV, pages 2134–
2141, 2011.

[54] T. Windheuser, M. Vestner, E. Rodola, R. Triebel, and
D. Cremers. Optimal intrinsic descriptors for non-rigid shape
analysis. In British Machine Vision Conf., 2014.

[55] S. Zagoruyko and N. Komodakis. Learning to compare im-
In IEEE

age patches via convolutional neural networks.
CVPR, pages 4353–4361, 2015.

[41] Y. Sahillio˘glu and Y. Yemez. Coarse-to-ﬁne isometric shape
In Computer
correspondence by tracking symmetric ﬂips.
Graphics Forum, volume 32, pages 177–189. Wiley Online
Library, 2013.

[42] F. Schroff, D. Kalenichenko, and J. Philbin. Facenet: A uni-
ﬁed embedding for face recognition and clustering. CoRR,
abs/1503.03832, 2015.

[43] P. Sermanet, D. Eigen, X. Zhang, M. Mathieu, R. Fergus,
and Y. LeCun. Overfeat: Integrated recognition, localiza-
tion and detection using convolutional networks. CoRR,
abs/1312.6229, 2013.

[44] J. Shotton, R. Girshick, A. Fitzgibbon, T. Sharp, M. Cook,
M. Finocchio, R. Moore, P. Kohli, A. Criminisi, A. Kipman,
and A. Blake. Efﬁcient human pose estimation from single
depth images. IEEE PAMI, 2012.

[45] J. Sun, M. Ovsjanikov, and L. Guibas. A concise and prov-
ably informative multi-scale signature based on heat diffu-
sion. In CGF (SGP), pages 1383–1392, 2009.

[46] J. S¨ussmuth, M. Winter, and G. Greiner. Reconstructing an-
imated meshes from time-varying point clouds. Number 5,
pages 1469–1476, 2008.

[47] J. Taylor, J. Shotton, T. Sharp, and A. Fitzgibbon. The Vit-
ruvian manifold: Inferring dense correspondences for one-
shot human pose estimation. In Computer Vision and Pat-
tern Recognition (CVPR), 2012 IEEE Conference on, pages
103–110. IEEE, 2012.

[48] A. Tevs, A. Berner, M. Wand, I. Ihrke, M. Bokeloh, J. Kerber,
and H.-P. Seidel. Animation cartography – intrinsic recon-
struction of shape and motion. ACM TOG, 31(2):12:1–12:15,
Apr. 2012.

[49] J. Tompson, M. Stein, Y. Lecun, and K. Perlin. Real-time
continuous pose recovery of human hands using convolu-

11

