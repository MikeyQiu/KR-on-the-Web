9
1
0
2
 
y
a
M
 
0
2
 
 
]
L
M

.
t
a
t
s
[
 
 
1
v
0
6
3
8
0
.
5
0
9
1
:
v
i
X
r
a

Conditionally-additive-noise Models for Structure
Learning

Daniel Chicharro
Neural Computation Laboratory
Center for Neuroscience and Cognitive Systems@UniTn
Istituto Italiano di Tecnologia
38068 Rovereto, Italy
Department of Neurobiology
Harvard Medical School
Boston, MA 02115
daniel.chicharro@iit.it
daniel_chicharro@hms.harvard.edu

Stefano Panzeri
Neural Computation Laboratory
Center for Neuroscience and Cognitive Systems@UniTn
Istituto Italiano di Tecnologia
38068 Rovereto, Italy
stefano.panzeri@iit.it

Ilya Shpitser
Department of Computer Science
Whiting School of Engineering
Johns Hopkins University
ilyas@cs.jhu.edu

Abstract

Constraint-based structure learning algorithms infer the causal structure of multi-
variate systems from observational data by determining an equivalent class of causal
structures compatible with the conditional independencies in the data. Methods
based on additive-noise (AN) models have been proposed to further discriminate
between causal structures that are equivalent in terms of conditional independencies.
These methods rely on a particular form of the generative functional equations,
with an additive noise structure, which allows inferring the directionality of causa-
tion by testing the independence between the residuals of a nonlinear regression
and the predictors (nrr-independencies). Full causal structure identiﬁability has
been proven for systems that contain only additive-noise equations and have no
hidden variables. We extend the AN framework in several ways. We introduce
alternative regression-free tests of independence based on conditional variances
(cv-independencies). We consider conditionally-additive-noise (CAN) models, in
which the equations may have the AN form only after conditioning. We exploit
asymmetries in nrr-independencies or cv-independencies resulting from the CAN
form to derive a criterion that infers the causal relation between a pair of variables
in a multivariate system without any assumption about the form of the equations or
the presence of hidden variables.

Inferring the causal structure of multivariate systems from observational data has become an indispens-
able need in many domains of science, from physics, to neuroscience, to ﬁnance (Lütkepohl, 2006;
Wibral et al., 2014; Peters et al., 2017). Constraint-based structure learning algorithms have been used
to infer the causal structure by determining an equivalent class of causal structures compatible with

1

Introduction

Preprint. Work in progress.

the conditional independencies in the data (Spirtes et al., 2000; Pearl, 2009). Additive-noise (AN)
models were proposed as powerful solutions that allow further discriminating between structures
within these equivalent classes (Hoyer et al., 2009; Peters et al., 2014; Mooij et al., 2016). A pure
AN functional equation requires that the noise is additively separable from the causes of a variable,
and in the standard approach this property is exploited by testing independencies of the residuals of
a nonlinear regression with the regression predictors. For multivariate systems, algorithms testing
these nonlinear regression residuals independencies (nrr-independencies) proceed inferring a global
causal ordering (Mooij et al., 2009) under the assumption that the noise is separable in all equations.
This approach has been mostly studied in the case of causal sufﬁciency (no hidden variables), (but
see Janzing et al., 2009, for an exception). In this work we extend the AN framework in four fronts.
First, allowing for the presence of hidden variables. Second, considering functional equations that
have the AN form only after conditioning on certain variables. Third, introducing an alternative
regression-free test to infer causality exploiting the independencies present in AN models. Fourth,
proposing a criterion to infer the causal relation between a speciﬁc pair of variables in a multivariate
system with hidden variables, without restrictions on the form of the functional equations and without
involving the inference of a global causal ordering.

In more detail, we generalize AN models to partial conditionally-additive-noise (CAN) models with
hidden variables. These models contain both equations reducible and irreducible to the AN form, and
the AN form may only be obtained after conditioning on some of the observable variables. We show
how structure learning for partial CAN models can be formulated in terms of nrr-independencies
asymmetries, analogously to AN models (Hoyer et al., 2009; Peters et al., 2014). Furthermore,
we introduce a regression-free test to detect additive noise. This test assesses the independence of
the residuals second-order moments from the predictors indirectly, estimating conditional variance
independencies (cv-independencies) that do not require an actual reconstruction of the noise variables.
We formulate a criterion to infer a potential cause from one particular variable to another in the
presence of hidden variables, which does not require inferring a global causal ordering. Finally,
we discuss the extension of CAN models by generalizing post-nonlinear AN models (Zhang and
Hyvärinen, 2009), which allow for the presence in the functional equations of a global invertible
nonlinear transformation of the AN terms. We believe that this work will lead to a structure learning
algorithm alternative to the ones existing for AN models with no hidden variables (Mooij et al.,
2009; Peters et al., 2014; Bühlmann et al., 2014). The proposal of such algorithm exploiting the new
criterion we propose is left for a future contribution.

This paper is organized as follows. In Section 2, we review previous work on AN models and post-
nonlinear AN models. In Section 3, we describe the regression-free test based on cv-independence.
In Section 4, we extend the AN models to CAN models, providing conditions for the existence of
cv-independencies and nrr-independencies that appear after conditioning. We introduce a criterion
that exploits these independencies to infer causal relations in the presence of hidden variables and for
system which may be only partially CAN models. In Section 5, we examine examples of concrete
systems. In Section 6, we extend our approach to post-nonlinear AN models.

2 Previous work on additive-noise models

We start with some basic notions for graphs. We use capital letters for random variables and
bold letters for sets and vectors. Consider a set of random variables V “ tV1, ..., Vnu. A graph
G “ pV; Eq consists of nodes V and edges E between the nodes. pV; Vq R E for any V P V. We
write Vi Ñ Vj for pVi; Vjq P E. We refer to V as both variable V and its corresponding node. A
node Vi is called a parent of Vj if pVi; Vjq P E. The set of parents of Vj is denoted by Paj. A
path in G is a sequence of (at least two) distinct nodes V1, ..., Vn, such that there is an edge between
Vk and Vk`1 for all k “ 1, ..., n ´ 1. If all edges are Vk Ñ Vk`1 the path is a causal or directed
path. A node Vi is a collider in a path if it has incoming arrows Vi´1 Ñ Vi Ð Vi`1 and is a
noncollider otherwise. The set of descendants DpViq of node Vi comprises those variables that can
be reached going forward through causal pathways from Vi. The set of non-descendants NDpViq of
Vi, is complementary to DpViq, including Vi. In Directed Acyclic Graphs (DAGs) no node is its
own descendant. Two nodes Vi and Vj are adjacent if either pVi; Vjq P E, pVj; Viq P E, or there
is a hidden common parent Vk between them (i. e. pVk; Viq P E and pVk; Vjq P E and Vk is not
observable). Vi is a potential cause of Vj if it is a parent or they share a hidden common parent.
Conditional independence between two variables is equivalent to d-separation Pearl (2009) of their

2

corresponding nodes under the faithfulness assumption Spirtes et al. (2000), which ensures that the
probability distribution contains only independencies induced by the causal structure. Accordingly,
a conditional dependence between V1 and Vn given S, i.e. , V1 M Vn|S exists iff the nodes are
connected by a path that is active when blocking the nodes in S (S-active path). See Spirtes et al.
(2000) for a more detailed description.

The functional equation generating variable Vi has the AN form if it conforms to

Vi “ fipVi, εiq “ fipVi,1, ..., Vi,nq ` εi,
with Pai “ Vi “ tVi,1, ..., Vi,nu and noise εi by deﬁnition independent of the parents. Most
part of the work with AN models assumes that all variables are observable. Under the assumption
of no hidden variables, since the noise is additively separable from the parents, an estimate ˆεi
can be obtained by nonlinear regression as ˆεi ” Vi ´ ˆfipViq. If εi is properly reconstructed,
ˆεi K V @V P Vi, that is, the independence of the noise from the parents is recovered. Consider a
particular variable Y and parent X P Pay. If all variables are observed and the equation of Y has the
AN form it is guaranteed that an independent noise can be reconstructed.

(1)

Proposition 1 Nrr-independence with AN functional equations: ‘If the functional equation of Y has
the AN form, then @X P Pay DS and ˆfypX, Sq such that ˆεy K X, with ˆεy ” Y ´ ˆfypX, Sq.’

The existence of at least one set S is guaranteed because S “ PayzX leads to ˆεy K X. If we knew
that ˆεy reconstructs a truly generative noise variable, Proposition 1 would sufﬁce to infer a cause
from X to Y (assuming no hidden variables). This is because, if Y is adjacent to both X and ˆεy (there
are edges Y ´ X and Y ´ ˆεy), the fact that X M Y and X K ˆεy is a sufﬁcient condition for Y to be a
collider (X Ñ Y Ð ˆεy) (Pearl, 2009). However, because ˆεy is only a reconstruction of the presumed
underlying noise variable, extra checks are required: the question is if the nrr-independence X K ˆεy
could also occur when ˆεy is estimated but the generative model contains the reverse causal relation.

Hoyer et al. (2009) proved that, if Y has a generative AN functional equation and X P Pay,
nrr-independence holds for ˆεy “ Y ´ ˆfypX, Sq, given S “ PayzX ﬁxed, and in general not for
the direction opposite to causality, that is, there is no nrr-independence for ˆεx “ X ´ ˆfxpY, Sq.
However, they also showed that nrr-independence in both directions holds for a family of distributions
ppX, Y|Sq which, for S ﬁxed, is characterized as the solutions of a third-order linear inhomogeneous
differential equation. For example, Gaussian distributions belong to that family. Accordingly, if a
system only contained AN equations with no hidden variables, an asymmetry ˆεy K X and ˆεx M Y,
would sufﬁce to infer a cause from X to Y. This is because ˆεy K X always holds given the AN
form of the functional equation of Y and only if the data generating distribution is within the special
family of Hoyer et al. (2009) nrr-independence holds in both directions, in which case nothing can be
concluded.

However, generally not all functional equations have an AN form. Focusing on the bivariate case,
Janzing and Steudel (2010) discussed the necessary assumptions for structure learning based on
asymmetries of nrr-independencies. They indicated that, for a generative functional equation with
the opposite direction of causality X “ fxpY, εxq, it has to be assumed that ˆεy K X will not hold
for any ˆεy “ Y ´ ˆfypXq, except within the family of Hoyer et al. (2009). Janzing and Steudel
(2010) justiﬁed the fulﬁllment of this assumption because ˆεy K X would impose constraints making
ppYq and ppX|Yq dependent. This dependence requires a ﬁne tuning of the distribution ppYq of the
cause, given the mechanism ppX|Yq, and hence is fragile to changes in ppYq if the cause distribution
changes independently of the causal mechanism, as expected. These arguments are tightly related
with the justiﬁcation of the faithfulness assumption for conditional independencies based on stability.
In particular stability rules out ’pathological parameterizations’ (Pearl, 2009) in which a conditional
independence does not correspond to a d-separation present in the causal structure because such
independencies also require tuning the parameters of the functional equation, and will vanish with
small changes of these parameters.

When testing for nrr-independencies in multivariate systems, the common procedure starts by in-
ferring a global causal ordering of the variables (Mooij et al., 2009). This step already uses nrr-
independencies, and relies on the fact that conditioning on a descendant introduces a dependence
between Y and its noise variable. Subsequently, nrr-independencies are tested with regression models
that, if the causal ordering is correct, do not take descendants as arguments. This allows removing
superﬂuous edges from non-descendants that are not parents of Y. To our knowledge, for the multi-

3

variate case an analogous assumption of faithfulness has not been formulated explicitly. For the sake
of comparison with our results we here explicitly state the following assumption:

Assumption 1 Nrr-independence faithfulness for non-additive-noise functional equations: ‘if
the generative functional equation of X, with Y P Pax, does not have an AN form, then ˆεy M
X, @tS, ˆfypX, Squ with S Ď NDpXq, PaxzY Ď S and ˆεy ” Y ´ ˆfypX, Sq.’
This assumption is a multivariate version of the bivariate one discussed in Janzing and Steudel (2010).
It considers that all other parents of X are included in the regression, and that only X and Y are
exchanged. The assumption can be used iteratively when determining the causal ordering. It ensures
that, if a functional equation does not have the AN form and hence Proposition 1 does not guarantee
independence in the right direction, an asymmetry of independence does not appear in the wrong
direction. The assumption focuses on equations without an AN form because, by Proposition 1, with
the AN form nrr-independence in the wrong direction only leads to symmetric nrr-independencies.

Finally, we also review post-nonlinear AN models, where a global nonlinearity transforms the AN
equation (Zhang and Hyvärinen, 2009):

Vi “ fipVi, εiq “ hi,2phi,1pViq ` εiq.

(2)

Here hi,2 is an invertible nonlinear function. For the bivariate case, with Y “ h2ph1pXq ` εyq, Zhang
and Hyvärinen (2009) generalized the work of Hoyer et al. (2009) extending the characterization of
the special family of distributions that admits a statistical post-nonlinear AN model in both directions.
Furthermore, they showed how to ﬁt a nonlinear model to extract residuals ˆεy ” ˆh´1
2 pyq ´ ˆh1pxq
to test nrr-independencies. For the multivariate case, assuming no hidden variables, Zhang and
Hyvärinen (2009) used regressions to evaluate nrr-independencies given sets of candidate parents
previously determined examining conditional independencies between the variables (Spirtes et al.,
2000).

Additive-noise models are a well-established approach for structure learning, which has been mostly
studied in the case of causal sufﬁciency (no hidden variables). A pure AN functional equation
requires that the noise is separable as in Eq. 1, and in the standard approach this property is exploited
by testing the independence of the residuals of a nonlinear regression from the predictors. For
multivariate systems, the application of these tests proceeds by inferring a global causal ordering. We
extend the AN framework in four fronts, allowing for the presence of hidden variables, considering
functional equations that have the AN form only after conditioning on certain variables, introducing
an alternative regression-free test to infer causality, and modifying the procedure not to rely on the
inference of a global causal ordering.

3 Conditional variance independencies

We start introducing a regression-free test for causal directionality alternative to the regression-based
analysis of nrr-independencies. For this purpose, we continue to consider the pure AN equations of
the form of Eq. 1. The key property of AN functional equations is that the independent noise εi is
additively separable from the parents. For a particular variable Y and a parent X, deﬁne Z ” PayzX.
We can study the conditional variance σY|X,Z as a variable which is a function only of X, with Z ﬁxed.
For AN functional equations, the independence and separability of the noise leads to σY|X,Z “ σεy ,
which is independent of X (σY|X,Z K X). This independence reﬂects the independence of the
second-order moments of the residuals from the predictors indirectly, and does not require an actual
reconstruction of the noise variables. Analogously to Proposition 1, the AN form sufﬁces for this
type of independence, which we call conditional variance independence (cv-independence).

Proposition 2 Cv-independence with AN functional equations: ‘If the functional equation of Y has
the AN form, then @X P Pay DS : σY|X,S K X @S “ s.’

The existence of at least one set S is guaranteed because S “ Z leads to σY|X,S K X. Because
cv-independence follows from the fact that the noise is independent and separable from the other
arguments of the equation, for the special family characterized by Hoyer et al. (2009) in which an
AN statistical model can also be constructed in the reverse direction, cv-independence holds in both
directions. For general systems, possibly containing functional equations without the AN form, an
assumption analogous to Assumption 1 is required to ensure that the asymmetry of cv-independencies

4

does not hold in the direction inconsistent with the causal relation. Like for Assumption 1, to
formulate this assumption of faithfulness we consider a functional equation with the opposite causal
direction for X and Y, and compare the cv-dependence of σY|X,S with respect to the independence
stated in Proposition 2.

Assumption 2 Cv-independence faithfulness for non-additive-noise functional equations: ‘if the
functional equation of X, with Y P Pax, does not have an AN form, then σY|X,S M X @S Ď
NDpXq, PaxzY Ď S.’

The two faithfulness assumptions are related by the following conditions:

Proposition 3 Relation between cv-independence faithfulness and nrr-independence faithfulness:
‘The fulﬁllment of Assumption 2 implies the one of Assumption 1, but not the opposite.’

Proof of Proposition 3: See Appendix.

Despite this theoretical asymmetry between the two faithfulness assumptions, the fulﬁlment of
assumption 1 and not assumption 2 would impose further constraints to the probability distributions.
It would require that ppˆεy|x, sq is such that dependencies appear in third or higher-order moments,
so that cv-independence holds despite nrr-dependence. Furthermore, because we are considering
a functional equation where Y is a parent of X, the fulﬁllment of faithfulness regards ppˆεy|x, sq,
which does not correspond to the generative direction. Accordingly, cases in which nrr-independence
faithfulness is violated and cv-independence faithfulness holds require a speciﬁc tuning introducing a
dependence between the probability of the causes and the causal mechanism (Janzing and Steudel,
2010). The necessity of this tuning renders these cases fragile to changes in the distribution of the
causes, and hence nonstable.

Testing nrr-independencies intrinsically requires a regression-based approach, ﬁtting a (nonlinear)
regression model. On the other hand, while cv-independencies can also be evaluated using the
variance of the residuals, they can alternatively be tested in a regression-free approach, estimating
the conditional variance of the variables without reconstructing the noise variables. The latter has
the advantage that it does not rely on a particular model of regression. However, in some cases a
test of variance homogeneity, if S is highly dimensional, may require more data than the nonlinear
regression approach. These practical issues are out of the scope of this work. As we will see below,
the cv-independencies formulation is particularly intuitive to derive an extension of AN models to
partial CAN models.

4 Conditionally-additive-noise models

For systems in which all functional equations have the AN form, full identiﬁability of the causal
structure has been proven when there are no hidden variables (Peters et al., 2014). For partially AN
models, for which only some of the equations have the AN form, asymmetries in nrr-independencies
have been used (Tillman et al., 2009) as a method to complement algorithms of constraint-based causal
discovery such as the PC algorithm (Spirtes et al., 2000), which exploit conditional independencies
between the variables. However, to our knowledge, it has not been examined how extra inferential
power can be gained from functional equations that, although not having a pure AN form, are
converted to the AN form after conditioning on some variables. We call these type of equations
conditionally-additive-noise (CAN) functional equations. We derive the conditions on the form of a
functional equation so that it can be converted to the CAN form in order to test nrr-independencies or
cv-independencies. Furthermore, we now drop the assumption of causal sufﬁciency and consider also
the existence of hidden variables.

To derive which equations have the conditionally-additive-noise form, we start expressing a generic
functional equation as:

Vi “ fipVi, εiq “ fi,1pVi,1,1, ..., Vi,1,n1 q ` fi,2pVi,2,1, ..., Vi,2,n2 , εiq ` fεpεiq.
(3)
Here the form allowed for fi,1 and fi,2 should be understood as complementary to simpler terms.
That is, fi,1 comprises any function of only Vi. Function fi,2 comprises any function that contains
εi as an argument, but excluding terms that only contain εi. The sets Vi,1 and Vi,2 can overlap. Any
functional equation can be expressed in this form. In particular, if Vi,2 “ H the equation reduces to
the AN form.

5

Consider Y “ Vi and a particular parent X P Vy. We want to determine under which conditions
cv-independencies or nrr-independencies can occur. As a ﬁrst remark, if X P Vy,2, σY|X,S M X
for any set S, since εy is an argument of fy,2 and X modulates its variance. For the same reason
the residuals cannot be independent from X when X P Vy,2. Subsequently, we focus on variables
X P Vy,1. Taking a particular variable X as reference, Eq. 3 can be expanded into the following
subterms, where we also differentiate between observable variables (V) and hidden variables (U):

Y “ f1,1pX, V1,1, U1,1q ` f1,2pV1,2, U1,2q `

f1,3,jp ˜V1,3,jqV1,3,j `

βjV3,j

n13ÿ

j“1

ÿ

j

(4)

`

n14ÿ

j“1

ÿ

j

f1,4,jp ˜V1,4,jqU1,4,j `

αjU3,j ` f2pV2, U2, εyq ` fεpεyq.

We dropped subindex y from all variables and functions to simplify the notation. As in Eq. 3, the
meaning of each function is determined by opposition to simpler terms explicitly separated. For
example, f1,1 is any function that does not have εy as an argument and does not include the other
explicit simpler terms that do not include εy either. As will be appreciated below, we only separate
those terms that are subject to different constraints in the conditions to obtain the CAN form. Only the
function f1,1 has X as an argument. Function f1,3 is linear on some observable variables V1,3,j with a
coefﬁcient that is a function f1,3,j of other observable variables. Function f1,4 is linear in each hidden
variable of U1,4, with a coefﬁcient that is a function f1,4,j of observable variables ˜V1,4. Here ˜V1,3 “
t ˜V1,3,1, ..., ˜V1,3,n13 u, and ˜V1,4 “ t ˜V1,4,1, ..., ˜V1,4,n14 u. Similarly V1,3 “ tV1,3,1, ..., V1,3,n13u
and U1,4 “ tU1,4,1, ..., U1,4,n14 u. Vy “ tV1,1, V1,2, V1,3, ˜V1,3, ˜V1,4, V2, V3u contains all other
observable parents apart from X, and Uy “ tU1,1, U1,2, U1,4, U2, U3u all hidden parents. There
can be overlaps between subgroups of Vy or of Uy.

We determine the conditions that lead to cv-independencies and nrr-independencies. We will focus
on the case in which, for a certain variable X P PAy, which causal relation with Y is examined, X
is adjacent to all other potential causes of Y, i.e. , parents and variables sharing a hidden common
cause with Y. This is because, as discussed above, it sufﬁces that two observable potential causes
are nonadjacent to infer that Y is a collider for them using conditional independencies (Spirtes et al.,
2000). This means that the conditions we derive could be relaxed, but the knowledge obtained would
be redundant to the one provided by conditional independencies. Because cv-independencies only rely
on second-order moments, there is a difference in the conditions needed to obtain cv-independence
and nrr-independence. We start with cv-independencies, which lead to less restrictive conditions.

4.1 The CAN form with cv-independence

We deﬁne the cv-CAN form as the form of a functional equation leading to cv-independence:

Deﬁnition 1 Cv-independence with cv-CAN functional equations: ‘The functional equation of Y has
the cv-CAN form for X when conditioning on S if σY|X,S K X @S “ s.’
We now enunciate when a functional equation can be set into the cv-CAN form. For this purpose,
expressing the functional equation of Y as in Eq. 4, we deﬁne the functions Y1,2 ” f1,2pU1,2; V1,2q
and Y2 ” f2pU2, εy; V2q, where V1,2 and V2 play the role of ﬁxed parameters, and we also deﬁne
S2 ” tY1,2, Y2, U1,4, U3u. The cv-CAN form is characterized as follows.

Theorem 1 Functional equations with the cv-CAN form: ‘Consider an X P Pay and a set S. For the
case in which X is adjacent to all other potential causes of Y, the functional equation of Y has the
cv-CAN form with respect to X given the set S if and only if the hidden variables fulﬁll the following
conditions

iq U1,1 “ H;
iiq X K Uk|S @Uk P tU1,2, U2u;
iiiq σUk|X,S K X @Uk P tU1,4, U3u;
ivq σZiZj |X,S K X @Zi, Zj P S2,

(5)

the set S is such that

tV1,1, V1,2, ˜V1,3, ˜V1,4, V2, V1,3,2, V3,2u Ď S,

6

where V3,2 is deﬁned as V3,2 ” V3zV3,1, with V3,1 Ď V3 such that @Vi P V3,1 σVi|X,S K X,
V1,3,2 is deﬁned as V1,3,2 ” V1,3zV1,3,1 with V1,3,1 Ď V1,3 such that @Vi P V1,3,1 σVi|X,S K X,
and the unconditioned observable variables also fulﬁll the following conditions

vq σViVj |X,S K X @Vi, Vj P S3;
viq σViZj |X,S K X @Vi P S3, Zj P S2,

where S3 “ tV3,1, V1,3,1u.’

Proof of Theorem 1: See Appendix.

To understand the logic of these conditions, we rewrite Eq. 4 as

Y “ f1,1pX; V1,1q `

f1,2pU1,2; V1,2q `

˜βjV1,3,1,j `

ÿ

j

ÿ

βjV3,1,j
ﬀ

j

`

˜αjU1,4,j `

αjU3,j ` f2pU2, εy; V2q ` fεpεyq ` c

.

ÿ

j

«

ÿ

j

(6)

(7)

˜βj “ f1,3,1,jp ˜V1,3,1,jq and ˜αj “ f1,4,jp ˜V1,4,jq are constant coefﬁcients because t ˜V1,3, ˜V1,4u Ď S.
j βjV3,2,j because t ˜V1,3, V1,3,2, V3,2u Ď S. Eq. 7 can be
The constant c equals
summarized as:

˜βjV1,3,2,j `

ř

ř

j

Y “ f1,1pX; Sq ` gpV1,3,1, V3,1, U1,2, U1,4, U2, U3; Sq “ f1,1pX; Sq ` ξy|S,

(8)

where the function g plays the role of a noise ξy|S analogous to the additive noise term of a pure AN
equation, and hence the equation has the additive-noise form when seen as a function of X. U1,2
and U2 are conditionally independent of X given S, and g is linear in all the other arguments, with
their variances and covariances conditionally independent of X given S. This leads to σξy|S|X,S K X.
Note that, to fulﬁll the conditions in Eqs. 5 and 6, S may need to include other variables that are
not parents of Y. Furthermore, the constraints are intertwined because independencies change
depending on which variables are included in S. Since all variables in V3 and V1,3 are observable,
it is always possible to try to ﬁnd a valid set S with V3,1 “ H and V1,3,1 “ H. In that case,
the constraints of Eq. 6 vanish. It is also possible to formulate a simpler sufﬁcient condition by
demanding X K Uk|S @Uk P tUyzU1,1u.

Note that the cv-CAN form is obtained relative to a certain variable. The existence of a valid set S
to place an equation in the CAN form relative to a variable is not guaranteed for all the observable
parents. This is because of two reasons. First, it may be due to the presence of hidden variables that
for a certain X do not fulﬁll the conditions of Theorem 1. This limitation is common to pure AN
functional equations if hidden variables are allowed, since AN equations are CAN equations with
Vy,2 “ H. Second, even with no hidden variables, @V P Vy,2 ES : σY|V,S K V. That is, certain
parents are not additively separable from the noise and cannot lead to any cv-independence. The
fact that only some equations in the system, and only relatively to certain variables, have the CAN
form, hinders the application of algorithms of structure learning in which a global causal ordering
is inferred searching for the ordering that leads to the highest estimates of residuals independence
(Mooij et al., 2009; Peters et al., 2014), which are designed for systems in which all equations have
the pure AN form. This is because now a lack of independence can be due not to the wrong order, but
to the lack of separability of the noise, for the reasons mentioned above.

Theorem 1 states which form of a functional equation will create a cv-independence. Assuming
that a certain functional equation is known or hypothesized, and for a certain context in which the
existence of certain hidden variables is known or hypothesized, the theorem allows determining
if a cv-independence exists. However, the theorem cannot be applied for inference, given that the
conditions in Eqs. 5 and 6 involve hidden variables and hence their fulﬁllment cannot be tested from
data. To derive a criterion applicable for inference, we identify the assumptions required so that a

7

speciﬁc asymmetry of cv-independencies provides information about the causal relation between the
corresponding pair of variables, without inferring a global causal ordering.

Assumption 3 Cv-independence faithfulness for non-conditionally-additive-noise functional equa-
tions: ‘if @S1 Ď S the generative functional equation of X, with Y P Pax, does not have the cv-CAN
form for Y conditioned on S1, then σY|X,S M X.’

In comparison to the previous assumptions of faithfulness, here there is no restriction of S to non-
descendants of X. S is not limited based on any causal knowledge. The assumption again focuses on
functional equations which do not have the CAN form. In the Appendix we indicate that, like for pure
AN equations, a special family of joint distributions ppX, Y|Sq as described by Hoyer et al. (2009),
allows a CAN statistical form in both directions. Assumption 3 can be used to infer a potential cause
from X to Y, that is, to infer that X causes Y or there is a latent common cause:

Proposition 4 Inferring noncausality with cv-independence asymmetries: ‘Consider two adjacent
variables X and Y. Under the assumption of cv-independence faithfulness for non-cv-CAN functional
equations (Assumption 3), if DS : σY|X,S K X and σX|Y,S1 M Y @S1 Ď S, then there is no causality
from Y to X, that is, X is a potential cause of Y.’

Proof of Proposition 4: If DS : σY|X,S K X, it does not hold that σY|X,S M X. By Assumption 3, this
implies that, either Y R Pax or the functional equation of X has the cv-CAN form for Y conditioning
on S1 for some S1 Ď S. The latter is discarded since we have σX|Y,S1 M Y @S1 Ď S. l

We now provide some intuition about this criterion. First, if there is only a latent common cause
between X and Y, it is valid to infer a potential cause in either direction. Therefore, what we need is
to avoid inferring the potential cause in the wrong direction when there is a genuine cause. For the
bivariate case, the asymmetry of cv-independencies sufﬁces if we assume faithfulness for non-CAN
functional equations. However, conditioning on some set S not only can convert an equation to
the CAN form, it can also introduce cv-dependencies that were not present when conditioning only
on a subset of S. An asymmetry could appear in the following way: for a certain S˚, not only
the functional equation of Y has the CAN form relatively to X, but furthermore the conditional
joint distribution ppX, Y|S˚q belongs to the special family that allows a CAN statistical model in
both directions. For S˚, a symmetry of cv-independencies is obtained. However, conditioning on a
larger set (S˚ Ă S) can introduce a cv-dependence that only appears in the direction in which the
independence given S˚ was consistent with the causal structure. Accordingly, for S an unfaithful
asymmetry is obtained. See Section 5 for an example of a system in which this type unfaithful of
asymmetry occurs. Checking if σX|Y,S1 M Y @S1 Ď S, we can ﬁnd the S˚ Ă S for which symmetric
independencies were obtained, showing that the observed asymmetry is not reliable.

Altogether, Theorem 1 states when cv-independencies occur as a consequence of the causal structure,
and Assumption 3 speciﬁes the faithfulness assumption required so that cv-independencies do not
occur inconsistently with the causal structure, which allows formulating the criterion of Proposition
4 to infer noncausality from data. That is, Theorem 1 provides us an analytical tool to establish
cv-independencies from a known or hypothesized functional equation, and Proposition 4 provides us
an empirical tool to infer the causal information from data.

4.2 The CAN form with nrr-independence

We now deﬁne the nrr-CAN form as the form of a functional equation leading to nrr-independence:

Deﬁnition 2 Nrr-independence with nrr-CAN functional equations: ‘The functional equation of Y
has the nrr-CAN form for X when conditioning on S if @S “ s D ˆfypX; Sq such that ˆεy|X;S K X, with
ˆεy|X;S ” Y ´ ˆfypX; Sq.’
We distinguish X and S as an argument and constant parameters of the function ˆfy, since S “ s
is ﬁxed when conditioning. We now enunciate the conditions in which a functional equation can
be set into the nrr-CAN form. Similarly to Theorem 1, we focus on conditions for the case that
X is adjacent to all other potential causes of Y, since otherwise the rules based on conditional
independencies would already be applicable to extract the same causal information. For this purpose,
we ﬁrst introduce some further notation. Consider a variable Z P tV3, U3u. This variable has a

8

linear additive contribution to the functional equation of Y (Eq. 4), and hence ˆfypX; Sq will contain
an additive component associated with the term in which Z appears. This component corresponds to
the conditional mean of Z given X and S, scaled by its coefﬁcient in Eq. 4. The contribution of this
term to the residual of Y is hence proportional to the residual εz|X;S that would result from a separate
regression to estimate Z. Therefore, we deﬁne εz|X;S ” Z ´ ˆfzpX; Sq for Z P tV3, U3u. We use
an analogous deﬁnition in relation to the part of the residual of Y associated with Z P tV1,3, U1,4u
when, after conditioning on ˜V1,3 and ˜V1,4, respectively, they also have linearly additive contributions
in Eq. 4. The nrr-CAN form is characterized as follows:

Theorem 2 Functional equations with nrr-CAN form: ‘Consider an X P Pay and the case in which
X is adjacent to all other potential causes of Y. Express the functional equation of Y as in Eq. 4. The
equation has the nrr-CAN form with respect to X given S if and only if the hidden variables fulﬁll
the following conditions

iq U1,1 “ H;
iiq X K Uk|S @Uk P tU1,2, U2u;
iiiq εUk|X;S K X @Uk P tU1,4, U3u,

(9)

the set S is such that

tV1,1, V1,2, ˜V1,3, ˜V1,4, V2, V1,3,2, V3,2u Ď S,

where V3,2 is deﬁned as V3,2 ” V3zV3,1, with V3,1 Ď V3 such that @Vi P V3,1 εVi|X;S K X,
V1,3,2 is deﬁned as V1,3,2 ” V1,3zV1,3,1 with V1,3,1 Ď V1,3 such that @Vi P V1,3,1 εVi|X;S K X.
Proof of Theorem 2: See Appendix.

The correspondence between Theorems 1 and 2 can be understood considering that the conditional
variances only quantify, in a regression-free way, dependencies of X with the second-order moments
of the residuals of Y. On the other hand, nrr-independencies are sensitive also to dependencies of
X with the residuals higher-order moments. Accordingly, while the conditions i-ii) of Theorem 1
requiring conditional independencies are preserved in Theorem 2, the rest of conditions iii-vi), speciﬁc
for second-order moments, are modiﬁed. Condition iii) of Theorem 2 is analogous to condition
iii) of Theorem 1. It indicates that for U P tU1,4, U3u a dependence with X can exist in the mean
µu|X;S, which will be captured by the regression function, but any other dependence with X in εu|X;S
will create also an nrr-dependence between X and the residuals εy|X;S. The other conditions of
Theorem 1, iv-vi), are already fulﬁlled given the standard assumption of faithfulness for conditional
independencies (Spirtes et al., 2000). This because in Theorem 1 condition iii) and the requirements
in the selection of V3,1 and V1,3,1 only involve conditional variances, and the conditional variance of
Y also depends on the covariance between the different linear contributions in its functional equation.
Conversely, in Theorem 2 condition iii) and the requirements in the selection of V3,1 and V1,3,1 are
conditional independence constraints. Any dependence between X and a subset of variables in S2
or S3 which exists despite X being independent of each of these single variables would violate the
standard assumption of faithfulness for conditional independencies.

For most functional equations, both or none of the CAN forms are obtainable, because the existence
of higher-order dependencies without second-order dependencies imposes restrictive constraints
to the form of the functional equations. However, the speciﬁc cases in which the cv-CAN form
holds and the nrr-CAN form does not may still be stable, in the sense that they do not depend on
a speciﬁc tuning of the distribution of the causes (Janzing and Steudel, 2010). This is because the
independencies required in Theorem 1 and 2 may depend exclusively on the form of the functional
equations. The relation between the fulﬁllment of the cv-CAN form and the nrr-CAN form is thus
qualitatively different than the one of cv-independence faithfulness and nrr-independence faithfulness,
as discussed in relation to Proposition 3. In the latter case, because the violation of faithfulness
regards dependencies with residuals extracted in the direction opposite to the generative functional
equation, cases in which cv-independence faithfulness is violated and nrr-independence faithfulness
is not will occur only for speciﬁc tunings of the distribution of the causes, as discussed above.

Similarly to the formulation based on cv-independencies, the conditions in Eq. 5 are not testable
experimentally, since they involve hidden variables. Again, Theorem 2 serves to identify for which
type of functional equations nrr-independencies will exist as a consequence of the form of the

9

equation, but furthermore a criterion for inference from data has to be introduced. For this purpose
we formulate for nrr-independence an assumption of faithfulness analogous to Assumption 3:

Assumption 4 Nrr-independence faithfulness for non-conditionally-additive-noise functional equa-
tions: ‘if @S1 Ď S the generative functional equation of X, with Y P Pax, does not have
the nrr-CAN form for Y conditioned on S1, then ˆεy|X;S M X for any regression ˆfypX; Sq, with
ˆεy|X;S ” Y ´ ˆfypX; Sq.’

Based on this assumption, we can state a criterion of noncausality using nrr-independencies analogous
to Proposition 4:

Proposition 5 Inferring noncausality with nrr-independence asymmetries: ‘Under the assump-
tion of nrr-independence faithfulness for non-nrr-CAN functional equations (Assumption 4), if
DS and ˆfypX; Sq : ˆεy|X;S K X with ˆεy|X;S ” Y ´ ˆfypX; Sq and ˆεx|Y;S1 M Y for any regression
ˆfxpY; S1q, @S1 Ď S, with ˆεx|Y;S1 ” X ´ ˆfxpY; S1q, then there is no causality from Y to X.’

Proof of Proposition 5: If DS and ˆfypX; Sq : ˆεy|X;S K X with ˆεy|X;S ” Y ´ ˆfypX; Sq, it does not
hold that ˆεy|X;S M X for any ˆfypX; Sq. By assumption 4, this implies that, either Y R Pax or the
functional equation of X has the nrr-CAN form for Y conditioning on S1 for some S1 Ď S. The
latter is discarded since we have ˆεx|Y;S1 M Y for any regression ˆfxpY; S1q, @S1 Ď S. l

This criterion is analogous to the one with cv-independencies. However, because nrr-independencies
are a regression-based approach, there is an extra condition requiring that dependencies hold for any
possible regression. Theoretically, this is an extra requirement to apply nrr-independencies for causal
discovery as opposed to cv-independencies. Pragmatically, this reduces to the requirement of a good
regression model, in the same way that we need a good estimate of the conditional variances. Note
that the use of nonlinear regressions differs from that common in algorithms that infer a global causal
ordering (Mooij et al., 2009). In that approach, a regression takes as predictors all the candidate
parents of a variable. Conversely, here the regression operates on X with all variables in S conditioned,
or at least, regarding the terms in Eq. 7, it has to estimate f1,1 as a function of X and the subset of
variables in V1,1 which does not appear in any other term, while conditioning on the rest. The relation
between a formulation of nrr-independence in terms of conditional regressions and of multivariate
regressions will be further addressed in future work.

5 Examples

We now examine some concrete examples to understand the different possible effects that conditioning
on an extra variable can have to confer the CAN form or remove it from a functional equation. For
that purpose, we ﬁrst consider systems within the class of linear mixed models (LMM) (West et al.,
2007). This widely applied type of models takes into account the existence of random effects, that
is, coefﬁcients of the predictors which are themselves random variables. A functional equation in a
linear mixed model has the form:

Vi “

bikV1k `

(cid:15)ikV2k ` ξi.

ÿ

k

ÿ

k

(10)

The sets of parents V1 “ tV1,1, ..., V1,n1 u and V2 “ tV2,1, ..., V2,n2u can overlap. Here bik
indicates a constant ﬁxed coefﬁcient, while (cid:15)ik indicates a random coefﬁcient, that is, (cid:15)ik is itself a
random variable. For example, (cid:15)ik can represent across-subjects variability in the inﬂuence strength of
a parent variable. All random coefﬁcients are hidden variables. Furthermore, only a subset of V may
be observed. For simplicity, we restrict the examples to Gaussian linear mixed models. Because linear
Gaussian models belong to the special family of Hoyer et al. (2009) for which cv-independencies
symmetrically hold, this has the advantage that in these examples we can relate cv(nrr)-dependencies
only to the presence of random effects introducing nonlinearities in the equations. LMM equations
are only in the AN form if the random coefﬁcients vanish. A CAN form can be obtained conditioning
on the parents in V2. We use LMM models for exemplary purpose because the connection between
random effects and cv(nrr)-dependencies facilitates the explanation. However, as it is clear from
the general form of the functional equations that can have the cv(nrr)-CAN-forms, according to
Theorem 1 and 2, cv(nrr)-independencies will exist in a much wider type of systems than LMM

10

Figure 1: Examples of the effect of conditioning on cv-independencies. The examples represent
Gaussian Linear Mixed Models (Eq. 10), with random coefﬁcients indicated by (cid:15)
ÝÑ. The corresponding
cv-dependencies between X and Y conditioned or unconditioned on Z are collected in Table 1.
Systems with the same causal structure of A) and B) and more general functional equations are
described in Eqs. 11-13.

Table 1: Cv-Independencies in the examples of Figure 1. The last column indicates whether or not it
is possible to infer a potential cause based on the criterion of Proposition 4.

σY|X

A K
B M
C M
D K

σX|Y
M
M
M
K

σY|X,Z
K
K
K
K

σX|Y,Z
M
M
K
M

Yes
Yes
No
No

models. We will later discuss general versions of these examples, sharing the same causal structures
as in Figure 1, but with a more general form of the functional equations. Furthermore, note that the
random coefﬁcients do not play any especial role other than being hidden variables which appear
multiplicatively with the observed variables.

Figure 1 shows examples of different effects that conditioning has on the cv(or nrr)-independencies
asymmetry. For simpliﬁcation from now on we describe these examples referring only to cv-
independencies, but the same reasoning holds for the nrr-independencies. To reﬂect the form of the
(cid:15)
equation in the graphical representation, we indicate by an arrow Vi
ÝÑ Vj the presence of (cid:15)Vi in the
equation of Vj, but as mentioned above the random effects are just hidden variables. We focus on
cv-dependencies between X and Y, conditioned or unconditioned on Z, which are collected in Table
1. In Figure 1A, conditioning on Z does not alter the asymmetry. This is because it is the inﬂuence of
(cid:15)V on Y what leads to a cv-dependence in the direction Y Ñ X. Because V is independent of X, (cid:15)V
acts effectively as a source of noise on Y and the equation of Y has the CAN form for X, conditioned
or unconditioned on Z. (cid:15)V does not have a Gaussian distribution, which brings the distribution of X
and Y out of the special family of Hoyer et al. (2009) and leads to cv-dependencies in the direction
opposite to causality. In this case, if V is observable, the collider V Ñ Y Ð X can be identiﬁed using
conditional independencies. Otherwise, σY|X K X, σX|Y M Y provides new causal information.
In Figure 1B, conditioning on X activates the collider V Ñ X Ð Z, activating a path of dependence
between V and Y. Changes in the mean of V modulate the variance of (cid:15), leading to σY|X M X. In the
opposite direction, again (cid:15)V acts a source of non-Gaussian noise, leading to σX|Y M Y. Conditioning
on Z inactivates the alternative path between V and Y, providing the CAN form to the equation of Y.
The non-Gaussian inﬂuence from (cid:15)V results in the asymmetry σY|X,Z K X, σX|Y,Z M Y.
In Figure 1C, conditioning does not help to ﬁnd an asymmetry. When Z is not conditioned, either
conditioning on X or Y changes the mean of Z, which modulates the variance of (cid:15). After conditioning
Z, the system is reduced to a linear Gaussian model, leading to a symmetry of cv-independencies.
Finally, in Figure 1D, conditioning creates a misleading asymmetry. Because the random effect
only affects Z, without conditioning Z the system is linear Gaussian, resulting in a symmetric cv-
independence. After conditioning Z, a dependence is created between the random effect and both X
and Y. Because Y K Z|X, this dependence is inactivated when further conditioning on X, leading
to σY|X,Z K X. That is, in this case the cv-independence results from a more general conditional
independence. In the opposite direction, Y cannot inactivate the dependence between X and Z

11

(X M Z|Y), and the effect of (cid:15) leads to σX|Y,Z M Y. Because the asymmetry only appears after
conditioning on Z, the extra check of Proposition 4 can detect that it is not reliable to infer a potential
cause from X to Y.

These examples do not cover all possible effects of conditioning, but indicate that conditioning
can maintain an informative asymmetry (Figure 1A), create an informative asymmetry (Figure 1B),
exchange symmetries of cv-dependencies and cv-independencies (Figure 1C), and create a misleading
asymmetry that has to be detected by the extra checks of Proposition 4 (Figure 1D). Note that the
graphs of Figure 1 do not have the structure of DAGs for all variables, since the random effect
variables are assigned to edges instead of nodes. However, the way they provide information about
cv(nrr)-independencies suggests that graphical criteria can be used to read cv(nrr)-independencies. A
formal introduction of graphical criteria will be described in forthcoming work.

We now discuss more general forms of systems that would lead to the cv-independence asymmetries
reported in Table 1A-B, corresponding to the causal structures of Figure 1A-B, that is, the examples
for which it is possible to infer a potential cause from X to Y. The pattern of cv-independencies of
Table 1A is more generally compatible with any system of the form:

Z “ ηz; X “ bxzZ ` ηx; Y “ byxX ` byzZ ` fypV, (cid:15), εyq,

(11)

where η indicates a Gaussian noise. We follow the same notational rule as in Section 4, writing
the functional equations in the most generic form possible given the constraints we require. This
class of systems is more general than Gaussian LMM models since fy can have any form, including
nonlinearities, and εy can be non-Gaussian. This is because, with respect to X, the component
fypV, (cid:15), εyq acts as an additive noise, in agreement with the CAN form of Eq. 8. Furthermore, the
pattern σY|X,Z K X and σX|Y,Z M Y of Table 1A, which by itself allows inferring the potential cause
from X to Y, holds for a larger class of systems compatible with the causal structure of Figure 1A:

Z “ εz; X “ fxpZ, εxq; Y “ fy,1pX, Zq ` fy,2pZ, V, (cid:15), εyq,

(12)

where all noises can have generic distributions and fx, fy1, and fy2 are generic and can be nonlinear.
Again, after conditioning Z, given the causal structure of Figure 1A and the form of the functional
equation of Y in Eq. 12, the cv-CAN form holds according to Theorem 1.

In the same way, the pattern of Table 1B is also obtained for a much wider class of functional
equations compatible with the causal structure of Figure 1B:

Z “ εz; X “ fxpZ, V, (cid:15), εxq; Y “ fy,1pX, Zq ` fy,2pZ, εyq,

(13)

where all noises have generic distributions and fx, fy,1, and fy,2 are generic.

The analysis of these concrete examples illustrates how, when the functional equations are known
or hypothesized, Theorem 1 (or Theorem 2), allow determining which cv(or nrr)-independencies
exist. In application to data, the criterion of Proposition 4 (or Proposition 5) would be applied after
estimating the cv(nrr)-independencies, and the patterns displayed in Table 1 determine whether a
potential cause would be inferred.

6 Post-nonlinear CAN functions

Finally, we also brieﬂy consider how post-nonlinear AN equations (Zhang and Hyvärinen, 2009)
can also be extended to a post-nonlinear CAN form. From Theorem 1 and 2, it is straightforward to
derive the same conditions for CAN post-nonlinear forms, simply considering that the conditions
apply to h´1
i,2 pViq in Eq. 2. However, this class of models can be further generalized. To see this,
consider a functional equation of the form

Y “ h4ph2ph1pX, V1, U1, εyqq ` h3pX, V3, U3qq,
(14)
where both h4 and h2 are nonlinear invertible functions and h1 is a function that has the CAN form
for X given a certain conditioning set S, where X is the parent of interest for which we examine the
causal relation with Y. The equation can be reexpressed as

(15)
If U3 “ H, considering the set S1 “ S Y V3, and using the same notation as in Eq. 8 for the CAN
function h1, Eq. 15 has the form

4 pYq ´ h3pX, V3, U3qq “ h1pX, V1, U1, εyq.

2 ph´1
h´1

hpY, X; S1q “ f pX; S1q ` ξy|S1.

(16)

12

Exploiting a model of this type requires estimating the functions h and f to minimize the information
between X and ˆξy|S1 ” ˆhpY, X; S1q ´ ˆf pX; S1q. If X is not an argument of h3 this reduces to the
same estimation problem studied in Zhang and Hyvärinen (2009), with ˆξy|S1 ” ˆhpY; S1q ´ ˆf pX; S1q.
The form of Eq. 14 suggests a generalization by an iterative composition of two operations. Consider
the operation consisting in an invertible nonlinear univariate transformation gpzq and the operation
consisting in the bivariate sum spz1, z2q “ z1 ` z2. Starting from a function hpX, V, U, εyq that
has the CAN form for X given a certain conditioning set S, a set of invertible nonlinear functions
gipzq i “ 1, ..., m and a set of arguments z2,i “ ˜fipX, Viq, i “ 1, ..., m, the functional equation
of Y can be constructed by the iterative composition starting as g2pg1phq ` z2,1q ` z2,2, with
skpgkpspk´1qpgpk´1q, z2,k´1qq, z2,kq. Because all functions gk are invertible, the functional equation
of Y can be expressed in the form of Eq. 16 by inverting the operations. As in the case of Eq. 14, if X
is not an argument of the functions ˜fk, the expression further simpliﬁes to the form studied in Zhang
tS, V1, ..., Vmu. The same procedure
and Hyvärinen (2009). The required conditioning set is
can be followed replacing the sum operation by the product. This procedure results in increasingly
complex functional equations for which in principle cv-independencies and nrr-independencies can
be tested. In practice, the difﬁculty of the estimation problem of Eq. 16 will depend on the number of
these operations, the extra variables introduced in the functions analogous to h3, as well as on the
number of variables in h1pX, V1, U1, εyq, and the complexity of the functions.

Ť

7 Conclusions

In this paper we extended the theory behind the AN framework for structure learning in several ways.
We ﬁrst introduced an alternative regression-free test of independence. This test does not require
the reconstruction of the additive noise using the residuals of a nonlinear regression. Instead of
testing the independence between the residuals and the parents of a variable (nrr-independencies), it
evaluates indirectly the independence between the noise variance and the parents using conditional
variances (cv-independencies). The use of cv-independencies is expected to be especially useful when
the form of the functional equation is complex. In that case, the family of regression models used
may not be powerful enough to capture the form of the actual dependencies, and thus our indirect
estimate of independencies may be particularly beneﬁcial. On the other hand, the examination
of cv-independencies and nrr-independencies is not mutually exclusive and could be combined to
improve learning.

We formulated all the other contributions of this work both for cv-independencies as well as for nrr-
independencies. In the latter case, the implementation of nonlinear regressions developed in previous
work (see the actual implementations provided by Hoyer et al., 2009; Mooij et al., 2009; Peters et al.,
2014; Bühlmann et al., 2014) can already be applied to implement this extended framework. We
generalized AN models to partial conditionally-additive-noise (CAN) models with hidden variables.
In these models, only some functional equations and only for certain parents have the AN form,
possibly after conditioning. We determined when a functional equation has the CAN form that
results in cv(or nrr)-independencies. Exploiting asymmetries in cv(or nrr)-independencies, we then
introduced a criterion to infer the causal relation between speciﬁc pairs of variables in a multivariate
system with hidden variables, without restrictions on the form of the functional equations. The
criterion can be applied locally, if the CAN form holds for a certain functional equation, and without
inferring a global causal ordering (Mooij et al., 2009). Because the type of functional equations that
have a CAN form is substantially larger than the type of pure additive-noise functional equations, we
can expect that cv(nrr)-independencies induced by the CAN form will exist more often and hence that
in more practical cases the AN framework will increase the inferential power of standard methods
based on conditional independencies. The magnitude of this increase will be speciﬁc to each domain
of application, depending on the properties of the generative functional equations.

The new criterion can readily be applied to complement the existing algorithms that in the presence
of hidden variables extract equivalence classes of causal structures given conditional independencies
(Spirtes et al., 2000; Drton and Maathuis, 2017; Heinze-Deml et al., 2018). Like for any standard rule
of causal orientation used in constraint-based structure learning algorithms (e.g. Spirtes et al., 2000),
this new criterion relies on faithfulness assumptions. While it is an ongoing subject of research to
understand when faithfulness holds (Uhler et al., 2013), only under these types of assumptions the
corresponding analysis of independencies can be applied for structure learning. In future work we will

13

address in full detail how to exploit the new criterion in combination with conditional independencies
as part of a structure learning algorithm.

This research was supported by the NIH Brain Initiative (Grant No. U19 NS107464) and by the
Fondation Bertarelli.

Acknowledgments

Appendix

Proof of Proposition 3

Proof of Proposition 3: We ﬁrst prove that cv-independence faithfulness implies nrr-independence
faithfulness. Consider that a nonlinear regression is implemented such that ˆεy ” Y ´ ˆfypX, Sq
is independent of X despite Y P Pax. Then the statistical model Y “ ˆfypX, Sq ` ˆεy has the
AN form and it follows that σY|X,S K X. Given that ˆεy K X implies σY|X,S K X, inversely
σY|X,S M X implies ˆεy M X. Because cv-independence faithfulness assumes σY|X,S M X @S Ď
NDpXq, PaxzY Ď S, this implies ˆεy M X @S Ď NDpXq, PaxzY Ď S, which corresponds to
the assumption of nrr-independence faithfulness. We now justify that nrr-independence faithfulness
does not imply cv-independence faithfulness. To see this, it sufﬁces to realize that nrr-independence
requires that all moments of the residuals variable ˆεy are independent of X. On the other hand, cv-
independence only requires that the variance of the residuals variable is independent. The distribution
ppˆεy|x, sq can be such that the dependence only appears in the third and higher moments. In that
case, cv-independence holds despite nrr-dependence. l

Proof of Theorem 1 and Theorem 2

We ﬁrst prove the if and only if conditions of Theorem 1 for the functional equation of Y to be in
the cv-CAN form with respect to a parent X given the set S when X is adjacent to all other potential
causes of Y.

Proof of Theorem 1: We proceed justifying the necessary and sufﬁcient requirements for each set
of hidden and observed variables of Eq. 4. First, we need U1,1 “ H because X modulates the
variance of any U P U1,1, since they appear together as arguments of f1,1 in Eq. 4, which is nonlinear.
Also for U P U1,2, dependencies on X produce a change in the variance of f1,2pV1,2, U1,2q
due to nonlinearities, even if V1,2 is conditioned. Because U1,2 are hidden, we have to require
X K Uk|S @Uk P U1,2. For the same reason, we need X K Uk|S @Uk P U2. On the other hand,
the variables U1,4, conditioning on ˜V1,4, contribute linearly to Y, similarly to U3. Accordingly,
to avoid that these terms introduce a dependence of σY|X,S on X, it is required that σUk|X,S K
X @Uk P tU1,4, U3u and that the covariances fulﬁll σZiZj |X,S K X @Zi, Zj P S2, where S2 “
tY1,2, Y2, U1,4, U3u.

Regarding the observable variables, we need V1,1 Ď S because of the nonlinearity of f1,1 such
that X modulates their variance. Similarly, we also need V1,2 Ď S because of the nonlinearity of
f1,2 and also because V P V1,2 can modulate the variance of variables in U1,2. The same holds
to require ˜V1,3 Ď S and ˜V1,4 Ď S. We also need V2 Ď S because any V P V2 modulates the
variance of εy. Regarding V3, because these variables only contribute linearly, we can divide the set
in two groups. The variables in ¯V3 ” tVi P V3 : σVi|X,S K Xu may not need to be conditioned,
because although not independent from X, the dependence does not affect their conditional variance.
Similarly, once we have conditioned on ˜V1,3, the variables V1,3 contribute linearly to Y, and hence
can be divided analogously to V3. The variables in ¯V1,3 ” tVi P V1,3 : σVi|X,S K Xu may
not need to be conditioned. Because V3 and V1,3 are observable there is the option to try to ﬁnd
a valid S conditioning on all of them. Alternatively, we can exclude from the conditioning set
some subsets V3,1 Ď ¯V3 and V1,3,1 Ď ¯V1,3. We complementarily deﬁne V3,2 “ V3zV3,1 and
V1,3,2 “ V1,3zV1,3,1. If V3,1 ‰ H or V1,3,1 ‰ H, we also need to require that the covariance
between any pair of variables from these subsets is not modulated by X. Similarly we need that the
covariance with the other linear terms in S2 is also independent of X. This together guarantees that the

14

linear contributions of the functional equation do not create a dependence of σY|X,S on X. Altogether,
the observable variables to be included in S are tV1,1, V1,2, ˜V1,3, V1,3,2, ˜V1,4, V2, V3,2u. Because
for each set of variables we described the requirements necessary and sufﬁcient to eliminate their
contribution to any dependence of the conditional variance, the fulﬁllment of these requirements
leads to cv-independence. l

Proof of Theorem 2: The proof is analogous to the one of Theorem 1. We only highlight the
differences. In contrast to cv-independence, nrr-independence regards all moments of the residu-
als. According to Eq. 7, the variables Z P tV1,3,1, V3,1, U1,4, U3u contribute linearly to Y after
conditioning on S. The regression will result in a residual for Y that can equally be decomposed
as comprising a contribution from each of these linearly additive terms, which is proportional to
the residual from the separate regression of each Z. That is, the regression ˆfypX; Sq will contain a
component ﬁtted to each conditional mean µz|X;S. Accordingly, the residual of Y has a contribution
from the residuals εz|X;S ” Z ´ µz|X;S, and hence any dependence of Z with X in any moment other
than the mean produces an nrr-dependence between X and the residual of Y. l

The special family of distributions with bidirectional statistical CAN form

We here show that, analogously to the case of pure AN equations studied in Hoyer et al. (2009),
there is a special family of joint distributions ppX, Y|Sq that allows a CAN statistical form in both
directions. The proof relies on the one of Hoyer et al. (2009). It sufﬁces to realize that when the
functional equation of Y admits the CAN form for X given the set S, the bivariate distribution
ppX, Y|Sq, for ﬁxed S, can be expressed in the same form used in the proof of Hoyer et al. (2009). In
particular, using the notation of Eq. 8,

log ppX, Y|Sq “ log pξy|SpY ´ f1,1pX; Sqq ` log ppXq,
which is analogous to Equation 5 in Hoyer et al. (2009). The rest of the proof follows equivalently.

(17)

References

Bühlmann, P., Peters, J., and Ernest, J. (2014). CAM: Causal additive models, high-dimensional

order search and penalized regression. The Annals of Statistics, 42(6):2526–2556.

Drton, M. and Maathuis, M. H. (2017). Structure learning in graphical modeling. Annual Review of

Statistics and Its Application, 4:365–393.

Heinze-Deml, C., Maathuis, M. H., and Meinshausen, N. (2018). Causal structure learning. Annual

Review of Statistics and Its Application, 5:371–391.

Hoyer, P. O., Janzing, D., Mooij, J. M., Peters, J., and Schölkopf, B. (2009). Nonlinear causal
discovery with additive noise models. Proceedings of the 21st Conference on Advances in Neural
Information Processing Systems (NIPS 2008), pages 689–696.

Janzing, D., Peters, J., Mooij, J. M., and Schölkopf, B. (2009). Identifying confounders using additive
noise models. Proceedings of the 25th Annual Conference on Uncertainty in Artiﬁcial Intelligence
(UAI), pages 249–257.

Janzing, D. and Steudel, B. (2010). Justifying additive-noise-model based causal discovery via

algorithmic information theory. Open Systems and Information Dynamics, 17(2):189–212.

Lütkepohl, H. (2006). New introduction to multiple time series analysis. Springer-Verlag, Berlin.

Mooij, J. M., Janzing, D., Peters, J., and Schölkopf, B. (2009). Regression by dependence minimiza-
tion and its application to causal inference. Proceedings of the 26th International Conference on
Machine Learning (ICML), pages 745–752.

Mooij, J. M., Peters, J., Janzing, D., Zscheischler, J., and Schölkopf, B. (2016). Distinguishing cause
from effect using observational data: Methods and benchmarks. Journal of Machine Learning
Research, 17:1–102.

Pearl, J. (2009). Causality: Models, Reasoning, and Inference. Cambridge University Press, New

York, 2nd edition.

15

Peters, J., Janzing, D., and Schölkopf, B. (2017). Elements of causal inference: Foundations and

learning algorithms. MIT Press, Cambridge, MA.

Peters, J., Mooij, J. M., Janzing, D., and Schölkopf, B. (2014). Causal discovery with continuous

additive noise models. Journal of Machine Learning Research, 15:2009–2053.

Spirtes, P., Glymour, C., and Scheines, R. (2000). Causation, Prediction, and Search. MIT Press,

Cambridge, MA, 2nd edition.

Tillman, R., Gretton, A., and Spirtes, P. (2009). Nonlinear directed acyclic structure learning
with weakly additive-noise models. Proceedings of the 22nd Conference on Advances in Neural
Information Processing Systems (NIPS 2009), pages 1847–1855.

Uhler, C., Raskutti, G., Bühlmann, P., and Yu, B. (2013). Geometry of the faithfulness assumption in

causal inference. The Annals of Statistics, 41(2):436–463.

West, B. T., Welch, K. B., and Galecki, A. T. (2007). Linear Mixed Models: A Practical Guide Using

Statistical Software. Chapman and Hall/CRC, New York.

Wibral, M., Vicente, R., and Lizier, J. T. (2014). Directed Information Measures in Neuroscience.

Springer-Verlag, Berlin Heidelberg.

Zhang, K. and Hyvärinen, A. (2009). On the identiﬁability of the post-nonlinear causal model.
Proceedings of the 25th Annual Conference on Uncertainty in Artiﬁcial Intelligence (UAI), pages
647–655.

16

