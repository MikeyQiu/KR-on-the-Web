Defect detection for patterned fabric images based
on GHOG and low-rank decomposition

Chunlei Li(1), Guangshuai Gao(1), Zhoufeng Liu(1), Di Huang(2), Sheng Liu(1), Miao Yu(1)
(1) School of Electronic and Information Engineering, Zhongyuan University of Technology, ZhengZhou 450007,
China
(2) School of Computer Science and Engineering, Beihang University, BeiJing, 100191, China

1

7
1
0
2
 
b
e
F
 
8
1
 
 
]

V
C
.
s
c
[
 
 
1
v
5
5
5
5
0
.
2
0
7
1
:
v
i
X
r
a

Abstract—In order to accurately detect defects in patterned
fabric images, a novel detection algorithm based on Gabor-HOG
(GHOG) and low-rank decomposition is proposed in this paper.
Defect-free pattern fabric images have the speciﬁed direction,
while defects damage their regularity of direction. Therefore,
a direction-aware descriptor is designed, denoted as GHOG, a
combination of Gabor and HOG, which is extremely valuable for
localizing the defect region. Upon devising a powerful directional
descriptor, an efﬁcient low-rank decomposition model is con-
structed to divide the matrix generated by the directional feature
extracted from image blocks into a low-rank matrix (background
information) and a sparse matrix (defect information). A noncon-
vex log det(·) as a smooth surrogate function for the rank instead
of the nuclear norm is also exploited to improve the efﬁciency
of the low-rank model. Moreover, the computational efﬁciency
is further improved by utilizing the alternative direction method
of multipliers (ADMM). Thereafter, the saliency map generated
by the sparse matrix is segmented via the optimal threshold
algorithm to locate the defect regions. Experimental results show
that the proposed method can effectively detect patterned fabric
defects and outperform the state-of-the-art methods.

Index Terms—patterned fabric, defect detection, GHOG, low-

rank decomposition, ADMM.

I. INTRODUCTION

Fabric defect detection always plays a key role in the quality
control of textile industry. Currently, it is mainly performed
visually by skilled workers. However, its reliability is restricted
by eye fatigue and human errors. An automated detection
system based on machine vision can provide a promising
solution that not only minimizes labor costs, but will also
improve accuracy and efﬁciency. Moreover, an automated
system is better equipped to deal with different kinds of fabric
patterns, from the non-motif pattern (plain and twill fabrics,
as shown in Fig.1 (a)) to the motif pattern (star-, box-, and
dot-patterned fabrics, as shown in Fig.1 (b-d)).

Most existing defect detection methods focus on simple
plain and twill fabrics, which can be classiﬁed into four
categories: statistical method [1], frequency analysis method
[2], model method [3], and dictionary learning method [4].

The aforementioned defect detection methods achieve high
detection accuracy. However, because of the complexity and
sophisticated design on patterned fabric, these proposed meth-
ods cannot be extended to detect patterned fabric defects.
Moreover, few studies have been conducted on patterned fabric
so far. In this paper, our research is focused on defect detection
in patterned fabric.

(a)

(b)

(c)

(d)

(a) Plain and twill. (b) Star-patterned fabric.(c) Box-patterned fabric.

Fig. 1.
(d) Dot-patterned fabric.

The patterned fabrics are deﬁned as fabrics with repetitive
patterned units in their designs. Even within the same class
of ’patterned’ fabrics, there are still many categories, and
the pattern sizes are different. Therefore, patterned fabric
defect detection is a challenging task. Traditional methods
cannot efﬁciently recognize the normal pattern; furthermore,
they fail to localize the defect region. Some methods devised
for pattern fabric defect detection, such as the ELO rating
(ER) method [31], and wavelet-preprocessing golden image
subtraction (WGIS) [21], et al.,which are performed in a
supervised approach, require non-defective samples; moreover,
the detection accuracy of these methods depends on precise
alignment and choosing a suitable template.

Visual attention mechanism can enable machine and bio-
logical vision systems to quickly ﬁnd the most salient regions
or objects from a scene [5]. Generally, pattern fabric images
always exhibit a high periodic texture among sub-patterns.
However, the defect will disrupt their periodicity (regularity),
resulting in the defects outstanding from homogeneous back-
ground. Therefore, visual saliency models provide a promising
method for pattern fabric defect detection.

Many saliency models have been proposed to detect salient
objects [5]. A representative series of papers are based on
the low-rank matrix decomposition (LR) theory [6,7]. The
background usually lies in a low-dimensional subspace, while
the objects that are different from the background can be
considered as noises or errors. Therefore, these methods divide
an image into a low-rank matrix plus a sparse matrix in a
learned feature space, where the low-rank matrix represents
the background regions, and the sparse matrix indicates the
salient object regions.

For different kinds of patterned fabrics, the background
of the fabric has a visually homogeneous texture, and any
defects stand out from the background. Compared with object
detection in a natural scene, patterned fabric defect detection

better ﬁts the low-rank decomposition model.

However, using low-rank decomposition directly in a color
space or in some other feature space of images does not
deal with the task of pattern fabric defect detection with any
sort of efﬁciency. This is because sub-parts have different
colors or other features locally, but globally they belong to the
normal texture. Therefore, a new powerful descriptor should
be proposed to efﬁciently characterize the fabric texture, and
should be required to possess the following attributes: (1)
defect regions should have a totally different feature descriptor
compared with the background; (2) the background should
have a similar feature descriptor (that can be easily regarded
as the low-rank part).

Defect-free pattern fabric images have a speciﬁed direction,
while defects damage their regularity of direction. Therefore,
a direction-aware descriptor can better represent the fabric
feature, which is extremely valuable for separating a salient
defect from a non-salient background.

Therefore, in this paper, a direction-aware descriptor, de-
noted as GHOG, is designed to be a combination of Gabor
and HOG. Upon devising a powerful directional descriptor,
an efﬁcient low-rank decomposition model is constructed to
divide the matrix generated by the directional feature extracted
from image blocks into a low-rank matrix (background infor-
mation) and a sparse matrix (defect information). Moreover,
we also propose the use of a non-convex log det() as a smooth
surrogate function for the rank as opposed to the nuclear norm
in order to improve the model’s efﬁciency. Finally, the saliency
map generated by the sparse matrix is segmented to locate the
defect regions.

The reminder of this paper is organized as follows. Section
2 introduces the related works of fabric defect detection.
In Section 3, we focus on the proposed algorithm and its
speciﬁc procedures. Section 4 evaluates the performance of
the proposed algorithm and compares it with other state-of-
the-art methods. Finally, we conclude the paper in Section 5.

II. RELATED WORKS

Defect detection plays an important role in the fabric quality
control process. Many different fabric defect detection meth-
ods have been proposed to solve this problem, and are gen-
erally used to detect defects in plain and twill fabrics. These
methods are divided into the following categories: spatial sta-
tistical analysis, spectral analysis, model-based methods, and
dictionary learning. Spatial statistical methods detect defects
by calculating gray values contrasted with their surroundings,
including histogram character analysis [8], morphology [9],
local contrast enhancement [10], and the fractal method [11].
The detection results of these methods depend largely on the
size of a selected window and its discrimination threshold; it is
difﬁcult to detect smaller sizes defects for them. Additionally,
these methods cannot effectively exploit the image’s global
information, and are always inﬂuenced by noise.

Spectral analysis methods transform the image to the spec-
tral domain by choosing a suitable orthogonal basis, which
can make better use of the image’s global information detect
defects. These methods include the Fourier transform (FT)

2

[12], the Gabor transform [13] and the orthogonal wavelet
transform [14]. However, these methods always have high
computational complexity and poor detection performance for
the complex texture fabric images.

Model-based methods ﬁrst extract image texture features
through modeling and parameter estimation techniques. Defect
detection is realized by discriminating whether the test image
conforms with the normal texture model. Existing methods
include the Gaussian-Markov random ﬁeld (GMRF) [15], and
the Gaussian mixture model (GMM) [16, 17]. These methods
have obtained satisfactory detection performance; however,
they usually share a high computational complexity, and these
methods cannot efﬁciently detect smaller size defects.

Dictionary learning-based methods learn a dictionary of
training images or test images, and then reconstruct the defect-
free fabric image; thereafter, defect detection can be realized
by subtracting the recovered image from the test image [18,
19]. In a different way, dictionary learning based methods also
reduce the dimension of an image block by projecting the im-
age block into a dictionary learning from reference image, then
the SVDD is adopted to discriminate whether an image block
is a defect block [20]. However, these methods are unable to
achieve ideal detection performance because the reconstructed
image by the dictionary learning from themselves may exist
some defects, or the self-adaptability of these methods are
reduced if the dictionary learns from the reference images.

Regarding complicated patterned fabrics, several meth-
ods have been recently published, such as the wavelet-
preprocessing golden image subtraction method (WGIS) [21],
the Bollinger band method (BB)
the regular band
method (RB) [23], template matching for discrepancy mea-
the pattern matching and subtraction
sures (TMPM) [24],
approach [25-28], the Hash function method [29], and the
regularity and local orientation (RLO) method [30].

[22],

The WGIS method utilized a golden image to perform a
moving subtraction of each pixel along each row of every
wavelet-pre-processed tested image. The BB and RB meth-
ods, designed by different combination of moving averages
and standard deviations, utilized the regularity property of a
patterned texture to carry out on dot-, box-and star-patterned
fabrics. The TMPM method used a golden image-like ap-
proach to exploit a discrepancy measure as a ﬁtness function
to detect defectson patterned textures. The patterned matching
and subtraction method performs a point-to-point comparison,
which is inherently sensitive to image noise, misalignment
and distortion. The hash function method utilizes the offset
properties between defect-free and regular patterns to detect
the defects; it is fast but is also sensitive to noise and unable
to show the shape of any defects after segmentation. The ELO
rating (ER) method [31], is a method in which the detection
of fabric defects is similar to carrying out fair matches in the
spirit of good sportsmanship. However, this method depends
on partition size, the number of randomly located partitions,
w-variable and constant K.

The above pattern fabric defect detection methods adopt
traditional approaches to characterize the fabric texture, such
as wavelet transform, Gabor transform, average value, standard
deviation and regular bands. They devised the feature descrip-

tors, but did not consider the characteristics of the pattern
fabric image. On the other hand, most of the complicated
pattern fabric defect detection methods adopted template-
matching technology to localize the defect; they are performed
in a supervised approach. The detection accuracy depends on
precise alignment and choosing a suitable template. There-
fore, in this paper, a powerful direction-aware descriptor was
designed, denoted as GHOG. The descriptor considers the
characteristic of the patterned fabric image, and a low-rank
decomposition model that can better ﬁt the defect detection
problem is adopted to separate the salient defect from the non-
salient background.

III. THE PROPOSED ALGORITHM

Defect-free pattern fabric images have a speciﬁed direction,
while defects damage their regularity of direction. More-
over, compared with the object detection in a natural scene,
patterned fabric defect detection can better ﬁt a low-rank
decomposition model. Therefore, our paper proposes a novel
method of patterned fabric defect detection, based on GHOG
and low-rank decomposition, and it includes the following four
steps: 1) GHOG feature extraction; 2) low-rank decomposition
model construction; 3) optimal solution of the model; 4) the
generation and segmentation of the saliency map.

A. GHOG feature extraction

Highly effective fabric defect detection algorithms should
resort
to meaningful and powerful feature descriptors to
facilitate uniqueness measurements and warrant sufﬁciently
discriminative capabilities. Defect-free patterned fabric images
have a speciﬁed direction, while defects damage their regular-
ity of direction. Therefore, a direction-aware descriptor can
better represent the fabric feature.

Due to the outstanding mathematical properties of the Gabor
ﬁlter and its analogy to human visual mechanisms, the two-
dimensional (2D) Gabor ﬁlter has been widely applied in the
texture analysis. In this paper, a bank of Gabor directional
ﬁlters have been adopted to extract directional information,
and generate the directional Gabor ﬁltered maps.

In addition, the gradient space of an image provides a
measure of change in intensity over the pixels, as opposed
to the absolute values of the pixels’ intensity values. Al-
though the existence of defects destroys the regularity of
a patterned texture, it will have a more enhanced effect in
gradient space domain than in image space domain. As a
consequence, features extracted from gradient space domain
of a defective periodic block will differ signiﬁcantly to those
extracted from a defective-free block. Considering that the
Histogram of Oriented Gradients (HOG) features are extracted
from generated Gabor ﬁltered maps in quantized directions, a
novel Gabor-HOG (GHOG) feature description is proposed
to greatly reduce the feature dimension and to capture the
directional feature. The construction process of the proposed
GHOG descriptor is shown in Figure.2, and the speciﬁc
procedures are described as follows:

3

1) Gabor directional ﬁltered map generation. The com-
plex function expression of a 2-D Gabor ﬁlter is described as
follows [34]:

g (x, y; λ, ψ, σ, γ) = exp

−

Its real part can be formulated as:

x′2 + γ2y′2
2σ2

(cid:19)

x′
λ

exp

2π

+ ψ

i
(cid:18)

(cid:18)

(cid:19)(cid:19)

(1)

(cid:18)

(cid:18)

x′2 + γ2y′2
2σ2

x′
λ

x′
λ

g (x, y; λ, ψ, σ, γ) = exp

−

cos

2π

+ ψ

(cid:19)

(cid:18)

(cid:19)(2)

And its imaginary part is described as:

x′2 + γ2y′2
2σ2

g (x, y; λ, ψ, σ, γ) = exp

−

sin

2π

+ ψ

(cid:18)

(cid:18)

(cid:19)

(cid:19)(3)
where x′ = x cos θ + y sin θ, y′ = −x sin θ + y cos θ, λ
is wave length, which is always greater than or equal to 2,
but not more than 1/5 of the size of the input image; θ
represents directions, their values ranging from 0 to 2π; ψ
indicates phase shift, whose range is from −π to π, 0 and π
correspond to center-on and center-off functions, respectively,
while −π/2 and π/2 correspond to anti-symmetric function; γ
is the length-width ratio, also known as the ratio of the vertical
and the horizontal, which determines the ellipticity of the
Gabor function; if γ = 1, the shape is round, if γ < 1 , shape
stretches along the direction of parallel stripes, in this paper,
γ is set to 0.5; σ is the Gaussian factor standard deviation of
the Gabor function.The value of σ cannot be preset directly,
its change just depends on the variation of the bandwidth b.
b must be a positive constant, which is related to the ratio of
σ/λ, we usually set it as 1. Then the relationship of σ and
λ is σ = 0.56λ. In this paper, empirically, we choose eight
orientations with one scale to ﬁlter the patterned fabric image,
and accordingly generate eight directional ﬁltered maps IGo
(o=1,2,...,N, N=8 here) that capture the directional features.

2) Uniformly sampling for the Gabor ﬁltered maps.
Once these directional ﬁltered maps of all quantized directions
are obtained, they are exploited as the inputs for the next
computing histogram of orientated gradients features over the
same image region. For each generated Gabor ﬁltered map ,
the size of which is the same as the given original image, is
with sizes
equally decomposed into segments
of Nb × Nb ; where o indicts the orientations, and o=1,2,...8,
K is the number of segments, Nb equals 16 in this paper.
3) HOG feature extraction. For each segment I i

, the
HOG is similar to the method described in [35]. The detail
procedures are as follows:

i=1,2...K

I i
Go

Go

(cid:8)

(cid:9)

First of all, normalize the input image block I j
Gi
by gamma rectiﬁcation, and it is described as follows.

obtained

Ho(x, y) = (Ii

Go)gamma

In this paper, gamma is set to 1/2.

Calculate the gradient of image pixels along the horizontal

and vertical directions:

mago(x, y) =

∂Ho(x, y)
∂x

2

+

(cid:19)

(cid:18)

∂Ho(x, y)
∂y

2

(cid:19)

s(cid:18)

(4)

(5)

4

" !" #$%&’()*+’

",-+’

",-+’

",-+’

./(0+’1
%,1)2(/3

./(0+’1
%,1)2(/3

./(0+’1
%,1)2(/3

 !"

 !"

 !"

4+’1,2(5,*(+/

4+’1,2(5,*(+/

4+’1,2(5,*(+/

Fig. 2. Construction process of the proposed GHOG descriptor

θo(x, y) = arctan(

∂Ho(x, y)
∂y

/

∂Ho(x, y)
∂x

)

∂Ho (x, y)
∂x

∂Ho (x, y)
∂y

= Ho (x + 1, y) − Ho (x − 1, y)

= Ho (x, y + 1) − Ho (x, y − 1)

(6)

(7)

(8)

Then each orientation is mapped to the range of [0, 2π] from
that of [−π/2, π/2], which keeps consistent with the number
of the Gabor ﬁlter maps. After quantization, the entry no of
each orientation θo is computed as follows:

no(x, y) = mod(

+

, N ), o = 1, 2, ..., N (9)

θo(x, y)
2π/N

(cid:22)

1
2

(cid:23)

is
The histogram of orientation gradients features, hoi,
constructed as (10) by accumulating the gradient magnitude
mago of all the pixels with the same quantized orientation
entry no.

hoi(j) =

f (no(x, y) = j) ∗ mago(x, y)

(10)

where j =0, 1,..., N-1; o=1,2,...,N; i =1,2,...,K.

X

f (x) =

(cid:26)

1,
0,

if x is true
otherwise

(11)

Then, for each Gabor ﬁltered maps IGo , its HOG features
ho is generated by concatenating all the histograms of all the
segments:

ho = [ho1, ho2, ho3, ..., hoK]T

(12)

The ﬁnal GHOG descriptor is generated by concatenating
all N histogram of HOG features of all segments as (13). Each

histogram ho is normalized to a unit norm vector
the concatenation.

∧
hoK before

GHOGK =

∧

∧
h1K,

h2K, ...,

∧
hN K

(13)

(cid:20)

T

(cid:21)

We deﬁne a feature matrix F as the ﬁnal GHOG descriptors

to represent the information of the entire image.

F = [GHOG1, GHOG2, ..., GHOGK ]

(14)

B. Low-rank decomposition model

Low-rank decomposition and subspace recovery have been
widely used for detection and recognition. This is because
the background of an image always lies in a low-dimensional
subspace, while the objects to be detected are different from
the background can be considered as either noise or errors.
Therefore, these methods divide an image into a low-rank
matrix, plus a sparse matrix in a learned feature space, where
the low-rank matrix represents the background regions, and the
sparse matrix indicates the salient object regions. For different
the fabric’s background has a visually
kinds of patterns,
homogeneous texture, and the defects stand out. Compared
with object detection in a natural scene, the patterned fabric
defect detection better ﬁts the low-rank decomposition model.
Therefore, in this paper, the low-rank decomposition model is
proposed to detect the defect region.

For the aforementioned generated feature matrix F , a low-

rank decomposition model is constructed as follows:

(L∗, S∗) = arg min
(L,S)

(rank (L) + λ kSk0 )

s.t. F = L + S

(15)

where L is a low-rank matrix, indicating the background, i.e.,
repeated patterns. S is a sparse matrix, and it represents the
defective objects.

Since the above problem is NP-hard, it is difﬁcult to ap-
proximate the optimal solution of (7), so the convex surrogate
is adopted as follows:

(L∗, S∗) = arg min
(L,S)

(kLk∗ + λ kSk1) s.t. = L + S

(16)
where kLk∗ is the nuclear norm of L, k . k1 indicates the l1
norm, λ is a weighted factor that controls the low-rank and
sparsity degree.

Using the nuclear norm as a convex surrogate in the ﬁrst
term of Eq. (8), i.e., rank minimization problem is correct,
while non-convex optimization toward the rank minimization
problem could lead to better recovery results.

In this paper, a smooth but non-convex surrogate of the
rank is adopted instead of the nuclear norm. For a given

matrix with a symmetric positive semi-deﬁnite X ∈ Rn×n, the
rank minimization problem can be approximately surrogate by
minimizing the following equation [34]:

E(X, ξ) = log det(X + ξI)

(17)

where ξ is a positive scalar. E (X, ξ) approximates the sum
of the logarithm of singular values, thus it is smooth and non-
convex. The log det as a non-convex surrogate of the rank
has also been more carefully proofed from an information-
theoretic perspective. As shown in Figure 3, the surrogate
function E (X, ξ) can better approximate the rank than the
nuclear norm.

x

*

!
 
L x, 
! "
rank x

Fig. 3. Comparison of L (x, ξ), rank (x),

x

∗ in the case of a scalar.
k

k

For the low-rank matrix L, Eq.(9) is rewritten as follows:

L(L, ξ) = log det((LLT )1/2 + ξI)
−1 + ξI)
= log det(U Σ1/2U
= log det(Σ1/2 + ξI)

(18)

where Σ is the diagonal matrix whose diagonal elements are
eigenvalues of matrix LLT , i.e., LLT = U ΣU −1, meanwhile,
Σ1/2 is also the diagonal matrix whose diagonal elements are
the singular values of the matrix L. Hence, L (L, ξ) is a log
det() surrogate function of rank (L) obtained by setting X =
1/2. Finally, Eq.(8) can be rewritten as follows:
LLT

(cid:0)

∗

∗

(cid:1)
, S

(L

) = arg min
(L,S)

(L(L, ξ) + λ kSk1) s.t. F = L + S

(19)

C. Optimal solution of the model

The alternative direction method of multipliers (ADMM)
demonstrates a good balance between efﬁciency and accuracy
in solving optimization problems. In this paper, ADMM has
been adopted to solve Eq. (11).

The Augmented Lagrange Multiplier function of Eq.(11) is

as follows:

L(L, S, Z) = L(L, ξ) + λ kSk1 +

kL + S − F k2
F

β
2
− hZ, L + S − F i

(20)

where Z ∈ Rm×n is the multiplier of the linear constraint,
β > 0 is the penalty parameter for the violation of the
linear constraint, h·i is the inner product and k·kF is the
induced Frobenius norm. The proposed objective function can
be solved by alternatively minimizing the objective function

5

(21)

with respect to the L, S and the multiplier Z. It can be
described as solving the following three sub-problems:

Lk+1 = arg minL L(L, Sk, Zk; β)
Sk+1 = arg minS L(Lk+1, S, Zk; β)
Zk+1 = Zk − β (Lk+1 + Sk+1 − F )




For the ﬁrst sub-problem in (13) which solves for L at ﬁxed
S and Z, it can be explicitly represented as the following form:



∗

L

= arg min

L

n0

j=1

X

log(σj (L) + ξ) +

kL + S − F k2
F

β
2
− hZ, L + S − F i

(22)

where n0 = min {m, n}, and σj (L) indicates the j-th singular
value of L. For simplicity, we use σj to denote σj (L) . Even
n
j=1 log (σj + ξ) is non-convex, it can be solved by
though
utilizing a local minimization approach. We deﬁne the equality
n
j=1 log (σj + ξ). Then f (σ) can be approximated
f (σ) =
by using its ﬁrst-order Taylor expansion, as follows:

P

P
f (σ) = f

σ(k)

+

∇f

σ(k)

, σ − σ(k)

(23)

where σ(k)
Therefore, Eq.(14) can be solved by iteratively solving:

is the solution obtained in the k-th iteration.

(cid:16)

(cid:17)

D

(cid:16)

(cid:17)

E

L(k+1) = arg min

L + S − F −

β
2

L

(24)

(cid:13)
(cid:13)
(cid:13)
(cid:13)

+

n

j=1

X

2

F

Z
β
(cid:13)
σj
(cid:13)
(cid:13)
σ(k)
(cid:13)
j + ξ
n0
j=1

where we use the fact that ∇f (σ(k)) =
ignore the constants in Eq.(14). For convenience, we rewrite
Eq.(16) as:

1
σ(k)
j +ξ

and

P

2

Z
β

1
2

L(k+1) = arg min

L + S − F −

+ τ ϕ

L, ω(k)

L

F

(cid:13)
(cid:13)
(cid:13)
(cid:13)

(cid:17)(25)
j σj indicates a weighted
where τ = 1/β. ϕ(L, ω) =
nuclear norm whose weights ω(k)
. Note that
P
the weights are ascending, since the singular values σj are
ordered in a descending order.

(cid:13)
(cid:13)
(cid:13)
(cid:13)
σ(k)
j + ξ
(cid:16)

j ω(k)
j = 1/

n0

(cid:17)

(cid:16)

In general, for a real matrix, the weighted nuclear norm is
a convex function only if the weights are descending, and the
optimal solution to Eq. (17) is obtained by a weighted sin-
gular value thresholding operator, referred to as the proximal
operator. In this paper, the weights are ascending, thus Eq.
(17) is non-convex. It is therefore difﬁcult to ﬁnd its global
minimizer. Nevertheless, we could ﬁnd that
the weighted
singular value thresholding gives one minimizer to Eq. (17)
via Theorem 1 (Proximal Operator of Weighted Nuclear Norm)
[35]. According to this Theorem, we can obtain the low-rank
matrix at the (k + 1)-th iteration by

L(k+1) = U

Σ − τ diag

ω(k)

V T

(26)

(cid:16)

(cid:16)

+

(cid:17)(cid:17)

where U ΣV T is the SVD of the feature matrix F , and ω(k)
j =
. Even though the weighted thresholding is only
1/
a local minimizer, it always leads to a decrease in the objective

σ(k)
j + ξ
(cid:16)

(cid:17)

function value. In this paper, the initial value ω(0)
[1, 1, ...1]T .

is set to

After solving the low-rank matrix L, the sparse matrix S
can be solved by ﬁxing L and Z. Indeed, we can easily obtain
the solution using the widely-used shrinkage problem [36]:

Sk+1 =

1
β
where PΩγ/β
Ωγ/β

∞

Z k − Lk + F − PΩγ/β

∞

Z k − Lk + F

(27)

indicts the Euclidean projection onto:

(cid:21)

1
β

(cid:20)

∞ :=

X ∈ Rn×n |−γ/β ≤ Xij ≤ γ/β

(28)

Then the multipliers Z can be updated as follows:

(cid:8)

(cid:9)

Z k+1 = Z k − β(Lk+1 + Sk+1 − F )

(29)

D. The generation and segmentation of the saliency map

Saliency map generation. After decomposing the feature
matrix F of the given patterned fabric image into the low-
rank matrix L, which corresponds to the patterned fabric
background, and a sparse matrix S, which corresponds to the
defective regions by the aforementioned methods. A saliency
map M is generated by the l1-norm of each column Si in S,
and it is described as follows:

M (Ii) = kSik1

(30)

The larger value of M (Ii) indicates that the block Ii has

higher probability of being defective.

The segmentation of saliency map.
1). Denoise the saliency map M to generate a new saliency

map

∧
M

∧
M = g ∗ (M ◦ M )

(31)

where g is the radius of the circular smoothing ﬁlter and ”◦”
denotes the Hadamard inner product operator and ”*” is the
convolution operator.

2). Transform the saliency map

∧
M into a gray-scale image

G

∧
M − min(

∧
M )

G =

∧
M ) − min(
3). Segment G by using improved adaptive threshold algo-

∧
M )

max(

× 255

(32)

rithm [37] to locate the defect regions.

IV. EXPERIMENTAL RESULTS AND ANALYSIS

In order to verify the effectiveness of the proposed algo-
rithm, we chose images from the dot-, box-, and star-patterned
fabric databases for performance evaluation. The size of the
fabric image is 512 pixels × 512 pixels. The dot-patterned
fabric database contains 30 defect-free and 30 defective im-
ages, the star-patterned fabric database contains 25 defect-
free and 25 defective images, and the box-patterned fabric
database contains 30 defect-free and 26 defective images. All
the defective images have a corresponding ground-truth that
shows the defect-free regions as black and defective regions as
white. All experiments in this paper were implemented in an
Inter(R) Core(TM) i3-2120 3.3GHZCPU environment, using
software MATLAB 2011a.

6

A. Qualitative Results
The test patterned fabric image matrix was divided into
the superposition of two parts, i.e., a low-rank matrix and a
sparse matrix, and the visual saliency map was generated from
the sparse matrix and outstands the defective regions. Thus a
simple threshold method can easily localize the defect region.
The feature extraction method and detection model are
equally important for fabric defect detection. In order to
validate the effectiveness of our method, we ﬁrstly compared
the saliency maps generated by different descriptors, including
Gabor [32], HOG [33], and different detection models, such
as the template matching model (TMM) [38] and the context
analysis model (CAM) [39] with our method, as shown in
Figure 4. The ﬁrst column consists of the original images,
the second column consists of saliency maps generated by
the Gabor feature [32] and the LR detection model, the third
column consists of the saliency maps generated by the HOG
feature [33] and the LR detection model, the fourth column
consists of the saliency maps generated by the GHOG feature
and the TMM [38] detection model, the ﬁfth column consists
of the saliency maps generated by the GHOG feature and the
CAM [39] detection model, and the last column consists of
the saliency maps generated by our method (GHOG feature
and the LR detection model). From the second column and the
third column in Figure 4, we can conclude that the detection
result based on the Gabor or HOG features cannot outstand
the defect region for star-patterned fabric and box-patterned
fabric images, but they can outstand the detect region for
dot-patterned fabric images. On the other hand, from the
fourth column and the ﬁfth column in Figure 4, the saliency
map generated by the GHOG feature and the TMM or CAM
detection models cannot outstand the defect region. In the last
column we can see that the saliency map generated by our
method can efﬁciently outstand the defect region for all the
three types of images. And the performance of these methods
can be concluded as Table1.

From Figure 4 and Table 1, we can see that the proposed
defection method based on GHOG and LR is suitable for
pattern fabric defect detection.

In addition, we compared our method with some state of
the art visual saliency models, including the wavelet transform
(WT) method [40], the prior guided least squares regression
method (PGLSR) [41], the textural differential visual saliency
model (TDVSM) [38] and the local statistic features and global
saliency analysis model (LSF-GSA) [39].

As is shown in Figure 5, WT [40] ﬁrst transformed the
image into a frequency domain, then generated the saliency
map by analyzing the wavelet coefﬁcient. However, even in
a normal background with a complicated pattern, its wavelet
coefﬁcients are larger, which will lead to incorrect detection
results. The PGLSR method [41] could effectively detect
defects in the patterned fabric, but similarities in texture
between the background and the defect lead to inaccurate
shape descriptions of the defects. In Li et al. [38], saliency
was calculated by comparing their textural features with the
average texture features, it obtains a successful performance
for fabric images with a stochastic texture, while the method
fails to detect defects in a patterned fabric image, especially

7

 

 

 

(a) Saliency map for star-patterned fabric image

(b) Saliency map for box-patterned fabric imagec

(c) Saliency map for dot-patterned fabric image

Fig. 4. The saliency maps generated by different features and detection model. The ﬁrst column shows the original images, the second column shows saliency
maps generated by Gabor [32] with the LR model (Gabor + LR), the third column shows the saliency maps generated by HOG [33] with LR model (HOG
+ LR), the fourth column shows the saliency maps generated by TDVSM [38](GHOG + TDVSM), the ﬁfth column shows the saliency maps generated by
LSF-GSA [39](GHOG + LSF-GSA), and the last column shows the saliency maps generated by our method(GHOG + LR).

8

(33)

(34)

TABLE I
COMPARISONS WITH OTHER METHODS

Methods/ fabric image
star-patterned
box-patterned
dot-patterned

×
×
√

Gabor+LR

HOG+LR

GHOG+TMM

GHOG+CAM

×
×
√

×
×
×

×
×
×

GHOG+LR
√
√
√

in box-patterned fabrics, as shown in Figure.5(b). Liu et al.
[39] detected fabric defects by using the local statistic feature
and global saliency analysis, while the detection results have
a large amount of noise. Our method generates a saliency
map by combining the GHOG feature descriptor with a
low-rank decomposition model, and it effectively highlights
the defect regions. Subsequently, the detection results are
obtained by segmenting the generated saliency map. In order
to further verify the effectiveness of our proposed method,
we compared our detection method with the existing fabric
detection algorithm. Because most of the traditional detection
methods are invalid for detecting patterned fabric defect, in this
paper, we only compared the proposed method with the other
two valid detection methods for detecting patterned fabrics.
The experimental results are described in Figure 6, where
the white pixels represent the defect regions, and the black
pixels represent the background. The ﬁrst row represents the
detection results generated by PGLSR [41], the second row
represents the detection results generated by LSF-GSA [39],
the third row indicates the detection results generated by our
method and the last row indicates the ground-truth images. In
Figure 6, we can see that the other two methods (as shown in
the ﬁrst two rows) can almost localize the defect region, but
the detected shape of the defect is different from the ground
truth. Our detection results (as shown in the third row) are
similar to the ground truth (as shown in the last row), can
efﬁciently localize the defect regions, and the detected shape
of the defect is similar to the ground truth. This demonstrates
our proposed method is superior to the other two methods.

B. Quantitative Evaluations
In order to further evaluate the performance of our proposed
method, the receiver operating characteristic curve (ROC) is
adopted, as shown in Figure 7. Figure.7(a) shows the ROC
curves of star-patterned fabric images, Figure.7(b) shows the
ROC curves of box-patterned fabric images, and Figure.7(c)
shows the ROC curves of dot-patterned fabric images. From
Figure 7(a) and (b), we can see that our method outperforms
the other three methods for star-patterned and box-patterned
fabrics. This demonstrates the effectiveness of our proposed
method. However, our proposed method is unsatisfactory re-
garding dot-patterned fabrics, as shown in Figure.7(c). The
proposed GHOG feature is orientation-aware, while the orien-
tation features of the dot-patterned fabric are indistinct; there-
fore, GHOG is not enough to characterize the dot-patterned
fabric. In fact, for most of the fabric samples, they are weaved
using warp and weft, and have distinct directions.

In addition, some other statistical parameters, such as true
positive (TP), true negative (TN), false positive (FP), false
negative (FN), are adopted in this paper, originally proposed
by Ng.et.al [42]. Based on these parameters, some measure

metrics, such as precision, are calculated as:

and recall is calculated as:

precision =

T P
T P + F P

recall =

T P
T P + F N

As shown in Figure 8, we can see that

the proposed
approach not only provided the highest rate in recall but also
provided a balanced performance with respect to precision.
Figure 9 takes into account both recall and precision, and
adopts the criteria of the F-measure. Additionally, it also
demonstrates the effectiveness of our proposed method.

F = 2

precision · recall
precision + recall

(35)

V. CONCLUSION

In this paper, we proposed a novel patterned fabric defect al-
gorithm based on GHOG and low-rank decomposition. GHOG
descriptor is adopted to extract the features of the patterned
fabric image, and the proposed low-rank model is adopted
to decompose the fabric image into normal background and
defect, respectively. Experimental results demonstrate that
the proposed method can efﬁciently and correctly locate the
defect region, and show that our approach outperforms other
state-of-the-art methods. In the future, additional theoretical
development will be beneﬁcial for defect detection in the glass
surface, rail surface, etc.

ACKNOWLEDGMENT

This work was supported by the National Natural Science
Foundation of China (No.61202499, No.61379113), Science
and technology innovation talent project of Education De-
partment of Henan Province(17HASTIT019), Science and
technology leader project of Zhengzhou City(131PLJRC643).
In addition, the authors would like to thank Dr. Henry Y.T.
Ngan, Industrial Automation Research Laboratory, Dept. of
Electrical and Electronic Engineering, The University of Hong
Kong, for providing the database of patterned fabric images.

REFERENCES

[1] Selver, M. A., Avsar, V., & ¨Ozdemir, H. (2014). Textural fabric defect
texture transformations and gradient search.

detection using statistical
Journal of the Textile Institute, 105(9), 998-1007.

[2] Jing, J. (2015). Automatic defect detection of patterned fabric via com-
bining the optimal gabor ﬁlter and golden image subtraction. Journal of
Fiber Bioengineering & Informatics, 8, 229-239.

9

 

 

 

(a) Saliency map for star-patterned fabric image

(b) Saliency map for box-patterned fabric image

(c) Saliency map for dot-patterned fabric image

Fig. 5. The saliency maps of our method compared with other state-of-the-art saliency models. The ﬁrst column shows the original images, the second column
shows saliency maps generated by WT [40], the third column shows the saliency maps generated by PGLSR [41], the fourth column shows the saliency maps
generated by TDVSM [38], the sixth column shows the saliency maps generated by LSF-GSA [39], and the last column shows the saliency maps generated
by our method.

10

 

 

 

(a) Detection result for star-patterned fabric image

(b) Detection result for box-patterned fabric image

Fig. 6. Detection results of our method compared with other fabric defect detection methods. The ﬁrst row shows the detection results of PGLSR method,
the second row shows the detection results of LSF-GSA method, the third row shows the detection results of our method, the last row shows the ground-truth
images.

(c) Detection result for dot-patterned fabric image

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

e
t
a
r
 
e
v
i
t
i
s
o
p
 
e
u
r
T

i

i

n
o
s
c
e
r
P

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0
 
0

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

 

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

e
t
a
r
 
e
v
i
t
i
s
o
p
 
e
u
r
T

i

i

n
o
s
c
e
r
P

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0
 
0

 Star−patterned ROC Curve

Box−patterned ROC Curve

Dot−patterned ROC Curve

 

PGLSR
TDVSM
LSF−GSA
Ours

 

PGLSR
TDVSM
LSF−GSA
Ours

11

 

PGLSR
TDVSM
LSF−GSA
Ours

0
 
0

0.2

0.6
0.4
False positive rate

0.8

1

0
 
0

0.2

0.8

1

0
 
0

0.2

0.6
0.4
False positive rate

0.6
0.4
False positive rate

0.8

1

(a) Star-patterned ROC curves

(b) Box-patterned ROC curves

(c) Dot-patterned ROC curves

Fig. 7. ROC curves of patterned fabric images compared with other detection methods. (a) ROC curves of the Star-patterned fabric images. (b) ROC curves
of the Box-patterned fabric images. (c) ROC curves of the Dot-patterned fabric images.

Star−patterned fabircs PR−Curve

Box−patterned fabircs PR−Curve

Dot−patterned fabircs PR−Curve

 

PGLSR
TDVSM
LSF−GSA
Ours

 

PGLSR
TDVSM
LSF−GSA
Ours

 

PGLSR
TDVSM
LSF−GSA
Ours

0.2

0.4

0.6

0.8

1

0.2

0.4

0.6

0.8

1

0.2

0.4

0.6

0.8

1

Recall

Recall

Recall

(a) Star-patterned PR curves

(b) Box-patterned PR curves

(c) Dot-patterned PR curves

Fig. 8. ROC curves of patterned fabric images compared with other detection methods. (a) ROC curves of star-patterned fabric images. (b) ROC curves of
box-patterned fabric images. (c) ROC curves of dot-patterned fabric images.

F−measure

Institute, 105(3), 223-234.

 

PGLSR
TDVSM
LSF−GSA
Ours

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

e
t
a
r
 
e
v
i
t
i
s
o
p
 
e
u
r
T

i

i

n
o
s
c
e
r
P

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0
 
0

[5] Borji, A., & Itti, L. State-of-the-art in visual attention modeling. Pattern
Analysis and Machine Intelligence, IEEE Transactions on,2013, 35(1),
185-207.

[6] Lang C, Liu G, Yu J, et al. Saliency detection by multitask sparsity pursuit

[J]. Image Processing, IEEE Transactions on, 2012, 21(3): 1327-1338.

[7] Chen C, Li S, Qin H, et al. Structure-Sensitive Saliency Detection via
Multilevel Rank Analysis in Intrinsic Feature Space[J]. Image Processing,
IEEE Transactions on, 2015, 24(8): 2303-2316.

[8] Selver, M. A., Avsar, V., & ¨Ozdemir, H. Textural fabric defect detection
using statistical texture transformations and gradient search [J]. Journal of
Thoracic Oncology Ofﬁcial Publication of the International Association
for the Study of Lung Cancer, 2014, 6(105):2017-2023.

[9] Hu J, He Z, Weng G, et al. Detection of chemical fabric defects on the
basis of morphological processing [J]. Journal of the Textile Institute,
2015:1-9.

[10] Guan S, Shi H, Zhao T. Image segmentation of fabric defect based on
object rarity feature [J].Textile Research Journal, 2015,36(11): 45-50.
[11] Hanmandlu M, Choudhury D, Dash S. Detection of defects in fabrics
using topothesy fractal dimension features [J]. Signal, Image and Video
Processing, 2015, 9(7): 1521-1530.

[12] Sakhare K, Kulkarni A, Kumbhakarn M, et al. Spectral and spatial do-
main approach for fabric defect detection and classiﬁcation [C]//Industrial
Instrumentation and Control (ICIC), 2015 International Conference on.
IEEE, 2015: 640-644.

[13] Jing J, Chen S, Li P. Automatic Defect Detection of Patterned Fabric via
Combining the Optimal Gabor Filter and Golden Image Subtraction [J].
Journal of Fiber Bioengineering and Informatics, 2015, 8(2): 229-239.

[14] Wen Z, Cao J, Liu X, et al. Fabric defects detection using adaptive
wavelets [J]. International Journal of Clothing Science and Technology,
2014, 26(3): 202-211.

[15] Xiaobo Y. Fabric defect detection of statistic aberration feature based

on GMRF model [J]. Journal of Textile Research, 2013, 4: 026.

star−patterned

box−patterned

dot−patterned

Fig. 9. The F-measure of our method compared with other methods.

[3] Allili, M. S., Baaziz, N., & Mejri, M. (2014). Texture modeling using
contourlets and ﬁnite mixtures of generalized gaussian distributions and
applications. Multimedia IEEE Transactions on, 16(3), 772-784.

[4] Zhou, J., Semenovich, D., Sowmya, A., & Wang, J. (2014). Dictionary
learning framework for fabric defect detection. Journal of the Textile

12

[41] Cao J, Zhang J, Wen Z, et al. Fabric defect inspection using prior
knowledge guided least squares regression [J]. Multimedia Tools and
Applications, 2015: 1-17.

[42] Ng M K, Ngan H Y T, Yuan X, et al. Patterned Fabric Inspection
and Visualization by the Method of Image Decomposition[J]. IEEE
Transactions on Automation Science & Engineering, 2014, 11(3):943-
947.

[16] Li M, Cui S, Xie Z. Application of Gaussian mixture model on defect

detection of print fabric [J]. Journal of Textile Research, 2015, 8: 019.

[17] Allili M S, Baaziz N, Mejri M. Texture modeling using contourlets and
ﬁnite mixtures of generalized Gaussian distributions and applications [J].
Multimedia, IEEE Transactions on, 2014, 16(3): 772-784.

[18] Zhou J, Wang J. Fabric defect detection using adaptive dictionaries [J].

Textile Research Journal, 2013.

[19] Qu T, Zou L, Zhang Q, et al. Defect detection on the fabric with complex
texture via dual-scale over-complete dictionary [J]. The Journal of The
Textile Institute, 2015: 1-14.

[20] Zhou J, Semenovich D, Sowmya A, et al. Dictionary learning framework
for fabric defect detection [J]. The Journal of The Textile Institute, 2014,
105(3): 223-234.

[21] Ngan H Y T, Pang G K H, Yung S P, et al. Wavelet based methods
on patterned fabric defect detection [J]. Pattern recognition, 2005, 38(4):
559-576.

[22] Ngan H Y T, Pang G K H. Novel method for patterned fabric inspection
using Bollinger bands [J]. Optical Engineering, 2006, 45(8): 087202-
087202-15.

[23] Ngan H Y T, Pang G K H. Regularity analysis for patterned texture
inspection [J]. Automation Science and Engineering, IEEE Transactions
on, 2009, 6(1): 131-144.

[24] G. Stubl, J.-L. Bouchot, P. Haslinger, B. Moser, Discrepancy norm as
ﬁtness function for defect detection on regularly textured surfaces, LNCS
7476 (2012) 428-437.

[25] Costa M F M, Rodrigues F, Guedes J, et al. Automated evaluation
of patterned fabrics for defect detection [C]//Education and Training in
Optics and Photonics (ETOP’99). International Society for Optics and
Photonics, 2000: 403-407.

[26] Sanby C, Norton-Wayne L, Harwood R. The automated inspection of
lace using machine vision [J]. Mechatronics, 1995, 5(2): 215-231.
[27] Farooq U, King T, Gaskell P H, et al. Machine vision using image data
feedback for fault detection in complex deformable webs [J]. Transactions
of the Institute of Measurement and Control, 2004, 26(2): 119-137.
[28] Cano J, Perez J C, Valiente J M, et al. Textile inspection with a parallel
computer cluster [C]//5th Int. Conf. Quality Control by Artiﬁcial Vision
(QCAV-2001), Le Creusot, France. 2001.

[29] Baykal I C, Muscedere R, Jullien G A. On the use of hash functions
for defect detection in textures for in-camera web inspection systems
[C]//Circuits and Systems, 2002. ISCAS 2002. IEEE International Sym-
posium on. IEEE, 2002, 5: V-665-V-668 vol. 5.

[30] Chetverikov D, Hanbury A. Finding defects in texture using regularity
and local orientation [J]. Pattern Recognition, 2002, 35(10): 2165-2180.
[31] Tsang C S C, Ngan H Y T, Pang G K H. Fabric inspection based on
the Elo rating method [J]. Pattern Recognition, 2016, 51: 378-394.
[32] Kruizinga P, Petkov N, Grigorescu S E. Comparison of Texture Features
Based on Gabor Filters [J]. IEEE Transactions on Image Processing, 1999,
11(10):142-147.

[33] Dalal N, Triggs B. Triggs, B.: Histograms of Oriented Gradients for
Human Detection. In: CVPR [J]. Proceedings / CVPR, IEEE Computer
Society Conference on Computer Vision and Pattern Recognition. IEEE
Computer Society Conference on Computer Vision and Pattern Recogni-
tion, 2005, 1(12):886-893 vol. 1.

[34] Fazel M, Hindi H, Boyd S P. Log-det heuristic for matrix rank min-
imization with applications to Hankel and Euclidean distance matrices
[C]//American Control Conference, 2003. Proceedings of the 2003. IEEE,
2003, 3: 2156-2162.

[35] Dong W, Shi G, Li X, et al. Compressive sensing via nonlocal low-rank
regularization [J]. Image Processing, IEEE Transactions on, 2014, 23(8):
3618-3632.

[36] Tibshirani R. Regression shrinkage and selection via the lasso [J].
Journal of the Royal Statistical Society. Series B (Methodological), 1996:
267-288.

[37] Zhoufeng L, Jiuge W, Quanjun Z, et al. Research on fabric defect detec-
tion algorithm based on improved adaptive threshold [J]. Microcomputer
& Its Applications, 2013, 10: 016.

[38] LI C, ZHANG Z, LIU Z, et al. A novel fabric defect detection
algorithm based on textural differential visual saliency model [J]. Journal
of Shandong University (Engineering Science), 2014, 44(4): 1-9.

[39] LIU Z, ZHAO Q, LI C, et al. Fabric defect detection algorithm using
local statistic features and global saliency analysis [J]. Journal of Textile
Research, 2014, 11: 013.

[40] Imamo glu N, Lin W, Fang Y. A saliency detection model using low-level
features based on wavelet transform [J]. Multimedia, IEEE Transactions
on, 2013, 15(1): 96-105.

