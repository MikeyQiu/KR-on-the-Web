8
1
0
2
 
v
o
N
 
5
1
 
 
]
I
S
.
s
c
[
 
 
1
v
1
2
3
6
0
.
1
1
8
1
:
v
i
X
r
a

MULTIVARIATE SPATIOTEMPORAL HAWKES PROCESSES AND
NETWORK RECONSTRUCTION∗

BAICHUAN YUAN† , HAO LI† , ANDREA L. BERTOZZI† , P. JEFFREY BRANTINGHAM‡ ,
AND MASON A. PORTER†

Abstract. There is often latent network structure in spatial and temporal data and the tools of
network analysis can yield fascinating insights into such data. In this paper, we develop a nonpara-
metric method for network reconstruction from spatiotemporal data sets using multivariate Hawkes
processes.
In contrast to prior work on network reconstruction with point-process models, which
has often focused on exclusively temporal information, our approach uses both temporal and spatial
information and does not assume a speciﬁc parametric form of network dynamics. This leads to an
eﬀective way of recovering an underlying network. We illustrate our approach using both synthetic
networks and networks constructed from real-world data sets (a location-based social media network,
a narrative of crime events, and violent gang crimes). Our results demonstrate that, in comparison
to using only temporal data, our spatiotemporal approach yields improved network reconstruction,
providing a basis for meaningful subsequent analysis — such as community structure and motif
analysis — of the reconstructed networks.

Key words. Multivariate Hawkes processes, community structure, spatiotemporal data, social

networks, motifs

AMS subject classiﬁcations. 60G55, 62H11, 91D30

1. Introduction. Digital devices such as smartphones and tablets generate a
massive amount of spatiotemporal data about human activities, providing a won-
derful opportunity for researchers to gain insight into human dynamics through our
“digital footprints”. A broad variety of human activities are analyzed using such data,
creating new disciplines [36] such as computational social science and digital human-
ities. Examples of such activities include online check-ins in large cities [14], eﬀects
of human mobility [6] and currency ﬂow [11] on the spread of contagious diseases,
online communications during Occupy Wall Street [15], crime reports in Los Angeles
county [31], and many others.

Network analysis is a powerful approach for representing and analyzing complex
systems of interacting components [49], and network-based methods can provide con-
siderable insights into the structure and dynamics of complex spatiotemporal data [8].
It has been valuable for studies of both digital human footprints and human mobil-
ity [7]. To give one recent example, Noulas et al. [51] studied geographic online social
networks to illustrate similarities and heterogeneities in human mobility patterns.

Suppose that each node in a network represents an entity, and that the edges
(which can be either undirected or directed, and can be either unweighted or weighted)
represent spatiotemporal connections between pairs of entities. For instance, in a
check-in data set from a social medium, one can model each user as a node, which
has associated check-in time and locations. In this case, one can suppose that an edge
exists between a pair of users if they follow each other on the social medium. One can
use edge weights to quantify the amount of “inﬂuence” between users, where a larger

∗Submitted to the editors DATE.
Funding: This work is supported by NSF grant DMS-1417674, NSF grant DMS-1737770, and

DARPA grant FA8750-18-2-0066.

†Department of Mathematics, University of California, Los Angeles, Los Angeles, CA
(byuan@math.ucla.edu, lihao0809@math.ucla.edu, bertozzi@math.ucla.edu, mason@math.ucla.edu).
‡Department of Anthropology, University of California, Los Angeles, Los Angeles, CA (brant-

ing@ucla.edu).

1

2

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

weight signiﬁes a larger impact. In our investigation, we assume that the relationships
between nodes are time-independent.1 In some cases, the entities and relationships
are both known, and one can investigate the structure and dynamics of the associated
networks. However, in many situations, network data is incomplete — with potentially
a large amount of missing data, in the form of missing entities, interactions, and/or
metadata [66] — and the relationships between nodes may not be directly observable
[60]. For example, social-media companies attempt to infer friendship relationships
among their users to provide accurate friendship recommendations for online social
networks.

In the last few years, there has been a considerable amount of work on inferring
missing data (both structure and weights) in networks. A basic approach for inferring
relationships among entities is to calculate cross-correlations of their associated time
series [35]. Another approach is to use coeﬃcients from a generalized linear model
(GLM) [47], a generalization of linear regression that allows response variables to
have a non-Gaussian error-distribution. Recently, people have begun to use point-
process methods [63] in network reconstruction. For example, Perry and Wolfe [55]
modeled networks as a multivariate point process and then inferred covariate-based
edges (both their existence and their weights) by estimating a point process. Among
point-process models, it is very popular to use Hawkes processes (also known as self-
exciting point processes2 ) for studying human dynamics [22, 38]. Hawkes-process
models are characterized by mutual “triggering” among events [52], as one event may
increase the probability for subsequent events to occur. Such models can capture
inhomogeneous inter-event times and causal (temporal) correlations, which have both
been observed in human dynamics [30]. These properties make it a useful approach
in social-network applications [28].
It thus seems promising to use such processes
for network inference on dynamic human data, such as crime events or online social
activity. For example, Linderman and Adams [38] proposed a fully-bayesian Hawkes
model that they reported to be more accurate for their data at inferring missing
edges than GLMs, cross-correlations, and a simple self-exciting point process with an
exponential kernel. Very recently, self-exciting point processes were applied in [68] to
reconstruct multilayer networks [29], a generalization of ordinary graphs. However,
the aforementioned temporal point-process models are not without limitations. For
example, most of these models do not use spatial information, even when it plays
a signiﬁcant role in a system’s dynamics. Furthermore, many assume an a priori
model [38] or a speciﬁc parametrization [69] for their point processes.

In the present paper, we propose a nonparametric and multivariate version of the
spatiotemporal Hawkes process. Spatiotemporal Hawkes processes have been used
previously to study numerous topics, including crime [44], social media [34], and
earthquake prediction [21]. In our model, each node in a network is associated with
a spatiotemporal Hawkes process. The nodes can “trigger” each other, so events
that are associated with one node increase the probability that there will be events
associated with the other nodes. We measure the extent of such mutual-triggering
eﬀects using a U × U “triggering matrix” K, where U is the number of nodes.
If
one considers an exclusively temporal scenario, a point process u does not “cause”
(in the Granger sense [23]) a point process v if and only if K(u, v) = 0 [19]. Because
triggering between point processes reﬂects an underlying connection, one can try to

1For other regimes of relative time scales between spatiotemporal processes and network dynam-

ics, it is necessary to consider time-dependent edges [26, 56].
2We use these terms interchangeably in this paper.

SPATIOTEMPORAL HAWKES PROCESSES AND NETWORK RECONSTRUCTION

3

recover latent relationships in a network from K. Such triggering should decrease
with both distance and time according to some spatial and temporal kernels. In our
work, instead of assuming exponential decay [22] or some other distribution [38, 69],
we adopt a nonparametric approach [41] to learn both spatial and temporal kernels
from data using an expectation-maximization-type (EM-type) algorithm [72].

We compare our approach with other recent point-process network-reconstruction
methods [22, 38] on both synthetic and real-world data sets with spatial information.
Our two examples of the latter data sets come from a location-based social-networking
website and crime topics. We illustrate the importance both of incorporating spatial
information and of using nonparametric kernels. Although we assume that the rela-
tionships among nodes are time-independent, our model still recovers a causal struc-
ture among events in synthetic data sets. We also build event-causality networks on
data sets about violent crimes of gangs and examine gang retaliation patterns using
motif analysis.

Our paper proceeds as follows. In section 2, we review self-exciting point pro-
In section 3,
cesses and recent point-process methods for network reconstruction.
we introduce our nonparametric spatiotemporal model and our approaches to model
estimation and simulation. In section 4, we compare our model with others on both
synthetic and real-world data sets. We conclude in section 5. We give details about
our preprocessing for the social-networking website data set in Appendix A.

2. Self-Exciting Point Processes. A point process S is a random measure on
a complete separable metric space that takes values on {0, 1, 2, . . .} ∪ {∞} [61]. We
ﬁrst consider a temporal point process, which consists of a list {t1, t2, . . . , tN } of N
time points, with corresponding events 1, 2, . . . , N . Let S[a, b) denote the number
of points (i.e., events) that occur in a ﬁnite time interval [a, b), with a < b. One
typically models the behavior of a simple temporal point process (multiple events
cannot occur at the same time) by specifying its conditional intensity function λ(t),
which represents the rate at which events are expected to occur around a particular
time t, conditional on the prior history of the point process before time t. Speciﬁcally,
when Ht = {ti|ti < t} is the history of the process up to time t, one deﬁnes the
conditional intensity function

λ(t) = lim
∆t↓0

E[S[t, t + ∆t)|Ht]
∆t

.

One important point-process model is a Poisson process, in which the number of points
in any time interval follows a Poisson distribution and the number of points in disjoint
sets are independent. A Poisson process is called homogeneous if λ(t) ≡ constant and
is thus characterized by a constant rate at which events are expected to occur per unit
time. It is called inhomogeneous if the conditional intensity function λ(t) depends on
the time t (e.g., λ(t) = sin(t)). In both situations, the numbers of points (i.e., events)
in disjoint intervals are independent random variables.

We now discuss self-exciting point processes, which allow one to examine a notion
of causality in a point process. If we consider a list {t1, t2, . . . , tN } of time stamps,
we say that a point process is self-exciting if

Cov [S(tk−1, tk), S(tk, tk+1)] > 0 for k such that

tk−1 < tk < tk+1 .

That is, if an event occurs, another event becomes more likely to occur locally in time.
A univariate temporal Hawkes process has the following conditional intensity func-

4

tion:

(2.1)

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

λ(t) = µ(t) + K

g(t − tk) ,

(cid:88)

tk<t

where the background rate µ(t) can either be a constant or a time-dependent function
that describes how the likelihood of some process (crimes, e-mails, tweets, and so on)
evolves in time. For example, violent crimes are more likely to happen at night than
during the day, and business e-mails are less likely to be sent during the weekend
than on a weekday. One can construe the rate µ(t) as a process that designates the
likelihood of an event to occur, independent of the other events. The summation term
in Equation (2.1) describes the self-excitation: past events increase the current con-
ditional intensity. The function g(t) is called the triggering kernel, and the parameter
K denotes the mean number of events that are triggered by an event. One standard
example is a Hawkes process with an exponential kernel g(t) = ωe−ωt, where ω is
a constant decay rate for the triggering kernel that controls how fast the rate λ(t)
returns to its baseline level µ(t) after an event occurs.

2.1. Temporal Multivariate Models. In network reconstruction, one seeks to
infer the relationships (i.e., edges) and the strengths of such relationships (i.e., edge
weights) among a set of entities (i.e., nodes). When modeling the relationships in a
network, it is more appropriate to use a multivariate point process than a univariate
one. In a temporal multivariate point process, there are U diﬀerent point processes
(Su)u=1,...,U , and the corresponding conditional intensity functions are (λu(t))u=1,...,U .
We seek to infer the intensity functions from observed data (tj, uj)j=1,...,N in a time
window [0, T ], where tj and uj, respectively, are the time and point-process index of
event j. There are numerous applications of temporal multivariate point processes,
such as ﬁnancial markets [5], real-time crime forecasting [73] and neural spike trains
[12]. Here we focus on the speciﬁc application of network reconstruction.

A trivial example of a multivariate point process is the multivariate Poisson pro-
cess, in which each point process is a univariate Poisson process. Another example is
the multivariate Cox process, which consists of doubly stochastic Poisson processes
in which the conditional intensity itself is a stochastic process. Perry and Wolfe [55]
used a Cox process to model e-mail interactions (edges) among a set of users (nodes).
Neither the multivariate Poisson nor the multivariate Cox process are self-exciting.

Instead of modeling edges as Cox processes, Fox et al. [22] used multivariate
Hawkes processes to model people (nodes) communicating with each other via e-mail.
Their conditional intensity function has an exponential kernel and a nonparametric
background function µu(t) for each person (process) u:

(2.2)

λu(t) = µu(t) +

Kuiuωe−ω(t−ti) ,

(cid:88)

ti<t

where Kuv = K(u, v) is the expected number of events of person v that are triggered
by one event of person u. One can estimate the set of parameters Θ by minimizing
the negative log-likelihood function

(2.3)

− log(L(Θ)) = −

log(λuk (tk)) +

λu(t)dt .

N
(cid:88)

k=1

U
(cid:88)

(cid:90) T

u=1

0

Recall that uk is the point process associated with event k.

SPATIOTEMPORAL HAWKES PROCESSES AND NETWORK RECONSTRUCTION

5

There are several variants of the multivariate Hawkes process. One is to add reg-
ularization terms to Equation (2.3) to improve the accuracy of parameter estimation.
Lewis and Mohler [37] used maximum-penalized likelihood estimation, which enforces
some regularity on the model parameters, to infer Hawkes processes. Zhou et al. [74]
extended this idea and promoted the low-rank and sparsity properties of K by adding
nuclear and L1 norms of K to Equation (2.3) with the conditional intensity function
λu(t) from Equation (2.2). Linderman et al. [38] added random-graph priors on K
and developed a fully Bayesian multivariate Hawkes model. See [40] for theoretical
guarantees on inferring Hawkes processes with a regularizer. Another research direc-
tion is to speed up the parameter estimation of point-process models. For example,
Hall et al. [25] tried to learn the triggering matrix K via an online learning frame-
work for streaming data. Instead of using a likelihood-based method, Achab et al. [2]
developed a fast moment-matching method to estimate the matrix K.

2.2. Spatiotemporal Point Processes. Many real-world data sets include not
only time stamps but also accompanying spatial information, which can be particu-
larly important for correctly inferring and understanding the associated dynamics [8].
In earthquakes, for example, most aftershocks usually occur geographically near the
main shock [53]. In online social media, if two people often check in at the same loca-
tion at closely proximate times, there is more likely to be a connection between them
than if such “joint check-ins” occur rarely [14]. These situations suggest that it is im-
portant to examine spatiotemporal point processes, rather than just temporal ones.
Indeed, there are myriad applications of spatiotemporal Hawkes processes, including
crime prediction [44], seismology [53], and Twitter topics [34]. The successful em-
ployment of such processes in earthquake prediction and predictive policing [45] have
helped inspire our work, in which we extend these ideas to network reconstruction.

We characterize a spatiotemporal point process S(t, x, y) via its conditional in-
tensity λ(t, x, y), which is the expected rate of the accumulation of points around a
particular spatiotemporal location. Given the history Ht of all points up to time t,
we write

λ(t, x, y) =

lim
∆t,∆x,∆y↓0

(cid:18) E [S{(t, t + ∆t) × (x, x + ∆x) × (y, y + ∆y)}|Ht]
∆t ∆x ∆y

(cid:19)

.

For the purpose of modeling earthquakes, [53] used a self-exciting point process with
a conditional intensity of the form

λ(t, x, y) = µ(x, y) +

g(x − xi, y − yi, t − ti) .

(cid:88)

t>ti

In this setting, if an earthquake occurs, aftershocks are more likely to occur locally
in time and space. The choice of the triggering kernel g(t, x, y) is inspired by phys-
ical properties of earthquakes. For example, [53] used a modiﬁed Omori formula (a
power law) [52] to describe the frequency of aftershocks per unit time. In sociological
applications, there is no direct theory to indicate appropriate choices for the kernel
function. Some researchers have chosen speciﬁc kernels (e.g., exponential kernels)
that are easy to compute. For example, Tita et al. [69] used a spatiotemporal point
process to infer missing information about event participants. They modeled inter-
actions between event participants as a combination of a spatial Gaussian mixture
model and a temporal Hawkes process with an exponential kernel. A key problem is
how to justify kernel choices in speciﬁc applications.

6

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

3. Spatiotemporal Models for Network Reconstruction. Many network-
reconstruction methods using self-exciting point processes, such as [22, 38], have in-
ferred time-independent relationships (i.e., edges) among entities (i.e., nodes) with
corresponding (exclusively) temporal point processes. Entity (process) u is adjacent
to v if K(u, v) > 0, where one estimates the triggering matrix K from the data. Entity
u is not adjacent to v if entity u’s point process does not cause entity v’s point process
in time (in the Granger sense [19]). For many problems, it is desirable — or even
crucial — to incorporate spatial information [8, 16]. For example, spatial information
is an important part of online ﬁngerprints in human activity, and it has a signiﬁcant
impact on most other social networks. In crime modeling, for example, there is a “near
repeat” phenomenon in crime locations, indicating the necessity of including spatial
information. Speciﬁcally, the spatial neighborhood of an initial burglary has a higher
risk of repeat victimization than more-distant locations [62]. In our work, we propose
multivariate spatiotemporal Hawkes processes to infer relationships in networks and
provide a novel approach for analyzing spatiotemporal dynamics.

Another important issue is the assumptions on triggering kernels for a Hawkes
process. In seismology, for example, researchers attempt to use an underlying physical
model to help determine a good kernel. However, it is much more diﬃcult to validate
such models in social networks than for physical or even biological phenomena [57].
The content of social data is often unclear, and there is often little understanding of
the underlying mechanisms that produce them. With less direct knowledge of possible
triggering kernels, it is helpful to employ a data-driven method for kernel selection.
Using a kernel with an inappropriate decay rate may lead to either underestimation
or overestimation of the elements in the triggering matrix K, which may also include
false negatives or positives in the inferred relationships between entities. Therefore,
we ultimately use a nonparametric approach to learn triggering kernels in various
applications to avoid a priori assumptions about a speciﬁc parametrization.

A multivariate spatiotemporal Hawkes process is a sequence {(ti, xi, yi, ui)}N
i=1
with N events, where ti and (xi, yi) are spatiotemporal stamps and ui is the point-
process index of event i. Each of the U nodes is a marginal process. The conditional
intensity function for node u is

(3.1)

λu(t, x, y) = µu(x, y) +

Kuiug(x − xi, y − yi, t − ti) .

(cid:88)

t>ti

The above Hawkes process assumes that each node u has a background Poisson pro-
cess that is constant in time but inhomogeneous in space with conditional intensity
µu(x, y). There is also self-excitation, as past events increase the likelihood of subse-
quent events. We quantify the amount of impact that events associated with node ui
have on subsequent events of node uj with a spatiotemporal kernel and the element
K(ui, uj) = Kuiuj of the triggering matrix.

3.1. A Parametric Model. We ﬁrst propose a multivariate Hawkes process
with a speciﬁc parametric form. We use this model to generate spatiotemporal events
on synthetic networks and provide a form of “ground truth” that we can use later.

The background rate µu and the triggering kernel g for Equation (3.1) are given

SPATIOTEMPORAL HAWKES PROCESSES AND NETWORK RECONSTRUCTION

7

by

g(x, y, t) = g1(t) × g2(x, y) = ω exp (−ωt) ×

µu(x, y) =

N
(cid:88)

i=1

βuiu
2πη2T

(cid:18)

× exp

−

(cid:18)

−

x2 + y2
2σ2

(cid:19)

,

1
2πσ2 exp
(cid:19)
(x − xi)2 + (y − yi)2
2η2

.

For simplicity, we use exponential decay in time [52] and a Gaussian kernel in space
[43]. We let T denote the time window of a data set; Kuiu denote the mean number of
the events in process u that are triggered by each event in the process ui; the quantity
βuiu denote the extent to which events in process ui contribute to the background rate
for events in the process u; and σ and η, respectively, denote the standard deviations
in the triggering kernel and background rate. The value of σ determines the spreading
scale of the triggering eﬀect in space.

3.2. A Nonparametric Model. With the conditional intensity given in Equa-
tion (3.1), we estimate the triggering kernel g(x, y, t) = g1(t) × g2(x, y) nonparamet-
rically using histogram estimators [41]. We assume that g2 is isotropic, which entails
that g2(x, y) = g2(r), where r = (cid:112)x2 + y2. We let h(r) be the spatial triggering
kernel in the polar coordinate: h(r) = 2πrg2(r). We extend the background rate that
was proposed in [21] to the multivariate case and write

(3.2)

µu(x, y) = γuτ (x, y) =

γu
T

N
(cid:88)

i=1

pii
2πd2
i

(cid:18)

exp

−

(x − xi)2 + (y − yi)2
2d2
i

(cid:19)

,

where γu is the background intensity of process u and pii is the probability that event
i is a background event (i.e., it is not triggered by any event). We compute di by
determining the radius of the smallest disk centered at (xi, yi) that includes at least
np other events and is at least as large as some small value (cid:15) that represents the error
in location.

Once we ﬁt the model to spatiotemporal data, the triggering matrix K gives
our inferences for the underlying relationships between entities. For two entities u
and v, the matrix element K(u, v) indicates a mixture of temporal causality and
spatial dependence between them. In inferring latent relationships in a network, we
assume that entity u is not related to v if K(u, v) = 0. We threshold the matrix
K at a certain level: we set elements that are smaller than the threshold value to
0 and either maintain the values of larger or equal elements to obtain a weighted
network or set them to 1 to produce an unweighted network. We use ˜K to denote
the thresholded matrix K. We interpret that there is no relation between two nodes
u and v if ˜K(u, v) = ˜K(v, u) = 0.

3.3. Model Estimation. We use an EM-type algorithm [72] to estimate the
parameters and kernel functions of our model. This EM-type algorithm gives us
an iterative method to ﬁnd maximum-likelihood estimates of the parameters. We
assume that the original model depends on unobservable latent variables. Suppose
that we have data X and want to estimate parameters Θ. One can view the likelihood
function L(Θ; X) as the marginal likelihood function of L(Θ; Y, X), where Y is a latent
variable. We call L(Θ; Y, X) the “complete-data likelihood function” and L(Θ; X) the
“incomplete-data likelihood function”. Because both Y and L(Θ; Y, X) are random
variables, we cannot estimate them directly. Therefore, we consider the following

8

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

expectation function:

(3.3)

Q(Θ, Θi−1) = E (cid:2)log(L(Θ; Y, X))|X, Θi−1(cid:3)

(cid:90)

=

log(L(Θ; Y, X))f (Y |X, Θi−1)dY ,

where f (Y |X, Θi−1) is the probability density function of Y , given the data X and
Θi−1. We update parameters by solving the following equation:

ˆΘi = arg max
Θ

Q(Θ, Θi−1) .

3.3.1. Parametric Model. The log-likelihood for the parametric model deﬁned

in Equation (3.1) in a spatial region R and time window [0, T ] is

(3.4)

log(L(Θ; X)) =

log(λuk (tk)) −

λu(t) dt dx dy .

N
(cid:88)

k=1

U
(cid:88)

u=1

(cid:90) (cid:90)

(cid:90) T

R

0

We deﬁne random variables Yij and Y b

ij using the approach from [43]. If event j
triggers event i via the kernel g, then Yij = 1; otherwise, Yij = 0. The equality Y b
ij = 1
indicates that event i is triggered by event j at a background rate of µ. We deﬁne two
expectation matrices P(i, j) = pij = E[Yij] and Pb(i, j) = pb
ij]. We convert
the incomplete-data log-likelihood function in (3.4) into the following complete-data
log-likelihood function:

ij = E[Y b

log(L(Θ; X, Y )) =

Yij log (cid:0)Kuiuj g(ti − tj, xi − xj, yi − yj)(cid:1) −

U
(cid:88)

N
(cid:88)

u=1

i=1

βuui

(cid:88)

j<i

−

U
(cid:88)

N
(cid:88)

u=1

i=1

(cid:16)

1 − e−w(T −ti)(cid:17)

+

Kuiu

Y b
ij log(µui) .

N
(cid:88)

N
(cid:88)

i=1

j=1

We then calculate the expectation function using (3.3) to obtain

Q(Θ) =

pb
ij log

(cid:18) βuj ui
2πη2T

(cid:18)

exp

−

(xi − xj)2 + (yi − yj)2
2η2

(cid:19)(cid:19)

U
(cid:88)

N
(cid:88)

−

(cid:18)

pij log

ωKuj uie−ω(ti−tj )

1
2πσ2 exp

(cid:18)

−

u=1

i=1
(xi − xj)2 + (yi − yj)2
2σ2

βuiu

(cid:19)(cid:19)

N
(cid:88)

N
(cid:88)

i=1

j=1

+

(cid:88)

j<i

U
(cid:88)

N
(cid:88)

−

u=1

i=1

(cid:16)

1 − e−w(T −ti)(cid:17)

.

Kuiu

We perform the maximization step of the EM-type algorithm (a projected gradient
ascent) [37] directly by taking derivatives with respect to the parameters and setting
them to 0. For the expectation step, we use the “optimal” parameter values from
the prior maximization step to update the probabilities pij and pb
ij. By (alternately)
iterating these the expectation and maximization steps, we obtain Algorithm 3.1 for
the parametric model. For initialization, we sample Θ0, pij, and pb
ij uniformly at
random. Note additionally that pij = 0 for i > j.

SPATIOTEMPORAL HAWKES PROCESSES AND NETWORK RECONSTRUCTION

9

Algorithm 3.1 EM-type Algorithm for the Parametric Model
1: Inputs: point process: {(ui, ti, xi, yi)}N
uv }U

i=1; initial guesses for parameters: Θ(0) =
and {p(0)
termination

u,v=1, σ(0), ω(0)(cid:17)

u,v=1, {β(0)

i,j=1, {pb,(0)

}N
i,j=1;

ij }N

(cid:16)

ij

{K (0)
uv }U
threshold: (cid:15).

2: Outputs: model parameters Θ = (cid:0){Kuv}U
3: Initialize δ = 1 and k = 0.
4: while δ > (cid:15) do
5:
6: Expectation step: for i, j ∈ {1, 2, · · · , N },

Let η2,(k) and σ2,(k) be the value of η2 and σ2 at the kth iteration.

u,v=1, {βuv}U

u,v=1, σ, ω(cid:1).

ij = (cid:0)Kuj uig (ti − tj, xi − xj, yi − yj)(cid:1) /λ (xi, yi, ti) .
p(k)
− (xj −xi)2+(yj −yi)2
ij = β(k)
pb,(k)
2η2,(k)

uj ui exp

/2πη2,(k)T λ(xi, yi, ti) .

(cid:16)

(cid:17)

9: Maximization step: for u, ˆu ∈ {1, 2, · · · , U },

ω(k+1) =

(cid:80)
ij (ti − tj) + (cid:80)U

j<i p(k)
ij
(cid:80)N
i=1 Kuiu(T − ti)e−ω(T −ti)

,

(cid:80)

j<i p(k)

(cid:16)

l=1

(cid:80)

/ (cid:80)n ˆu
l=1

u=1
Let nu denote the number of events in point process u; and let iu
{1, . . . , nu}, index the events for process u.
ˆuu = (cid:80)nu
K (k+1)
ˆuu = (cid:80)nu
β(k+1)
i=1
σ2,(k+1) = (cid:80)N
η2,(k+1) = σ2,(k+1) .
δ = (cid:107)Θ(k) − Θ(k+1)(cid:107) .
k = k + 1.

ti ˆu
<tiu
l
ˆl
(cid:80)n ˆu
j=1 pb,(k)
iu
l i ˆu
ˆl
(cid:16)
ij + p(k)
pb,(k)

(cid:17) (cid:0)(xi − xj)2 + (yi − yj)2(cid:1) / (cid:80)N

p(k)
iu
l i ˆu
ˆl
/nˆu .

T − ti ˆu
ˆl

1 − exp

i,j=1 2

(cid:17)(cid:17)(cid:17)

−w

i,j=1

(cid:16)

(cid:16)

ij

,

l , with l ∈

(cid:16)
ij + p(k)
pb,(k)

ij

(cid:17)

.

7:

8:

10:

11:

12:

13:

14:
15:
16:
17: end while

3.3.2. Nonparametric Model. The log-likelihood function of the nonparamet-
ric model is the same as for the parametric model in Equation (3.4). We use a similar
approach as before to derive an EM-type algorithm for the nonparametric model. The
main diﬀerences are that (1) only Yij are latent variables and Yii = 1 signiﬁes that
event i is a background event, whereas Yji = 1 signiﬁes that event i is triggered by
event j; and (2) we assume that the triggering kernels g1(t) and g2(r) are piecewise
temporal bins and nbins
constant functions. We discretize space and time into nbins
spatial bins, and the kernel takes a constant value in each spatiotemporal bin.

r

t

To formally present the EM-type algorithm (see Algorithm 3.2), we borrow nota-
tion from [21]. Let Ck denote the set of event pairs (i, j) for which tj − ti belongs to
the kth temporal bin, Dk denote the set of event pairs (i, j) for which rij (the distance
between nodes i and j) belongs to the kth spatial bin, Nu denote the number of events
that include node u, the parameter ∆tk denote the size of the kth temporal bin, and
∆rk denote the size of the kth spatial bin.

3.4. Simulations. To generate synthetic data for model comparisons, we need
to simulate self-exciting point processes with the conditional intensity in Equation
(3.1) for each process u. We use the branching structures [76] of self-exciting point
processes to develop Algorithm 3.3 for our simulations.

4. Numerical Experiments and Results. We apply our algorithm to both
synthetic and real-world data sets to demonstrate the usefulness of incorporating spa-

10

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

Algorithm 3.2 EM-type Algorithm for our Nonparametric Model

1: Inputs:
{K (0)
uv }U

point process:
ij }N

u,v=1 and {p(0)

i,j=1; termination threshold: (cid:15).

{(ui, ti, xi, yi)}N

i=1;

initial guesses of parameters:

2: Outputs: model parameters: {Kuv}U

u,v=1; triggering probability between events:

{pij}N

i,j=1; temporal triggering kernel: g1; spatial triggering kernel: g2.

S τ η(x, y)ds dt = Z (η) for a

3: Initialize δ = 1 and η = 0 .
4: while δ > (cid:15) do
5: Update background kernel τ η(x, y) (see (3.2))
6:

ii /Z (η) , where Z (η) satisﬁes (cid:82) T

u = (cid:80)
γ(η)
bounded spatial domain S and for u ∈ {1, . . . , U }.
ij /Nu for u, v ∈ {1, . . . , U }.

ui=u p(η)

(cid:80)

(cid:82)(cid:82)

0

uj =v p(η)
p(η)
ij /∆tk
p(η)
ij /∆rk

i,j∈Ck

i,j∈Dk

8:

ui=u

uv = (cid:80)
7: K (η)
1 (t) = (cid:80)
g(η)
h(η)(r) = (cid:80)
h(η)(r)/(2πr) .
= K (η)
p(η+1)
ij

9:

uiuj g(η)

10:
11: Normalize p(η+1)
δ = maxi,j (cid:107)p(η+1)

12:
13: end while

ij

ij

(cid:80)

i<j p(η)
(cid:80)
i<j p(η)

ij

ij

for t in the kth temporal bin.
for r in the kth spatial bin. Set g(η)

2 (r) =

1 (tj − ti)g(η)
so that (cid:80)N
− p(η)

2 (rij) for i < j and p(η+1)
i=1 p(η+1)
ij (cid:107) and η = η + 1.

jj
= 1 for any j.

ij

= µ(η)

uj (xj, yj).

Algorithm 3.3 Simulation of a Multivariate Hawkes Process
1: Inputs: time-window size: T ; spatial region: S ⊂ R2; background rate: {γu}U

u=1;
u,v=1; temporal and spatial triggering kernels: g1(t),

triggering matrix: {Kuv}U
g2(x, y) .

2: Output: point process: C = {(ui, ti, xi, yi)}N
i=1 .
3: Initialize an empty set C and an empty stack Q.
4: Generate background events:
5: Draw Nu, the number of background events of type u, from a Poisson distribu-

tion with parameter λ = γuT for each u ≤ U .

6: Add each background event i ≤ (cid:80)U

u=1 Nu — i.e., (xi, yi, ti, ui) — to the set C
and the stack Q, where (xi, yi, ti) is drawn from the uniform spatiotemporal
distribution over the time interval [0, T ] and a bounded spatial region S.

7: Generate triggered events:
8: while Q is not empty do
9:
10:

Remove the most recently added element (xi, yi, ti, ui) from the stack Q.
Draw Ni, the number of events triggered by event i, from a Poisson distribu-
tion with parameter λi = (cid:80)U
Generate events (xk, yk, tk, uk) for each k ≤ Ni as follows:

u(cid:48)=1 Kuiu(cid:48).

Sample tk, (xk, yk) and uk according to g1(t − ti), g2(x − xi, y − yi), and
P (uk = ˜u) = Kui ˜u
(cid:80)U
Add (xk, yk, tk, uk) to the set C.
if tk ≤ T then

, respectively.

v=1 Kuiv

Add the element (xk, yk, tk, uk) to the stack Q.

11:

12:

13:
14:
15:
16:

17:

end if
end while

SPATIOTEMPORAL HAWKES PROCESSES AND NETWORK RECONSTRUCTION 11

tial information and of our nonparametric approach. We consider a synthetic data
set in subsection 4.1, a Gowalla data set in subsection 4.2, a crime-topic network
data set in subsection 4.3, and a violent gang-crime data set in subsection 4.4. Using
the ﬁrst three of these data sets, we compare our nonparametric model (“Nonpara-
metric Hawkes”) with the Bayesian Hawkes model3 in [38] (“Bayesian Hawkes”), the
exclusively temporal Hawkes model with kernel g(t) = ω exp(−ωt) from [22] (“Tem-
poral Hawkes”), and the parametric spatiotemporal model detailed in subsection 3.1
(“Parametric Hawkes”). We make comparisons by examining how well the following
properties are recovered in the inferred triggering matrix: (1) symmetry and reci-
procity; (2) existence of edges; and (3) community structure. We also demonstrate
the ability of our algorithm to infer the triggering kernel g. Using the fourth data
set (see subsection 4.4), we study a network of crime events using a violent gang-
crime data set. We examine relations between crime events and repeated triggering
patterns.

4.1. Synthetic Data. We ﬁrst generate synthetic triggering matrices K using
a weighted stochastic block model (WSBM) [3, 54]. We assign a network’s nodes to
four sets (called “communities”) and assign edges to adjacency-matrix blocks based
on the set memberships of the nodes. Two of the communities consist of ten nodes
each, and the other two communities consist of ﬁve nodes each. For each edge, we ﬁrst
draw a Bernoulli random variable to determine whether it exists, and we then draw
an exponential random variable to determine the weight of the edge (if it exists). The
parameter of the Bernoulli random variable is 0.68 for there to be an edge between
nodes from the same community and 0.2 for an edge between nodes from diﬀerent
communities. The decay-rate parameter for the exponential random variable in these
two situations is 0.1 and 0.01, respectively. By construction, our triggering matrices
are symmetric.

The triggering matrices that we generate in this way are not guaranteed to sat-
isfy the stability condition for Hawkes processes; this condition is that the largest-
magnitude eigenvalue of K is smaller than one [17]. When this condition is satisﬁed,
each event has, almost surely, ﬁnitely many subsequent events as “oﬀspring”. In our
work, we discard any simulated adjacency matrix that does not satisfy the stabil-
(With our choices of the
ity condition, and we generate a new one to replace it.
parameters, we discard about 65% of the generated adjacency matrices.)

With each triggering matrix K, we use Algorithm 3.3 to simulate a multivariate
spatiotemporal Hawkes process with our parametric model in subsection 3.1 with
ω = 0.6, σ2 = 0.3, T = 250, S = [0, 1] × [0, 1], and a homogeneous value γu = 0.2 for
all nodes u. We then reconstruct the underlying networks and the triggering kernels
from the simulated data.

4.1.1. Symmetry and Reciprocity. As we noted in subsection 4.1, our sim-
ulated triggering matrices are symmetric, but our reconstructed adjacency matrices
generally are not symmetric. Measuring deviation from symmetry gives one way to
evaluate the performance of our inference methods. We use various reciprocity mea-
sures to quantify such deviation.

We conduct two sets of experiments. In the ﬁrst one, we ﬁx a single synthetic trig-
gering matrix and simulate ten multivariate spatiotemporal Hawkes point processes.

3We use code from the authors of [38];

it is available at https://github.com/slinderman/
pyhawkes. In all of our experiments, we use the default hyperparameters that come with the pub-
lished code.

12

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

Reciprocity of the triggering matrices that we infer using diﬀerent methods. We report the
mean and standard deviation (in parentheses) over ten simulations with the same (ground-truth)
triggering matrix.

R1
Correlation
Ratio
Coherence
Entropy

Nonparametric
0.59 (0.05)
0.84 (0.05)
0.55 (0.02)
0.75 (0.01)
0.71 (0.01)

Temporal
0.29 (0.06)
0.36 (0.16)
0.37 (0.11)
0.63 (0.03)
0.59 (0.03)

Parametric
0.54 (0.03)
0.79 (0.05)
0.58 (0.02)
0.71 (0.02)
0.68 (0.02)

Bayesian
0.36 (0.03)
0.30 (0.14)
0.32 (0.02)
0.68 (0.02)
0.60 (0.02)

Table 1

Table 2

Reciprocity of the triggering matrices that we infer using diﬀerent methods. We report the mean
and standard deviation (in parentheses) over ten simulations, each with a diﬀerent (ground-truth)
triggering matrix.

R1
Correlation
Ratio
Coherence
Entropy

Nonparametric
0.61 (0.12)
0.81 (0.16)
0.63 (0.04)
0.78 (0.04)
0.75 (0.05)

Temporal
0.36 (0.12)
0.48 (0.27)
0.43 (0.06)
0.62 (0.03)
0.58 (0.03)

Parametric
0.55 (0.10)
0.76 (0.15)
0.62 (0.03)
0.72 (0.03)
0.69 (0.03)

Bayesian
0.40 (0.05)
0.23 (0.14)
0.33 (0.03)
0.70 (0.03)
0.62 (0.04)

We then estimate the triggering matrix K from each point process using various
methods, which we thereby compare with each other. In a second set of experiments,
instead of ﬁxing a single triggering matrix, we generate ten diﬀerent triggering matri-
ces using the same WSBM model and parameters, and we simulate one point process
for each triggering matrix.

u(cid:54)=v K↔

uv and the total weight W = (cid:80)

There is no standard way of measuring reciprocity in a weighted network.
In
our calculations, we use diagnostics that were proposed in [65] and [4]. First, as
in [65], we compute the reciprocated edge weight K↔
uv = min{Kuv, Kvu}, and we
then calculate a network-level reciprocity score R1 as the ratio between the total
reciprocated weight W ↔ = (cid:80)
u(cid:54)=v Kuv. That is,
the “reciprocity” is R1 := W ↔/W . Second, Akoglu et al. [4] proposed three node-level
measures of reciprocity: (1) the “ratio” Rratio := min{Kuv, Kvu}/ max{Kuv, Kvu};
(2) “coherence” Rcoher = 2
KuvKvu/(Kuv + Kvu); and (3) “entropy” Rentropy :=
−ruv log2(ruv) − rvu log2(rvu), where ruv = Kuv/(Kuv + Kvu). These last three
measures of reciprocity are measured at a node level, whereas R1 is a network-level
measure. For the other measures, we obtain a network-level measure by calculating
those scores for each pair of nodes and then taking a mean over all pairs of nodes.
Each of the above quantities gives a score between 0 and 1, where a larger value
indicates a stronger tendency for the nodes in a network to reciprocate. In a perfectly
symmetric and reciprocal network, each of the four methods gives a value of 1.

√

In Table 1, we report the mean reciprocity and the standard deviation over ten
simulations with the same triggering matrix. In Table 2, we report the mean results
from ten diﬀerent triggering matrices. Both spatiotemporal models give higher scores
than the exclusively temporal models, which is what we expected, as the tempo-
ral models discard spatial information. According to these measures of success, the
nonparametric model has the best performance.

4.1.2. Edge Reconstruction. We also evaluate the reconstruction methods
based on their ability to recover the existence of edges. This is particularly relevant if
we want to know whether there is a connection between two entities. We will discuss

SPATIOTEMPORAL HAWKES PROCESSES AND NETWORK RECONSTRUCTION 13

Fig. 1. Model comparison using synthetic networks. We show the mean ROC curves with error
bars (averaged over ten simulations, each with a diﬀerent triggering matrix) on edge reconstruction.
The ROC curve of a better reconstruction should be closer to 1 for a larger range of horizontal-axis
values, such that it has a larger area under the curve (AUC), which is equal to the probability that
a uniformly-randomly chosen existing edge in a ground-truth network has a larger weight than a
uniformly-randomly chosen missing edge in the inferred network.

this application in detail using the Gowalla data set (see subsection 4.2).

In our model, we consider an edge to exist if the corresponding weighted entry
in the inferred triggering matrix exceeds a certain threshold. For diﬀerent threshold
levels, we compute the numbers of true positives (TP), false positives (FP), true neg-
atives (TN), and false negatives (FN) for a given ground-truth triggering matrix. We
summarize our results in a receiver operating characteristic (ROC) plot (see Figure 1),
in which we plot the true-positive rate (TPR) (where TPR = TP/(TP + FN)) versus
the false-positive rate (FPR) (where FPR = FP/(FP + TN)). A better inference of a
triggering matrix gives a larger value of TPR at a ﬁxed FPR.

Based on the ROC plot in Figure 1, we conclude that the spatiotemporal models
— both the parametric and nonparametric Hawkes models that we proposed in sec-
tion 3 — outperform the exclusively temporal ones. Therefore, incorporating spatial
information improves the quality of our reconstructed binary networks, at least ac-
cording to this measure of success. The best results are from our parametric model,
which is not surprising, given that we use the same model to simulate the data. The
performance of our nonparametric model is very close to that of the parametric model,
conﬁrming its eﬀectiveness at inferring the existence of edges.

(cid:16)

4.1.3. Inferred Kernels. We report the inferred kernels of the diﬀerent models
in Figure 2. Recall that the ground-truth kernels that we use to simulate point
processes are g1(t) = ω exp (−ωt) and h(r) = 2πrg2(r) = r
, where
r2 = x2 + y2, ω = 0.6, and σ2 = 0.3. Let ˆg1 and ˆh denote the inferred temporal and
spatial kernels, respectively.

We calculate the L1 errors (cid:82) |g1(t) − ˆg1(t)| dt and (cid:82) |h(r) − ˆh(r)| dr . We report
these errors in Table 3 and present visualizations of the inferred kernels in Figure 2.
As expected, both spatiotemporal Hawkes models give more accurate kernel inference
than the exclusively temporal model. The nonparametric Hawkes model does not use
any information about the ground-truth kernels. Surprisingly, it is more accurate,
in terms of the L1 error, at inferring the spatial trigger kernel than the parametric
model, whose kernel shares the same parametric form as the ground-truth kernel.

σ2 exp

− r2
2σ2

(cid:17)

14

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

The L1 errors of the inferred spatial and temporal kernels. We simulate ten point processes
with the same triggering matrix and triggering kernel. We report the mean and standard deviation
(in parentheses) of the L1 errors averaged over the ten simulations with the same triggering kernel
and matrix. Note that the exclusively temporal model does not estimate a spatial kernel.

Table 3

Temporal kernel
Spatial kernel

Nonparametric
0.07 (0.02)
0.06 (0.02)

Temporal
0.20 (0.06)
-

Parametric
0.02 (0.02)
0.12 (0.02)

Fig. 2. Model comparison using synthetic networks: Inferred (left) temporal and (right) spatial
kernels using diﬀerent methods: Temporal Hawkes, Parametric Hawkes and Nonparametric Hawkes.
The dashed lines are ground-truth kernels used for the synthetic data.

4.1.4. Community-Structure Recovery. We also evaluate the quality of the
inferred networks based on their community structure, in which dense sets of nodes
in a network are connected sparsely to other dense sets of nodes [20, 58]. Recall
that we have planted a four-community structure in the synthetic triggering matri-
ces (see subsection 4.1). We apply the community-detection methods from [3] (an
inference method for a WSBM), [33] (symmetric non-negative matrix factorization;
NMF), and [27, 46, 48, 50] (modularity maximization4). The WSBM that we infer for
community detection is the same that one we use to construct the synthetic adjacency
matrices (see subsection 4.1). To evaluate our inferred community structure, we use
the square-root variant of normalized mutual information (NMI) [67] between the
inferred community assignment and “ground truth” community labels. Speciﬁcally,
Let S1 and S2 be community assignments of the U nodes to C1 and C2 communities,
respectively; and let S(cid:96)k, with (cid:96) ∈ {1, 2} and k ∈ {1, 2, · · · , C(cid:96)}, denote the set of
nodes in the kth community in assignment S(cid:96). The NMI between S1 and S2 is

NMI(S1, S2) =

I(S1, S2)
(cid:112)H(S1)H(S2)

∈ [0, 1] ,

i=1

|S1i∩S2j |
U

where I(S1, S2) = (cid:80)C1
(cid:80)C2
log |S1i∩S2j |/U
|S1i||S2j |/U 2 (where |J| denotes the cardi-
j=1
nality of the set J) and the entropy is H(S(cid:96)) = − (cid:80)N(cid:96)
N (with (cid:96) ∈ {1, 2}).
Intuitively, NMI measures the amount of information that is shared by two commu-
nity assignments. If they are the same after permuting community labels, the NMI
is equal to 1. A larger NMI score implies that the inferred community assignment
shares more information with the ground-truth labels. See [70] for a discussion of

|S(cid:96)i|
N log |S(cid:96)i|

i=1

4For modularity maximization, we use the implementation of a (locally greedy) Louvain-like [9]
method (called GenLouvain) from [27] with the default resolution-parameter value of 1 and the
Newman–Girvan null model.

SPATIOTEMPORAL HAWKES PROCESSES AND NETWORK RECONSTRUCTION 15

Normalized mutual information (NMI) between the outputs of diﬀerent community-detection
methods applied to the inferred networks and the ground-truth community structure (averaged over
ten simulations, each with a diﬀerent triggering matrix).

Table 4

Nonparametric Temporal

Parametric Bayesian

Weighted SBM
Symmetric NMF
Modularity Maximization

0.80
0.62
0.64

0.38
0.31
0.47

0.83
0.66
0.71

0.36
0.19
0.28

other approaches for comparing diﬀerent community assignments in networks.

There are numerous approaches for detecting communities in networks [20, 54,
58], and we use methods with readily-available code. As we show in Table 4, all of
these community-detection methods perform better when we infer triggering matrices
using both spatial and temporal information than with with exclusively temporal
information. One can, of course, repeat our experiments using other methods.

4.2. Gowalla Friendship Network. Gowalla is a location-based social-media
website in which users share their locations by checking in. We use a Gowalla data
set — collected in [14] using Gowalla’s public API — of a “friendship” network with
196,591 users, 950,327 edges, and a total of 6,442,890 check-ins of these users between
February 2009 and October 2010. The data set also includes the latitude and longitude
coordinates and the time (with a precision of one second) of each check-in. Similar to
a Facebook “friendship” network, the Gowalla friendship network is undirected. The
mean number of friends for each user is 9.7, the median is 3, and the maximum is
14, 730. We study several subnetworks in the Gowalla data set; see Appendix A for
details. We view the spatiotemporal check-ins of Gowalla users within each subnet-
work as events in a multivariate point process and infer relationships between these
users.

We compare our Nonparametric Hawkes method with the Bayesian Hawkes and
the exclusively Temporal Hawkes in terms of how well our inferred edges match the
Gowalla friendships. Because a Gowalla friendship network is undirected, we ﬁrst
symmetrize the inferred triggering matrix (via ˜K = (cid:0)K + KT (cid:1) /2) to obtain an undi-
rected network. We then calculate FPRs and TPRs in the same fashion as subsec-
tion 4.1.2 using ˜K’s associated “ground-truth” friendship network and generate the
corresponding ROC curves. In the ROC curves of three diﬀerent cities in Figure 3,
we observe that the best results are from our nonparametric model that incorporates
spatial information. The mean AUCs are 0.4277 (with a standard deviation of 0.1042)
for the Temporal Hawkes method; 0.5301 (with a standard deviation of 0.0585) for
the Bayesian Hawkes method; and 0.6692 (with a standard deviation of 0.0421) for
our Nonparametric Hawkes method in all of the examined subnetworks.

4.3. Crime-Topic Network. In a recent paper on crime classiﬁcation, Kuang
et al. [31] performed topic modeling (see [32] for a review) on short narrative (i.e.,
text) descriptions of all crimes, with spatial coordinates and time stamps (with a
precision of a minute), that were reported to the Los Angeles Police Department
(LAPD) between 1 January 2009 and 19 July 2014. The premise in their work was
that crime topics, sets of words that co-occur frequently in the same crime narrative,
better reﬂect the ecological circumstances of crime than standard crime classiﬁcations
based on legal codes. Targeting discovery of up to twenty topics, they found six topics
related to violent crime, eight topics related to property crime, and six topics that
seem to be related to deception-based crime. This classiﬁes the twenty crime topics

16

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

(a) San Fransisco

(b) New York City

(c) Los Angeles

Fig. 3. ROC curves of diﬀerent methods for reconstructing three Gowalla friendship networks.
(See Appendix A for details about the networks.) Here dashed lines are for our Nonparametric
Hawkes; dotted lines for Temporal Hawkes; and solid lines for Bayesian Hawkes.)

Mean NMI (with one standard deviation reported in parentheses) between community assign-
ments from several community-detection methods and the classiﬁcations from [31] in the 100 neigh-
borhoods in Los Angeles with the most recorded crime events between 1 January 2009 and 19 July
2014.

Table 5

Symmetric NMF
Weighted SBM

Nonparametric
0.25 (0.11)
0.24 (0.12)

Temporal
0.12 (0.084)
0.085 (0.086)

Parametric
0.084 (0.12)
0.078 (0.079)

into three classes.

In the present case study, we extend this work by modeling the above data set
as a crime-topic network. We associate each crime topic with a node, and we infer
edges based on whether crime events of one topic trigger events of other topics. That
is, we discover latent relationships between diﬀerent crime topics based on associ-
ated crime events. Inspired by previous research on point-process models of crime
events [44], we model crime events of diﬀerent topics via a multivariate point pro-
cess and infer connections between the crime topics using our Nonparametric Hawkes
method. To evaluate our approach, we compare the communities that we detect in
the reconstructed network with the three crime classes in [31].

4.3.1. Community Detection. We infer crime-topic networks directly from
crime events within individual Los Angeles neighborhoods5 using our Nonparamet-
ric Hawkes method, the Parametric Hawkes method, and the exclusively temporal
Hawkes method. We investigate the 100 neighborhoods with the most reported crime
events among all 296 neighborhoods of LA. On average, there are 4, 140 crime events
in the top 100 neighborhood and 8, 750 such events in the top 10. We then apply the
community-detection methods mentioned in subsection 4.1.4 to the reconstructed net-
works; this assigns crime topics to communities. We quantify the diﬀerence between
these community assignments and the crime-topic classiﬁcations from [31] by calculat-
ing NMI. We also visualize the crime-topic networks of the Westwood and Wingfoot
neighborhoods in Figure 4; they are, respectively, located in West LA and South LA.
From Table 5, we see that using spatial information combined with a nonparametric
kernel leads to the best mean NMI score among the methods that we examine.

5We use the Zillow neighborhood boundaries from https://www.zillow.com/howto/api/

neighborhood-boundaries.htm.

SPATIOTEMPORAL HAWKES PROCESSES AND NETWORK RECONSTRUCTION 17

(a)

(b)

(c)

(d)

Fig. 4. Crime-Topic networks generated by the Nonparametric Hawkes and Temporal Hawkes
methods colored by community assignments from modularity maximization: (a) Nonparametric
Hawkes in Westwood, (b) Temporal Hawkes in Westwood, (c) Nonparametric Hawkes in Wingfoot,
and (d) Temporal Hawkes in Wingfoot.

4.4. Network of Crime Events. In the previous sections, we studied relation-
ships among entities given spatiotemporal events associated with them. To examine
connections between events, we now deﬁne an event network, which is both weighted
and directed, in which each event is a node and P denotes the adjacency matrix of
this network. Recall that, in subsection 3.3.1, we constructed an expectation matrix
P, where P(i, j) = pij is the probability that event j is triggered by event i and
P(i, i) = pii is the probability that event i is a background event. The weight of an
edge reﬂects a triggering eﬀect between two events, and the direction points from the
earlier event to the later one. For example, we can build a crime-event network in
which each node is a crime incident (i.e., an event), and we estimate edges between
events using our nonparametric model.

4.4.1. Stochastic Declustering. With an event network, a natural question is
whether one can diﬀerentiate between “true” background events and triggered events.
Such diﬀerentiation using the probability pii is called stochastic declustering [75]. To
determine whether event i is a background event, we compare pii with a uniformly
random sample from the interval (0, 1).
If pii is larger than the random number,
we consider this event to be from the background; otherwise, we consider it to be
triggered by other events.

We perform declustering experiments on synthetic data; we simulate ten synthetic
point processes using a ﬁxed triggering matrix that we generate from a WSBM. (See
subsection 4.1 for details.) Recall from Algorithm 3.3 that we retain causality in-
formation in the simulations (i.e., which events cause which others and which events
are from the background), giving a notion of “ground truth” about the ancestors of
each event. One way to measure the quality of declustering is by comparing the in-
ferred branching ratio [64] with the one from the ground-truth data. The branching
ratio is deﬁned as 1 − Nb/N , where Nb is the number of background events. How-
ever, the diﬀerence in branching ratios itself typically does not completely reﬂect
reconstruction errors. For example, in an extreme case, stochastic declustering can
erroneously misclassify some number of background events as triggered and the same
number of triggered events erroneously as background, although the branching ratio
is the same as the true branching ratio in this scenario. To resolve this problem, we
view declustering as a binary classiﬁcation problem that assigns events to be either
background or triggered events. We use measurements such as recall and precision to
evaluate our declustering results. Recall that “recall” is the ratio between the number
of background events that are correctly recovered by the declustering methods (i.e.,
the true positives) to the total number of background events, and “precision” is the
ratio between the number of true positives to the number of events that are labeled as

18

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

Table 6

Comparison of our stochastic declustering results for the Nonparametric Hawkes, Parametric
Hawkes, and Temporal Hawkes methods using synthetic point-process data with networks from a
WSBM (see subsection 4.1) and background labels from the simulation from Algorithm 3.3. We
report the mean and the standard deviation (in parentheses) of the branching-ratio error, precision,
and recall over ten simulations (which we do for ten point processes with the same triggering ker-
nels and matrix). For each simulation, each calculation is the mean over 20 runs of stochastic
declustering.

Branching-ratio error
Recall
Precision

Nonparametric
0.039 (0.0050)
0.75 (0.0098)
0.70 (0.0082)

Parametric
0.01 (0.011)
0.65 (0.027)
0.64 (0.0093)

Temporal
0.022 (0.019)
0.60 (0.035)
0.59 (0.0086)

background events by stochastic declustering. From the results in Table 6, we see that
the Temporal Hawkes method has the worst performance among the methods that we
consider. Our Nonparametric Hawkes method has the best recall and precision (with
the smallest variations as well), and the Parametric Hawkes method has the smallest
branching-ratio error.

4.4.2. Motif Analysis. Declustering methods can help diﬀerentiate between
background and triggered events in an event network. To further examine spa-
tiotemporal dynamics, we consider causality information among events. Similar to
a relational-event model [13], one can obtain causality information from the matrix
P, because pij is the probability that event j is triggered by event i. We focus on
repeated patterns to obtain information about local causality structure. Speciﬁcally,
we examine network motifs [42], which are recurrent (and often statistically signiﬁ-
cant) patterns in a network. Note that all event networks are directed acyclic graphs
(DAGs) because of how they incorporate temporal information.

We ﬁnd that motif analysis is insightful for studying gang-crime event networks.
Gang crimes are often characterized by retaliations (triggered crime events) among ri-
valry gangs; this can lead to a series of tit-for-tat reciprocal crimes. To ﬁnd signiﬁcant
gang retaliation patterns, we use a gang-crime data set (provided by the LAPD) from
2014–2015 with 4,158 events in Los Angeles. Using these data, we generate an event
network with our Nonparametric Hawkes method. We then threshold the network, by
keeping edges whose weight is at least 0.1 and then binarizing them, so that the edges
are unweighted. We use the motif-detection method and code [1] from [42], including
their null model.6

We ﬁnd, for thresholds ranging from 0.5 to 0.001, that a three-node feedforward-
loop motif [39] occurs more signiﬁcantly than by chance (with z-scores that are larger
than 2) in both the city-wide data set and in the South LA7 subset (which consists of
1,912 events) of the data set. Davies and Marchione [18] found that the same three-
node motif is signiﬁcant in networks that they constructed (using diﬀerent methods
from ours for both network construction and motif detection) using data sets from
maritime piracy and residential burglaries.

We focus on the South LA area, because it is the center of a gang interven-
tion program [10]. Establishing which causal structures are statistically signiﬁcant

6For each of our networks, we produce 100 “randomized” networks. To produce one such network,
we use the default edge-swapping approach from [42]. This entails making a number of random swaps
equal to about 100–200 times the number of edges. For each node in a network, we require that the
randomized network preserves its number of in-edges, out-edges, and bidirectional edges.

7South LA Gang Reduction and Youth Development (GRYD) Zones [10].

SPATIOTEMPORAL HAWKES PROCESSES AND NETWORK RECONSTRUCTION 19

Fig. 5. All possible three-node motifs for a DAG. We highlight the nodes in the feedforward-loop

motif (D) in red.

has important implications for countering gang violence, and fast response to gang
crime may reduce the potential that it triggers a future retaliation. Knowing that
feedforward-loop network motifs occur at rates that are larger than chance suggests
that disrupting retaliation may require assessment of trade-oﬀs in how to allocate
intervention resources. For example, in a simple triggering chain (see Figure 5C),
one can expect that intervention following an initial triggering event in time will have
a direct eﬀect on the second event in time and an indirect eﬀect on the third event,
although the eﬀect on the third event may be attenuated by the intervening event. By
contrast, we expect that intervention following the ﬁrst event in the feedforward-loop
motif (see Figure 5D) will have a direct eﬀect on the second event in time and both a
direct and indirect eﬀect on the third event. It is possible that the third event is more
likely to be disrupted given the feedforward structure and intervention following the
ﬁrst event than would be the case with direct intervention following only the second
event.

5. Conclusions and Discussion. In this paper, we used point-process mod-
els to infer latent networks from synthetic and real-world spatiotemporal data sets.
We then applied tools from network analysis to examine the inferred networks. We
studied the role of spatial information and nonparametric techniques in network re-
construction.

As we have illustrated, it is very important to incorporate spatial information.
However, using such information eﬀectively requires making a good choice of spa-
tiotemporal triggering kernels. We achieved this using a nonparametric approach.
Through experiments on synthetic data sets, we showed that our nonparametric
Hawkes method is capable of doing a good job of successfully recovering spatial and
temporal triggering kernels. Moreover, our approach is able to infer a network struc-
ture that better recovers — compared to other network reconstruction methods that
we studied — symmetry and reciprocity, edge reconstruction, and community struc-
tures. Through experiments on real-world data sets, we illustrated that the inferred
networks of our approach are meaningful, in the sense that they have large positive
correlations with some metadata.

This paper helps ﬁll a gap on incorporating spatial information into multivariate
self-exciting point processes [59], and it will be interesting to apply our approach to
other ﬁelds (such as seismology). Moreover, our approach is not limited to the Eu-
clidean distance (for the spatial variables) that is used commonly in seismology [53]
and crime applications [44]. In other words, although the spatial triggering kernel
g2(r) in this paper is a function of Euclidean distance, one can potentially use any
notion of “distance” between two entities. For example, in a network, one can mea-

20

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

sure a distance between two entities based on the length of shortest paths between
them. In a recent paper, Green et al. [24] proposed a social-contagion model in which
they assumed, using a parametric form, that the strength of triggering in a Hawkes-
process model depends on the shortest-path distance. With our approach, we can
nonparametrically estimate such dependence. To give another example, consider a
point process in which each event is associated with textual information. For in-
stance, in a Twitter data set, one can consider each tweet (a time-stamped body of
text) as an event in a point process. One can measure a distance between two tweets
based on their text.

Naturally, our network reconstruction method is not without limitations. It uses
O(U 2) parameters for U nodes. To avoid underﬁtting, it requires a large number
of observed events. The computational complexity and memory requirement scale
at least quadratically with the number of events, so the current EM-type algorithm
is not ideal for analyzing large data sets. It will thus be important to improve our
inference method for network reconstruction.

Appendix A. Preprocessing of the Gowalla Data.
In this section, we detail how we preprocess the Gowalla data that were collected
and studied in [14]. We examine data from three cities: New York City, Los Angeles,
and San Fransisco. We visualize the networks used in this paper in Figure 6.

A.1. New York City (NYC). We study check-ins in New York City (NYC)
during the period April–October 2010. We use a bounding box (with a north latitude
of 40.92, a south latitude of 40.48, an east longitude of −73.70, and a west longitude
of −74.26)8 to locate check-ins in NYC. We consider “active” users, who have at least
100 check-ins during the period. To alleviate the computational burden, we also only
consider users who have at most 500 check-ins during the period to reduce the number
of users and the total number of check-ins. Our inference process requires computing
a triggering probability for each pair of events (i.e., check-ins), which results in a
full upper-triangular matrix. The number of nonzero entries in this matrix scales
with the square of the total number of events, so the memory requirement also scales
quadratically with the number of events. We perform experiments only for cases
in which the total number of events is at most 10, 000 to be able to store triggering
probabilities for all pairs of events in 4-gigabyte memory. There are 5, 801 unique users
with at least one check-in in NYC during the period, and there are 101, 329check −ins
in total. After removing “inactive” users (i.e., those with strictly fewer than 100 check-
ins) and overly active users (i.e., those with strictly more than 500 check-ins), we are
left with 160 users and a total of 29, 118 check-ins. We also restrict ourselves to users
in the largest connected component (LCC) of the network. This yields 46 users and
8, 495 check-ins, on which we apply our inference methodology.

A.2. Los Angeles (LA). We apply the same procedure as in Appendix A.1 on
the check-in data for Los Angeles (LA). The bounding box that we use for LA has a
north latitude of 34.34, a south latitude of 33.70, an east longitude of −188.16, and a
west longitude of −188.67. We restrict the area of LA to be the same as that of NYC,
although LA’s geographic area is much larger than that of NYC. After selecting only
users in the LCC of the Gowalla network among users who are active (with at least
150 check-ins) but not overly active (with at most 1000 check-ins) users, we are left
with 23 users and 6, 203 check-ins.

8We obtain latitude and longitude coordinates from http://www.mapdevelopers.com/geocode

bounding box.php.

SPATIOTEMPORAL HAWKES PROCESSES AND NETWORK RECONSTRUCTION 21

(a) 1-Ego network of a user of
Gowalla in SF.

(b) Largest connected compo-
nent of the Gowalla network in
NYC.

(c) Largest connected compo-
nent of the Gowalla network in
LA.

Fig. 6. Three diﬀerent friendships networks in the Gowalla data set. We compare diﬀerent

network reconstruction methods for these networks.

A.3. San Francisco (SF). To look at a diﬀerent type of example, we also
examine the 1-ego network of the most popular user (with 14 friends) in San Francisco
(SF). (A 1-ego network [71] of a node is an induced subgraph that includes a focal
node — the ego — and its direct neighbors.) The bounding box that we use for SF
has a north latitude of 37.93, a south latitude of 37.64, an east longitude of −122.28,
and a west longitude of −123.17. In this 1-ego network, there are 9, 887 check-ins.

Acknowledgements. We thank Chandan Dhal and Jialin Liu for helpful dis-

cussions and preliminary work on community detection.

REFERENCES

[1] mfinder 1.21. http://www.weizmann.ac.il/mcb/UriAlon/download/network-motif-software.
[2] M. Achab, E. Bacry, S. Ga¨ıffas, I. Mastromatteo, and J.-F. Muzy, Uncovering causality
from multivariate Hawkes integrated cumulants, Journal of Machine Learning Research, 18
(2018), pp. 1–28.

[3] C. Aicher, A. Z. Jacobs, and A. Clauset, Learning latent block structure in weighted net-

works, Journal of Complex Networks, 3 (2014), pp. 221–248.

[4] L. Akoglu, P. O. V. de Melo, and C. Faloutsos, Quantifying reciprocity in large weighted
communication networks, in Paciﬁc-Asia Conference on Knowledge Discovery and Data
Mining, Springer, 2012, pp. 85–96.

[5] E. Bacry, I. Mastromatteo, and J.-F. Muzy, Hawkes processes in ﬁnance, Market Mi-

crostructure and Liquidity, 1 (2015), p. 1550005.

[6] D. Balcan, V. Colizza, B. Gonc¸alves, H. Hu, J. J. Ramasco, and A. Vespignani, Mul-
tiscale mobility networks and the spatial spreading of infectious diseases, Proceedings of
the National Academy of Sciences of the United States of America, 106 (2009), pp. 21484–
21489.

[7] H. Barbosa, M. Barthelemy, G. Ghoshal, C. R. James, M. Lenormand, T. Louail,
R. Menezes, J. J. Ramasco, F. Simini, and M. Tomasini, Human mobility: Models
and applications, Physics Reports, 734 (2018), pp. 1–74.

[8] M. Barthelemy, Morphogenesis of Spatial Networks, Springer-Verlag, 2018.
[9] V. D. Blondel, J.-L. Guillaume, R. Lambiotte, and E. Lefebvre, Fast unfolding of com-
munities in large networks, Journal of Statistical Mechanics: Theory and Experiment, 2008
(2008), p. P10008.

[10] P. J. Brantingham, N. Sundback, B. Yuan, and K. Chan, GRYD intervention incident

response & gang crime 2017 evaluation report, 2017.

[11] D. Brockmann, L. Hufnagel, and T. Geisel, The scaling laws of human travel, Nature, 439

[12] E. N. Brown, R. E. Kass, and P. P. Mitra, Multiple neural spike train data analysis: state-

of-the-art and future challenges, Nature Neuroscience, 7 (2004), p. 456.

[13] C. T. Butts, A relational event framework for social action, Sociological Methodology, 38

(2006), pp. 462–465.

(2008), pp. 155–200.

22

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

[14] E. Cho, S. A. Myers, and J. Leskovec, Friendship and mobility: User movement in location-
based social networks, in Proceedings of the 17th ACM SIGKDD International Conference
on Knowledge Discovery and Data Mining, ACM, 2011, pp. 1082–1090.

[15] M. D. Conover, C. Davis, E. Ferrara, K. McKelvey, F. Menczer, and A. Flammini,
The geospatial characteristics of a social movement communication network, PloS ONE,
8 (2013), p. e55957.

[16] N. Cressie, Statistics for Spatial Data, John Wiley & Sons, 2015.
[17] D. J. Daley and D. Vere-Jones, An Introduction to the Theory of Point Processes: Volume

II: General Theory and Structure, Springer Science & Business Media, 2007.

[18] T. Davies and E. Marchione, Event networks and the identiﬁcation of crime pattern motifs,

PloS ONE, 10 (2015), p. e0143638.

[19] M. Eichler, R. Dahlhaus, and J. Dueck, Graphical modeling for multivariate Hawkes pro-
cesses with nonparametric link functions, Journal of Time Series Analysis, 38 (2017),
pp. 225–242.

[20] S. Fortunato and D. Hric, Community detection in networks: A user guide, Physics Reports,

659 (2016), pp. 1–44.

[21] E. W. Fox, F. P. Schoenberg, and J. S. Gordon, Spatially inhomogeneous background rate
estimators and uncertainty quantiﬁcation for nonparametric Hawkes point process models
of earthquake occurrences, The Annals of Applied Statistics, 10 (2016), pp. 1725–1756.

[22] E. W. Fox, M. B. Short, F. P. Schoenberg, K. D. Coronges, and A. L. Bertozzi, Modeling
e-mail networks and inferring leadership using self-exciting point processes, Journal of the
American Statistical Association, 111 (2016), pp. 564–584.

[23] C. W. J. Granger, Investigating causal relations by econometric models and cross-spectral
methods, Econometrica: Journal of the Econometric Society, (1969), pp. 424–438.
[24] B. Green, T. Horel, and A. V. Papachristos, Modeling contagion through social networks to
explain and predict gunshot violence in Chicago, 2006 to 2014, JAMA Internal Medicine,
177 (2017), pp. 326–333.

[25] E. C. Hall and R. M. Willett, Tracking dynamic point processes on networks, IEEE Trans-

actions on Information Theory, 62 (2016), pp. 4327–4346.

[26] P. Holme, Modern temporal network theory: A colloquium, Eur. Phys. J. B, 88 (2015), 234.
[27] L. G. Jeub, M. Bazzi, I. S. Jutla, and P. J. Mucha, A generalized Louvain method for
community detection implemented in matlab, (2011–2017; Version 2.1.1), http://netwiki.
amath.unc.edu/GenLouvain.

[28] M. Karsai, H.-H. Jo, and K. Kaski, Bursty Human Dynamics, Briefs in Complexity, Springer-

Verlag, 2018.

[29] M. Kivel¨a, A. Arenas, M. Barthelemy, J. P. Gleeson, Y. Moreno, and M. A. Porter,

Multilayer networks, Journal of Complex Networks, 2 (2014), pp. 203–271.

[30] M. Kivel¨a and M. A. Porter, Estimating interevent time distributions from ﬁnite observation
periods in communication networks, Physical Review E, 92 (2015), p. 052813.

[31] D. Kuang, P. J. Brantingham, and A. L. Bertozzi, Crime topic modeling, Crime Science,

6 (2017), p. 12.

[32] D. Kuang, J. Choo, and H. Park, Nonnegative matrix factorization for interactive topic
modeling and document clustering, in Partitional Clustering Algorithms, Springer, 2015,
pp. 215–243.

[33] D. Kuang, C. Ding, and H. Park, Symmetric nonnegative matrix factorization for graph
clustering, in Proceedings of the 2012 SIAM International Conference on Data Mining,
SIAM, 2012, pp. 106–117.

[34] E. L. Lai, D. Moyer, B. Yuan, E. Fox, B. Hunter, A. L. Bertozzi, and P. J. Brantingham,
Topic time series analysis of microblogs, IMA Journal of Applied Mathematics, 81 (2016),
pp. 409–431.

[35] S. L. Lauritzen, Graphical Models, Clarendon Press, 1996.
[36] D. Lazer, A. Pentland, L. Adamic, S. Aral, A.-L. Barab´asi, D. Brewer, N. Christakis,
N. Contractor, J. Fowler, M. Gutmann, T. Jebara, G. King, M. Macy, D. Roy,
and M. Van Alstyne, Computational social science, Science, 323 (2009), pp. 721–723.

[37] E. Lewis and G. O. Mohler, A nonparametric EM algorithm for multiscale Hawkes processes,

Journal of Nonparametric Statistics, 1 (2011), pp. 1–20.

[38] S. Linderman and R. Adams, Discovering latent network structure in point process data, in

International Conference on Machine Learning, 2014, pp. 1413–1421.

[39] S. Mangan and U. Alon, Structure and function of the feed-forward loop network motif,
Proceedings of the National Academy of Sciences of the United States of America, 100
(2003), pp. 11980–11985.

[40] B. Mark, G. Raskutti, and R. Willett, Network estimation from point process data, arXiv

SPATIOTEMPORAL HAWKES PROCESSES AND NETWORK RECONSTRUCTION 23

[41] D. Marsan and O. Lengline, Extending earthquakes’ reach through cascading, Science, 319

preprint arXiv:1802.04838, (2018).

(2008), pp. 1076–1079.

[42] R. Milo, S. Shen-Orr, S. Itzkovitz, N. Kashtan, D. Chklovskii, and U. Alon, Network

motifs: Simple building blocks of complex networks, Science, 298 (2002), pp. 824–827.

[43] G. O. Mohler, Marked point process hotspot maps for homicide and gun crime prediction in

Chicago, International Journal of Forecasting, 30 (2014), pp. 491–497.

[44] G. O. Mohler, M. B. Short, P. J. Brantingham, F. P. Schoenberg, and G. E. Tita, Self-
exciting point process modeling of crime, Journal of the American Statistical Association,
106 (2011), pp. 100–108.

[45] G. O. Mohler, M. B. Short, S. Malinowski, M. Johnson, G. E. Tita, A. L. Bertozzi,
and P. J. Brantingham, Randomized controlled ﬁeld trials of predictive policing, Journal
of the American Statistical Association, 110 (2015), pp. 1399–1411.

[46] P. J. Mucha, T. Richardson, K. Macon, M. A. Porter, and J.-P. Onnela, Commu-
nity structure in time-dependent, multiscale, and multiplex networks, Science, 328 (2010),
pp. 876–878.

[47] J. A. Nelder and R. J. Baker, Generalized Linear Models, Wiley Online Library, 1972.
[48] M. E. J. Newman, Finding community structure in networks using the eigenvectors of matri-

ces, Physical Review E, 74 (2006), p. 036104.

[49] M. E. J. Newman, Networks, Oxford University Press, second ed., 2018.
[50] M. E. J. Newman and M. Girvan, Finding and evaluating community structure in networks,

Physical Review E, 69 (2004), p. 026113.

[51] A. Noulas, S. Scellato, R. Lambiotte, M. Pontil, and C. Mascolo, A tale of many cities:

Universal patterns in human urban mobility, PloS ONE, 7 (2012), p. e37027.

[52] Y. Ogata, Statistical Models for Earthquake Occurrences and Residual Analysis for Point
Processes, Journal of the American Statistical Association, 83 (1988), pp. 9–27.
[53] Y. Ogata, Space-time point-process models for earthquake occurrences, Annals of the Institute

of Statistical Mathematics, 50 (1998), pp. 379–402.

[54] T. P. Peixoto, Bayesian stochastic blockmodeling, arXiv:1705.10225, (2018). Chapter in “Ad-
vances in Network Clustering and Blockmodeling”, edited by P. Doreian, V. Batagelj, A.
Ferligoj, (John Wiley & Sons, New York City, USA [forthcoming]).

[55] P. O. Perry and P. J. Wolfe, Point process modelling for directed interaction networks,
Journal of the Royal Statistical Society: Series B (Statistical Methodology), 75 (2013),
pp. 821–849.

[56] M. A. Porter and J. P. Gleeson, Dynamical Systems on Networks: A tutorial, vol. 4 of
Frontiers in Applied Dynamical Systems: Reviews and Tutorials, Springer International
Publishing, 2016.

[57] M. A. Porter and S. D. Howison, The role of network analysis in industrial and applied

mathematics, arXiv preprint arXiv:1703.06843, (2017).

[58] M. A. Porter, J.-P. Onnela, and P. J. Mucha, Communities in networks, Notices of the

AMS, 56 (2009), pp. 1082–1097, 1164–1166.

[59] A. Reinhart et al., Rejoinder: A review of self-exciting spatio-temporal point processes and

their applications, Statistical Science, 33 (2018), pp. 330–333.

[60] S. Scellato, A. Noulas, and C. Mascolo, Exploiting place features in link prediction on
location-based social networks, in Proceedings of the 17th ACM SIGKDD International
Conference on Knowledge Discovery and Data Mining, ACM, 2011, pp. 1046–1054.
[61] F. P. Schoenberg, D. R. Brillinger, and P. Guttorp, Point processes, spatial-temporal,

Encyclopedia of Environmetrics, (2002).

[62] M. B. Short, P. J. Brantingham, A. L. Bertozzi, and G. E. Tita, Dissipation and dis-
placement of hotspots in reaction–diﬀusion models of crime, Proceedings of the National
Academy of Sciences of the United States of America, 107 (2010), pp. 3961–3965.
[63] A. Simma and M. I. Jordan, Modeling events with cascades of Poisson processes, in Proceed-
ings of the Twenty-Sixth Conference on Uncertainty in Artiﬁcial Intelligence, AUAI Press,
2010, pp. 546–555.

[64] D. Sornette and S. Utkin, Limits of declustering methods for disentangling exogenous from
endogenous events in time series with foreshocks, main shocks, and aftershocks, Physical
Review E, 79 (2009), p. 061110.

[65] T. Squartini, F. Picciolo, F. Ruzzenenti, and D. Garlaschelli, Reciprocity of weighted

networks, Scientiﬁc Reports, 3 (2013), p. 2729.

[66] A. Stomakhin, M. B. Short, and A. L. Bertozzi, Reconstruction of missing data in so-
cial networks based on temporal patterns of interactions, Inverse Problems, 27 (2011),
p. 115013.

24

B. YUAN, H. LI, A. L. BERTOZZI, P. J. BRANTINGHAM AND M. A. PORTER

[67] A. Strehl and J. Ghosh, Cluster ensembles—A knowledge reuse framework for combining
multiple partitions, Journal of Machine Learning Research, 3 (2002), pp. 583–617.
[68] P. Suny, J. Li, Y. Mao, R. Zhang, and L. Wang, Inferring multiplex diﬀusion network via
multivariate marked Hawkes process, arXiv preprint arXiv:1809.07688, (2018).
[69] G. Tita, P. J. Brantingham, A. Galstyan, and Y.-S. Cho, Latent self-exciting point process
model for spatial-temporal networks, Discrete and Continuous Dynamical Systems — Series
B, 19 (2014), pp. 1335–1354.

[70] A. L. Traud, E. D. Kelsic, P. J. Mucha, and M. A. Porter, Comparing community
structure to characteristics in online collegiate social networks, SIAM Review, 53 (2011),
pp. 526–543.

[71] J. Ugander, B. Karrer, L. Backstrom, and C. Marlow, The anatomy of the Facebook

social graph, arXiv preprint arXiv:1111.4503, (2011).

[72] A. Veen and F. P. Schoenberg, Estimation of space–time branching process models in seis-
mology using an EM-type algorithm, Journal of the American Statistical Association, 103
(2008), pp. 614–624.

[73] B. Wang, X. Luo, F. Zhang, B. Yuan, A. L. Bertozzi, and P. J. Brantingham, Graph-
based deep modeling and real time forecasting of sparse spatio-temporal data, arXiv preprint
arXiv:1804.00684, (2018).

[74] K. Zhou, H. Zha, and L. Song, Learning social infectivity in sparse low-rank networks using
multi-dimensional Hawkes processes, in Artiﬁcial Intelligence and Statistics, 2013, pp. 641–
649.

[75] J. Zhuang, Y. Ogata, and D. Vere-Jones, Stochastic declustering of space-time earthquake

occurrences, Journal of the American Statistical Association, 97 (2002), pp. 369–380.

[76] J. Zhuang, Y. Ogata, and D. Vere-Jones, Analyzing earthquake clustering features by using

stochastic reconstruction, Journal of Geophysical Research: Solid Earth, 109 (2004).

