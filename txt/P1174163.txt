PPDM: Parallel Point Detection and Matching for Real-time Human-Object
Interaction Detection

Yue Liao1,2 Si Liu1∗ Fei Wang2 Yanjie Chen2 Chen Qian2

Jiashi Feng3

1 School of Computer Science and Engineering, Beihang University
2 SenseTime Research 3 National University of Singapore

0
2
0
2
 
r
a

M
 
5
2
 
 
]

V
C
.
s
c
[
 
 
3
v
8
9
8
2
1
.
2
1
9
1
:
v
i
X
r
a

Abstract

We propose a single-stage Human-Object Interaction
(HOI) detection method that has outperformed all existing
methods on HICO-DET dataset at 37 fps on a single Ti-
tan XP GPU. It is the ﬁrst real-time HOI detection method.
Conventional HOI detection methods are composed of two
stages, i.e., human-object proposals generation, and pro-
posals classiﬁcation. Their effectiveness and efﬁciency are
limited by the sequential and separate architecture. In this
paper, we propose a Parallel Point Detection and Matching
(PPDM) HOI detection framework. In PPDM, an HOI is
deﬁned as a point triplet < human point, interaction point,
object point>. Human and object points are the center of
the detection boxes, and the interaction point is the mid-
point of the human and object points. PPDM contains
two parallel branches, namely point detection branch and
point matching branch. The point detection branch predicts
three points. Simultaneously, the point matching branch
predicts two displacements from the interaction point to its
corresponding human and object points. The human point
and the object point originated from the same interaction
point are considered as matched pairs. In our novel par-
allel architecture, the interaction points implicitly provide
context and regularization for human and object detection.
The isolated detection boxes unlikely to form meaningful
HOI triplets are suppressed, which increases the precision
of HOI detection. Moreover, the matching between hu-
man and object detection boxes is only applied around lim-
ited numbers of ﬁltered candidate interaction points, which
saves much computational cost. Additionally, we build a
new application-oriented database named as HOI-A, which
serves as a good supplement to the existing datasets1.

1. Introduction

Human-Object Interaction (HOI) detection [30, 11, 10,
9, 12, 16, 22] has received increasing attention recently.

∗Corresponding author (liusi@buaa.edu.cn)
1https://github.com/YueLiao/PPDM

Figure 1. mAP versus inference time on the HICO-Det test set.
Our PPDM-DLA outperforms the state-of-the-art methods with
the inference speed of 37 fps (0.027s). It is the ﬁrst real-time HOI
detection method. Our PPDM-Hourglass achieves 4.27% mAP
improvement over the state-of-the-arts with a faster speed.

Given an image, HOI detection aims to detect the triplet
< human, interaction, object >. Different from the general
visual relationship detection [19, 29, 20, 13, 32], the sub-
ject of the triplet is ﬁxed as human while the interaction is
action. HOI detection is an important step toward the high-
level semantic understanding of human-centric scenes.
It
has a lot of applications, such as activity analysis, human-
machine interaction and intelligent monitoring.

The conventional HOI detection methods [2, 22, 12, 16,
26] mostly consist of two stages. The ﬁrst stage is the
human-object proposal generation. A pre-trained detec-
tor [8, 23] is used to localize both the humans and objects.
Then M ×N human-object proposals are generated by pair-
wisely combining the ﬁltered M human boxes and N ob-
ject boxes. The second stage is the proposal classiﬁcation
which predicts the interactions for each human-object pro-
posal. The limitations of the two-stage methods’ effective-
ness and efﬁciency are mainly because their two stages are
sequential and separated. The proposal generation stage is
completely based on object detection conﬁdences. Each hu-
man/object proposal is independently generated. The pos-

1

sibility of combining two proposals to form a meaningful
HOI triplet in the second stage is not taken into account.
Therefore, the generated human-object proposals may have
relatively low quality. Moreover, in the second stage, all
human-object proposals need to be linearly scanned, while
only a few of them are valid. The extra computational cost
is large. Therefore, we argue that the non-sequential and
highly-coupled framework is needed.

We propose a parallel HOI detection framework and re-
formulate HOI detection as a point detection and matching
problem. As shown in Figure 2, we represent a box as a cen-
ter point and corresponding sizes (width and height). More-
over, we deﬁne an interaction point as the midpoint of the
human and object center points. To match each interaction
point with the human point and the object point, we design
two displacements from the interaction point to the corre-
sponding human and object point. Based on the novel refor-
mulation, we design a novel single-stage framework Paral-
lel Point Detection and Matching (PPDM), which breaks up
the complex task of HOI detection into two simpler parallel
tasks. The PPDM is composed of two parallel branches.
The ﬁrst branch is points detection, which estimates the
three center points (interaction, human and object points),
corresponding sizes (width and height) and two local off-
sets (human and object points). The interaction point can
be considered as providing contextual information for both
human and object detection. In other words, estimating the
interaction point implicitly enhances the detection of hu-
mans and objects. The second branch is points matching.
Two displacements from the interaction point to human and
object points are estimated. The human and object points
originated from the same interaction points are considered
as matched. In the novel parallel architecture, the point de-
tection branch estimates the interaction points, which im-
plicitly provide context and regularization for the human
and object detection. The isolated detection boxes unlikely
to form meaningful HOI triplets are suppressed while the
It is different
more likely detection boxes are enhanced.
from the human-object proposal generation stage in two-
stage methods, where all detection human/object boxes in-
discriminately form the human-object proposals to feed into
the second stage. Moreover, in the point matching branch,
the matching is only applied around limited numbers of ﬁl-
tered candidate interaction points, which saves a lot of com-
putational costs. On the contrary, in the proposal classiﬁca-
tion stage of two-stage methods, all human-object propos-
als need to be classiﬁed. Experimental results on the public
benchmark HICO-Det [2] and our newly collected HOI-A
dataset show that PPDM outperforms state-of-the-art meth-
ods in terms of accuracy and speed.

The existing datasets such as HICO-Det [22] and V-
COCO [11] have greatly boosted the development of related
research. These datasets are very general. However, in prac-

Figure 2. PPDM contains two parallel branches. In the point de-
tection branch, the human/object box denoted as the center points,
widths, and heights, are detected. Moreover, an interaction point,
i.e., the midpoint of the human and object point, is also localized.
Simultaneously, in the point matching branch, two displacements
from each interaction point to the human/object are estimated. The
human point and the object point originated from the same inter-
action point are considered as matched pairs.

tical applications, several limited, frequent HOI categories
need to be paid special attention to. To this end, we collect
a new Human-Object Interaction for Applications dataset
(HOI-A) with the following features: 1) specially selected
10 kinds of HOI categories with wide application values,
such as smoke and ride. 2) huge intra-class variations in-
cluding various illuminations and different human poses for
each category. The HOI-A is more application-driven, sev-
ering as a good supplement to the existing datasets.

Our contributions are summarized as: 1) We reformu-
late the HOI detection task as a point detection and match-
ing problem and propose a novel one-stage PPDM so-
lution.
2) PPDM is the ﬁrst HOI detection method to
achieve real-time and outperform state-of-the-art methods
both HICO-Det and HOI-A benchmarks. 3) A large-scale
and application-oriented HOI detection dataset is collected
to supplement existing datasets. Both source code and the
dataset are to be released to facilitate the related research.

2. Related Work

HOI Detection Methods. The existing HOI detection
methods can be mostly divided into two stages: in the ﬁrst
stage, an object detector [23] is applied to localize the hu-
man and objects; in the second stage, pairing the detected
human and object, and feeding their features into a classi-
ﬁcation network to predict the interaction between the hu-
man and object. Current works pay more attention to ex-
ploring how to improve the second stage. The most recent
works aim to understand HOI by capturing context infor-
mation [7, 27] or human structural message [26, 6, 5, 33].
Some works [22, 28, 33] formulated the second stage as a
graph reasoning problem and use graph convolutional net-
work to predict the HOI.

The above methods are all proposal based, thus their

Figure 3. Overview of the proposed PPDM framework. We ﬁrstly apply a key-point heatmap prediction network, e.g. Hourglass-104 or
DLA-34, to extract the appearance feature from an image. a) Point Detection Branch: Based on the extracted visual feature, we utilize
three convolutional modules to predict the heatmap of the interaction points, human center points, and object center points. Additionally, to
generate the ﬁnal box, we regress the 2-D size and the local offset. b) Point Matching Branch: the ﬁrst step of this branch is to regress the
displacements from the interaction point to the human point and object point respectively. Based on the predicted points and displacements,
the second step is to match each interaction point with the human point and object point to generate a set of points triplets.

performance is limited by the quality of proposals. Addi-
tionally, the existing methods have to spend much compu-
tational cost in proposals generation and feature extraction
process. Based on these drawbacks, we propose a novel
one-stage and proposal-free framework to detect HOI.
HOI Detection Datasets. There are mainly two commonly
used HOI detection benchmarks: VCOCO [11] and HICO-
Det [2], and a human-centric relationship detection dataset:
HCVRD [36]. The VCOCO is a relatively small dataset,
which is a subset of MSCOCO [18] including 10, 346 im-
ages annotated with 26 actions based on COCO annotation.
The HICO-Det is a large-scale and generic HOI detection
dataset, including 47, 776 images, which has 117 verbs and
80 object categories (same as COCO). The HCVRD is col-
lected from the general visual relationship detection dataset,
Visual Genome [14]. It has 52, 855 images, 927 predicate
categories and 1, 824 kinds of objects. Comparing the for-
mer two HOI detection datasets, which only focuses on hu-
man actions, the HCVRD is concerned about a more gen-
eral human-centric relationship, e.g., spatial relationships,
possessive relationships.

The previous HOI detection datasets mostly concentrate
on common and general actions. From a practical view, we
build up a new HOI-A dataset, which has about 38K images
only annotated with limited typical kinds of actions with
practical signiﬁcance.

3. Parallel Point Detection and Matching

3.1. Overview

HOI detection aims to estimate the HOI triplet < human,
interaction, object >, which is composed of the subject box

and class, the human action class and the object box and
class. We break up the complex task of HOI detection into
two simpler parallel tasks that can be assembled to form
the ﬁnal results. The framework of the proposed Parallel
Point Detection and Matching (PPDM) method is shown in
Figure 3. The ﬁrst branch of PPDM is points detection. It
estimates the center points, corresponding sizes (width and
height) and local offsets of both humans and objects. The
center, size and offset collaboratively represent some box
candidates. Moreover, the interaction point which is deﬁned
as the midpoint of a corresponding < human center point,
object center point > pair is also estimated. The second
branch of PPDM is points matching. The displacements
between the interaction point and the corresponding human
and object points are estimated. The human point and the
object point originated from the same interaction point are
considered as matched pairs.

3.2. Point Detection

The point detection branch estimates the human box, ob-
ject box and interaction point. A human box is represented
as its center point (xh, yh) ∈ R2, the corresponding size
(width and height) (wh, hh) ∈ R2 as well as the local point
offset δch ∈ R2 to recover the discretization error caused
by the output stride. The object box is represented similarly.
Moreover, we deﬁne the interaction point (xa, ya) ∈ R2 as
the midpoint of the paired human point and object point.
Considering the receptive ﬁeld of the interaction point is
large enough to contain both human and object, the human
action a can be estimated based on the feature of (xa, ya).
Actually, when there are M human in the dataset, each hu-
man box is represented as (xh
i ), i ∈ [1, M ]. For the

i , yh

2

convenience of description, we omit the subscript i when
no confusion is caused. Similar omissions are also applica-
ble for (xo, yo) and (xa, ya).

(cid:99)).

In Figure 3, the input image I ∈ RH×W is fed into
d × W
the feature extractor to produce the feature V ∈ R H
d ,
where W and H are the width and height of the input
image and d is the output stride. The point heatmaps
are of low-resolution,
thus we also calculate the low-
resolution center points. Given a ground-truth human
point (xh, yh), the corresponding low-resolution point is
(˜xh, ˜yh) = ((cid:98) xh
d (cid:99)). The low-resolution ground-truth
object point (˜xo, ˜yo) can be computed in the same way.
Based on the low-resolution human and object points, the
ground-truth interaction point can be deﬁned as (˜xa, ˜ya) =
((cid:98) ˜xh+˜xo
2

(cid:99), (cid:98) ˜yh+˜yo

d (cid:99), (cid:98) yh

d × W

Point location loss. Directly detecting a point is difﬁ-
cult, thus we follow the key-point estimation methods [25]
to splat a point into a heatmap with a Gaussian kernel.
Thereby the point detection is transformed into a heatmap
estimation task. The three ground-truth low-resolution
points (xh, yh), (xo, yo) and (xa, ya) are splatted into three
Gaussian heatmaps, including human point heatmap ˜Ch ∈
d , object point heatmap ˜Co ∈ [0, 1]T × H
[0, 1] H
d and
interaction point heatmap ˜Ca ∈ [0, 1]K× H
d , where T
is the number of object categories and K is the the num-
ber of interaction classes. Note that in ˜Co and ˜Ca, only
the channel corresponding to the speciﬁc object class and
human action are non-zero. The three heatmaps are pro-
duced by adding three respective convolutional blocks upon
the feature map V , each of which is composed of a 3 × 3
convolutional layer with ReLU, followed by a 1 × 1 convo-
lutional layer and a Sigmoid.

d × W

d × W

For the three heatmaps, we all apply an element-wise
focal loss [17]. For example, given an estimated interac-
tion point heatmap ˆC
and the corresponding ground-truth
heatmaps ˜C

a

a

La = −

1
N

, the loss function is:
(1 − ˆC a
(1 − ˜C a




kxy)α log( ˆC a
kxy)β( ˆC a
kxy),

kxy)
kxy)α

log(1 − ˆC a



(cid:88)

kxy

if ˜C a
kxy = 1
otherwise

(1)
where N is equal to the number of interaction points (HOI
triplet) in the image, and ˆC a
kxy is the score at location (x, y)
for class k in the predicted heatmaps ˆCa. We set α as 2
and β as 4 following the default setting in [15, 35, 4]. The
losses Lp and Lo for the human points and the object points
can be computed similarly.

Size and offset loss. Besides the center points, the box
size and the local offset for the center points are needed to
form the human/object box. Four convolutional blocks are
added to the feature map V to estimate the 2-D size and the
local offset of human and object boxes respectively. Each
block contains a 3 × 3 convolutional layer with ReLU and

a 1 × 1 convolutional layer.

During training, we only compute the L1 loss at each lo-
cation of the ground truth human point (˜xh, ˜yh) and object
point (˜xo, ˜yo) and ignore all other locations. We take the
loss function for the local offset as an example, while the
size regression loss Lwh is deﬁned similarly. The ground
truth local offset for the human point localized at (˜xh, ˜yh)
is deﬁned as (˜δx
d − ˜yh).
Thus the loss function Lof f is the summation of the human
box loss Lh

(˜xh,˜yh)) = ( xh

of f and object box loss Lo

d − ˜xh, yh

(˜xh,˜yh), ˜δy

of f .

Lof f =

1
M + D

(Lh

of f + Lo

of f )

Lh

of f =

(cid:88)

(|˜δx

(˜xh,˜yh) − ˆδx

(˜xh,˜yh)|

(2)

(3)

(˜xh,˜yh)∈ ˜Sh
+ |˜δy

(˜xh,˜yh)|,

(˜xh,˜yh) − ˆδy
where ˜Sh and ˜Sh denote the ground-truth human and object
points sets in the training set. M = | ˜Sh| and D = | ˜So| are
the number of human points and object points. Note that M
is not necessarily equal to D. For example a human may
correspond to multiple actions and objects. Lo
of f is deﬁned
similarly with Equation 3.

3.3. Point Matching

The points matching branch pairs the human box with its
corresponding object box by using the interaction point as
the bridge. More speciﬁcally, the interaction point is treated
as the anchor. Two displacements dah = (dah
y ) and
dao = (dao
y ), i.e., the displacements between interac-
tion point vs. human/box point are estimated. The coarse
human point and object point are (xa, ya) plus dah and dao
respectively.

x , dah

x , dao

Our proposed displacement branch is composed of two
convolutional modules. Each module consists of a 3×3 con-
volutional layer with ReLU and a 1 × 1 convolutional layer.
The size of both subject and object displacement maps are
2 × H

d × W
d .

Displacement loss. To train the displacement branch,
we apply L1 loss for each interaction point. The ground-
truth displacement from the interaction point located at
(˜xa, ˜ya) to the corresponding human point can be computed
by ( ˜dhx
(˜xa,˜ya)) = (˜xa − ˜xh, ˜ya − ˜yh). The predicted
displacement at location of (˜xa, ˜ya) is ( ˆdhx
(˜xa,˜ya)).
The displacement loss is deﬁned as:

(˜xa,˜ya), ˆdhy

(˜xa,˜ya), ˜dhy

Lah =

1
N

(cid:88)

| ˆdhx

(˜xa,˜ya) − ˜dhx

(˜xa,˜ya)|

(˜xa,˜ya)∈ ˜Sa
(˜xa,˜ya) − ˜dhy

+ | ˆdhx

(˜xa,˜ya)|,

(4)

where ˜Sa denotes the ground-truth interaction point sets in
the training set. N = | ˜Sa| is the number of interaction

points. The loss function for displacement from the interac-
tion point to the object point Lao has the same form.

Triplet matching. Two aspects are considered to judge
whether a human/object point can be matched with the in-
teraction point. The human/object needs to: 1) be close
to the coarse human/object point generated by interaction
point plus the displacement and 2) have high conﬁdence
scores. On basis of these, for the detected interaction point
(ˆxa, ˆya), we rank the points in the detected human point set
ˆSh by Equation 5 and select the optimal one.
(ˆxh

opt) = arg min
(ˆxh,ˆyh)∈ ˆSh
(|(ˆxa, ˆya) − ( ˆdhx

,
(ˆxa,ˆya)) − (ˆxh, ˆyh)|)
(5)
(ˆxh,ˆyh) denotes the conﬁdence score for human
opt) can be

where C h
point (ˆxh, ˆyh). The optimal object box (ˆxo
calculated similarly.

(ˆxa,ˆya), ˆdhy

opt, ˆyh

opt, ˆyo

(ˆxh,ˆyh)

C h

1

3.4. Loss and Inference

The ﬁnal loss can be obtained by weighted summing the

above losses:

L = La + Lh + Lo + λ(Lah + Lao + Lwh) + Lof f (6)

where we set the λ as 0.1 following [15, 35]. La, Lh and Lo
are point location loss, Lah and Loh are displacement loss
while Lwh and Lof f are size and offset lose .

During the inference, we ﬁrstly do a 3 × 3 max-pooling
operation with stride 1 on the predicted human, object and
interaction points heatmap, which plays a similar role as
NMS. Secondly, we select top K human points ˆSh, object
center points ˆSo and interaction points ˆSa through the cor-
responding conﬁdence scores ˆC h, ˆC o and ˆC a across all cat-
egories. Then, we ﬁnd the subject point and object point
for each selected interaction point by Equation 5. For each
matched human point (ˆxh
opt), we get the ﬁnal box as:

opt, ˆyh

(ˆxh

ref −

ˆxh
ref +

ˆw(ˆxh

opt)

opt,ˆyh
2

ˆw(ˆxh

opt)

opt,ˆyh
2
opt + ˆδx
(ˆxh

, ˆyh

ref −

opt)

opt,ˆyh
2

,

ˆh(ˆxh

ˆh(ˆxh

, ˆyh

opt)

ref +

opt,ˆyh
2
ref = ˆyh
opt) and ˆyh

.

where ˆxh
ˆδy
(ˆxh

opt,ˆyh

ref = ˆxh
opt +
opt) are the reﬁned location of the human center
ˆw(ˆxh

opt,ˆyh

ˆh(ˆxh

,

) is the size of box in the
point. (
corresponding position. The ﬁnal HOI detection results are
a set of triplets, and the conﬁdence score for the triplet is
ˆC p
.
ref ˆyh
ˆxh

ˆC a
ref ˆya
ˆxa

ˆC o
ref ˆyo
ˆxo

ref

ref

ref

opt , ˆyh
2

opt, ˆyh
2

opt )

opt)

4. HOI-A Dataset

The existing datasets such as HICO-Det [22] and V-
COCO [11] have greatly boosted the development of related

research. However, in practical application, there are lim-
ited frequent HOI categories that need to be paid special
attention to, which are not emphasized in previous datasets.
We then introduce a new dataset called Human-Object In-
teraction for Application (HOI-A).

Figure 4. Example images of our HOI-A dataset. We take
<human, smoke, cigarette> as an example. The (a)-(d) show huge
intra-class variations of <human, smoke, cigarette> in the wild.
The (e)-(f) show two kinds of negative samples.

As shown in Table 1, we select the categories of verb
driven by practical application. Each kind of verb in HOI-A
dataset has its corresponding application scenario, for ex-
ample ‘talk on’ can be applied in dangerous action detec-
tion, e.g., if the human is talking on phone in-car, it can be
considered as a dangerous driving action.

Verbs
smoking
talk on
play (mobile phone)
eat
drink
ride

hold

kick
read
play (computer)

Objects
cigarette
mobile phone
mobile phone
food
drink
bike, motorbike, horse
cigarette, mobile phone, food
drink, document, computer
sports ball
document
computer

# Instance
8624
18763
6728
831
6898
7111

44568

365
869
1402

(7)

Table 1. The list and occurrence numbers of the verbs of the cor-
responding objects in HOI-A dataset.

4.1. HOI-A Construction

We describe the image collection and annotation process
for constructing the HOI-A dataset. The ﬁrst step is collect-
ing candidate images, which can be divided into two parts,
namely positive and negative images collections.
Positive Images Collection. We collect positive images
in two ways, i.e., camera shooting and crawling. Camera
shooting is an important way to enlarge the intra-class vari-
ations of the data. We employ 50 performers and require
them to perform all predeﬁned actions in different scenes
and illumination, with various poses, and take photos of
them respectively with an RGB camera and an IR camera.
For data crawling from the Internet, we generate a series of

keywords based on the HOI triplet < person, action name,
object name>, action pair <action name, object name> and
action name, and retrieve images from the Internet.
Negative Images Collection. Negative Images Collection.
There are two kinds of negative samples of the predeﬁned
< human, interaction, object >. 1) The concerned object
appears in the image, but the concerned action does not hap-
pen. For example, in Figure 4(f), although the cigarette ap-
pears in the image, it is not smoked by a human. Therefore,
the image is still a negative sample. 2) Other action similar
to the concerned action happens but the concerned object is
missing. For example, in Figure 4(e), the man is smoking at
a glance. But a closer look shows there is no cigarette in the
image. We collect this kind of negative sample in the ‘at-
tack manner. We ﬁrstly train a multi-label action classiﬁer
based on the annotated positive images. The classiﬁer takes
an image as input and outputs the probability of action clas-
siﬁcation. Then, we let actors perform arbitrarily to attack
the classiﬁer without any interacted objects. If the attack is
successful, we record this image as a hard negative sample.
Annotation. The process of annotation contains two steps:
box annotation and interaction annotation. First, all objects
in the pre-deﬁned categories are annotated with a box and
the corresponding category. Second, we visualize the boxes
in the images with their id and annotate whether a person
has the deﬁned interactions with a object. The annotator
should record the triplet <person ID, action ID, object ID>.
For more accurate annotation, each image is annotated by 3
annotators. The annotation of an image is regarded qualiﬁed
if at least 2 annotators share the same annotation.
4.2. Dataset Properties
Scale. Our HOI-A dataset consists of 38,668 annotated im-
ages, 11 kinds of objects and 10 action categories. In de-
tail, it contains 43, 820 human instances, 60, 438 object in-
stances and 96, 160 interaction instances. There are on av-
erage 2.2 interactions performed per person. Table 1 lists
the number of instances for each verb which occurs at least
360 times. 60% verbs appear more than 6, 500 times. To
our knowledge, this is already the largest HOI dataset, in
terms of the number of images per interaction category.
Intra-Class Variation. To enlarge the intra-class variation
of the data, each type of verbs in our HOI-A dataset will
be captured with three general scenes including indoor, out-
door and in-car, three lighting conditions including dark,
natural and intense, various human poses and different an-
gles. Additionally, we shoot the images with two kinds of
cameras: RGB and IR.

5. Experiments

5.1. Experimental Setting

Datasets. To verify the effectiveness of our PPDM, we con-
duct experiments not only on our HOI-A dataset but also on

the general HOI detection dataset HICO-Det [2]. HICO-
Det is a large-scale dataset for common HOI detection. It
has 47, 776 images (38, 118 for training and 9, 658 for test),
annotated with 117 verbs including ‘no-interaction’ and 80
object categories. The 117 verbs and 80 objects form 600
kinds of HOI triplets, where 138 types of HOIs which ap-
pear <10 times are considered as the rare set, and the rest
462 kinds of HOIs form the non-rare set.

Metric. Following the standard-setting in HOI detection
task, we use mean average precious (mAP) as the metric. If
a predicted triplet is considered as a true positive sample, it
needs to match a certain ground-truth triplet. Speciﬁcally,
they have the same HOI class and their human and object
boxes have overlap with IOUs large than 0.5. There is a
slight difference when computing AP on the two datasets.
We compute AP per HOI class in HICO-Det and compute
AP per verb class in HOI-A dataset.

Implementation Details. We use two common heatmap
prediction networks as our feature extractor, Hourglass-
104 [21, 15] and DLA-34 [31, 35]. Hourglass-104 is a
general heatmap prediction network commonly used in key-
point detection and object detection.
In PPDM, we use
the modiﬁed version Hourglass-104 proposed in [15]. The
DLA-34 is a lightweight backbone network, and we apply a
reﬁned version proposed in [35]. The receptive ﬁeld of the
network need large enough to cover the subject and the ob-
ject. Hourglass-104 has a sufﬁciently large receptive ﬁeld,
while that of DLA-34 cannot cover the region including the
human and the object, due to its relatively shallow archi-
tecture. Thus for the DLA-based model, we concatenate
the last three level features and apply a graph-based global
reasoning module [3] to enlarge the receptive ﬁeld for the
interaction point and displacement prediction. In the global
reasoning module, we set the channels of the node and the
reduced feature as 48 and 96 respectively. For Hourglass-
104, we only use the last-level feature for all the follow-
ing modules. We initialize the feature extractor with the
weights pre-trained on COCO [18]. Our experiments are all
conducted on the Titan Xp GPU and CUDA 9.0.

During training and inference, the input resolution is
512 × 512 and the output is 128 × 128. PPDM is trained
with Adam on 8 GPUs. We set the hyper-parameter follow-
ing [35], which is robust to our framework. We train the
model based on DLA-34 with a 128 sized mini-batch for
110 epochs, with a learning rate of 5e-4 decreased to 5e-5
at the 90th epoch. For the hourglass-104 based model, we
train it with a batch size of 32 for 110 epochs, with a learn-
ing rate of 3.2e-4 decreased by 10 times at the 90th epoch.
We follow [15, 35] applying data augmentation, i.e., ran-
dom scale and random shift to train the model and there is
no augmentation during inference. We set the number of
selected predictions K as 100.

Method
Shen et. al [24]
HO-RCNN [2]
InteractNet [9]
GPNN [22]
Xu et. al [28]
iCAN [7]
PMFNet-Base [26]
Wang et. al [27]
No-Frills [12]
TIN [16]
RPNN [33]
PMFNet [26]
PPDM-DLA
PPDM-Hourglass

Feature
A + P
A + S
A
A
A + L
A + S
A + S
A
A + S + P
A + S + P
A + P
A + S + P
A
A

Full
6.46
7.81
9.94
13.11
14.70
14.84
14.92
16.24
17.18
17.22
17.35
17.46
20.29
21.73

Default
Rare
4.24
5.37
7.16
9.34
13.26
10.45
11.42
11.16
12.17
13.51
12.78
15.65
13.06
13.78

Non-Rare
7.12
8.54
10.77
14.23
15.13
16.15
15.96
17.75
18.68
18.32
18.71
18.00
22.45
24.10

Know Object

Full
-
10.41
-
-
-
16.26
18.83
17.73
-
19.38
-
20.34
23.09
24.58

Rare
-
8.94
-
-
-
11.33
15.30
12.78
-
15.38
-
17.47
16.14
16.65

Non-Rare
-
10.85
-
-
-
17.73
19.89
19.21
-
20.57
-
21.20
25.17
26.84

Inference Time (ms) ↓
-
-
145
197 + 48 = 245
-
92 + 112 = 204
-
-
197 + 230 + 67 = 494
92 + 98 + 323 = 513
-
92 + 98 + 63 = 253
27
71

FPS ↑
-
-
6.90
4.08
-
4.90
-
-
2.02
1.95
-
3.95
37.03
14.08

Table 2. Performance comparison on the HICO-DET test set. The ‘A’, ‘P’, ‘S’, ‘L’ represent the appearance feature, human pose informa-
tion, the spatial feature, and the language feature, respectively.

5.2. Comparison to State-of-the-art

We compare PPDM with state-of-the-art methods on two
datasets. The quantitative results can be seen in Table 2
and Table 3, and the qualitative results are presented in Fig-
ure 5. The compared methods mainly use a pre-trained
Faster R-CNN [23] to generate a set of human-object pro-
posals, which are then fed into a pairwise classiﬁcation net-
work. As shown in Table 2, to more accurately classify the
HOI, many methods use additional human pose feature or
language feature.

5.2.1 Quantitative Analysis

HICO-Det. See table 2. Our PPDM-DLA and PPDM-
Hourglss both outperform all previous state-of-the-art meth-
ods. Speciﬁcally, our PPDM-Hourglass achieves a signiﬁ-
cant performance gain (24.5%) comparing to the previous
best method PMFNet [26]. We can see the previous meth-
ods with mAP greater than 17% all use the human pose as
an additional feature, while our PPDM only uses the ap-
pearance feature. Performance of PPDM is slightly lower
than PMFNet on the rare subset. However, the baseline
model in PMFNet without using human pose information
only achieves 11.42% mAP on the rare-set. The perfor-
mance gain on the rare-set may mainly come from the ad-
ditional human pose feature. The human structural infor-
mation plays an important role in understanding human ac-
tions, thus we regard how to utilize human context in our
framework as a signiﬁcant future work.
HOI-A. The compared methods in HOI-A dataset are com-
posed of two parts. Firstly, we select the top-3 methods
from the leaderboard of ICCV 2019 PIC challenge HOI de-
tection track [1], which was held by us based on HOI-A
dataset. Comparing to the top-1 method, C-HOI [34], which
uses a very strong detector, our methods still outperform it.
Secondly, we choose two open-source state-of-the-art meth-
ods, iCAN [7] and TIN [16], as the baselines on our HOI-

Method
Faster Interaction Net [1]
GMVM [1]
C-HOI [34]
iCAN [7]
TIN [16]
PPDM-DLA
PPDM-Hourglass

mAP (%)
56.93
60.26
66.04
44.23
48.64
67.45
71.23

Time (ms)
-
-
-
194
501
27
71

Table 3. Performance comparison on HOI-A test set.

A dataset. We ﬁrst pre-train Faster R-CNN with FPN and
ResNet-50 on HOI-A dataset, and then follow their origi-
nal settings to train the HOI classiﬁer. The results show our
PPDM outperforms the two methods by a signiﬁcant mar-
gin. Additionally, for our selected interaction types with
practical signiﬁcance, our PPDM can achieve high perfor-
mance, which is practically applicable.

5.2.2 Qualitative Analysis
We visualize the HOI prediction with the top-3 conﬁ-
dence score on HICO-Det dataset based on PPDM-DLA,
and compare our results with the typical two-stage method
iCAN [7]. As shown in Figure 5, we select some rep-
resentative failure cases of the two-stage methods. We
can see iCAN tends to focus on the human/object with a
high detection score but without interaction. In Figure 5(b)
and Figure 5(c), due to the huge imbalance between pos-
itive/negative samples, iCAN easily produces high conﬁ-
dence for the ‘no-interaction’ type. In Figure 5(d), the per-
son sitting on the airplane is so small that it cannot be de-
tected. However, our PPDM can accurately predict the HOI
triplets with high conﬁdence in these cases. Because PPDM
is not dependent on the proposals. Moreover, PPDM con-
centrates on the HOI triplets understanding.

5.2.3 Efﬁciency Analysis
We compare the inference speed on a single Titan Xp GPU
with the methods which have released code or reported the

Figure 5. Visualization results compared with iCAN on HICO-Det. The ﬁrst row is the prediction of iCAN and the second row by PPDM.
Purple denotes the subject and red is the object. If a subject has interaction with an object, they will be linked by a green line. We show
results with top-3 conﬁdence per image: 1-blue, 2-yellow, 3-pink. The ‘no’ denotes ‘no-interaction’.
Non-Rare
22.01
22.22
21.90
20.61
22.45

Method
Basic Model
+ Feature Fusion
+ Global Reasoning
Union Center
PPDM-DLA

Rare
13.01
12.56
12.99
12.11
13.06

Full
19.94
20.00
19.85
18.65
20.29

Time
24
26
26
27
27

1
2
3
4
5

Table 4. Component analysis on HICO-Det Test Set.

speed. As shown in Table 2, PPDM with DLA and Hour-
glass are both faster than other methods by a large mar-
gin. PPDM-DLA is the only real-time method, which only
takes 27ms for inference. Concretely, the inference time of
two-stage HOI detection methods can be divided into pro-
posal generation time and HOI classiﬁer time. Besides, the
pose based methods take extra time to estimate human key-
points. It can be seen that the speed of PPDM-DLA is faster
than any stage of the compared methods.
5.3. Component Analysis

We analyze the proposed components in PPDM from

quantitative and qualitative views.

global reasoning. The ﬁrst row in Table 4 represents the ba-
sic framework with DLA, where we predict the interaction
only based on the last-level feature. It shows that the basic
model can still outperform all existing methods. It proves
the effectiveness of our designed framework. The second
row and third row show the results of the basic model with
the feature fusion and a global reasoning module respec-
tively, it can be seen in Table 4 that the performance only
change little.
If we add a these two settings to the basic
framework as the same time, that the performance improves
by 0.35% mAP. We conclude that a larger receptive ﬁeld
and global context are helpful to interaction prediction.
Point Detection. To verify whether the midpoint of two
center points is the best choice to predict the interaction,
we perform an experiment based on the interaction point at
the center of the union of human and object boxes, which is
another suitable location to predict the interaction. See the
4th row in Table 4. The mAPs drop 1.64 point compared
with PPDM-DLA. It is common that two objects interact
with the same person and may locate in the human box, in
which case the center points of their union boxes overlap.
Additionally, we analyze our interaction point qualitatively.
As shown in Figure 6, the predicted interaction almost ac-
curately locates at the midpoint of the human/object points,
though the human is apart from the object or in the object.
Point Matching. To further understand the displacement,
we visualize the displacements in Figure 6. We can see
the interaction point plus the corresponding displacement
is very close to the center point of the human/object box,
even though the human/object is hard to be detected.
6. Conclusion

In this paper, we propose a novel one-stage framework
and a new dataset for HOI detection. Our proposed method
can outperform the existing methods by a margin also with
a signiﬁcantly faster speed. It breaks the limits of the tradi-
tional two-stage methods and directly predicts the HOI by
a parallel framework. Our proposed HOI-A dataset is more
inclined to practical application for HOI detection. For fu-

Figure 6. Visualization of interaction points heatmaps and dis-
placements. Red and purple line represent displacements from
interaction point (green) to human and object.
Feature Extractor. We analyze effectiveness of the addi-
tional modules in DLA backbone, i.e., feature fusion and

ture work, we plan to explore how to utilize human context
in our framework. Additionally, we plan to enrich the action
categories for HOI-A dataset.

References

[1] Pic leaderboard.

http://www.picdataset.com/

challenge/leaderboard/hoi2019.

[2] Yu-Wei Chao, Yunfan Liu, Xieyang Liu, Huayi Zeng, and
Jia Deng. Learning to detect human-object interactions. In
WACV, 2018.

[3] Yunpeng Chen, Marcus Rohrbach, Zhicheng Yan, Yan
Shuicheng, Jiashi Feng, and Yannis Kalantidis. Graph-based
global reasoning networks. In CVPR, 2019.

[4] Zhiwei Dong, Guoxuan Li, Yue Liao, Fei Wang, Pengju Ren,
and Chen Qian. Centripetalnet: Pursuing high-quality key-
point pairs for object detection. In CVPR, 2020.

[5] Hao-Shu Fang, Jinkun Cao, Yu-Wing Tai, and Cewu Lu.
Pairwise body-part attention for recognizing human-object
interactions. In ECCV, 2018.

[6] Wei Feng, Wentao Liu, Tong Li, Jing Peng, Chen Qian, and
Xiaolin Hu. Turbo learning framework for human-object in-
teractions recognition and human pose estimation. 2019.
[7] Chen Gao, Yuliang Zou, and Jia-Bin Huang. ican: Instance-
centric attention network for human-object interaction detec-
tion. In BMVC, 2018.

[8] Ross Girshick. Fast r-cnn. In CVPR, 2015.
[9] Georgia Gkioxari, Ross Girshick, Piotr Doll´ar, and Kaiming
He. Detecting and recognizing human-object interactions. In
CVPR, 2018.

[10] Abhinav Gupta, Aniruddha Kembhavi, and Larry S Davis.
Observing human-object interactions: Using spatial and
functional compatibility for recognition. TPAMI, 2009.
[11] Saurabh Gupta and Jitendra Malik. Visual semantic role la-

beling. arXiv preprint arXiv:1505.04474, 2015.

[12] Tanmay Gupta, Alexander Schwing, and Derek Hoiem. No-
frills human-object interaction detection: Factorization, ap-
pearance and layout encodings, and training techniques. In
ICCV, 2019.

[13] Roei Herzig, Moshiko Raboh, Gal Chechik, Jonathan Be-
rant, and Amir Globerson. Mapping images to scene graphs
In NIPS,
with permutation-invariant structured prediction.
2018.

[14] Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson,
Kenji Hata, Joshua Kravitz, Stephanie Chen, Yannis Kalan-
tidis, Li-Jia Li, David A Shamma, et al. Visual genome:
Connecting language and vision using crowdsourced dense
International Journal of Computer Vi-
image annotations.
sion, 123(1):32–73, 2017.

[15] Hei Law and Jia Deng. Cornernet: Detecting objects as

paired keypoints. In ECCV, 2018.

[16] Yong-Lu Li, Siyuan Zhou, Xijie Huang, Liang Xu, Ze Ma,
Hao-Shu Fang, Yan-Feng Wang, and Cewu Lu. Transferable
interactiveness prior for human-object interaction detection.
In CVPR, 2019.

[17] Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and
Piotr Doll´ar. Focal loss for dense object detection. In CVPR,
2017.

[18] Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays,
Pietro Perona, Deva Ramanan, Piotr Doll´ar, and C Lawrence
Zitnick. Microsoft coco: Common objects in context.
In
ECCV, 2014.

[19] Cewu Lu, Ranjay Krishna, Michael Bernstein, and Li Fei-
Fei. Visual relationship detection with language priors. In
ECCV, 2016.

[20] Alejandro Newell and Jia Deng. Pixels to graphs by associa-

tive embedding. In NIPS, 2017.

[21] Alejandro Newell, Kaiyu Yang, and Jia Deng. Stacked hour-
glass networks for human pose estimation. In ECCV, 2016.
[22] Siyuan Qi, Wenguan Wang, Baoxiong Jia, Jianbing Shen,
and Song-Chun Zhu. Learning human-object interactions by
graph parsing neural networks. In ECCV, 2018.

[23] Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.
Faster r-cnn: Towards real-time object detection with region
proposal networks. In NIPS, 2015.

[24] Liyue Shen, Serena Yeung, Judy Hoffman, Greg Mori, and
Li Fei-Fei. Scaling human-object interaction recognition
through zero-shot learning. In WACV, 2018.

[25] Jonathan J Tompson, Arjun Jain, Yann LeCun, and Christoph
Joint training of a convolutional network and a

Bregler.
graphical model for human pose estimation.

[26] Bo Wan, Desen Zhou, Yongfei Liu, Rongjie Li, and Xuming
He. Pose-aware multi-level feature network for human object
interaction detection. In ICCV, 2019.

[27] Tiancai Wang, Rao Muhammad Anwer, Muhammad Haris
Khan, Fahad Shahbaz Khan, Yanwei Pang, Ling Shao, and
Jorma Laaksonen. Deep contextual attention for human-
object interaction detection. In ICCV, 2019.

[28] Bingjie Xu, Yongkang Wong, Junnan Li, Qi Zhao, and Mo-
han S. Kankanhalli. Learning to detect human-object inter-
actions with knowledge. In CVPR, 2019.

[29] Danfei Xu, Yuke Zhu, Christopher B Choy, and Li Fei-Fei.
Scene graph generation by iterative message passing.
In
CVPR, 2017.

[30] Bangpeng Yao and Li Fei-Fei. Recognizing human-object
interactions in still images by modeling the mutual context
of objects and human poses. TPAMI, 2012.

[31] Fisher Yu, Dequan Wang, Evan Shelhamer, and Trevor Dar-

rell. Deep layer aggregation. In CVPR, 2018.

[32] Ji Zhang, Kevin J Shih, Ahmed Elgammal, Andrew Tao,
and Bryan Catanzaro. Graphical contrastive losses for scene
graph parsing. In CVPR, 2019.

[33] Penghao Zhou and Mingmin Chi. Relation parsing neural
In ICCV,

network for human-object interaction detection.
2019.

[34] Tianfei Zhou, Wenguan Wang, Siyuan Qi, Haibin Ling, and
Jianbing Shen. Cascaded human-object interaction recogni-
tion. In CVPR, 2020.

[35] Xingyi Zhou, Dequan Wang, and Philipp Kr¨ahenb¨uhl. Ob-
jects as points. arXiv preprint arXiv:1904.07850, 2019.
[36] Bohan Zhuang, Qi Wu, Chunhua Shen, Ian Reid, and An-
ton van den Hengel. Care about you: towards large-scale
human-centric visual relationship detection. arXiv preprint
arXiv:1705.09892, 2017.

