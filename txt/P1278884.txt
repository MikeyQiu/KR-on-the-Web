7
1
0
2
 
r
p
A
 
1
1
 
 
]

V
C
.
s
c
[
 
 
1
v
5
2
2
3
0
.
4
0
7
1
:
v
i
X
r
a

Reconstruction of three-dimensional porous media
using generative adversarial neural networks

Lukas Mosser,∗ Olivier Dubrule,† and Martin J. Blunt‡
Department of Earth Science and Engineering,
Imperial College London

(Dated: April 12, 2017)

To evaluate the variability of multi-phase ﬂow properties of porous media at the pore scale, it is
necessary to acquire a number of representative samples of the void-solid structure. While modern
x-ray computer tomography has made it possible to extract three-dimensional images of the pore
space, assessment of the variability in the inherent material properties is often experimentally not
feasible. We present a novel method to reconstruct the solid-void structure of porous media by
applying a generative neural network that allows an implicit description of the probability distribu-
tion represented by three-dimensional image datasets. We show, by using an adversarial learning
approach for neural networks, that this method of unsupervised learning is able to generate repre-
sentative samples of porous media that honor their statistics. We successfully compare measures of
pore morphology, such as the Euler characteristic, two-point statistics and directional single-phase
permeability of synthetic realizations with the calculated properties of a bead pack, Berea sand-
stone, and Ketton limestone. Results show that GANs can be used to reconstruct high-resolution
three-dimensional images of porous media at diﬀerent scales that are representative of the morphol-
ogy of the images used to train the neural network. The fully convolutional nature of the trained
neural network allows the generation of large samples while maintaining computational eﬃciency.
Compared to classical stochastic methods of image reconstruction, the implicit representation of
the learned data distribution can be stored and reused to generate multiple realizations of the pore
structure very rapidly.

PACS numbers: 02.50.Ey, 07.05.Mh, 42.30.Wb, 83.80.Fg
Keywords: stochastic image reconstruction, porous media, artiﬁcial neural networks

I.

INTRODUCTION

A.

Image Reconstruction

The reconstruction and the evaluation of the material
properties of porous media plays a key role across many
engineering disciplines. Many physical processes such as
the movement of multiple phases of ﬂuids through sedi-
mentary rocks are controlled by individual pores at the
micron and sub-micron scale [1].

In carbon capture and sequestration (CCS), the long
term storage behavior is controlled by the physical and
chemical interaction of super-critical CO2 with the reser-
voir brine, as well as the spatial distribution and connec-
tivity of minerals in the pore-space [2, 3]. The variability
of the controlling properties such as the permeability of
the host rock is determined by repeated experiments or
numerical modeling of these processes.

Using modern computer tomographic methods, it is
possible to observe porous materials and evaluate their
material properties at the micrometer scale (micro-CT)
under static and transient conditions at high pressures
and temperatures in near real time. Performing micro-

∗ lukas.mosser15@imperial.ac.uk
† o.dubrule@imperial.ac.uk
‡ m.blunt@imperial.ac.uk

CT imaging of porous media requires specialized, expen-
sive equipment and in the case of CCS, only a single
image of the investigated rock type is typically acquired.
To evaluate the variability associated with the geomet-
rical and mineralogical morphology of the pore-space, nu-
merous physical experiments using the same rock type
would have to be performed to obtain a distribution over
larger volumes. Due to time and cost limitations inher-
ent with the experimental acquisition of high-resolution
images, this is often deemed unfeasible. Material prop-
erties governing the single and multi-phase ﬂow behavior
of porous media can be estimated from numerical so-
lution of partial diﬀerential equations at the scale of a
representative elementary volume (REV) and veriﬁed by
experimental results [4].

Many sedimentary rocks consist of granular siliciclas-
tic or carbonate materials. Boolean models use this fun-
damental characteristic of natural granular materials to
emulate the shape of the arising pore space, due to an
underlying random process that controls the distribution
of the individual grains [5, 6]. While for the classical
Boolean model, the centers of the grains are uniformly
distributed in space and grains can arbitrarily overlap,
more complicated models with rigid hard sphere grains
and more complex grain interaction functions have been
developed [7–10]. The framework of Boolean models also
allows extension beyond spherical particles and enables
derivation of the properties of material models as

a function of the parameters of the underlying random

process [11–14].

In sedimentary rocks, the arrangement of individual
grains occurs due to the transport of material from a
high energy source to a low energy sink. Process mod-
els, where depositional mechanisms are simulated, have
been shown to reproduce realistic granular reconstruc-
tions capturing the pore space morphology of granular
sedimentary rocks [15].

Spatial probabilistic models such as truncated Gaus-
sian processes or sequential indicator simulation have
been widely applied in the geosciences to model the spa-
tial distribution of materials [16]. Many of these methods
rely on two-point probability functions as a measure of
spatial variability, whereas recent methods in geostatis-
tics use training images as a basis for sample reconstruc-
tion [17–19]. These images are usually assumed to exhibit
stationarity of the probability distribution of the prop-
erties of interest and rely on higher order multiple point
statistics (MPS) to reconstruct stochastic random media.
With MPS, the probability distributions are repre-
sented by training images and are sampled using a limited
multi-scale neighborhood that captures the variation on
a large scale, as well as ﬁne structural details on smaller
scales [20]. MPS based methods have been used in two
and three-dimensional conditional simulation of spatial
properties in reservoir-scale earth modeling applications
[21]. The computational complexity of these methods
is highly dependent on individual algorithms as well as
the size of the domains used to sample from the training
images [22]. Parallelized versions have been developed,
reducing the computational time required to perform re-
construction using multiple point statistics [23, 24].

Three-dimensional porous media have been recon-
structed using a modiﬁed multiple-point statistics ap-
proach based on two-dimensional images of porous media
[25–27].

Stochastic methods based on simulated annealing al-
low the incorporation of arbitrary cost functions of sta-
tistical and morphological properties used in uncondi-
tional three-dimensional image reconstruction [28, 29].
Recent advances have reduced the computational run-
time of simulated annealing based methods for recon-
struction of porous media, to the order of tens of hours
per realization at the scale of 3003 voxels [30].

In the following section, we introduce a recently de-
veloped class of unsupervised machine learning methods
called generative adversarial networks (GAN) that al-
low simulation of probability distributions given a set
of training data [31]. Volumetric generative adversarial
networks have previously been applied to low-resolution
three-dimensional CAD model synthesis, and practical
applications of 3D-GANs are few compared to their
two-dimensional counterpart [32]. Integration of multi-
resolution datasets incorporating image data across a
number of length scales is possible in the GAN frame-
work by using a Laplacian pyramid approach such as
StackGAN [33].

2

We investigate the applicability of GANs to model
three-dimensional textures of rocks based on three-
dimensional binary representations of porous media ac-
quired at the micrometer scale. We compare statistical,
morphological and transport properties of the simulated
images with those of the training images. We evaluate
the single-phase directional permeability to show that the
synthetic realizations sampled from the learned represen-
tation of the input data can capture single-phase ﬂow
properties of sedimentary rocks.

Training of these neural networks involves ﬁnding a
set of hyperparameters that lead to stable training [34].
While this training can take on the order of tens of hours,
the sampling of large volumetric domains occurs on the
order of seconds on the current generation of graphical
processing units (GPU). We show that in favorable cases
convolutional neural networks incorporated in the GAN
framework allow the generation of synthetic reconstruc-
tions of porous media that exceed the dimensions of their
training images. Contrary to most existing simulation
techniques the set of parameters used to generate syn-
thetic realizations can be stored once trained allowing
rapid generation of new samples to assess the variability
of material properties.

While we apply GANs to a set of micro-CT images
of porous media, the method can readily be applied to
volumetric images of porous media obtained from other
three-dimensional microscopy instruments such as nano
or medical-CT instruments.

We discuss the challenges involved in training GANs
for stochastic image reconstruction of porous media, as
compared to other stochastic image reconstruction meth-
ods and evaluate the computational eﬃciency of GAN
based image reconstruction. Finally, we provide empir-
ical guidelines on the requirements of the input dataset
to allow successful training of GANs on large three-
dimensional voxel representations of natural porous me-
dia.

All data used in this study is available in the public
domain and we have made the code used for training,
as well as example pre-trained models, available as addi-
tional supporting material 1. A public dataset of high-
resolution micro-CT images made available by the Impe-
rial College Pore-Scale Modelling Group 2, of a spherical
beadpack, Berea sandstone, and oolitic Ketton limestone
will serve as benchmark cases to study the application of
GANs to three-dimensional stochastic image reconstruc-
tion.

1 https://github.com/LukasMosser/PorousMediaGan
2 http://www.imperial.ac.uk/earth-science/research/

research-groups/perm/research/pore-scale-modelling/
micro-ct-images-and-networks/

3

FIG. 1. Overview of the GAN training process. Segmented volumetric images are usually split into 643 voxel training images.
The generator G is a function that is applied to a sample from a latent random space Z and creates a synthetic realization.
We assume that samples drawn from the hidden latent space Z are distributed according to a normal distribution (see Sec. II).
The discriminator’s role is to determine whether a sample is part of the training image dataset (label 1) or from the generator
(label 0). The misclassiﬁcation error is computed as a binary cross-entropy criterion and the error back-propagated to improve
the discriminator’s ability to distinguish real and ”fake” images. Then the generator is updated to improve the quality of
the produced samples and ”fool” the discriminator. When suﬃcient image quality is obtained, training is stopped, and the
discriminator may be discarded. The generator can now be used to create new samples. By providing larger latent vectors
than used initially for training, larger output images can be produced.

II. GENERATIVE ADVERSARIAL NETWORKS

In the following section, we present generative ad-
versarial networks (GAN) in the context of three-
dimensional image generation. Generative neural net-
works have been developed in the context of deep learn-
ing by Goodfellow et al. as a methodology to learn a
representation of a high-dimensional probability distri-
bution from a given dataset [31]. In the context of image
reconstruction, we refer to this dataset as a set of training
images that present representative samples of the proba-
bility distribution underlying the image space.

GANs learn an implicit representation of the proba-
bility density as opposed to explicit density models. The
main drawback of explicit density models is their compu-
tational cost which grows with the dimensionality of the
samples and requires sequential simulation of each voxel.
For high-dimensional samples such as volumetric image
data, the computational cost is O(N ) where N repre-
sents the number of voxels in the domain of interest and
can easily exceed 109 voxels for modern high-resolution

micro-CT image data. Using any of these methods would
make it intractable to generate a large number of very
large samples. GANs have been designed to perform fast
sampling from the learned density representation and al-
low full parallel generation, making them an ideal candi-
date to generate large volumetric images [34].

GANs consist of two diﬀerentiable functions: a dis-
criminator D and a generator G. The discriminator re-
ceives samples of the ”real” dataset (Label 1) x ∼ pdata
and ”fake” samples G(z) (Label 0) created by the gener-
ator from the hidden latent space Z (see Fig. 1 above).
The latent space Z is composed of independent real
random variables, typically normally or uniformly dis-
tributed, that represent the random input to the genera-
tor G. The generator G maps random variables from the
latent space into the space of images. The discrimina-
tor’s role is to assign a probability that a random sam-
ple is from the ”real” data distribution pdata. The dis-
criminator tries to label each sample correctly, while the
generator tries to ”fool” the discriminator into labeling
the fake images as part of the true data distribution and

therefore achieving D(G(z)) close to one.

More formally we can deﬁne the loss i.e. the cost func-
tion for GANs as a minimization-maximization problem

image datasets. We treat all images under the assump-
tion of stationarity and the existence of a representative
elementary volume.

4

max
D

{Ex∼pdata(x)[log(D(x))]
min
G
+Ez∼pz(z)[log(1 − D(G(z)))]}
Solutions to this optimization problem have been
shown to be Nash equilibria, where each player achieves
a local minimum of their loss function with respect to
their parameters [34].

(1)

In practice we represent G and D by convolutional
neural networks that are trained by a gradient descent
based optimization method. Training is performed in
two steps: First the discriminator is trained to maximize
J (D) = Ex∼pdata(x)[log(D(x))]
+Ez∼pz(z)[log(1 − D(G(z)))]
while the parameters of the generator are ﬁxed. This
improves the ability of the discriminator to distinguish
between real and fake images.

(2)

In a subsequent step we generate synthetic samples
G(z) by drawing samples z from an N-dimensional nor-
mal distributed latent space and train the generator to
minimize

J (G) = Ez∼pz[log(1 − D(G(z)))]

(3)

while keeping the discriminator ﬁxed.

By minimizing Eq. (3) the generator tries to ”fool” the
discriminator into believing that the samples G(z) are
real data samples.
In this way the generator learns to
represent a distribution pg(x) that is as close as possible
to the real data distribution pdata(x). When convergence
is reached pg(x) = pdata(x) and the value of the discrim-
inator becomes 1
2 as it cannot distinguish between the
two anymore.

Initially, the discriminator D outperforms the gener-
ator signiﬁcantly making the gradient used to train the
generator close to zero. Therefore, instead of minimiz-
ing log(1 − D(G(z)) for the generator, it is helpful to
maximize log(D(G(z)) [34].

GANs show highly unstable behavior during training
and a large number of trial and error runs are required to
ﬁnd an optimal set of hyperparameters that allow stable
training. A number of heuristics have been published
which have been shown to stabilize GAN training, such
as one-sided label smoothing and adding white noise to
the input layer of the discriminator [35, 36].

We provide a more detailed overview of the neural
networks used in this study in Sec. III B and later pro-
vide suggestions on how to facilitate eﬃcient training (see
Sec. VI) for volumetric image datasets of porous media.

III. METHODOLOGY

In the following section we outline the criteria used to
evaluate the quality of simulations based on the training

A. Evaluation Criteria

1. Two-Point Statistics

We characterize the second order structure of the
porous media by calculating the two-point probability
function of the pore phase. By assuming stationarity,
this function is equivalent to the non-centered covariance
[7]:

S2(r) = P(x ∈ P, x + r ∈ P ) f or x, r ∈ Rd

(4)

which is the probability P that two points x and x + r,
separated by the lag vector r, are located in the pore
phase P . At the origin, S2(0) is equal to the porosity φ.
S2 stabilizes around φ2 as r → ∞ (Fig. 2). Due to the
anisotropic nature of many porous media, we compute
S2(r) along the three Cartesian directions, as well as the
radial average of S2(r).

FIG. 2. Comparison of S2(r) for a Boolean model and a
packing of hard spheres at a porosity φ = 0.5. S2 exhibits ex-
ponential decay for the Boolean model, whereas a dampened
oscillation is characteristic for packings of spheres. The mean
chord length can be found at the intersection of the slope of
S2 at the origin with the x-axis [see Eq. (6)].

It is a well known result that the speciﬁc surface area
SV of a porous medium can be expressed as a function of
S2 [37]. In the case of an isotropic porous medium and
in three-dimensions SV is related to S2 by

SV = −4S(cid:48)

2(0)

(5)

where S(cid:48)

2(0) is the derivative of S2(r) at the origin.
Furthermore, the average chord length within the pore

and the grain phases are [10]

pore
c =

l

grain
c

l

=

φ
S(cid:48)
2(0)
1 − φ
S(cid:48)
2(0)

(6a)

(6b)

which for the pore phase can be readily found from the
intersection of the slope of S2(r) with the x-axis.

In favorable cases, it is possible to ﬁnd analytical ex-
pressions of S2(r) from the spatial distribution and ge-
ometry of the grains. A Boolean model of overlapping
spherical grains of uniform spatial distribution exhibits
an exponential decay of the covariance until the lag dis-
tance is equal to the diameter of the grains where it be-
comes zero [7]. For porous media that can be well de-
scribed by a Boolean model, we can estimate the size of
the elementary Boolean grain from the decay of S2.

Semi-analytical expressions for more complex models
such as for a packing of hard spheres have been devel-
oped [38]. Models of S2(r) for spherical packings exhibit
a dampened oscillation. The shape of the estimated co-
variance, therefore, allows us to obtain information on
the structure of the porous medium (see Fig. 2 above).

The covariance S2(r) was estimated for the training
images and the stochastic reconstructions generated by
the trained GAN model. For each GAN model, we evalu-
ate the non-centered covariance S2 as well as the speciﬁc
surface area SV [Eq. (5)] and compare these to the values
obtained from the original training images.

In our discussion on the required training image sizes
(Sec. VI), we will use the average chord length and the
speciﬁc surface area as possible indicators of the neces-
sary training image size.

2. Morphological Measures

It has been shown that ﬂow properties at the pore-
scale can be related to morphological characteristics of
the void-solid interface of a porous medium [39]. Had-
wiger’s theorem states that the size of a body in a d-
dimensional space can be described by a linear combina-
tion of d + 1 independent parameters characterizing the
body. In three dimensions we can, therefore, deﬁne four
so-called Minkowski functionals that fully characterize
the size of a three-dimensional object. We compute esti-
mates of three Minkowski functionals; the porosity φ, the
speciﬁc surface area SV and the Euler characteristic χV
corresponding to the zero, ﬁrst and 3rd order functionals.

5

(7)

(8)

(9)

We compute the densities of the Minkowski functionals
by dividing by the volume V .

The Minkowski functional of order zero is the porosity,
deﬁned as the ratio of volume of the void space to the
bulk volume of the sample

and is, therefore, a measure of the ability of a porous
medium to store ﬂuids.

The Minkowski functional of rank one is the speciﬁc

surface area SV .

φ =

Vpore
V

SV =

dS

(cid:90)

1
V

where integration occurs over the void-solid interface S.
The speciﬁc surface area SV has dimensions of
length and
its inverse allows us to deﬁne a characteristic pore size.
The speciﬁc Euler characteristic is closely related to
the order three Minkowski functional and represents a
dimensionless quantity deﬁned as

1

χv =

(cid:90)

1
4πV

1
r1r2

dS

where r1 and r2 are the principal radii of curvature of the
void-solid interface. To compute χV we do not directly
evaluate the integral in Eq. (9) but instead make use
of a relationship for the Euler characteristic of arbitrary
polyhedra,

χ = V − E + F − O

(10)

where V is the number of vertices, E the number of
edges, F the number of faces and O the number of objects
[1]. This expression is the basis for eﬃcient algorithms
to compute Minkowski functionals of arbitrary geomet-
ric bodies represented as volumetric voxelized domains
[40]. To compute these three Minkowski functionals we
have used the open-source image morphological software
library MorphoLibJ [41].

While the porosity expresses the ability to store ﬂu-
ids in a porous medium, adsorption and dissolution pro-
cesses are controlled by the speciﬁc surface area. The
Euler characteristic allows the connectivity of the porous
medium to be characterized, which is a critical compo-
nent in the ability of ﬂuids to ﬂow. Reconstructions of
porous media should therefore closely match the observed
Minkowski functionals to represent the behavior of rele-
vant physical processes at the pore-scale.

The direct computation of the speciﬁc surface area
SV and porosity φ from images allows us to perform a
comparison with the values obtained from estimates ob-
tained by computing the empirical non-centered covari-
ance S2(r) [see Eq. (5)].

6

TABLE I. Neural network conﬁgurations and hyperparameters used to train on voxelized image subsets.

Training Image Size
Latent Space z Dimension
Generator Filters NG
Discriminator Filters ND
Optimizer
Learning Rate / Momentum
Stabilization

Beadpack
1283 voxels
100
64
8

Training Image Dataset
Berea
643 voxels
512
64
16
Generator + Discriminator: Adam
2 × 10−4 / 0.5
Label Smoothing ((cid:15) = 0.1)

2 × 10−4 / 0.5
White Noise (σ = 0.1)

2 × 10−4 / 0.5
White Noise (σ = 0.1)

Ketton
643 voxels
100
64
16

subsets of the Imagenet and CIFAR-10 datasets [43]. The
hyperparameters for the generator to be used in the opti-
mization of the neural network architecture are the num-
ber of trainable convolutional ﬁlters in each layer of the
neural network NG,F , ND,F and the size of the latent
vector z.

The generator and discriminator are optimized using a
gradient descent based method where the parameters w
are changed by taking k steps in the gradient

wk+1 = wk − α∇f (wk)

(13)

where α is the learning rate. We have used the gradient
descent based optimiser ADAM for optimization of both
the generator and discriminator [47].

GANs have been shown to exhibit unstable behavior
during training. The addition of Gaussian noise to the
input of the discriminator provides an eﬀective measure
to prevent mode collapse and stabilize the training pro-
cess [36]. An additional stabilization measure called one-
sided label smoothing, wherein the class label of 1 for
real images is replaced by a new value of 1 − (cid:15) has been
empirically shown to improve training of GANs [35].

Both label smoothing and white noise addition to the
input of the discriminator have been used in this study
to stabilize the training based on the volumetric image
datasets. Table I gives an overview of the neural network
hyperparameters used for each evaluated sample, the hy-
perparameters and the stabilization measure used during
training.

Images generated by the GAN were post-processed us-
ing a 33 median ﬁlter to remove single-pixel noise. The
resulting images are grayscale images with all voxel val-
ues close to zero or one. To compare the resulting images
to the binary training images, we segment the generated
images using Otsu’s method [48].

3. Single-Phase Permeability

To evaluate the single-phase permeability of the porous
media and their generated synthetic reconstructions we
solve the Stokes equations for slow, incompressible ﬂow
assuming small inertial forces.

The Stokes equations are solved on the domain that is
connected to the ﬂuid inlet and outlet. This allows us to
deﬁne an eﬀective porosity where only the fraction of the
pore space that also contributes to ﬂow is considered

∇ · v = 0
µ∇2v = ∇p

φef f =

Vf low
V

(11a)
(11b)

(12)

A ﬁnite diﬀerence method to solve Eq. (11a)-(11b) on
pore-space representations has been implemented as a
parallel ﬂow solver, in the free open source numerical
framework OpenFOAM [4, 42].

B. Neural Network Architecture

The neural network architecture used for the three-
dimensional image reconstruction corresponds to a vol-
umetric version of the DCGAN network [43]. The net-
work consists of two independent fully convolutional neu-
ral networks, the generator G and the discriminator D.
Upsampling from the input latent vector z is performed
by volumetric transposed convolution, followed by batch
normalization and a rectiﬁed linear unit (ReLU) activa-
tion function in all layers except the last [44, 45].

The discriminator D receives images sampled from the
latent space by the generator G(z) and images from the
set of training images representing pdata(x). Therefore,
the size of the input layer of the discriminator corre-
sponds to the dimensions of the input training images.
The discriminator consists of volumetric convolution lay-
ers combined with LeakyReLU activation functions [46].
The ﬁnal convolutional layer of the discriminator is fol-
lowed by a Tanh activation function.

This combination of generator and discriminator neu-
ral network architectures has previously been applied to

7

FIG. 3. Cross-sections of the three binary images that have been reconstructed. The bordered regions indicate the size of
the training images extracted from the full dataset. The beadpack consists of spheres of equal diameter (d = 50 voxels). The
Berea sandstone is an angular granular sandstone that shows traces of dispersed clay. The oolitic Ketton limestone consists of
ellipsoidal grains showing inter and intra-granular porosity. The voxel sizes are 3 µm for the bead pack as well as the Berea
sandstone and 15.2 µm for the Ketton sample.

IV. EXPERIMENTAL DATA

2. Berea

A.

Image Data and Processing

To evaluate the applicability of GANs for reconstruc-
tion of natural porous media we use three previously ac-
quired datasets. All images have been segmented into a
three-dimensional binary voxel representation of the pore
space (white) and grain structure (black) (Fig. 3). We
create a training database of images by extracting sub-
volumes from the voxelized binary images. Ideally, these
training images should represent independent domains,
but due to the limited size of these images, we extract
subsets that overlap.

Training image sizes were chosen based on an estimate
of the average grain size for each sample. To be able
to match the covariance S2(r) [Eq. (4)] and image mor-
phological characteristics, training images larger than the
structuring element were necessary. We discuss this re-
quirement in more detail in the discussion of our results
(see Section VI). Due to computational limitations, train-
ing image sizes exceeding 1283 voxels were not consid-
ered.

1. Beadpack

The beadpack is based on a real packing of equally
sized ceramic grains in a disordered close packing [49].
The image consists of 5003 voxels with a size of 3 µm.
The size of an individual sphere is 50 voxels. 1727 train-
ing images were extracted of size 1283 voxels correspond-
ing to a spacing of 32 voxels between them in the original
image.

Berea sandstone is a ﬂuvial sandstone of medium to
ﬁne grain size (Wentworth classiﬁcation) [50]. The indi-
vidual grains are bonded by clays. The sample analyzed
in this study was acquired from an outcropping of the
Berea sandstone in a quarry near Berea, Ohio. De Witt
showed that the Berea sandstone was deposited in the
early Carboniferous (354-323 Mya) [51].

The image of Berea sandstone consists of angular
grains with no clay presence in the intergranular pore-
space. The image has dimensions of 4003 voxels with a
voxel size of 3 µm.

To capture the local interaction of grains we have ex-
tracted training images at 643 voxels which allows a num-
ber of grains to be present in one training image (see
Sec. VI). Due to the small image size of 4003 voxels, sub-
volumes were extracted at a spacing of 16 voxels.
In
all, 10647 training images were used for the image recon-
struction.

3. Ketton

The Ketton sample is an oolitic limestone of Juras-
sic age (201.3-145 Mya). The sample was acquired from
a quarry of Lincolnshire limestone in the North-East of
England. The oolites contained in the Lincolnshire for-
mation are mainly non-ferroan calcite grains. The oolitic
limestones of the Lincolnshire show a wide variety of ce-
mentation, ranging from uncemented oolite sands with
no intergranular cement to heavily ferroan spar-cemented
oolites with inﬁlled microporosity [52]. Microstructures
in the pore space can be observed that lead to a reduction
in porosity (Fig. 3).

8

FIG. 4. Value of the cost function i.e. loss of the discriminator and generator [Eq. (2)-(3)] for the GAN trained on the Berea
sandstone. The samples shown were computed with the same random number seed, showing the evolution of a single realization
during training. Initially, image quality is very low and random noise can be observed. After 2000 generator iterations a drop
in the generator loss function is observed and coarse structures can be identiﬁed in the resulting sample. Loss functions in
GAN models do not reﬂect improvement in image quality which can be observed from samples. Learning rates [see Eq. (13)]
were reduced after suﬃcient image quality was reached and training stopped based manual inspection of Minkowski functionals
and two-point statistics.

The Ketton sample chosen for this study consists of
large grains compared to the overall image size. The im-
age used for the following evaluation has been downsam-
pled from a 5003 voxel representation to an image size
of 2563 voxels. This allows more grains to be resolved
per training image extracted from the full volume. The
downsampled voxel size is 15.2 µm.

Training images were extracted at a sub-volume size of
643 with a spacing of 8 voxels leading to a total of 15624
training images. The small spacing of the training images
results from the small CT image size of 2563 voxels.

V. RESULTS

Three GANs were trained based on the network archi-
tectures highlighted in Sec. III B. The training time for
each dataset was 24 hours. Manual inspection of syn-
thetic realizations was performed during training to en-
sure convergence and intermediate evaluation of the co-
variance and Minkowski functionals.

Figure 4 shows the training curve for the Berea sand-
stone dataset. Initially the generator loss function [see
Eq. (3)] is very high and no structural components can
be observed in the samples. After a large reduction in
the loss function of the generator, initial structures are

observed. Image reconstruction quality signiﬁcantly im-
proves with the number of generator iterations, but can-
not be linked to the loss function of the generator. This
can be observed from the increase in generator loss at the
end of training while image quality improves signiﬁcantly.
The ﬁnal GAN models were subsequently evaluated
in terms of their directional and radial averaged non-
centered covariance S2(r), Minkowski functionals and the
single-phase permeability.

For all datasets, 20 realizations were generated using
the trained GAN model.
In the following section, we
present the results of the evaluation of the properties
outlined in Sec. III A and compare these to the properties
of the original input training image.

A. Beadpack

The evaluation of the non-centered covariance S2(r) for
the beadpack (Fig. 5) shows a strong hole eﬀect reﬂecting
the spherical nature of the grains.

A GAN model was trained for 24 hours on the bead-
pack training image dataset. The GAN model achieves a
small error in the porosity of the generated images with
a tendency towards higher porosities (Fig. 7).

A bias can be observed for the speciﬁc surface area and
the Euler characteristic of the microstructure (Table II).
This bias can be explained by the deviation of the
grains from a perfect spherical shape in the synthetic
realizations. Due to the smooth nature of the spheri-
cal particles in the training image, any deviation from
this geometry will lead to an increase in the surface area.
This is reﬂected by a higher speciﬁc surface area for the
synthetic realizations.
In addition we observe a reduc-
tion in connectivity, represented by a less negative Euler
characteristic.

The directional covariance S2 measured on the gener-
ated samples show excellent agreement up to the training
image size of 1283 voxels and stabilizes at φ2 (see Fig. 8).
As expected no directional variation of the covariance
is observed and the sample is therefore assumed to be
isotropic.

Single-phase permeability shows a close agreement in
both magnitude and variance between the measured
training image and the synthetic realizations (Fig. 7).
Figure 6 shows a crossplot of the eﬀective porosity φef f
i.e. the porosity open to ﬂow [Eq. (12)], and the single-
phase permeability exhibiting a similar trend in the dis-
tribution of values computed on training images and syn-
thetic realizations.

We provide a comparison of all twenty realizations gen-
erated by the GAN model in cross-sections through the
x-y plane of the original model and a synthetic realization
in Fig. 9.

Many of the grains show a circular to ellipsoidal shape,
which considering the fact that a priori the GAN model
does not have any knowledge of the geometry of the
grains, learning a representation of a perfect sphere can
be considered challenging (see Sec. VI). The complex
grain-grain interface where individual beads contact at
single points can be observed for numerous grain arrange-
ments in the generated realizations.

9

FIG. 5. Radial averaged covariance S2(r) for the beadpack
sample and 20 synthetic realizations generated by the GAN
model.The speciﬁc surface area SV and mean chord lengths
lC are derived from the slope of the covariance at the origin
[see Equ. (5)-(6)].

FIG. 6.
A comparison of the numerical estimated single-
phase permeability of the beadpack for 1283 voxel subdomains
of the original image and equal sized GAN based realizations
shows an overestimation of the eﬀective porosity for the syn-
thetic models. The mean and variance of both permeability
distributions have been found to be in close agreement (see
Fig. 7).

10

TABLE II. Chord lengths lC for the pore and grain phase [Eq. (6)] determined from the radial averaged covariance S2(r) of
each training image and corresponding realizations generated by the GAN model. The speciﬁc surface area SV and porosity φ
were evaluated for each of the samples using direct image morphological computation and derived from the covariance. Close
agreement between estimates of the porosity and speciﬁc surface area can be observed for values determined by direct image
morphological estimation and derived values obtained from the radial averaged covariance.

pore
l
C
grain
l
C

[voxel]
[voxel]

Beadpack
20
36

Berea
10
41

Ketton
9
64

Training Image
Minkowski Functional S2(r) Direct
0.359
7.3

Porosity φ
1
voxel ]

Sv × 10−2 [

0.363
7.0

Synthetic

Training Image
S2(r) Direct S2(r) Direct
0.198
0.368
8.2
6.9

0.196
7.5

0.366
7.5

Synthetic

Training Image
S2(r) Direct S2(r) Direct
0.119
0.199
5.2
7.9

0.197
8.5

0.127
5.2

Synthetic
S2(r) Direct
0.119
0.119
5.2
4.7

FIG. 7. Comparison of three Minkowski functionals for the beadpack evaluated on 2003 voxel subdomains of the original
training image and realizations of the GAN model. An error of less than 5% can be observed for the porosity and surface area.

FIG. 8.
realizations. A clear hole eﬀect can be observed in the original dataset, clearly captured by the GAN model.

Comparison of the directional covariance of the beadpack and the average covariance of GAN based synthetic

11

FIG. 9. Twenty realizations of the spherical beadpack (top) generated to evaluate the statistical, image morphological and
transport properties considered in this study. Cross-sectional view of the beadpack training image dataset (bottom).

12

FIG. 10. Radial averaged covariance S2(r) for Berea sand-
stone training images and 20 synthetic realizations generated
by the GAN model.

B. Berea

The radial averaged covariance S2(r) in Fig. 10, shows
a near exponential decay and stabilisation occurs at a
lag distance of 30 voxels for both covariance functions
obtained from the Berea training image and synthetic
realizations generated by the GAN model.

Additionally, Fig. 12 shows that the directional two-
point statistics characterized by the directional covari-
ances is captured in the generated images. This is shown
by comparing the small hole eﬀect observed in the z-
direction of the Berea sample with the x-direction where
a near exponential decay can be observed. In both cases,
the GAN model shows excellent agreement and closely
follows the trend of the empirical estimates of S2.

The results of the direct computation of the Minkowski
functionals is presented in Fig. 13 and show comparable
distributions for the porosity φ, speciﬁc surface area SV
and the Euler characteristic χV of the training images
and the synthetic realizations.

A comparison of the speciﬁc surface area SV obtained
from the covariance and the direct computation of the
Minkowski functional, show nearly equal values (Ta-
ble II).

The obtained estimates of the single-phase permeabil-
ity show a similar distribution covering the range of eﬀec-
tive permeability measured on the training images. Fig-
ure 11 shows the computed values of permeability and the
corresponding eﬀective porosity. The permeability of the
synthetic realizations capture the values, variability and
trend obtained from the Berea training image dataset.

Figure 14 shows a comparison of twenty realizations of
the GAN model trained on the Berea dataset. A smaller
training image size of 643 voxels was used, as compared
to the beadpack (1283 voxels). This is due to the smaller
size of the structuring elements observed in the training
image. A smaller training image size was therefore suf-
ﬁcient to capture the long and short range correlation
found in the Berea sample.

FIG. 11. The distribution of numerically obtained perme-
ability values on 1283 voxel subdomains and sampled realiza-
tions obtained from a GAN model trained on the Berea sand-
stone dataset show close agreement in the eﬀective porosity,
as well as the evaluated permeability.

13

FIG. 12. Directional non-centered covariance comparison for Berea sandstone. The trained GAN model shows good agreement
with the non-centered covariance S2 of the training image.

FIG. 13. Comparison of three Minkowski functionals for Berea sandstone. The porosity, speciﬁc surface area and speciﬁc
Euler characteristic show good agreement between the training image and samples from the trained GAN model.

14

FIG. 14. Realizations generated by the GAN model (top) compared to training images (bottom) for Berea sandstone.

15

FIG. 15. Radial averaged covariance S2(r) for the oolitic
Ketton limestone training image and 20 synthetic realizations
generated by the GAN model.

C. Ketton

The covariance S2(r) of the Ketton limestone shown
in Fig. 15, shows a pronounced hole eﬀect due to the el-
lipsoidal oolitic grains. Due to the hole eﬀect observed
in the radial averaged covariance (Fig. 15), we relate the
Ketton sample to a hard-sphere model. Figure 17 in-
dicates that the images generated by the GAN model
trained on the Ketton image, capture the oscillatory and
anisotropic behavior of the covariance observed in Ket-
ton. The speciﬁc surface area SV derived from the gener-
ated images is in close agreement with the training data.
An error of approximately 1% was achieved in the poros-
ity of the GAN generated images compared to the origi-
nal Ketton dataset (Fig. 18).

The measured speciﬁc surface area of the synthetic im-
ages shows a higher variance compared to the original
training images. Nevertheless, the average values of the
porosity φ and speciﬁc surface area SV derived from the
non-centered covariance S2(r) [see Eq. (5)] are in good
agreement with values obtained from direct image mor-
phological estimation (see Table II).

The distribution of single-phase permeability estimates
of the synthetic GAN realizations overlies the permeabil-
ity values of the Ketton training images.

The Euler characteristic χV and the permeability of
the Ketton training dataset are closely matched by the
synthetic images and therefore capture the connectivity
observed in the oolitic Ketton limestone.

We present an overview of the 20 realizations gener-
ated by the GAN model trained on the Ketton dataset
in Fig. 19.

FIG. 16. Evaluated single-phase permeability for the Ket-
ton training image. The synthetic realizations show similar
eﬀective porosity and permeability as the Ketton sample.

16

FIG. 17. The directional covariance of the Ketton sample shows oscillating behavior in the x-direction, whereas a nearly
exponential decrease can be observed for the y and z directions. This anisotropy in S2(r) is also reﬂected in the covariance of
the samples obtained from the GAN model.

FIG. 18. Comparison of the Minkowski functionals for the Ketton training image. The three evaluated Minkowski functionals
show good agreement. The evaluated Euler characteristic indicates that the sampled synthetic realizations show a similar
degree of connectivity as the training image.

17

FIG. 19. Realizations generated by the GAN model (top) compared to training images (bottom) for Ketton limestone.

VI. DISCUSSION

This paper presents a novel method for

three-
dimensional stochastic image reconstruction based on
generative adversarial neural networks (GAN) trained on
three-dimensional segmented images. To summarize, the
objectives of this contribution are threefold. Firstly, the
generation of stochastic reconstructions of porous media
such as sedimentary rocks exceeding the size of the ac-
quired image datasets. Secondly, to evaluate the ability
of GAN models to capture the image morphological and
physical properties of micro-scale porous media. Thirdly,
to establish a method of stochastic image reconstruction
that allows a probabilistic treatment of pore-scale prop-
erties such as permeability without the need to acquire
numerous images of a single rock type.

The ﬁrst objective stems from technical limitations of
micro-CT data acquisition.
Images are acquired as a
trade-oﬀ between sample size i.e. how many represen-
tative structures can be captured in one image versus
the resolution at which these pore-scale structures are
resolved. The generation of large porous domains based
on high-resolution images enables this gap in scales to
be bridged and micro-scale features to be incorporated
in macro-scale models.

Our ﬁndings show that GANs can learn an implicit
representation of the image space given a limited num-
ber of training images subsampled from larger images.
These subdomains were extracted based on characteris-
tic length scales (see Sec. III A 1) and serve as a training
set for the GAN model. For the Ketton limestone, a small
spacing of the extracted subdomains was required to in-
crease the size of the training image dataset. While we
did not ﬁnd any evidence of an introduced bias by using
correlated subdomains, we believe that these extracted
training images should represent independent regions.

We have evaluated the ability to train GANs for a num-
ber of training image sizes less than and up to twice the
size of the structuring elements. We have found that
models trained on images smaller than the average grain
size results in artifacts and distorted shapes occurring in
the generated micro-structures. For the beadpack, the
size of an individual sphere is 50 voxels. A training im-
age of 643 voxels would typically only contain parts of
an individual grain and only capture the interaction of
the particles, but not the geometry of the structuring el-
ement. For the beadpack, models trained on 643 voxels
were successful in learning a representation of the short
scale micro-structure but failed to reproduce the long dis-
tance correlation. A larger training image of 1283 voxels,
as was used to model the beadpack has a much higher
chance to represent the full geometry of the particles and
therefore not only learn interactions, but also the shapes
of grains.

We, therefore, suggest that training images extracted
from large datasets must be larger than the average grain
size. For models that are well described by a Boolean
model, the size of the structuring element can be readily

18

estimated from stabilization of the covariance S2(r). For
more complex samples a diﬀerent measure must be used
to estimate the size of the required training image.

grain
C

The chord length is one additional measure that can be
obtained to characterize the grain space of porous media.
While we have found that the mean chord length of the
grain
grain space l
is always less than or equal to our cho-
C
sen training image size, l
increases with decreasing
porosity. This contradicts the need to have the largest
training domain for the beadpack sample which also has
the highest porosity. A better estimate may be related
to the representative elementary volume of the speciﬁc
surface area which by deﬁnition is the same for the grain
and pore space and is, therefore, more representative of
the morphology of the porous medium [53]. Based on the
properties we have evaluated we could not ﬁnd a measure
derived from two-point statistical or image morphological
properties that is closely related to the required training
image size and we see a theoretical discussion of this as
possible future work.

Conceptually the simplest model considered in this
study, the spherical beadpack, has proven to be the
most challenging as a training image for the GAN model
(Sec. V A). While we observe spherical and ellipsoidal
shapes in the resulting realizations (see Fig. 9), the
shape is exactly deﬁned by the spherical nature of the
grains. Any deviation from this shape, which for GANs,
is learned implicitly from the data itself, will lead to a
misrepresentation of the eﬀective properties. Random
hard-sphere models with spherical grains will eﬃciently
capture the nature of this dataset. Therefore we suggest
a ﬁt-for-purpose application of GANs, for training images
that exhibit variability of grain sizes and shapes, which
are not readily captured by a simpler model.

While for many sedimentary granular rocks represen-
tative volumetric images can be obtained, this may be
more challenging for carbonate samples with complex
pore-grain structures. The three training images consid-
ered in this study were all treated under the assumption
of stationarity i.e. we do not expect a variation in the
mean and variance of the averaged properties as a func-
tion of location. In theory, GANs are not limited to learn-
ing representations of stationary datasets. This is shown
by the many successful applications for two-dimensional
image and texture synthesis of non-stationary domains,
such as learned image representations of human faces [54]
or galaxies [55, 56]. Therefore a model that incorporates
non-stationarity for a single rock-type would technically
be possible in the GAN framework but would require the
acquisition of many images of the same porous medium.
A valid representation of the microscale variability and
connectivity of the pore space is critical to assess the
single and multi-phase ﬂow behavior of porous media.
Therefore any stochastic reconstruction method used in
the process of deriving or evaluating the variability of
micro-scale properties must capture the statistical and
image morphological characteristics of the reconstructed
porous medium. While we have shown that for the eval-

uated datasets, the GAN based image reconstructions
capture the variation and characteristics of these porous
media, a number of challenges arise in this task that are
fundamentally diﬀerent to classical stochastic methods of
image reconstruction.

For porous media, many ﬂow related properties can
be related to the porosity. Classical stochastic methods
are able to capture the porosity eﬃciently by deﬁning a
speciﬁc proportion of the grain and pore domain. The
GAN based model presented in this study initially has
no knowledge of the porosity. The porosity, therefore,
arises as a feature of the training image data. Matching
the porosity distribution of the training image dataset
was found to be the main challenge in training a GAN
model. An error of three percent in porosity would lead
to a mismatch in the permeability of the synthetic im-
ages. It is, therefore, necessary to continuously monitor
the derived properties such as the Minkowski functionals
or estimates of the permeability, in the course of training
the neural networks to ensure that synthetic realizations
created by the GAN model are able to capture the eﬀec-
tive properties of the micro-scale domains.

While this can be considered one of the main chal-
lenges in the application of GANs for synthetic image
reconstruction, learning an implicit representation of the
training data itself can be seen as a strength. Many clas-
sic stochastic methods rely on the formulation of an ob-
jective function that ensures that statistical properties
are captured in the generated realizations e.g. matching
S2(r) and the speciﬁc surface area SV of the stochastic re-
constructions to a desired precision. The GAN approach
does not require an explicit objective function a priori.
The objective function is encoded in the discriminator
and adapted in the course of training.

During adversarial training both the generator and dis-
criminator are continuously improved. The discrimina-
tor’s sole purpose is to be able to distinguish real training
data from generated synthetic data. On the other hand,
the generator tries to generate synthetic data that the
discriminator is not able to distinguish from the training
data. Due to the multi-scale representation of the convo-
lutional neural networks, these features must be learned
across the full range of length scales present in the train-
ing data, leading to a high-resolution image that cap-
tures small and large scale features of the image dataset.
A number of stacked GAN models can be trained on
e.g. low-resolution medical-CT data and high-resolution
micro-CT allowing incorporation of spatial information
across multiple length scales [33].

Once the GAN model has successfully learned to create
physically representative samples of the porous medium,
one possible application is to evaluate the variability in
the ﬂow properties by evaluating the properties of a large
number of samples. This not only requires a physically
valid representation of the porous medium but also re-
quires a method that allows fast image reconstruction.
In Sec. V we have shown that training was performed for
approximately 24 hours and may vary due to the need for

19

FIG. 20. Measured CPU time for generating synthetic real-
izations of Berea sandstone at increasing image size. 100 re-
alizations were computed at each image dimension and CPU
time averaged. Computational cost increases linearly with
the number of voxels in the generated image.

manual inspection of the generated samples in the train-
ing process. Figure 20 shows the CPU time required for
generation of images at increasing image size. The fully
convolutional nature of the GAN architecture allows very
large images, exceeding the size of the original sample to
be generated very eﬃciently and at low computational
cost and runtime.

While training requires considerable time and compu-
tational resources in the form of modern graphics pro-
cessors as well as optimized neural network frameworks,
image reconstruction requires little computational eﬀort
and scales linearly in the total number of voxels of the
generated images. This, therefore, enables the genera-
tion of ensembles of large domains based on volumetric
images acquired from 3D microscopy, that capture the
physical behavior of the porous medium. The learned
representation of the generator consists of the weights of
the convolutional ﬁlters learned in the training process
and can, therefore, be stored for future use once training
has ﬁnished.

VII. CONCLUSIONS

We have evaluated the application of generative adver-
sarial neural networks (GAN) for stochastic image recon-
struction of porous media based on previously acquired
images of sedimentary rocks. Three image datasets were
used as training images: a beadpack, a Berea sandstone,
and an oolitic Ketton limestone.

By evaluating two-point statistical measures,

image
morphological features and computing the single-phase
eﬀective permeability we have shown that the synthetic
images generated by the GAN model are able to cap-
ture the characteristic statistical and physical behavior
of these porous media.

While a large computational eﬀort is required to train
the GAN model, the generation of samples from the
learned representation is highly eﬃcient and learned
models are easily stored for future use.

Future work in the application of GANs to stochastic
image reconstruction of porous media will include im-
proving the quality of the image reconstruction by eval-
uating various generator-discriminator architectures, the
use of grayscale and multi-channel training images, as
well as the application of large multi-scale domains of

20

porous media to evaluate the ensemble behavior of single
and multi-phase ﬂow properties in porous media. Recent
advances in the understanding of GANs should lead to a
more stable and consistent training process [57, 58].

ACKNOWLEDGMENTS

O. Dubrule thanks Total for seconding him as a

Visiting Professor at Imperial College.

[1] M. J. Blunt, Multiphase Flow in Permeable Media:
A Pore-Scale Perspective (Cambridge University Press,
2017).

[2] R. Juanes, E. Spiteri, F. Orr, and M. Blunt, Water Re-
sources Research 42 (2006), 10.1029/2005WR004806.
[3] Q. Kang, P. C. Lichtner, H. S. Viswanathan, and A. I.
Abdel-Fattah, Transport in porous media 82, 197 (2010).
[4] P. Mostaghimi, M. J. Blunt, and B. Bijeljic, Mathemat-

vaux, and O. Besson, Mathematical Geosciences 43, 305
(2011).

[24] T. Huang, X. Li, T. Zhang, and D.-T. Lu, Computers &

Geosciences 57, 13 (2013).

[25] H. Okabe and M. J. Blunt, Physical Review E 70, 1

(2004).

[26] H. Okabe and M. J. Blunt, Journal of Petroleum Science

and Engineering 46, 121 (2005).

ical Geosciences 45, 103 (2013).

[27] H. Okabe and M. J. Blunt, Water Resources Research

[5] G. Matheron, Random sets and integral geometry, Wiley
series in probability and mathematical statistics: Proba-
bility and mathematical statistics (Wiley, 1975).

[6] J. Serra, Computer Graphics and Image Processing 12,

99 (1980).

[7] G. Matheron, Elements pour une Theorie des Milieux

Poreux (Masson, Paris, 1971).

[8] C. Arns, M. Knackstedt, and K. Mecke, Physical Review

[9] P. A. Rikvold and G. Stell, J. Chem. Phys. 82, 1014

E 80, 051303 (2009).

(1985).

[10] S. Torquato, Random heterogeneous materials: mi-
16

crostructure
(Springer Science & Business Media, 2013).

and macroscopic

properties, Vol.

[11] T. Bretheau and D. Jeulin, Revue de Physique Appliqu´ee

24, 861 (1989).

[12] D. Jeulin, Statistics and Computing 10, 121 (2000).
[13] C. Lin and M. H. Cohen, Journal of Applied Physics 53,

(1998).

[15] P.-E. Øren and S. Bakke, Journal of Petroleum Science

and Engineering 39, 177 (2003).

[16] M. J. Pyrcz and C. V. Deutsch, Geostatistical reservoir

modeling (Oxford University Press, 2014).

[17] J. Caers and T. Zhang, AAPG Memoir 80, 383 (2004).
[18] G. Mariethoz, P. Renard, and J. Straubhaar, Water Re-

[28] W. E. Smith, H. H. Barrett, and R. G. Paxman, Optics

43, 3 (2007).

Letters 8, 199 (1983).

[29] D. I. Svergun, Biophysical Journal 76, 2879 (1999).
[30] L. M. Pant, Stochastic Characterization and Reconstruc-
tion of Porous Media, Ph.D. thesis, University of Alberta
(2016).

[31] I. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu,
D. Warde-Farley, S. Ozair, A. Courville, and Y. Bengio,
in Advances in Neural Information Processing Systems
(2014) pp. 2672–2680.

[32] J. Wu, C. Zhang, T. Xue, W. T. Freeman, and J. B.
(2016), arXiv:1610.07584

Tenenbaum, ArXiv e-prints
[cs.CV].

[33] H. Zhang, T. Xu, H. Li, S. Zhang, X. Huang,
(2016),

and D. Metaxas, ArXiv e-prints

X. Wang,
arXiv:1612.03242 [cs.CV].
Goodfellow,

ArXiv

[34] I.

e-prints

(2016),

[35] T. Salimans, I. Goodfellow, W. Zaremba, V. Cheung,
A. Radford, and X. Chen, in Advances in Neural Infor-
mation Processing Systems (2016) pp. 2226–2234.
[36] C. Kaae Sønderby, J. Caballero, L. Theis, W. Shi,
and F. Husz´ar, ArXiv e-prints (2016), arXiv:1610.04490
[cs.CV].

[37] P. Debye, H. R. Anderson, and H. Brumberger, Journal

of Applied Physics 28, 679 (1957).

4152 (1982), http://dx.doi.org/10.1063/1.331238.

arXiv:1701.00160v3.

[14] C. L. Y. Yeong and S. Torquato, Phys. Rev. E 57, 495

sources Research 46, 11 (2010).

[38] S. Torquato and F. Lado, Journal of Physics A: Mathe-

[19] E. Meerschman, G. Pirot, G. Mariethoz, J. Straubhaar,
M. Van Meirvenne, and P. Renard, Computers & Geo-
sciences 52, 307 (2013).

[20] P. Tahmasebi, M. Sahimi, and J. Caers, Computers &

Geosciences 67, 75 (2014).

matical and General 18, 141 (1985).

[39] C. Scholz, F. Wirner, M. A. Klatt, D. Hirneise, G. E.
Schr¨oder-Turk, K. Mecke, and C. Bechinger, Physical
Review E 92, 043023 (2015).

[40] C. Lang, J. Ohser, and R. Hilfer, Journal of Microscopy

[21] A. Comunian, P. Renard, J. Straubhaar, and P. Bayer,

203, 303 (2001).

Journal of hydrology 405, 10 (2011).

[41] D. Legland, I. Arganda-Carreras, and P. Andrey, Bioin-

[22] G. Mariethoz and J. Caers, Multiple-point geostatistics:
stochastic modeling with training images (John Wiley &
Sons, 2014).

formatics 32, 3532 (2016).

put. Phys. 12, 620 (1998).

[42] H. G. Weller, G. Tabor, H. Jasak, and C. Fureby, Com-

[23] J. Straubhaar, P. Renard, G. Mariethoz, R. Froide-

[43] A. Radford, L. Metz, and S. Chintala, ArXiv e-prints

21

[44] S.

Ioﬀe and C. Szegedy, ArXiv e-prints

(2015),

(2015), arXiv:1511.06434.

arXiv:1502.03167 [cs.LG].

[45] V. Nair and G. E. Hinton, in Proceedings of the 27th
International Conference on Machine Learning (ICML-
10) (2010) pp. 807–814.

(1970).

[52] D. Emery, The Origin of Late Spar Cements in the
Lincolnshire Limestone, Jurassic of Central England:
145(4), Vol. 145 (Journal of the Geological Society, 1988)
pp. 621–633.

[53] J. Bear, Dynamics of ﬂuids in porous media (Courier

[46] A. L. Maas, A. Y. Hannun, and A. Y. Ng, in Proc. ICML,

Corporation, 2013).

Vol. 30 (2013).

arXiv:1412.6980.

[47] D. Kingma and J. Ba, ArXiv e-prints

(2014),

[48] N. Otsu, Automatica 11, 23 (1975).
[49] J. Finney, in Proceedings of the Royal Society of Lon-
don A: Mathematical, Physical and Engineering Sciences,
Vol. 319 (The Royal Society, 1970) pp. 479–493.

[50] J. F. Pepper, Geology of the Bedford Shale and Berea
Sandstone in the Appalachian Basin: A Study of the
Stratigraphy, Sedimentation and Paleogeography of Rocks
of Bedford and Berea Age in Ohio and Adjacent States,
Vol. 259 (US Government Printing Oﬃce, 1954).

[51] W. de Witt Jr, U.S. Geological Survey Bulletin 1294

[54] J. Gauthier, Class Project for Stanford CS231N: Convo-
lutional Neural Networks for Visual Recognition (2014).
[55] K. Schawinski, C. Zhang, H. Zhang, L. Fowler,
(2017),

and G. Krishnan Santhanam, ArXiv e-prints
arXiv:1702.00403 [astro-ph.IM].

[56] S. Ravanbakhsh, F. Lanusse, R. Mandelbaum, J. Schnei-
(2016),
and B. Poczos, ArXiv e-prints

der,
arXiv:1609.05796 [astro-ph.IM].

[57] X. Mao, Q. Li, H. Xie, R. Y. K. Lau, and Z. Wang,
ArXiv e-prints (2016), arXiv:1611.04076 [cs.CV].
[58] M. Arjovsky, S. Chintala, and L. Bottou, ArXiv e-prints

(2017), arXiv:1701.07875.

7
1
0
2
 
r
p
A
 
1
1
 
 
]

V
C
.
s
c
[
 
 
1
v
5
2
2
3
0
.
4
0
7
1
:
v
i
X
r
a

Reconstruction of three-dimensional porous media
using generative adversarial neural networks

Lukas Mosser,∗ Olivier Dubrule,† and Martin J. Blunt‡
Department of Earth Science and Engineering,
Imperial College London

(Dated: April 12, 2017)

To evaluate the variability of multi-phase ﬂow properties of porous media at the pore scale, it is
necessary to acquire a number of representative samples of the void-solid structure. While modern
x-ray computer tomography has made it possible to extract three-dimensional images of the pore
space, assessment of the variability in the inherent material properties is often experimentally not
feasible. We present a novel method to reconstruct the solid-void structure of porous media by
applying a generative neural network that allows an implicit description of the probability distribu-
tion represented by three-dimensional image datasets. We show, by using an adversarial learning
approach for neural networks, that this method of unsupervised learning is able to generate repre-
sentative samples of porous media that honor their statistics. We successfully compare measures of
pore morphology, such as the Euler characteristic, two-point statistics and directional single-phase
permeability of synthetic realizations with the calculated properties of a bead pack, Berea sand-
stone, and Ketton limestone. Results show that GANs can be used to reconstruct high-resolution
three-dimensional images of porous media at diﬀerent scales that are representative of the morphol-
ogy of the images used to train the neural network. The fully convolutional nature of the trained
neural network allows the generation of large samples while maintaining computational eﬃciency.
Compared to classical stochastic methods of image reconstruction, the implicit representation of
the learned data distribution can be stored and reused to generate multiple realizations of the pore
structure very rapidly.

PACS numbers: 02.50.Ey, 07.05.Mh, 42.30.Wb, 83.80.Fg
Keywords: stochastic image reconstruction, porous media, artiﬁcial neural networks

I.

INTRODUCTION

A.

Image Reconstruction

The reconstruction and the evaluation of the material
properties of porous media plays a key role across many
engineering disciplines. Many physical processes such as
the movement of multiple phases of ﬂuids through sedi-
mentary rocks are controlled by individual pores at the
micron and sub-micron scale [1].

In carbon capture and sequestration (CCS), the long
term storage behavior is controlled by the physical and
chemical interaction of super-critical CO2 with the reser-
voir brine, as well as the spatial distribution and connec-
tivity of minerals in the pore-space [2, 3]. The variability
of the controlling properties such as the permeability of
the host rock is determined by repeated experiments or
numerical modeling of these processes.

Using modern computer tomographic methods, it is
possible to observe porous materials and evaluate their
material properties at the micrometer scale (micro-CT)
under static and transient conditions at high pressures
and temperatures in near real time. Performing micro-

∗ lukas.mosser15@imperial.ac.uk
† o.dubrule@imperial.ac.uk
‡ m.blunt@imperial.ac.uk

CT imaging of porous media requires specialized, expen-
sive equipment and in the case of CCS, only a single
image of the investigated rock type is typically acquired.
To evaluate the variability associated with the geomet-
rical and mineralogical morphology of the pore-space, nu-
merous physical experiments using the same rock type
would have to be performed to obtain a distribution over
larger volumes. Due to time and cost limitations inher-
ent with the experimental acquisition of high-resolution
images, this is often deemed unfeasible. Material prop-
erties governing the single and multi-phase ﬂow behavior
of porous media can be estimated from numerical so-
lution of partial diﬀerential equations at the scale of a
representative elementary volume (REV) and veriﬁed by
experimental results [4].

Many sedimentary rocks consist of granular siliciclas-
tic or carbonate materials. Boolean models use this fun-
damental characteristic of natural granular materials to
emulate the shape of the arising pore space, due to an
underlying random process that controls the distribution
of the individual grains [5, 6]. While for the classical
Boolean model, the centers of the grains are uniformly
distributed in space and grains can arbitrarily overlap,
more complicated models with rigid hard sphere grains
and more complex grain interaction functions have been
developed [7–10]. The framework of Boolean models also
allows extension beyond spherical particles and enables
derivation of the properties of material models as

a function of the parameters of the underlying random

process [11–14].

In sedimentary rocks, the arrangement of individual
grains occurs due to the transport of material from a
high energy source to a low energy sink. Process mod-
els, where depositional mechanisms are simulated, have
been shown to reproduce realistic granular reconstruc-
tions capturing the pore space morphology of granular
sedimentary rocks [15].

Spatial probabilistic models such as truncated Gaus-
sian processes or sequential indicator simulation have
been widely applied in the geosciences to model the spa-
tial distribution of materials [16]. Many of these methods
rely on two-point probability functions as a measure of
spatial variability, whereas recent methods in geostatis-
tics use training images as a basis for sample reconstruc-
tion [17–19]. These images are usually assumed to exhibit
stationarity of the probability distribution of the prop-
erties of interest and rely on higher order multiple point
statistics (MPS) to reconstruct stochastic random media.
With MPS, the probability distributions are repre-
sented by training images and are sampled using a limited
multi-scale neighborhood that captures the variation on
a large scale, as well as ﬁne structural details on smaller
scales [20]. MPS based methods have been used in two
and three-dimensional conditional simulation of spatial
properties in reservoir-scale earth modeling applications
[21]. The computational complexity of these methods
is highly dependent on individual algorithms as well as
the size of the domains used to sample from the training
images [22]. Parallelized versions have been developed,
reducing the computational time required to perform re-
construction using multiple point statistics [23, 24].

Three-dimensional porous media have been recon-
structed using a modiﬁed multiple-point statistics ap-
proach based on two-dimensional images of porous media
[25–27].

Stochastic methods based on simulated annealing al-
low the incorporation of arbitrary cost functions of sta-
tistical and morphological properties used in uncondi-
tional three-dimensional image reconstruction [28, 29].
Recent advances have reduced the computational run-
time of simulated annealing based methods for recon-
struction of porous media, to the order of tens of hours
per realization at the scale of 3003 voxels [30].

In the following section, we introduce a recently de-
veloped class of unsupervised machine learning methods
called generative adversarial networks (GAN) that al-
low simulation of probability distributions given a set
of training data [31]. Volumetric generative adversarial
networks have previously been applied to low-resolution
three-dimensional CAD model synthesis, and practical
applications of 3D-GANs are few compared to their
two-dimensional counterpart [32]. Integration of multi-
resolution datasets incorporating image data across a
number of length scales is possible in the GAN frame-
work by using a Laplacian pyramid approach such as
StackGAN [33].

2

We investigate the applicability of GANs to model
three-dimensional textures of rocks based on three-
dimensional binary representations of porous media ac-
quired at the micrometer scale. We compare statistical,
morphological and transport properties of the simulated
images with those of the training images. We evaluate
the single-phase directional permeability to show that the
synthetic realizations sampled from the learned represen-
tation of the input data can capture single-phase ﬂow
properties of sedimentary rocks.

Training of these neural networks involves ﬁnding a
set of hyperparameters that lead to stable training [34].
While this training can take on the order of tens of hours,
the sampling of large volumetric domains occurs on the
order of seconds on the current generation of graphical
processing units (GPU). We show that in favorable cases
convolutional neural networks incorporated in the GAN
framework allow the generation of synthetic reconstruc-
tions of porous media that exceed the dimensions of their
training images. Contrary to most existing simulation
techniques the set of parameters used to generate syn-
thetic realizations can be stored once trained allowing
rapid generation of new samples to assess the variability
of material properties.

While we apply GANs to a set of micro-CT images
of porous media, the method can readily be applied to
volumetric images of porous media obtained from other
three-dimensional microscopy instruments such as nano
or medical-CT instruments.

We discuss the challenges involved in training GANs
for stochastic image reconstruction of porous media, as
compared to other stochastic image reconstruction meth-
ods and evaluate the computational eﬃciency of GAN
based image reconstruction. Finally, we provide empir-
ical guidelines on the requirements of the input dataset
to allow successful training of GANs on large three-
dimensional voxel representations of natural porous me-
dia.

All data used in this study is available in the public
domain and we have made the code used for training,
as well as example pre-trained models, available as addi-
tional supporting material 1. A public dataset of high-
resolution micro-CT images made available by the Impe-
rial College Pore-Scale Modelling Group 2, of a spherical
beadpack, Berea sandstone, and oolitic Ketton limestone
will serve as benchmark cases to study the application of
GANs to three-dimensional stochastic image reconstruc-
tion.

1 https://github.com/LukasMosser/PorousMediaGan
2 http://www.imperial.ac.uk/earth-science/research/

research-groups/perm/research/pore-scale-modelling/
micro-ct-images-and-networks/

3

FIG. 1. Overview of the GAN training process. Segmented volumetric images are usually split into 643 voxel training images.
The generator G is a function that is applied to a sample from a latent random space Z and creates a synthetic realization.
We assume that samples drawn from the hidden latent space Z are distributed according to a normal distribution (see Sec. II).
The discriminator’s role is to determine whether a sample is part of the training image dataset (label 1) or from the generator
(label 0). The misclassiﬁcation error is computed as a binary cross-entropy criterion and the error back-propagated to improve
the discriminator’s ability to distinguish real and ”fake” images. Then the generator is updated to improve the quality of
the produced samples and ”fool” the discriminator. When suﬃcient image quality is obtained, training is stopped, and the
discriminator may be discarded. The generator can now be used to create new samples. By providing larger latent vectors
than used initially for training, larger output images can be produced.

II. GENERATIVE ADVERSARIAL NETWORKS

In the following section, we present generative ad-
versarial networks (GAN) in the context of three-
dimensional image generation. Generative neural net-
works have been developed in the context of deep learn-
ing by Goodfellow et al. as a methodology to learn a
representation of a high-dimensional probability distri-
bution from a given dataset [31]. In the context of image
reconstruction, we refer to this dataset as a set of training
images that present representative samples of the proba-
bility distribution underlying the image space.

GANs learn an implicit representation of the proba-
bility density as opposed to explicit density models. The
main drawback of explicit density models is their compu-
tational cost which grows with the dimensionality of the
samples and requires sequential simulation of each voxel.
For high-dimensional samples such as volumetric image
data, the computational cost is O(N ) where N repre-
sents the number of voxels in the domain of interest and
can easily exceed 109 voxels for modern high-resolution

micro-CT image data. Using any of these methods would
make it intractable to generate a large number of very
large samples. GANs have been designed to perform fast
sampling from the learned density representation and al-
low full parallel generation, making them an ideal candi-
date to generate large volumetric images [34].

GANs consist of two diﬀerentiable functions: a dis-
criminator D and a generator G. The discriminator re-
ceives samples of the ”real” dataset (Label 1) x ∼ pdata
and ”fake” samples G(z) (Label 0) created by the gener-
ator from the hidden latent space Z (see Fig. 1 above).
The latent space Z is composed of independent real
random variables, typically normally or uniformly dis-
tributed, that represent the random input to the genera-
tor G. The generator G maps random variables from the
latent space into the space of images. The discrimina-
tor’s role is to assign a probability that a random sam-
ple is from the ”real” data distribution pdata. The dis-
criminator tries to label each sample correctly, while the
generator tries to ”fool” the discriminator into labeling
the fake images as part of the true data distribution and

therefore achieving D(G(z)) close to one.

More formally we can deﬁne the loss i.e. the cost func-
tion for GANs as a minimization-maximization problem

image datasets. We treat all images under the assump-
tion of stationarity and the existence of a representative
elementary volume.

4

max
D

{Ex∼pdata(x)[log(D(x))]
min
G
+Ez∼pz(z)[log(1 − D(G(z)))]}
Solutions to this optimization problem have been
shown to be Nash equilibria, where each player achieves
a local minimum of their loss function with respect to
their parameters [34].

(1)

In practice we represent G and D by convolutional
neural networks that are trained by a gradient descent
based optimization method. Training is performed in
two steps: First the discriminator is trained to maximize
J (D) = Ex∼pdata(x)[log(D(x))]
+Ez∼pz(z)[log(1 − D(G(z)))]
while the parameters of the generator are ﬁxed. This
improves the ability of the discriminator to distinguish
between real and fake images.

(2)

In a subsequent step we generate synthetic samples
G(z) by drawing samples z from an N-dimensional nor-
mal distributed latent space and train the generator to
minimize

J (G) = Ez∼pz[log(1 − D(G(z)))]

(3)

while keeping the discriminator ﬁxed.

By minimizing Eq. (3) the generator tries to ”fool” the
discriminator into believing that the samples G(z) are
real data samples.
In this way the generator learns to
represent a distribution pg(x) that is as close as possible
to the real data distribution pdata(x). When convergence
is reached pg(x) = pdata(x) and the value of the discrim-
inator becomes 1
2 as it cannot distinguish between the
two anymore.

Initially, the discriminator D outperforms the gener-
ator signiﬁcantly making the gradient used to train the
generator close to zero. Therefore, instead of minimiz-
ing log(1 − D(G(z)) for the generator, it is helpful to
maximize log(D(G(z)) [34].

GANs show highly unstable behavior during training
and a large number of trial and error runs are required to
ﬁnd an optimal set of hyperparameters that allow stable
training. A number of heuristics have been published
which have been shown to stabilize GAN training, such
as one-sided label smoothing and adding white noise to
the input layer of the discriminator [35, 36].

We provide a more detailed overview of the neural
networks used in this study in Sec. III B and later pro-
vide suggestions on how to facilitate eﬃcient training (see
Sec. VI) for volumetric image datasets of porous media.

III. METHODOLOGY

In the following section we outline the criteria used to
evaluate the quality of simulations based on the training

A. Evaluation Criteria

1. Two-Point Statistics

We characterize the second order structure of the
porous media by calculating the two-point probability
function of the pore phase. By assuming stationarity,
this function is equivalent to the non-centered covariance
[7]:

S2(r) = P(x ∈ P, x + r ∈ P ) f or x, r ∈ Rd

(4)

which is the probability P that two points x and x + r,
separated by the lag vector r, are located in the pore
phase P . At the origin, S2(0) is equal to the porosity φ.
S2 stabilizes around φ2 as r → ∞ (Fig. 2). Due to the
anisotropic nature of many porous media, we compute
S2(r) along the three Cartesian directions, as well as the
radial average of S2(r).

FIG. 2. Comparison of S2(r) for a Boolean model and a
packing of hard spheres at a porosity φ = 0.5. S2 exhibits ex-
ponential decay for the Boolean model, whereas a dampened
oscillation is characteristic for packings of spheres. The mean
chord length can be found at the intersection of the slope of
S2 at the origin with the x-axis [see Eq. (6)].

It is a well known result that the speciﬁc surface area
SV of a porous medium can be expressed as a function of
S2 [37]. In the case of an isotropic porous medium and
in three-dimensions SV is related to S2 by

SV = −4S(cid:48)

2(0)

(5)

where S(cid:48)

2(0) is the derivative of S2(r) at the origin.
Furthermore, the average chord length within the pore

and the grain phases are [10]

pore
c =

l

grain
c

l

=

φ
S(cid:48)
2(0)
1 − φ
S(cid:48)
2(0)

(6a)

(6b)

which for the pore phase can be readily found from the
intersection of the slope of S2(r) with the x-axis.

In favorable cases, it is possible to ﬁnd analytical ex-
pressions of S2(r) from the spatial distribution and ge-
ometry of the grains. A Boolean model of overlapping
spherical grains of uniform spatial distribution exhibits
an exponential decay of the covariance until the lag dis-
tance is equal to the diameter of the grains where it be-
comes zero [7]. For porous media that can be well de-
scribed by a Boolean model, we can estimate the size of
the elementary Boolean grain from the decay of S2.

Semi-analytical expressions for more complex models
such as for a packing of hard spheres have been devel-
oped [38]. Models of S2(r) for spherical packings exhibit
a dampened oscillation. The shape of the estimated co-
variance, therefore, allows us to obtain information on
the structure of the porous medium (see Fig. 2 above).

The covariance S2(r) was estimated for the training
images and the stochastic reconstructions generated by
the trained GAN model. For each GAN model, we evalu-
ate the non-centered covariance S2 as well as the speciﬁc
surface area SV [Eq. (5)] and compare these to the values
obtained from the original training images.

In our discussion on the required training image sizes
(Sec. VI), we will use the average chord length and the
speciﬁc surface area as possible indicators of the neces-
sary training image size.

2. Morphological Measures

It has been shown that ﬂow properties at the pore-
scale can be related to morphological characteristics of
the void-solid interface of a porous medium [39]. Had-
wiger’s theorem states that the size of a body in a d-
dimensional space can be described by a linear combina-
tion of d + 1 independent parameters characterizing the
body. In three dimensions we can, therefore, deﬁne four
so-called Minkowski functionals that fully characterize
the size of a three-dimensional object. We compute esti-
mates of three Minkowski functionals; the porosity φ, the
speciﬁc surface area SV and the Euler characteristic χV
corresponding to the zero, ﬁrst and 3rd order functionals.

5

(7)

(8)

(9)

We compute the densities of the Minkowski functionals
by dividing by the volume V .

The Minkowski functional of order zero is the porosity,
deﬁned as the ratio of volume of the void space to the
bulk volume of the sample

and is, therefore, a measure of the ability of a porous
medium to store ﬂuids.

The Minkowski functional of rank one is the speciﬁc

surface area SV .

φ =

Vpore
V

SV =

dS

(cid:90)

1
V

where integration occurs over the void-solid interface S.
The speciﬁc surface area SV has dimensions of
length and
its inverse allows us to deﬁne a characteristic pore size.
The speciﬁc Euler characteristic is closely related to
the order three Minkowski functional and represents a
dimensionless quantity deﬁned as

1

χv =

(cid:90)

1
4πV

1
r1r2

dS

where r1 and r2 are the principal radii of curvature of the
void-solid interface. To compute χV we do not directly
evaluate the integral in Eq. (9) but instead make use
of a relationship for the Euler characteristic of arbitrary
polyhedra,

χ = V − E + F − O

(10)

where V is the number of vertices, E the number of
edges, F the number of faces and O the number of objects
[1]. This expression is the basis for eﬃcient algorithms
to compute Minkowski functionals of arbitrary geomet-
ric bodies represented as volumetric voxelized domains
[40]. To compute these three Minkowski functionals we
have used the open-source image morphological software
library MorphoLibJ [41].

While the porosity expresses the ability to store ﬂu-
ids in a porous medium, adsorption and dissolution pro-
cesses are controlled by the speciﬁc surface area. The
Euler characteristic allows the connectivity of the porous
medium to be characterized, which is a critical compo-
nent in the ability of ﬂuids to ﬂow. Reconstructions of
porous media should therefore closely match the observed
Minkowski functionals to represent the behavior of rele-
vant physical processes at the pore-scale.

The direct computation of the speciﬁc surface area
SV and porosity φ from images allows us to perform a
comparison with the values obtained from estimates ob-
tained by computing the empirical non-centered covari-
ance S2(r) [see Eq. (5)].

6

TABLE I. Neural network conﬁgurations and hyperparameters used to train on voxelized image subsets.

Training Image Size
Latent Space z Dimension
Generator Filters NG
Discriminator Filters ND
Optimizer
Learning Rate / Momentum
Stabilization

Beadpack
1283 voxels
100
64
8

Training Image Dataset
Berea
643 voxels
512
64
16
Generator + Discriminator: Adam
2 × 10−4 / 0.5
Label Smoothing ((cid:15) = 0.1)

2 × 10−4 / 0.5
White Noise (σ = 0.1)

2 × 10−4 / 0.5
White Noise (σ = 0.1)

Ketton
643 voxels
100
64
16

subsets of the Imagenet and CIFAR-10 datasets [43]. The
hyperparameters for the generator to be used in the opti-
mization of the neural network architecture are the num-
ber of trainable convolutional ﬁlters in each layer of the
neural network NG,F , ND,F and the size of the latent
vector z.

The generator and discriminator are optimized using a
gradient descent based method where the parameters w
are changed by taking k steps in the gradient

wk+1 = wk − α∇f (wk)

(13)

where α is the learning rate. We have used the gradient
descent based optimiser ADAM for optimization of both
the generator and discriminator [47].

GANs have been shown to exhibit unstable behavior
during training. The addition of Gaussian noise to the
input of the discriminator provides an eﬀective measure
to prevent mode collapse and stabilize the training pro-
cess [36]. An additional stabilization measure called one-
sided label smoothing, wherein the class label of 1 for
real images is replaced by a new value of 1 − (cid:15) has been
empirically shown to improve training of GANs [35].

Both label smoothing and white noise addition to the
input of the discriminator have been used in this study
to stabilize the training based on the volumetric image
datasets. Table I gives an overview of the neural network
hyperparameters used for each evaluated sample, the hy-
perparameters and the stabilization measure used during
training.

Images generated by the GAN were post-processed us-
ing a 33 median ﬁlter to remove single-pixel noise. The
resulting images are grayscale images with all voxel val-
ues close to zero or one. To compare the resulting images
to the binary training images, we segment the generated
images using Otsu’s method [48].

3. Single-Phase Permeability

To evaluate the single-phase permeability of the porous
media and their generated synthetic reconstructions we
solve the Stokes equations for slow, incompressible ﬂow
assuming small inertial forces.

The Stokes equations are solved on the domain that is
connected to the ﬂuid inlet and outlet. This allows us to
deﬁne an eﬀective porosity where only the fraction of the
pore space that also contributes to ﬂow is considered

∇ · v = 0
µ∇2v = ∇p

φef f =

Vf low
V

(11a)
(11b)

(12)

A ﬁnite diﬀerence method to solve Eq. (11a)-(11b) on
pore-space representations has been implemented as a
parallel ﬂow solver, in the free open source numerical
framework OpenFOAM [4, 42].

B. Neural Network Architecture

The neural network architecture used for the three-
dimensional image reconstruction corresponds to a vol-
umetric version of the DCGAN network [43]. The net-
work consists of two independent fully convolutional neu-
ral networks, the generator G and the discriminator D.
Upsampling from the input latent vector z is performed
by volumetric transposed convolution, followed by batch
normalization and a rectiﬁed linear unit (ReLU) activa-
tion function in all layers except the last [44, 45].

The discriminator D receives images sampled from the
latent space by the generator G(z) and images from the
set of training images representing pdata(x). Therefore,
the size of the input layer of the discriminator corre-
sponds to the dimensions of the input training images.
The discriminator consists of volumetric convolution lay-
ers combined with LeakyReLU activation functions [46].
The ﬁnal convolutional layer of the discriminator is fol-
lowed by a Tanh activation function.

This combination of generator and discriminator neu-
ral network architectures has previously been applied to

7

FIG. 3. Cross-sections of the three binary images that have been reconstructed. The bordered regions indicate the size of
the training images extracted from the full dataset. The beadpack consists of spheres of equal diameter (d = 50 voxels). The
Berea sandstone is an angular granular sandstone that shows traces of dispersed clay. The oolitic Ketton limestone consists of
ellipsoidal grains showing inter and intra-granular porosity. The voxel sizes are 3 µm for the bead pack as well as the Berea
sandstone and 15.2 µm for the Ketton sample.

IV. EXPERIMENTAL DATA

2. Berea

A.

Image Data and Processing

To evaluate the applicability of GANs for reconstruc-
tion of natural porous media we use three previously ac-
quired datasets. All images have been segmented into a
three-dimensional binary voxel representation of the pore
space (white) and grain structure (black) (Fig. 3). We
create a training database of images by extracting sub-
volumes from the voxelized binary images. Ideally, these
training images should represent independent domains,
but due to the limited size of these images, we extract
subsets that overlap.

Training image sizes were chosen based on an estimate
of the average grain size for each sample. To be able
to match the covariance S2(r) [Eq. (4)] and image mor-
phological characteristics, training images larger than the
structuring element were necessary. We discuss this re-
quirement in more detail in the discussion of our results
(see Section VI). Due to computational limitations, train-
ing image sizes exceeding 1283 voxels were not consid-
ered.

1. Beadpack

The beadpack is based on a real packing of equally
sized ceramic grains in a disordered close packing [49].
The image consists of 5003 voxels with a size of 3 µm.
The size of an individual sphere is 50 voxels. 1727 train-
ing images were extracted of size 1283 voxels correspond-
ing to a spacing of 32 voxels between them in the original
image.

Berea sandstone is a ﬂuvial sandstone of medium to
ﬁne grain size (Wentworth classiﬁcation) [50]. The indi-
vidual grains are bonded by clays. The sample analyzed
in this study was acquired from an outcropping of the
Berea sandstone in a quarry near Berea, Ohio. De Witt
showed that the Berea sandstone was deposited in the
early Carboniferous (354-323 Mya) [51].

The image of Berea sandstone consists of angular
grains with no clay presence in the intergranular pore-
space. The image has dimensions of 4003 voxels with a
voxel size of 3 µm.

To capture the local interaction of grains we have ex-
tracted training images at 643 voxels which allows a num-
ber of grains to be present in one training image (see
Sec. VI). Due to the small image size of 4003 voxels, sub-
volumes were extracted at a spacing of 16 voxels.
In
all, 10647 training images were used for the image recon-
struction.

3. Ketton

The Ketton sample is an oolitic limestone of Juras-
sic age (201.3-145 Mya). The sample was acquired from
a quarry of Lincolnshire limestone in the North-East of
England. The oolites contained in the Lincolnshire for-
mation are mainly non-ferroan calcite grains. The oolitic
limestones of the Lincolnshire show a wide variety of ce-
mentation, ranging from uncemented oolite sands with
no intergranular cement to heavily ferroan spar-cemented
oolites with inﬁlled microporosity [52]. Microstructures
in the pore space can be observed that lead to a reduction
in porosity (Fig. 3).

8

FIG. 4. Value of the cost function i.e. loss of the discriminator and generator [Eq. (2)-(3)] for the GAN trained on the Berea
sandstone. The samples shown were computed with the same random number seed, showing the evolution of a single realization
during training. Initially, image quality is very low and random noise can be observed. After 2000 generator iterations a drop
in the generator loss function is observed and coarse structures can be identiﬁed in the resulting sample. Loss functions in
GAN models do not reﬂect improvement in image quality which can be observed from samples. Learning rates [see Eq. (13)]
were reduced after suﬃcient image quality was reached and training stopped based manual inspection of Minkowski functionals
and two-point statistics.

The Ketton sample chosen for this study consists of
large grains compared to the overall image size. The im-
age used for the following evaluation has been downsam-
pled from a 5003 voxel representation to an image size
of 2563 voxels. This allows more grains to be resolved
per training image extracted from the full volume. The
downsampled voxel size is 15.2 µm.

Training images were extracted at a sub-volume size of
643 with a spacing of 8 voxels leading to a total of 15624
training images. The small spacing of the training images
results from the small CT image size of 2563 voxels.

V. RESULTS

Three GANs were trained based on the network archi-
tectures highlighted in Sec. III B. The training time for
each dataset was 24 hours. Manual inspection of syn-
thetic realizations was performed during training to en-
sure convergence and intermediate evaluation of the co-
variance and Minkowski functionals.

Figure 4 shows the training curve for the Berea sand-
stone dataset. Initially the generator loss function [see
Eq. (3)] is very high and no structural components can
be observed in the samples. After a large reduction in
the loss function of the generator, initial structures are

observed. Image reconstruction quality signiﬁcantly im-
proves with the number of generator iterations, but can-
not be linked to the loss function of the generator. This
can be observed from the increase in generator loss at the
end of training while image quality improves signiﬁcantly.
The ﬁnal GAN models were subsequently evaluated
in terms of their directional and radial averaged non-
centered covariance S2(r), Minkowski functionals and the
single-phase permeability.

For all datasets, 20 realizations were generated using
the trained GAN model.
In the following section, we
present the results of the evaluation of the properties
outlined in Sec. III A and compare these to the properties
of the original input training image.

A. Beadpack

The evaluation of the non-centered covariance S2(r) for
the beadpack (Fig. 5) shows a strong hole eﬀect reﬂecting
the spherical nature of the grains.

A GAN model was trained for 24 hours on the bead-
pack training image dataset. The GAN model achieves a
small error in the porosity of the generated images with
a tendency towards higher porosities (Fig. 7).

A bias can be observed for the speciﬁc surface area and
the Euler characteristic of the microstructure (Table II).
This bias can be explained by the deviation of the
grains from a perfect spherical shape in the synthetic
realizations. Due to the smooth nature of the spheri-
cal particles in the training image, any deviation from
this geometry will lead to an increase in the surface area.
This is reﬂected by a higher speciﬁc surface area for the
synthetic realizations.
In addition we observe a reduc-
tion in connectivity, represented by a less negative Euler
characteristic.

The directional covariance S2 measured on the gener-
ated samples show excellent agreement up to the training
image size of 1283 voxels and stabilizes at φ2 (see Fig. 8).
As expected no directional variation of the covariance
is observed and the sample is therefore assumed to be
isotropic.

Single-phase permeability shows a close agreement in
both magnitude and variance between the measured
training image and the synthetic realizations (Fig. 7).
Figure 6 shows a crossplot of the eﬀective porosity φef f
i.e. the porosity open to ﬂow [Eq. (12)], and the single-
phase permeability exhibiting a similar trend in the dis-
tribution of values computed on training images and syn-
thetic realizations.

We provide a comparison of all twenty realizations gen-
erated by the GAN model in cross-sections through the
x-y plane of the original model and a synthetic realization
in Fig. 9.

Many of the grains show a circular to ellipsoidal shape,
which considering the fact that a priori the GAN model
does not have any knowledge of the geometry of the
grains, learning a representation of a perfect sphere can
be considered challenging (see Sec. VI). The complex
grain-grain interface where individual beads contact at
single points can be observed for numerous grain arrange-
ments in the generated realizations.

9

FIG. 5. Radial averaged covariance S2(r) for the beadpack
sample and 20 synthetic realizations generated by the GAN
model.The speciﬁc surface area SV and mean chord lengths
lC are derived from the slope of the covariance at the origin
[see Equ. (5)-(6)].

FIG. 6.
A comparison of the numerical estimated single-
phase permeability of the beadpack for 1283 voxel subdomains
of the original image and equal sized GAN based realizations
shows an overestimation of the eﬀective porosity for the syn-
thetic models. The mean and variance of both permeability
distributions have been found to be in close agreement (see
Fig. 7).

10

TABLE II. Chord lengths lC for the pore and grain phase [Eq. (6)] determined from the radial averaged covariance S2(r) of
each training image and corresponding realizations generated by the GAN model. The speciﬁc surface area SV and porosity φ
were evaluated for each of the samples using direct image morphological computation and derived from the covariance. Close
agreement between estimates of the porosity and speciﬁc surface area can be observed for values determined by direct image
morphological estimation and derived values obtained from the radial averaged covariance.

pore
l
C
grain
l
C

[voxel]
[voxel]

Beadpack
20
36

Berea
10
41

Ketton
9
64

Training Image
Minkowski Functional S2(r) Direct
0.359
7.3

Porosity φ
1
voxel ]

Sv × 10−2 [

0.363
7.0

Synthetic

Training Image
S2(r) Direct S2(r) Direct
0.198
0.368
8.2
6.9

0.366
7.5

0.196
7.5

Synthetic

Training Image
S2(r) Direct S2(r) Direct
0.119
0.199
5.2
7.9

0.197
8.5

0.127
5.2

Synthetic
S2(r) Direct
0.119
0.119
5.2
4.7

FIG. 7. Comparison of three Minkowski functionals for the beadpack evaluated on 2003 voxel subdomains of the original
training image and realizations of the GAN model. An error of less than 5% can be observed for the porosity and surface area.

FIG. 8.
realizations. A clear hole eﬀect can be observed in the original dataset, clearly captured by the GAN model.

Comparison of the directional covariance of the beadpack and the average covariance of GAN based synthetic

11

FIG. 9. Twenty realizations of the spherical beadpack (top) generated to evaluate the statistical, image morphological and
transport properties considered in this study. Cross-sectional view of the beadpack training image dataset (bottom).

12

FIG. 10. Radial averaged covariance S2(r) for Berea sand-
stone training images and 20 synthetic realizations generated
by the GAN model.

B. Berea

The radial averaged covariance S2(r) in Fig. 10, shows
a near exponential decay and stabilisation occurs at a
lag distance of 30 voxels for both covariance functions
obtained from the Berea training image and synthetic
realizations generated by the GAN model.

Additionally, Fig. 12 shows that the directional two-
point statistics characterized by the directional covari-
ances is captured in the generated images. This is shown
by comparing the small hole eﬀect observed in the z-
direction of the Berea sample with the x-direction where
a near exponential decay can be observed. In both cases,
the GAN model shows excellent agreement and closely
follows the trend of the empirical estimates of S2.

The results of the direct computation of the Minkowski
functionals is presented in Fig. 13 and show comparable
distributions for the porosity φ, speciﬁc surface area SV
and the Euler characteristic χV of the training images
and the synthetic realizations.

A comparison of the speciﬁc surface area SV obtained
from the covariance and the direct computation of the
Minkowski functional, show nearly equal values (Ta-
ble II).

The obtained estimates of the single-phase permeabil-
ity show a similar distribution covering the range of eﬀec-
tive permeability measured on the training images. Fig-
ure 11 shows the computed values of permeability and the
corresponding eﬀective porosity. The permeability of the
synthetic realizations capture the values, variability and
trend obtained from the Berea training image dataset.

Figure 14 shows a comparison of twenty realizations of
the GAN model trained on the Berea dataset. A smaller
training image size of 643 voxels was used, as compared
to the beadpack (1283 voxels). This is due to the smaller
size of the structuring elements observed in the training
image. A smaller training image size was therefore suf-
ﬁcient to capture the long and short range correlation
found in the Berea sample.

FIG. 11. The distribution of numerically obtained perme-
ability values on 1283 voxel subdomains and sampled realiza-
tions obtained from a GAN model trained on the Berea sand-
stone dataset show close agreement in the eﬀective porosity,
as well as the evaluated permeability.

13

FIG. 12. Directional non-centered covariance comparison for Berea sandstone. The trained GAN model shows good agreement
with the non-centered covariance S2 of the training image.

FIG. 13. Comparison of three Minkowski functionals for Berea sandstone. The porosity, speciﬁc surface area and speciﬁc
Euler characteristic show good agreement between the training image and samples from the trained GAN model.

14

FIG. 14. Realizations generated by the GAN model (top) compared to training images (bottom) for Berea sandstone.

15

FIG. 15. Radial averaged covariance S2(r) for the oolitic
Ketton limestone training image and 20 synthetic realizations
generated by the GAN model.

C. Ketton

The covariance S2(r) of the Ketton limestone shown
in Fig. 15, shows a pronounced hole eﬀect due to the el-
lipsoidal oolitic grains. Due to the hole eﬀect observed
in the radial averaged covariance (Fig. 15), we relate the
Ketton sample to a hard-sphere model. Figure 17 in-
dicates that the images generated by the GAN model
trained on the Ketton image, capture the oscillatory and
anisotropic behavior of the covariance observed in Ket-
ton. The speciﬁc surface area SV derived from the gener-
ated images is in close agreement with the training data.
An error of approximately 1% was achieved in the poros-
ity of the GAN generated images compared to the origi-
nal Ketton dataset (Fig. 18).

The measured speciﬁc surface area of the synthetic im-
ages shows a higher variance compared to the original
training images. Nevertheless, the average values of the
porosity φ and speciﬁc surface area SV derived from the
non-centered covariance S2(r) [see Eq. (5)] are in good
agreement with values obtained from direct image mor-
phological estimation (see Table II).

The distribution of single-phase permeability estimates
of the synthetic GAN realizations overlies the permeabil-
ity values of the Ketton training images.

The Euler characteristic χV and the permeability of
the Ketton training dataset are closely matched by the
synthetic images and therefore capture the connectivity
observed in the oolitic Ketton limestone.

We present an overview of the 20 realizations gener-
ated by the GAN model trained on the Ketton dataset
in Fig. 19.

FIG. 16. Evaluated single-phase permeability for the Ket-
ton training image. The synthetic realizations show similar
eﬀective porosity and permeability as the Ketton sample.

16

FIG. 17. The directional covariance of the Ketton sample shows oscillating behavior in the x-direction, whereas a nearly
exponential decrease can be observed for the y and z directions. This anisotropy in S2(r) is also reﬂected in the covariance of
the samples obtained from the GAN model.

FIG. 18. Comparison of the Minkowski functionals for the Ketton training image. The three evaluated Minkowski functionals
show good agreement. The evaluated Euler characteristic indicates that the sampled synthetic realizations show a similar
degree of connectivity as the training image.

17

FIG. 19. Realizations generated by the GAN model (top) compared to training images (bottom) for Ketton limestone.

VI. DISCUSSION

This paper presents a novel method for

three-
dimensional stochastic image reconstruction based on
generative adversarial neural networks (GAN) trained on
three-dimensional segmented images. To summarize, the
objectives of this contribution are threefold. Firstly, the
generation of stochastic reconstructions of porous media
such as sedimentary rocks exceeding the size of the ac-
quired image datasets. Secondly, to evaluate the ability
of GAN models to capture the image morphological and
physical properties of micro-scale porous media. Thirdly,
to establish a method of stochastic image reconstruction
that allows a probabilistic treatment of pore-scale prop-
erties such as permeability without the need to acquire
numerous images of a single rock type.

The ﬁrst objective stems from technical limitations of
micro-CT data acquisition.
Images are acquired as a
trade-oﬀ between sample size i.e. how many represen-
tative structures can be captured in one image versus
the resolution at which these pore-scale structures are
resolved. The generation of large porous domains based
on high-resolution images enables this gap in scales to
be bridged and micro-scale features to be incorporated
in macro-scale models.

Our ﬁndings show that GANs can learn an implicit
representation of the image space given a limited num-
ber of training images subsampled from larger images.
These subdomains were extracted based on characteris-
tic length scales (see Sec. III A 1) and serve as a training
set for the GAN model. For the Ketton limestone, a small
spacing of the extracted subdomains was required to in-
crease the size of the training image dataset. While we
did not ﬁnd any evidence of an introduced bias by using
correlated subdomains, we believe that these extracted
training images should represent independent regions.

We have evaluated the ability to train GANs for a num-
ber of training image sizes less than and up to twice the
size of the structuring elements. We have found that
models trained on images smaller than the average grain
size results in artifacts and distorted shapes occurring in
the generated micro-structures. For the beadpack, the
size of an individual sphere is 50 voxels. A training im-
age of 643 voxels would typically only contain parts of
an individual grain and only capture the interaction of
the particles, but not the geometry of the structuring el-
ement. For the beadpack, models trained on 643 voxels
were successful in learning a representation of the short
scale micro-structure but failed to reproduce the long dis-
tance correlation. A larger training image of 1283 voxels,
as was used to model the beadpack has a much higher
chance to represent the full geometry of the particles and
therefore not only learn interactions, but also the shapes
of grains.

We, therefore, suggest that training images extracted
from large datasets must be larger than the average grain
size. For models that are well described by a Boolean
model, the size of the structuring element can be readily

18

estimated from stabilization of the covariance S2(r). For
more complex samples a diﬀerent measure must be used
to estimate the size of the required training image.

grain
C

The chord length is one additional measure that can be
obtained to characterize the grain space of porous media.
While we have found that the mean chord length of the
grain
grain space l
is always less than or equal to our cho-
C
sen training image size, l
increases with decreasing
porosity. This contradicts the need to have the largest
training domain for the beadpack sample which also has
the highest porosity. A better estimate may be related
to the representative elementary volume of the speciﬁc
surface area which by deﬁnition is the same for the grain
and pore space and is, therefore, more representative of
the morphology of the porous medium [53]. Based on the
properties we have evaluated we could not ﬁnd a measure
derived from two-point statistical or image morphological
properties that is closely related to the required training
image size and we see a theoretical discussion of this as
possible future work.

Conceptually the simplest model considered in this
study, the spherical beadpack, has proven to be the
most challenging as a training image for the GAN model
(Sec. V A). While we observe spherical and ellipsoidal
shapes in the resulting realizations (see Fig. 9), the
shape is exactly deﬁned by the spherical nature of the
grains. Any deviation from this shape, which for GANs,
is learned implicitly from the data itself, will lead to a
misrepresentation of the eﬀective properties. Random
hard-sphere models with spherical grains will eﬃciently
capture the nature of this dataset. Therefore we suggest
a ﬁt-for-purpose application of GANs, for training images
that exhibit variability of grain sizes and shapes, which
are not readily captured by a simpler model.

While for many sedimentary granular rocks represen-
tative volumetric images can be obtained, this may be
more challenging for carbonate samples with complex
pore-grain structures. The three training images consid-
ered in this study were all treated under the assumption
of stationarity i.e. we do not expect a variation in the
mean and variance of the averaged properties as a func-
tion of location. In theory, GANs are not limited to learn-
ing representations of stationary datasets. This is shown
by the many successful applications for two-dimensional
image and texture synthesis of non-stationary domains,
such as learned image representations of human faces [54]
or galaxies [55, 56]. Therefore a model that incorporates
non-stationarity for a single rock-type would technically
be possible in the GAN framework but would require the
acquisition of many images of the same porous medium.
A valid representation of the microscale variability and
connectivity of the pore space is critical to assess the
single and multi-phase ﬂow behavior of porous media.
Therefore any stochastic reconstruction method used in
the process of deriving or evaluating the variability of
micro-scale properties must capture the statistical and
image morphological characteristics of the reconstructed
porous medium. While we have shown that for the eval-

uated datasets, the GAN based image reconstructions
capture the variation and characteristics of these porous
media, a number of challenges arise in this task that are
fundamentally diﬀerent to classical stochastic methods of
image reconstruction.

For porous media, many ﬂow related properties can
be related to the porosity. Classical stochastic methods
are able to capture the porosity eﬃciently by deﬁning a
speciﬁc proportion of the grain and pore domain. The
GAN based model presented in this study initially has
no knowledge of the porosity. The porosity, therefore,
arises as a feature of the training image data. Matching
the porosity distribution of the training image dataset
was found to be the main challenge in training a GAN
model. An error of three percent in porosity would lead
to a mismatch in the permeability of the synthetic im-
ages. It is, therefore, necessary to continuously monitor
the derived properties such as the Minkowski functionals
or estimates of the permeability, in the course of training
the neural networks to ensure that synthetic realizations
created by the GAN model are able to capture the eﬀec-
tive properties of the micro-scale domains.

While this can be considered one of the main chal-
lenges in the application of GANs for synthetic image
reconstruction, learning an implicit representation of the
training data itself can be seen as a strength. Many clas-
sic stochastic methods rely on the formulation of an ob-
jective function that ensures that statistical properties
are captured in the generated realizations e.g. matching
S2(r) and the speciﬁc surface area SV of the stochastic re-
constructions to a desired precision. The GAN approach
does not require an explicit objective function a priori.
The objective function is encoded in the discriminator
and adapted in the course of training.

During adversarial training both the generator and dis-
criminator are continuously improved. The discrimina-
tor’s sole purpose is to be able to distinguish real training
data from generated synthetic data. On the other hand,
the generator tries to generate synthetic data that the
discriminator is not able to distinguish from the training
data. Due to the multi-scale representation of the convo-
lutional neural networks, these features must be learned
across the full range of length scales present in the train-
ing data, leading to a high-resolution image that cap-
tures small and large scale features of the image dataset.
A number of stacked GAN models can be trained on
e.g. low-resolution medical-CT data and high-resolution
micro-CT allowing incorporation of spatial information
across multiple length scales [33].

Once the GAN model has successfully learned to create
physically representative samples of the porous medium,
one possible application is to evaluate the variability in
the ﬂow properties by evaluating the properties of a large
number of samples. This not only requires a physically
valid representation of the porous medium but also re-
quires a method that allows fast image reconstruction.
In Sec. V we have shown that training was performed for
approximately 24 hours and may vary due to the need for

19

FIG. 20. Measured CPU time for generating synthetic real-
izations of Berea sandstone at increasing image size. 100 re-
alizations were computed at each image dimension and CPU
time averaged. Computational cost increases linearly with
the number of voxels in the generated image.

manual inspection of the generated samples in the train-
ing process. Figure 20 shows the CPU time required for
generation of images at increasing image size. The fully
convolutional nature of the GAN architecture allows very
large images, exceeding the size of the original sample to
be generated very eﬃciently and at low computational
cost and runtime.

While training requires considerable time and compu-
tational resources in the form of modern graphics pro-
cessors as well as optimized neural network frameworks,
image reconstruction requires little computational eﬀort
and scales linearly in the total number of voxels of the
generated images. This, therefore, enables the genera-
tion of ensembles of large domains based on volumetric
images acquired from 3D microscopy, that capture the
physical behavior of the porous medium. The learned
representation of the generator consists of the weights of
the convolutional ﬁlters learned in the training process
and can, therefore, be stored for future use once training
has ﬁnished.

VII. CONCLUSIONS

We have evaluated the application of generative adver-
sarial neural networks (GAN) for stochastic image recon-
struction of porous media based on previously acquired
images of sedimentary rocks. Three image datasets were
used as training images: a beadpack, a Berea sandstone,
and an oolitic Ketton limestone.

By evaluating two-point statistical measures,

image
morphological features and computing the single-phase
eﬀective permeability we have shown that the synthetic
images generated by the GAN model are able to cap-
ture the characteristic statistical and physical behavior
of these porous media.

While a large computational eﬀort is required to train
the GAN model, the generation of samples from the
learned representation is highly eﬃcient and learned
models are easily stored for future use.

Future work in the application of GANs to stochastic
image reconstruction of porous media will include im-
proving the quality of the image reconstruction by eval-
uating various generator-discriminator architectures, the
use of grayscale and multi-channel training images, as
well as the application of large multi-scale domains of

20

porous media to evaluate the ensemble behavior of single
and multi-phase ﬂow properties in porous media. Recent
advances in the understanding of GANs should lead to a
more stable and consistent training process [57, 58].

ACKNOWLEDGMENTS

O. Dubrule thanks Total for seconding him as a

Visiting Professor at Imperial College.

[1] M. J. Blunt, Multiphase Flow in Permeable Media:
A Pore-Scale Perspective (Cambridge University Press,
2017).

[2] R. Juanes, E. Spiteri, F. Orr, and M. Blunt, Water Re-
sources Research 42 (2006), 10.1029/2005WR004806.
[3] Q. Kang, P. C. Lichtner, H. S. Viswanathan, and A. I.
Abdel-Fattah, Transport in porous media 82, 197 (2010).
[4] P. Mostaghimi, M. J. Blunt, and B. Bijeljic, Mathemat-

vaux, and O. Besson, Mathematical Geosciences 43, 305
(2011).

[24] T. Huang, X. Li, T. Zhang, and D.-T. Lu, Computers &

Geosciences 57, 13 (2013).

[25] H. Okabe and M. J. Blunt, Physical Review E 70, 1

(2004).

[26] H. Okabe and M. J. Blunt, Journal of Petroleum Science

and Engineering 46, 121 (2005).

ical Geosciences 45, 103 (2013).

[27] H. Okabe and M. J. Blunt, Water Resources Research

[5] G. Matheron, Random sets and integral geometry, Wiley
series in probability and mathematical statistics: Proba-
bility and mathematical statistics (Wiley, 1975).

[6] J. Serra, Computer Graphics and Image Processing 12,

99 (1980).

[7] G. Matheron, Elements pour une Theorie des Milieux

Poreux (Masson, Paris, 1971).

[8] C. Arns, M. Knackstedt, and K. Mecke, Physical Review

[9] P. A. Rikvold and G. Stell, J. Chem. Phys. 82, 1014

E 80, 051303 (2009).

(1985).

[10] S. Torquato, Random heterogeneous materials: mi-
16

crostructure
(Springer Science & Business Media, 2013).

and macroscopic

properties, Vol.

[11] T. Bretheau and D. Jeulin, Revue de Physique Appliqu´ee

24, 861 (1989).

[12] D. Jeulin, Statistics and Computing 10, 121 (2000).
[13] C. Lin and M. H. Cohen, Journal of Applied Physics 53,

(1998).

[15] P.-E. Øren and S. Bakke, Journal of Petroleum Science

and Engineering 39, 177 (2003).

[16] M. J. Pyrcz and C. V. Deutsch, Geostatistical reservoir

modeling (Oxford University Press, 2014).

[17] J. Caers and T. Zhang, AAPG Memoir 80, 383 (2004).
[18] G. Mariethoz, P. Renard, and J. Straubhaar, Water Re-

[28] W. E. Smith, H. H. Barrett, and R. G. Paxman, Optics

43, 3 (2007).

Letters 8, 199 (1983).

[29] D. I. Svergun, Biophysical Journal 76, 2879 (1999).
[30] L. M. Pant, Stochastic Characterization and Reconstruc-
tion of Porous Media, Ph.D. thesis, University of Alberta
(2016).

[31] I. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu,
D. Warde-Farley, S. Ozair, A. Courville, and Y. Bengio,
in Advances in Neural Information Processing Systems
(2014) pp. 2672–2680.

[32] J. Wu, C. Zhang, T. Xue, W. T. Freeman, and J. B.
(2016), arXiv:1610.07584

Tenenbaum, ArXiv e-prints
[cs.CV].

[33] H. Zhang, T. Xu, H. Li, S. Zhang, X. Huang,
(2016),

and D. Metaxas, ArXiv e-prints

X. Wang,
arXiv:1612.03242 [cs.CV].
Goodfellow,

ArXiv

[34] I.

e-prints

(2016),

[35] T. Salimans, I. Goodfellow, W. Zaremba, V. Cheung,
A. Radford, and X. Chen, in Advances in Neural Infor-
mation Processing Systems (2016) pp. 2226–2234.
[36] C. Kaae Sønderby, J. Caballero, L. Theis, W. Shi,
and F. Husz´ar, ArXiv e-prints (2016), arXiv:1610.04490
[cs.CV].

[37] P. Debye, H. R. Anderson, and H. Brumberger, Journal

of Applied Physics 28, 679 (1957).

4152 (1982), http://dx.doi.org/10.1063/1.331238.

arXiv:1701.00160v3.

[14] C. L. Y. Yeong and S. Torquato, Phys. Rev. E 57, 495

sources Research 46, 11 (2010).

[38] S. Torquato and F. Lado, Journal of Physics A: Mathe-

[19] E. Meerschman, G. Pirot, G. Mariethoz, J. Straubhaar,
M. Van Meirvenne, and P. Renard, Computers & Geo-
sciences 52, 307 (2013).

[20] P. Tahmasebi, M. Sahimi, and J. Caers, Computers &

Geosciences 67, 75 (2014).

matical and General 18, 141 (1985).

[39] C. Scholz, F. Wirner, M. A. Klatt, D. Hirneise, G. E.
Schr¨oder-Turk, K. Mecke, and C. Bechinger, Physical
Review E 92, 043023 (2015).

[40] C. Lang, J. Ohser, and R. Hilfer, Journal of Microscopy

[21] A. Comunian, P. Renard, J. Straubhaar, and P. Bayer,

203, 303 (2001).

Journal of hydrology 405, 10 (2011).

[41] D. Legland, I. Arganda-Carreras, and P. Andrey, Bioin-

[22] G. Mariethoz and J. Caers, Multiple-point geostatistics:
stochastic modeling with training images (John Wiley &
Sons, 2014).

formatics 32, 3532 (2016).

put. Phys. 12, 620 (1998).

[42] H. G. Weller, G. Tabor, H. Jasak, and C. Fureby, Com-

[23] J. Straubhaar, P. Renard, G. Mariethoz, R. Froide-

[43] A. Radford, L. Metz, and S. Chintala, ArXiv e-prints

21

[44] S.

Ioﬀe and C. Szegedy, ArXiv e-prints

(2015),

(2015), arXiv:1511.06434.

arXiv:1502.03167 [cs.LG].

[45] V. Nair and G. E. Hinton, in Proceedings of the 27th
International Conference on Machine Learning (ICML-
10) (2010) pp. 807–814.

(1970).

[52] D. Emery, The Origin of Late Spar Cements in the
Lincolnshire Limestone, Jurassic of Central England:
145(4), Vol. 145 (Journal of the Geological Society, 1988)
pp. 621–633.

[53] J. Bear, Dynamics of ﬂuids in porous media (Courier

[46] A. L. Maas, A. Y. Hannun, and A. Y. Ng, in Proc. ICML,

Corporation, 2013).

Vol. 30 (2013).

arXiv:1412.6980.

[47] D. Kingma and J. Ba, ArXiv e-prints

(2014),

[48] N. Otsu, Automatica 11, 23 (1975).
[49] J. Finney, in Proceedings of the Royal Society of Lon-
don A: Mathematical, Physical and Engineering Sciences,
Vol. 319 (The Royal Society, 1970) pp. 479–493.

[50] J. F. Pepper, Geology of the Bedford Shale and Berea
Sandstone in the Appalachian Basin: A Study of the
Stratigraphy, Sedimentation and Paleogeography of Rocks
of Bedford and Berea Age in Ohio and Adjacent States,
Vol. 259 (US Government Printing Oﬃce, 1954).

[51] W. de Witt Jr, U.S. Geological Survey Bulletin 1294

[54] J. Gauthier, Class Project for Stanford CS231N: Convo-
lutional Neural Networks for Visual Recognition (2014).
[55] K. Schawinski, C. Zhang, H. Zhang, L. Fowler,
(2017),

and G. Krishnan Santhanam, ArXiv e-prints
arXiv:1702.00403 [astro-ph.IM].

[56] S. Ravanbakhsh, F. Lanusse, R. Mandelbaum, J. Schnei-
(2016),
and B. Poczos, ArXiv e-prints

der,
arXiv:1609.05796 [astro-ph.IM].

[57] X. Mao, Q. Li, H. Xie, R. Y. K. Lau, and Z. Wang,
ArXiv e-prints (2016), arXiv:1611.04076 [cs.CV].
[58] M. Arjovsky, S. Chintala, and L. Bottou, ArXiv e-prints

(2017), arXiv:1701.07875.

7
1
0
2
 
r
p
A
 
1
1
 
 
]

V
C
.
s
c
[
 
 
1
v
5
2
2
3
0
.
4
0
7
1
:
v
i
X
r
a

Reconstruction of three-dimensional porous media
using generative adversarial neural networks

Lukas Mosser,∗ Olivier Dubrule,† and Martin J. Blunt‡
Department of Earth Science and Engineering,
Imperial College London

(Dated: April 12, 2017)

To evaluate the variability of multi-phase ﬂow properties of porous media at the pore scale, it is
necessary to acquire a number of representative samples of the void-solid structure. While modern
x-ray computer tomography has made it possible to extract three-dimensional images of the pore
space, assessment of the variability in the inherent material properties is often experimentally not
feasible. We present a novel method to reconstruct the solid-void structure of porous media by
applying a generative neural network that allows an implicit description of the probability distribu-
tion represented by three-dimensional image datasets. We show, by using an adversarial learning
approach for neural networks, that this method of unsupervised learning is able to generate repre-
sentative samples of porous media that honor their statistics. We successfully compare measures of
pore morphology, such as the Euler characteristic, two-point statistics and directional single-phase
permeability of synthetic realizations with the calculated properties of a bead pack, Berea sand-
stone, and Ketton limestone. Results show that GANs can be used to reconstruct high-resolution
three-dimensional images of porous media at diﬀerent scales that are representative of the morphol-
ogy of the images used to train the neural network. The fully convolutional nature of the trained
neural network allows the generation of large samples while maintaining computational eﬃciency.
Compared to classical stochastic methods of image reconstruction, the implicit representation of
the learned data distribution can be stored and reused to generate multiple realizations of the pore
structure very rapidly.

PACS numbers: 02.50.Ey, 07.05.Mh, 42.30.Wb, 83.80.Fg
Keywords: stochastic image reconstruction, porous media, artiﬁcial neural networks

I.

INTRODUCTION

A.

Image Reconstruction

The reconstruction and the evaluation of the material
properties of porous media plays a key role across many
engineering disciplines. Many physical processes such as
the movement of multiple phases of ﬂuids through sedi-
mentary rocks are controlled by individual pores at the
micron and sub-micron scale [1].

In carbon capture and sequestration (CCS), the long
term storage behavior is controlled by the physical and
chemical interaction of super-critical CO2 with the reser-
voir brine, as well as the spatial distribution and connec-
tivity of minerals in the pore-space [2, 3]. The variability
of the controlling properties such as the permeability of
the host rock is determined by repeated experiments or
numerical modeling of these processes.

Using modern computer tomographic methods, it is
possible to observe porous materials and evaluate their
material properties at the micrometer scale (micro-CT)
under static and transient conditions at high pressures
and temperatures in near real time. Performing micro-

∗ lukas.mosser15@imperial.ac.uk
† o.dubrule@imperial.ac.uk
‡ m.blunt@imperial.ac.uk

CT imaging of porous media requires specialized, expen-
sive equipment and in the case of CCS, only a single
image of the investigated rock type is typically acquired.
To evaluate the variability associated with the geomet-
rical and mineralogical morphology of the pore-space, nu-
merous physical experiments using the same rock type
would have to be performed to obtain a distribution over
larger volumes. Due to time and cost limitations inher-
ent with the experimental acquisition of high-resolution
images, this is often deemed unfeasible. Material prop-
erties governing the single and multi-phase ﬂow behavior
of porous media can be estimated from numerical so-
lution of partial diﬀerential equations at the scale of a
representative elementary volume (REV) and veriﬁed by
experimental results [4].

Many sedimentary rocks consist of granular siliciclas-
tic or carbonate materials. Boolean models use this fun-
damental characteristic of natural granular materials to
emulate the shape of the arising pore space, due to an
underlying random process that controls the distribution
of the individual grains [5, 6]. While for the classical
Boolean model, the centers of the grains are uniformly
distributed in space and grains can arbitrarily overlap,
more complicated models with rigid hard sphere grains
and more complex grain interaction functions have been
developed [7–10]. The framework of Boolean models also
allows extension beyond spherical particles and enables
derivation of the properties of material models as

a function of the parameters of the underlying random

process [11–14].

In sedimentary rocks, the arrangement of individual
grains occurs due to the transport of material from a
high energy source to a low energy sink. Process mod-
els, where depositional mechanisms are simulated, have
been shown to reproduce realistic granular reconstruc-
tions capturing the pore space morphology of granular
sedimentary rocks [15].

Spatial probabilistic models such as truncated Gaus-
sian processes or sequential indicator simulation have
been widely applied in the geosciences to model the spa-
tial distribution of materials [16]. Many of these methods
rely on two-point probability functions as a measure of
spatial variability, whereas recent methods in geostatis-
tics use training images as a basis for sample reconstruc-
tion [17–19]. These images are usually assumed to exhibit
stationarity of the probability distribution of the prop-
erties of interest and rely on higher order multiple point
statistics (MPS) to reconstruct stochastic random media.
With MPS, the probability distributions are repre-
sented by training images and are sampled using a limited
multi-scale neighborhood that captures the variation on
a large scale, as well as ﬁne structural details on smaller
scales [20]. MPS based methods have been used in two
and three-dimensional conditional simulation of spatial
properties in reservoir-scale earth modeling applications
[21]. The computational complexity of these methods
is highly dependent on individual algorithms as well as
the size of the domains used to sample from the training
images [22]. Parallelized versions have been developed,
reducing the computational time required to perform re-
construction using multiple point statistics [23, 24].

Three-dimensional porous media have been recon-
structed using a modiﬁed multiple-point statistics ap-
proach based on two-dimensional images of porous media
[25–27].

Stochastic methods based on simulated annealing al-
low the incorporation of arbitrary cost functions of sta-
tistical and morphological properties used in uncondi-
tional three-dimensional image reconstruction [28, 29].
Recent advances have reduced the computational run-
time of simulated annealing based methods for recon-
struction of porous media, to the order of tens of hours
per realization at the scale of 3003 voxels [30].

In the following section, we introduce a recently de-
veloped class of unsupervised machine learning methods
called generative adversarial networks (GAN) that al-
low simulation of probability distributions given a set
of training data [31]. Volumetric generative adversarial
networks have previously been applied to low-resolution
three-dimensional CAD model synthesis, and practical
applications of 3D-GANs are few compared to their
two-dimensional counterpart [32]. Integration of multi-
resolution datasets incorporating image data across a
number of length scales is possible in the GAN frame-
work by using a Laplacian pyramid approach such as
StackGAN [33].

2

We investigate the applicability of GANs to model
three-dimensional textures of rocks based on three-
dimensional binary representations of porous media ac-
quired at the micrometer scale. We compare statistical,
morphological and transport properties of the simulated
images with those of the training images. We evaluate
the single-phase directional permeability to show that the
synthetic realizations sampled from the learned represen-
tation of the input data can capture single-phase ﬂow
properties of sedimentary rocks.

Training of these neural networks involves ﬁnding a
set of hyperparameters that lead to stable training [34].
While this training can take on the order of tens of hours,
the sampling of large volumetric domains occurs on the
order of seconds on the current generation of graphical
processing units (GPU). We show that in favorable cases
convolutional neural networks incorporated in the GAN
framework allow the generation of synthetic reconstruc-
tions of porous media that exceed the dimensions of their
training images. Contrary to most existing simulation
techniques the set of parameters used to generate syn-
thetic realizations can be stored once trained allowing
rapid generation of new samples to assess the variability
of material properties.

While we apply GANs to a set of micro-CT images
of porous media, the method can readily be applied to
volumetric images of porous media obtained from other
three-dimensional microscopy instruments such as nano
or medical-CT instruments.

We discuss the challenges involved in training GANs
for stochastic image reconstruction of porous media, as
compared to other stochastic image reconstruction meth-
ods and evaluate the computational eﬃciency of GAN
based image reconstruction. Finally, we provide empir-
ical guidelines on the requirements of the input dataset
to allow successful training of GANs on large three-
dimensional voxel representations of natural porous me-
dia.

All data used in this study is available in the public
domain and we have made the code used for training,
as well as example pre-trained models, available as addi-
tional supporting material 1. A public dataset of high-
resolution micro-CT images made available by the Impe-
rial College Pore-Scale Modelling Group 2, of a spherical
beadpack, Berea sandstone, and oolitic Ketton limestone
will serve as benchmark cases to study the application of
GANs to three-dimensional stochastic image reconstruc-
tion.

1 https://github.com/LukasMosser/PorousMediaGan
2 http://www.imperial.ac.uk/earth-science/research/

research-groups/perm/research/pore-scale-modelling/
micro-ct-images-and-networks/

3

FIG. 1. Overview of the GAN training process. Segmented volumetric images are usually split into 643 voxel training images.
The generator G is a function that is applied to a sample from a latent random space Z and creates a synthetic realization.
We assume that samples drawn from the hidden latent space Z are distributed according to a normal distribution (see Sec. II).
The discriminator’s role is to determine whether a sample is part of the training image dataset (label 1) or from the generator
(label 0). The misclassiﬁcation error is computed as a binary cross-entropy criterion and the error back-propagated to improve
the discriminator’s ability to distinguish real and ”fake” images. Then the generator is updated to improve the quality of
the produced samples and ”fool” the discriminator. When suﬃcient image quality is obtained, training is stopped, and the
discriminator may be discarded. The generator can now be used to create new samples. By providing larger latent vectors
than used initially for training, larger output images can be produced.

II. GENERATIVE ADVERSARIAL NETWORKS

In the following section, we present generative ad-
versarial networks (GAN) in the context of three-
dimensional image generation. Generative neural net-
works have been developed in the context of deep learn-
ing by Goodfellow et al. as a methodology to learn a
representation of a high-dimensional probability distri-
bution from a given dataset [31]. In the context of image
reconstruction, we refer to this dataset as a set of training
images that present representative samples of the proba-
bility distribution underlying the image space.

GANs learn an implicit representation of the proba-
bility density as opposed to explicit density models. The
main drawback of explicit density models is their compu-
tational cost which grows with the dimensionality of the
samples and requires sequential simulation of each voxel.
For high-dimensional samples such as volumetric image
data, the computational cost is O(N ) where N repre-
sents the number of voxels in the domain of interest and
can easily exceed 109 voxels for modern high-resolution

micro-CT image data. Using any of these methods would
make it intractable to generate a large number of very
large samples. GANs have been designed to perform fast
sampling from the learned density representation and al-
low full parallel generation, making them an ideal candi-
date to generate large volumetric images [34].

GANs consist of two diﬀerentiable functions: a dis-
criminator D and a generator G. The discriminator re-
ceives samples of the ”real” dataset (Label 1) x ∼ pdata
and ”fake” samples G(z) (Label 0) created by the gener-
ator from the hidden latent space Z (see Fig. 1 above).
The latent space Z is composed of independent real
random variables, typically normally or uniformly dis-
tributed, that represent the random input to the genera-
tor G. The generator G maps random variables from the
latent space into the space of images. The discrimina-
tor’s role is to assign a probability that a random sam-
ple is from the ”real” data distribution pdata. The dis-
criminator tries to label each sample correctly, while the
generator tries to ”fool” the discriminator into labeling
the fake images as part of the true data distribution and

therefore achieving D(G(z)) close to one.

More formally we can deﬁne the loss i.e. the cost func-
tion for GANs as a minimization-maximization problem

image datasets. We treat all images under the assump-
tion of stationarity and the existence of a representative
elementary volume.

4

max
D

{Ex∼pdata(x)[log(D(x))]
min
G
+Ez∼pz(z)[log(1 − D(G(z)))]}
Solutions to this optimization problem have been
shown to be Nash equilibria, where each player achieves
a local minimum of their loss function with respect to
their parameters [34].

(1)

In practice we represent G and D by convolutional
neural networks that are trained by a gradient descent
based optimization method. Training is performed in
two steps: First the discriminator is trained to maximize
J (D) = Ex∼pdata(x)[log(D(x))]
+Ez∼pz(z)[log(1 − D(G(z)))]
while the parameters of the generator are ﬁxed. This
improves the ability of the discriminator to distinguish
between real and fake images.

(2)

In a subsequent step we generate synthetic samples
G(z) by drawing samples z from an N-dimensional nor-
mal distributed latent space and train the generator to
minimize

J (G) = Ez∼pz[log(1 − D(G(z)))]

(3)

while keeping the discriminator ﬁxed.

By minimizing Eq. (3) the generator tries to ”fool” the
discriminator into believing that the samples G(z) are
real data samples.
In this way the generator learns to
represent a distribution pg(x) that is as close as possible
to the real data distribution pdata(x). When convergence
is reached pg(x) = pdata(x) and the value of the discrim-
inator becomes 1
2 as it cannot distinguish between the
two anymore.

Initially, the discriminator D outperforms the gener-
ator signiﬁcantly making the gradient used to train the
generator close to zero. Therefore, instead of minimiz-
ing log(1 − D(G(z)) for the generator, it is helpful to
maximize log(D(G(z)) [34].

GANs show highly unstable behavior during training
and a large number of trial and error runs are required to
ﬁnd an optimal set of hyperparameters that allow stable
training. A number of heuristics have been published
which have been shown to stabilize GAN training, such
as one-sided label smoothing and adding white noise to
the input layer of the discriminator [35, 36].

We provide a more detailed overview of the neural
networks used in this study in Sec. III B and later pro-
vide suggestions on how to facilitate eﬃcient training (see
Sec. VI) for volumetric image datasets of porous media.

III. METHODOLOGY

In the following section we outline the criteria used to
evaluate the quality of simulations based on the training

A. Evaluation Criteria

1. Two-Point Statistics

We characterize the second order structure of the
porous media by calculating the two-point probability
function of the pore phase. By assuming stationarity,
this function is equivalent to the non-centered covariance
[7]:

S2(r) = P(x ∈ P, x + r ∈ P ) f or x, r ∈ Rd

(4)

which is the probability P that two points x and x + r,
separated by the lag vector r, are located in the pore
phase P . At the origin, S2(0) is equal to the porosity φ.
S2 stabilizes around φ2 as r → ∞ (Fig. 2). Due to the
anisotropic nature of many porous media, we compute
S2(r) along the three Cartesian directions, as well as the
radial average of S2(r).

FIG. 2. Comparison of S2(r) for a Boolean model and a
packing of hard spheres at a porosity φ = 0.5. S2 exhibits ex-
ponential decay for the Boolean model, whereas a dampened
oscillation is characteristic for packings of spheres. The mean
chord length can be found at the intersection of the slope of
S2 at the origin with the x-axis [see Eq. (6)].

It is a well known result that the speciﬁc surface area
SV of a porous medium can be expressed as a function of
S2 [37]. In the case of an isotropic porous medium and
in three-dimensions SV is related to S2 by

SV = −4S(cid:48)

2(0)

(5)

where S(cid:48)

2(0) is the derivative of S2(r) at the origin.
Furthermore, the average chord length within the pore

and the grain phases are [10]

pore
c =

l

grain
c

l

=

φ
S(cid:48)
2(0)
1 − φ
S(cid:48)
2(0)

(6a)

(6b)

which for the pore phase can be readily found from the
intersection of the slope of S2(r) with the x-axis.

In favorable cases, it is possible to ﬁnd analytical ex-
pressions of S2(r) from the spatial distribution and ge-
ometry of the grains. A Boolean model of overlapping
spherical grains of uniform spatial distribution exhibits
an exponential decay of the covariance until the lag dis-
tance is equal to the diameter of the grains where it be-
comes zero [7]. For porous media that can be well de-
scribed by a Boolean model, we can estimate the size of
the elementary Boolean grain from the decay of S2.

Semi-analytical expressions for more complex models
such as for a packing of hard spheres have been devel-
oped [38]. Models of S2(r) for spherical packings exhibit
a dampened oscillation. The shape of the estimated co-
variance, therefore, allows us to obtain information on
the structure of the porous medium (see Fig. 2 above).

The covariance S2(r) was estimated for the training
images and the stochastic reconstructions generated by
the trained GAN model. For each GAN model, we evalu-
ate the non-centered covariance S2 as well as the speciﬁc
surface area SV [Eq. (5)] and compare these to the values
obtained from the original training images.

In our discussion on the required training image sizes
(Sec. VI), we will use the average chord length and the
speciﬁc surface area as possible indicators of the neces-
sary training image size.

2. Morphological Measures

It has been shown that ﬂow properties at the pore-
scale can be related to morphological characteristics of
the void-solid interface of a porous medium [39]. Had-
wiger’s theorem states that the size of a body in a d-
dimensional space can be described by a linear combina-
tion of d + 1 independent parameters characterizing the
body. In three dimensions we can, therefore, deﬁne four
so-called Minkowski functionals that fully characterize
the size of a three-dimensional object. We compute esti-
mates of three Minkowski functionals; the porosity φ, the
speciﬁc surface area SV and the Euler characteristic χV
corresponding to the zero, ﬁrst and 3rd order functionals.

5

(7)

(8)

(9)

We compute the densities of the Minkowski functionals
by dividing by the volume V .

The Minkowski functional of order zero is the porosity,
deﬁned as the ratio of volume of the void space to the
bulk volume of the sample

and is, therefore, a measure of the ability of a porous
medium to store ﬂuids.

The Minkowski functional of rank one is the speciﬁc

surface area SV .

φ =

Vpore
V

SV =

dS

(cid:90)

1
V

where integration occurs over the void-solid interface S.
The speciﬁc surface area SV has dimensions of
length and
its inverse allows us to deﬁne a characteristic pore size.
The speciﬁc Euler characteristic is closely related to
the order three Minkowski functional and represents a
dimensionless quantity deﬁned as

1

χv =

(cid:90)

1
4πV

1
r1r2

dS

where r1 and r2 are the principal radii of curvature of the
void-solid interface. To compute χV we do not directly
evaluate the integral in Eq. (9) but instead make use
of a relationship for the Euler characteristic of arbitrary
polyhedra,

χ = V − E + F − O

(10)

where V is the number of vertices, E the number of
edges, F the number of faces and O the number of objects
[1]. This expression is the basis for eﬃcient algorithms
to compute Minkowski functionals of arbitrary geomet-
ric bodies represented as volumetric voxelized domains
[40]. To compute these three Minkowski functionals we
have used the open-source image morphological software
library MorphoLibJ [41].

While the porosity expresses the ability to store ﬂu-
ids in a porous medium, adsorption and dissolution pro-
cesses are controlled by the speciﬁc surface area. The
Euler characteristic allows the connectivity of the porous
medium to be characterized, which is a critical compo-
nent in the ability of ﬂuids to ﬂow. Reconstructions of
porous media should therefore closely match the observed
Minkowski functionals to represent the behavior of rele-
vant physical processes at the pore-scale.

The direct computation of the speciﬁc surface area
SV and porosity φ from images allows us to perform a
comparison with the values obtained from estimates ob-
tained by computing the empirical non-centered covari-
ance S2(r) [see Eq. (5)].

6

TABLE I. Neural network conﬁgurations and hyperparameters used to train on voxelized image subsets.

Training Image Size
Latent Space z Dimension
Generator Filters NG
Discriminator Filters ND
Optimizer
Learning Rate / Momentum
Stabilization

Beadpack
1283 voxels
100
64
8

Training Image Dataset
Berea
643 voxels
512
64
16
Generator + Discriminator: Adam
2 × 10−4 / 0.5
Label Smoothing ((cid:15) = 0.1)

2 × 10−4 / 0.5
White Noise (σ = 0.1)

2 × 10−4 / 0.5
White Noise (σ = 0.1)

Ketton
643 voxels
100
64
16

subsets of the Imagenet and CIFAR-10 datasets [43]. The
hyperparameters for the generator to be used in the opti-
mization of the neural network architecture are the num-
ber of trainable convolutional ﬁlters in each layer of the
neural network NG,F , ND,F and the size of the latent
vector z.

The generator and discriminator are optimized using a
gradient descent based method where the parameters w
are changed by taking k steps in the gradient

wk+1 = wk − α∇f (wk)

(13)

where α is the learning rate. We have used the gradient
descent based optimiser ADAM for optimization of both
the generator and discriminator [47].

GANs have been shown to exhibit unstable behavior
during training. The addition of Gaussian noise to the
input of the discriminator provides an eﬀective measure
to prevent mode collapse and stabilize the training pro-
cess [36]. An additional stabilization measure called one-
sided label smoothing, wherein the class label of 1 for
real images is replaced by a new value of 1 − (cid:15) has been
empirically shown to improve training of GANs [35].

Both label smoothing and white noise addition to the
input of the discriminator have been used in this study
to stabilize the training based on the volumetric image
datasets. Table I gives an overview of the neural network
hyperparameters used for each evaluated sample, the hy-
perparameters and the stabilization measure used during
training.

Images generated by the GAN were post-processed us-
ing a 33 median ﬁlter to remove single-pixel noise. The
resulting images are grayscale images with all voxel val-
ues close to zero or one. To compare the resulting images
to the binary training images, we segment the generated
images using Otsu’s method [48].

3. Single-Phase Permeability

To evaluate the single-phase permeability of the porous
media and their generated synthetic reconstructions we
solve the Stokes equations for slow, incompressible ﬂow
assuming small inertial forces.

The Stokes equations are solved on the domain that is
connected to the ﬂuid inlet and outlet. This allows us to
deﬁne an eﬀective porosity where only the fraction of the
pore space that also contributes to ﬂow is considered

∇ · v = 0
µ∇2v = ∇p

φef f =

Vf low
V

(11a)
(11b)

(12)

A ﬁnite diﬀerence method to solve Eq. (11a)-(11b) on
pore-space representations has been implemented as a
parallel ﬂow solver, in the free open source numerical
framework OpenFOAM [4, 42].

B. Neural Network Architecture

The neural network architecture used for the three-
dimensional image reconstruction corresponds to a vol-
umetric version of the DCGAN network [43]. The net-
work consists of two independent fully convolutional neu-
ral networks, the generator G and the discriminator D.
Upsampling from the input latent vector z is performed
by volumetric transposed convolution, followed by batch
normalization and a rectiﬁed linear unit (ReLU) activa-
tion function in all layers except the last [44, 45].

The discriminator D receives images sampled from the
latent space by the generator G(z) and images from the
set of training images representing pdata(x). Therefore,
the size of the input layer of the discriminator corre-
sponds to the dimensions of the input training images.
The discriminator consists of volumetric convolution lay-
ers combined with LeakyReLU activation functions [46].
The ﬁnal convolutional layer of the discriminator is fol-
lowed by a Tanh activation function.

This combination of generator and discriminator neu-
ral network architectures has previously been applied to

7

FIG. 3. Cross-sections of the three binary images that have been reconstructed. The bordered regions indicate the size of
the training images extracted from the full dataset. The beadpack consists of spheres of equal diameter (d = 50 voxels). The
Berea sandstone is an angular granular sandstone that shows traces of dispersed clay. The oolitic Ketton limestone consists of
ellipsoidal grains showing inter and intra-granular porosity. The voxel sizes are 3 µm for the bead pack as well as the Berea
sandstone and 15.2 µm for the Ketton sample.

IV. EXPERIMENTAL DATA

2. Berea

A.

Image Data and Processing

To evaluate the applicability of GANs for reconstruc-
tion of natural porous media we use three previously ac-
quired datasets. All images have been segmented into a
three-dimensional binary voxel representation of the pore
space (white) and grain structure (black) (Fig. 3). We
create a training database of images by extracting sub-
volumes from the voxelized binary images. Ideally, these
training images should represent independent domains,
but due to the limited size of these images, we extract
subsets that overlap.

Training image sizes were chosen based on an estimate
of the average grain size for each sample. To be able
to match the covariance S2(r) [Eq. (4)] and image mor-
phological characteristics, training images larger than the
structuring element were necessary. We discuss this re-
quirement in more detail in the discussion of our results
(see Section VI). Due to computational limitations, train-
ing image sizes exceeding 1283 voxels were not consid-
ered.

1. Beadpack

The beadpack is based on a real packing of equally
sized ceramic grains in a disordered close packing [49].
The image consists of 5003 voxels with a size of 3 µm.
The size of an individual sphere is 50 voxels. 1727 train-
ing images were extracted of size 1283 voxels correspond-
ing to a spacing of 32 voxels between them in the original
image.

Berea sandstone is a ﬂuvial sandstone of medium to
ﬁne grain size (Wentworth classiﬁcation) [50]. The indi-
vidual grains are bonded by clays. The sample analyzed
in this study was acquired from an outcropping of the
Berea sandstone in a quarry near Berea, Ohio. De Witt
showed that the Berea sandstone was deposited in the
early Carboniferous (354-323 Mya) [51].

The image of Berea sandstone consists of angular
grains with no clay presence in the intergranular pore-
space. The image has dimensions of 4003 voxels with a
voxel size of 3 µm.

To capture the local interaction of grains we have ex-
tracted training images at 643 voxels which allows a num-
ber of grains to be present in one training image (see
Sec. VI). Due to the small image size of 4003 voxels, sub-
volumes were extracted at a spacing of 16 voxels.
In
all, 10647 training images were used for the image recon-
struction.

3. Ketton

The Ketton sample is an oolitic limestone of Juras-
sic age (201.3-145 Mya). The sample was acquired from
a quarry of Lincolnshire limestone in the North-East of
England. The oolites contained in the Lincolnshire for-
mation are mainly non-ferroan calcite grains. The oolitic
limestones of the Lincolnshire show a wide variety of ce-
mentation, ranging from uncemented oolite sands with
no intergranular cement to heavily ferroan spar-cemented
oolites with inﬁlled microporosity [52]. Microstructures
in the pore space can be observed that lead to a reduction
in porosity (Fig. 3).

8

FIG. 4. Value of the cost function i.e. loss of the discriminator and generator [Eq. (2)-(3)] for the GAN trained on the Berea
sandstone. The samples shown were computed with the same random number seed, showing the evolution of a single realization
during training. Initially, image quality is very low and random noise can be observed. After 2000 generator iterations a drop
in the generator loss function is observed and coarse structures can be identiﬁed in the resulting sample. Loss functions in
GAN models do not reﬂect improvement in image quality which can be observed from samples. Learning rates [see Eq. (13)]
were reduced after suﬃcient image quality was reached and training stopped based manual inspection of Minkowski functionals
and two-point statistics.

The Ketton sample chosen for this study consists of
large grains compared to the overall image size. The im-
age used for the following evaluation has been downsam-
pled from a 5003 voxel representation to an image size
of 2563 voxels. This allows more grains to be resolved
per training image extracted from the full volume. The
downsampled voxel size is 15.2 µm.

Training images were extracted at a sub-volume size of
643 with a spacing of 8 voxels leading to a total of 15624
training images. The small spacing of the training images
results from the small CT image size of 2563 voxels.

V. RESULTS

Three GANs were trained based on the network archi-
tectures highlighted in Sec. III B. The training time for
each dataset was 24 hours. Manual inspection of syn-
thetic realizations was performed during training to en-
sure convergence and intermediate evaluation of the co-
variance and Minkowski functionals.

Figure 4 shows the training curve for the Berea sand-
stone dataset. Initially the generator loss function [see
Eq. (3)] is very high and no structural components can
be observed in the samples. After a large reduction in
the loss function of the generator, initial structures are

observed. Image reconstruction quality signiﬁcantly im-
proves with the number of generator iterations, but can-
not be linked to the loss function of the generator. This
can be observed from the increase in generator loss at the
end of training while image quality improves signiﬁcantly.
The ﬁnal GAN models were subsequently evaluated
in terms of their directional and radial averaged non-
centered covariance S2(r), Minkowski functionals and the
single-phase permeability.

For all datasets, 20 realizations were generated using
the trained GAN model.
In the following section, we
present the results of the evaluation of the properties
outlined in Sec. III A and compare these to the properties
of the original input training image.

A. Beadpack

The evaluation of the non-centered covariance S2(r) for
the beadpack (Fig. 5) shows a strong hole eﬀect reﬂecting
the spherical nature of the grains.

A GAN model was trained for 24 hours on the bead-
pack training image dataset. The GAN model achieves a
small error in the porosity of the generated images with
a tendency towards higher porosities (Fig. 7).

A bias can be observed for the speciﬁc surface area and
the Euler characteristic of the microstructure (Table II).
This bias can be explained by the deviation of the
grains from a perfect spherical shape in the synthetic
realizations. Due to the smooth nature of the spheri-
cal particles in the training image, any deviation from
this geometry will lead to an increase in the surface area.
This is reﬂected by a higher speciﬁc surface area for the
synthetic realizations.
In addition we observe a reduc-
tion in connectivity, represented by a less negative Euler
characteristic.

The directional covariance S2 measured on the gener-
ated samples show excellent agreement up to the training
image size of 1283 voxels and stabilizes at φ2 (see Fig. 8).
As expected no directional variation of the covariance
is observed and the sample is therefore assumed to be
isotropic.

Single-phase permeability shows a close agreement in
both magnitude and variance between the measured
training image and the synthetic realizations (Fig. 7).
Figure 6 shows a crossplot of the eﬀective porosity φef f
i.e. the porosity open to ﬂow [Eq. (12)], and the single-
phase permeability exhibiting a similar trend in the dis-
tribution of values computed on training images and syn-
thetic realizations.

We provide a comparison of all twenty realizations gen-
erated by the GAN model in cross-sections through the
x-y plane of the original model and a synthetic realization
in Fig. 9.

Many of the grains show a circular to ellipsoidal shape,
which considering the fact that a priori the GAN model
does not have any knowledge of the geometry of the
grains, learning a representation of a perfect sphere can
be considered challenging (see Sec. VI). The complex
grain-grain interface where individual beads contact at
single points can be observed for numerous grain arrange-
ments in the generated realizations.

9

FIG. 5. Radial averaged covariance S2(r) for the beadpack
sample and 20 synthetic realizations generated by the GAN
model.The speciﬁc surface area SV and mean chord lengths
lC are derived from the slope of the covariance at the origin
[see Equ. (5)-(6)].

FIG. 6.
A comparison of the numerical estimated single-
phase permeability of the beadpack for 1283 voxel subdomains
of the original image and equal sized GAN based realizations
shows an overestimation of the eﬀective porosity for the syn-
thetic models. The mean and variance of both permeability
distributions have been found to be in close agreement (see
Fig. 7).

10

TABLE II. Chord lengths lC for the pore and grain phase [Eq. (6)] determined from the radial averaged covariance S2(r) of
each training image and corresponding realizations generated by the GAN model. The speciﬁc surface area SV and porosity φ
were evaluated for each of the samples using direct image morphological computation and derived from the covariance. Close
agreement between estimates of the porosity and speciﬁc surface area can be observed for values determined by direct image
morphological estimation and derived values obtained from the radial averaged covariance.

pore
l
C
grain
l
C

[voxel]
[voxel]

Beadpack
20
36

Berea
10
41

Ketton
9
64

Training Image
Minkowski Functional S2(r) Direct
0.359
7.3

Porosity φ
1
voxel ]

Sv × 10−2 [

0.363
7.0

Synthetic

Training Image
S2(r) Direct S2(r) Direct
0.198
0.368
8.2
6.9

0.196
7.5

0.366
7.5

Synthetic

Training Image
S2(r) Direct S2(r) Direct
0.119
0.199
5.2
7.9

0.197
8.5

0.127
5.2

Synthetic
S2(r) Direct
0.119
0.119
5.2
4.7

FIG. 7. Comparison of three Minkowski functionals for the beadpack evaluated on 2003 voxel subdomains of the original
training image and realizations of the GAN model. An error of less than 5% can be observed for the porosity and surface area.

FIG. 8.
realizations. A clear hole eﬀect can be observed in the original dataset, clearly captured by the GAN model.

Comparison of the directional covariance of the beadpack and the average covariance of GAN based synthetic

11

FIG. 9. Twenty realizations of the spherical beadpack (top) generated to evaluate the statistical, image morphological and
transport properties considered in this study. Cross-sectional view of the beadpack training image dataset (bottom).

12

FIG. 10. Radial averaged covariance S2(r) for Berea sand-
stone training images and 20 synthetic realizations generated
by the GAN model.

B. Berea

The radial averaged covariance S2(r) in Fig. 10, shows
a near exponential decay and stabilisation occurs at a
lag distance of 30 voxels for both covariance functions
obtained from the Berea training image and synthetic
realizations generated by the GAN model.

Additionally, Fig. 12 shows that the directional two-
point statistics characterized by the directional covari-
ances is captured in the generated images. This is shown
by comparing the small hole eﬀect observed in the z-
direction of the Berea sample with the x-direction where
a near exponential decay can be observed. In both cases,
the GAN model shows excellent agreement and closely
follows the trend of the empirical estimates of S2.

The results of the direct computation of the Minkowski
functionals is presented in Fig. 13 and show comparable
distributions for the porosity φ, speciﬁc surface area SV
and the Euler characteristic χV of the training images
and the synthetic realizations.

A comparison of the speciﬁc surface area SV obtained
from the covariance and the direct computation of the
Minkowski functional, show nearly equal values (Ta-
ble II).

The obtained estimates of the single-phase permeabil-
ity show a similar distribution covering the range of eﬀec-
tive permeability measured on the training images. Fig-
ure 11 shows the computed values of permeability and the
corresponding eﬀective porosity. The permeability of the
synthetic realizations capture the values, variability and
trend obtained from the Berea training image dataset.

Figure 14 shows a comparison of twenty realizations of
the GAN model trained on the Berea dataset. A smaller
training image size of 643 voxels was used, as compared
to the beadpack (1283 voxels). This is due to the smaller
size of the structuring elements observed in the training
image. A smaller training image size was therefore suf-
ﬁcient to capture the long and short range correlation
found in the Berea sample.

FIG. 11. The distribution of numerically obtained perme-
ability values on 1283 voxel subdomains and sampled realiza-
tions obtained from a GAN model trained on the Berea sand-
stone dataset show close agreement in the eﬀective porosity,
as well as the evaluated permeability.

13

FIG. 12. Directional non-centered covariance comparison for Berea sandstone. The trained GAN model shows good agreement
with the non-centered covariance S2 of the training image.

FIG. 13. Comparison of three Minkowski functionals for Berea sandstone. The porosity, speciﬁc surface area and speciﬁc
Euler characteristic show good agreement between the training image and samples from the trained GAN model.

14

FIG. 14. Realizations generated by the GAN model (top) compared to training images (bottom) for Berea sandstone.

15

FIG. 15. Radial averaged covariance S2(r) for the oolitic
Ketton limestone training image and 20 synthetic realizations
generated by the GAN model.

C. Ketton

The covariance S2(r) of the Ketton limestone shown
in Fig. 15, shows a pronounced hole eﬀect due to the el-
lipsoidal oolitic grains. Due to the hole eﬀect observed
in the radial averaged covariance (Fig. 15), we relate the
Ketton sample to a hard-sphere model. Figure 17 in-
dicates that the images generated by the GAN model
trained on the Ketton image, capture the oscillatory and
anisotropic behavior of the covariance observed in Ket-
ton. The speciﬁc surface area SV derived from the gener-
ated images is in close agreement with the training data.
An error of approximately 1% was achieved in the poros-
ity of the GAN generated images compared to the origi-
nal Ketton dataset (Fig. 18).

The measured speciﬁc surface area of the synthetic im-
ages shows a higher variance compared to the original
training images. Nevertheless, the average values of the
porosity φ and speciﬁc surface area SV derived from the
non-centered covariance S2(r) [see Eq. (5)] are in good
agreement with values obtained from direct image mor-
phological estimation (see Table II).

The distribution of single-phase permeability estimates
of the synthetic GAN realizations overlies the permeabil-
ity values of the Ketton training images.

The Euler characteristic χV and the permeability of
the Ketton training dataset are closely matched by the
synthetic images and therefore capture the connectivity
observed in the oolitic Ketton limestone.

We present an overview of the 20 realizations gener-
ated by the GAN model trained on the Ketton dataset
in Fig. 19.

FIG. 16. Evaluated single-phase permeability for the Ket-
ton training image. The synthetic realizations show similar
eﬀective porosity and permeability as the Ketton sample.

16

FIG. 17. The directional covariance of the Ketton sample shows oscillating behavior in the x-direction, whereas a nearly
exponential decrease can be observed for the y and z directions. This anisotropy in S2(r) is also reﬂected in the covariance of
the samples obtained from the GAN model.

FIG. 18. Comparison of the Minkowski functionals for the Ketton training image. The three evaluated Minkowski functionals
show good agreement. The evaluated Euler characteristic indicates that the sampled synthetic realizations show a similar
degree of connectivity as the training image.

17

FIG. 19. Realizations generated by the GAN model (top) compared to training images (bottom) for Ketton limestone.

VI. DISCUSSION

This paper presents a novel method for

three-
dimensional stochastic image reconstruction based on
generative adversarial neural networks (GAN) trained on
three-dimensional segmented images. To summarize, the
objectives of this contribution are threefold. Firstly, the
generation of stochastic reconstructions of porous media
such as sedimentary rocks exceeding the size of the ac-
quired image datasets. Secondly, to evaluate the ability
of GAN models to capture the image morphological and
physical properties of micro-scale porous media. Thirdly,
to establish a method of stochastic image reconstruction
that allows a probabilistic treatment of pore-scale prop-
erties such as permeability without the need to acquire
numerous images of a single rock type.

The ﬁrst objective stems from technical limitations of
micro-CT data acquisition.
Images are acquired as a
trade-oﬀ between sample size i.e. how many represen-
tative structures can be captured in one image versus
the resolution at which these pore-scale structures are
resolved. The generation of large porous domains based
on high-resolution images enables this gap in scales to
be bridged and micro-scale features to be incorporated
in macro-scale models.

Our ﬁndings show that GANs can learn an implicit
representation of the image space given a limited num-
ber of training images subsampled from larger images.
These subdomains were extracted based on characteris-
tic length scales (see Sec. III A 1) and serve as a training
set for the GAN model. For the Ketton limestone, a small
spacing of the extracted subdomains was required to in-
crease the size of the training image dataset. While we
did not ﬁnd any evidence of an introduced bias by using
correlated subdomains, we believe that these extracted
training images should represent independent regions.

We have evaluated the ability to train GANs for a num-
ber of training image sizes less than and up to twice the
size of the structuring elements. We have found that
models trained on images smaller than the average grain
size results in artifacts and distorted shapes occurring in
the generated micro-structures. For the beadpack, the
size of an individual sphere is 50 voxels. A training im-
age of 643 voxels would typically only contain parts of
an individual grain and only capture the interaction of
the particles, but not the geometry of the structuring el-
ement. For the beadpack, models trained on 643 voxels
were successful in learning a representation of the short
scale micro-structure but failed to reproduce the long dis-
tance correlation. A larger training image of 1283 voxels,
as was used to model the beadpack has a much higher
chance to represent the full geometry of the particles and
therefore not only learn interactions, but also the shapes
of grains.

We, therefore, suggest that training images extracted
from large datasets must be larger than the average grain
size. For models that are well described by a Boolean
model, the size of the structuring element can be readily

18

estimated from stabilization of the covariance S2(r). For
more complex samples a diﬀerent measure must be used
to estimate the size of the required training image.

grain
C

The chord length is one additional measure that can be
obtained to characterize the grain space of porous media.
While we have found that the mean chord length of the
grain
grain space l
is always less than or equal to our cho-
C
sen training image size, l
increases with decreasing
porosity. This contradicts the need to have the largest
training domain for the beadpack sample which also has
the highest porosity. A better estimate may be related
to the representative elementary volume of the speciﬁc
surface area which by deﬁnition is the same for the grain
and pore space and is, therefore, more representative of
the morphology of the porous medium [53]. Based on the
properties we have evaluated we could not ﬁnd a measure
derived from two-point statistical or image morphological
properties that is closely related to the required training
image size and we see a theoretical discussion of this as
possible future work.

Conceptually the simplest model considered in this
study, the spherical beadpack, has proven to be the
most challenging as a training image for the GAN model
(Sec. V A). While we observe spherical and ellipsoidal
shapes in the resulting realizations (see Fig. 9), the
shape is exactly deﬁned by the spherical nature of the
grains. Any deviation from this shape, which for GANs,
is learned implicitly from the data itself, will lead to a
misrepresentation of the eﬀective properties. Random
hard-sphere models with spherical grains will eﬃciently
capture the nature of this dataset. Therefore we suggest
a ﬁt-for-purpose application of GANs, for training images
that exhibit variability of grain sizes and shapes, which
are not readily captured by a simpler model.

While for many sedimentary granular rocks represen-
tative volumetric images can be obtained, this may be
more challenging for carbonate samples with complex
pore-grain structures. The three training images consid-
ered in this study were all treated under the assumption
of stationarity i.e. we do not expect a variation in the
mean and variance of the averaged properties as a func-
tion of location. In theory, GANs are not limited to learn-
ing representations of stationary datasets. This is shown
by the many successful applications for two-dimensional
image and texture synthesis of non-stationary domains,
such as learned image representations of human faces [54]
or galaxies [55, 56]. Therefore a model that incorporates
non-stationarity for a single rock-type would technically
be possible in the GAN framework but would require the
acquisition of many images of the same porous medium.
A valid representation of the microscale variability and
connectivity of the pore space is critical to assess the
single and multi-phase ﬂow behavior of porous media.
Therefore any stochastic reconstruction method used in
the process of deriving or evaluating the variability of
micro-scale properties must capture the statistical and
image morphological characteristics of the reconstructed
porous medium. While we have shown that for the eval-

uated datasets, the GAN based image reconstructions
capture the variation and characteristics of these porous
media, a number of challenges arise in this task that are
fundamentally diﬀerent to classical stochastic methods of
image reconstruction.

For porous media, many ﬂow related properties can
be related to the porosity. Classical stochastic methods
are able to capture the porosity eﬃciently by deﬁning a
speciﬁc proportion of the grain and pore domain. The
GAN based model presented in this study initially has
no knowledge of the porosity. The porosity, therefore,
arises as a feature of the training image data. Matching
the porosity distribution of the training image dataset
was found to be the main challenge in training a GAN
model. An error of three percent in porosity would lead
to a mismatch in the permeability of the synthetic im-
ages. It is, therefore, necessary to continuously monitor
the derived properties such as the Minkowski functionals
or estimates of the permeability, in the course of training
the neural networks to ensure that synthetic realizations
created by the GAN model are able to capture the eﬀec-
tive properties of the micro-scale domains.

While this can be considered one of the main chal-
lenges in the application of GANs for synthetic image
reconstruction, learning an implicit representation of the
training data itself can be seen as a strength. Many clas-
sic stochastic methods rely on the formulation of an ob-
jective function that ensures that statistical properties
are captured in the generated realizations e.g. matching
S2(r) and the speciﬁc surface area SV of the stochastic re-
constructions to a desired precision. The GAN approach
does not require an explicit objective function a priori.
The objective function is encoded in the discriminator
and adapted in the course of training.

During adversarial training both the generator and dis-
criminator are continuously improved. The discrimina-
tor’s sole purpose is to be able to distinguish real training
data from generated synthetic data. On the other hand,
the generator tries to generate synthetic data that the
discriminator is not able to distinguish from the training
data. Due to the multi-scale representation of the convo-
lutional neural networks, these features must be learned
across the full range of length scales present in the train-
ing data, leading to a high-resolution image that cap-
tures small and large scale features of the image dataset.
A number of stacked GAN models can be trained on
e.g. low-resolution medical-CT data and high-resolution
micro-CT allowing incorporation of spatial information
across multiple length scales [33].

Once the GAN model has successfully learned to create
physically representative samples of the porous medium,
one possible application is to evaluate the variability in
the ﬂow properties by evaluating the properties of a large
number of samples. This not only requires a physically
valid representation of the porous medium but also re-
quires a method that allows fast image reconstruction.
In Sec. V we have shown that training was performed for
approximately 24 hours and may vary due to the need for

19

FIG. 20. Measured CPU time for generating synthetic real-
izations of Berea sandstone at increasing image size. 100 re-
alizations were computed at each image dimension and CPU
time averaged. Computational cost increases linearly with
the number of voxels in the generated image.

manual inspection of the generated samples in the train-
ing process. Figure 20 shows the CPU time required for
generation of images at increasing image size. The fully
convolutional nature of the GAN architecture allows very
large images, exceeding the size of the original sample to
be generated very eﬃciently and at low computational
cost and runtime.

While training requires considerable time and compu-
tational resources in the form of modern graphics pro-
cessors as well as optimized neural network frameworks,
image reconstruction requires little computational eﬀort
and scales linearly in the total number of voxels of the
generated images. This, therefore, enables the genera-
tion of ensembles of large domains based on volumetric
images acquired from 3D microscopy, that capture the
physical behavior of the porous medium. The learned
representation of the generator consists of the weights of
the convolutional ﬁlters learned in the training process
and can, therefore, be stored for future use once training
has ﬁnished.

VII. CONCLUSIONS

We have evaluated the application of generative adver-
sarial neural networks (GAN) for stochastic image recon-
struction of porous media based on previously acquired
images of sedimentary rocks. Three image datasets were
used as training images: a beadpack, a Berea sandstone,
and an oolitic Ketton limestone.

By evaluating two-point statistical measures,

image
morphological features and computing the single-phase
eﬀective permeability we have shown that the synthetic
images generated by the GAN model are able to cap-
ture the characteristic statistical and physical behavior
of these porous media.

While a large computational eﬀort is required to train
the GAN model, the generation of samples from the
learned representation is highly eﬃcient and learned
models are easily stored for future use.

Future work in the application of GANs to stochastic
image reconstruction of porous media will include im-
proving the quality of the image reconstruction by eval-
uating various generator-discriminator architectures, the
use of grayscale and multi-channel training images, as
well as the application of large multi-scale domains of

20

porous media to evaluate the ensemble behavior of single
and multi-phase ﬂow properties in porous media. Recent
advances in the understanding of GANs should lead to a
more stable and consistent training process [57, 58].

ACKNOWLEDGMENTS

O. Dubrule thanks Total for seconding him as a

Visiting Professor at Imperial College.

[1] M. J. Blunt, Multiphase Flow in Permeable Media:
A Pore-Scale Perspective (Cambridge University Press,
2017).

[2] R. Juanes, E. Spiteri, F. Orr, and M. Blunt, Water Re-
sources Research 42 (2006), 10.1029/2005WR004806.
[3] Q. Kang, P. C. Lichtner, H. S. Viswanathan, and A. I.
Abdel-Fattah, Transport in porous media 82, 197 (2010).
[4] P. Mostaghimi, M. J. Blunt, and B. Bijeljic, Mathemat-

vaux, and O. Besson, Mathematical Geosciences 43, 305
(2011).

[24] T. Huang, X. Li, T. Zhang, and D.-T. Lu, Computers &

Geosciences 57, 13 (2013).

[25] H. Okabe and M. J. Blunt, Physical Review E 70, 1

(2004).

[26] H. Okabe and M. J. Blunt, Journal of Petroleum Science

and Engineering 46, 121 (2005).

ical Geosciences 45, 103 (2013).

[27] H. Okabe and M. J. Blunt, Water Resources Research

[5] G. Matheron, Random sets and integral geometry, Wiley
series in probability and mathematical statistics: Proba-
bility and mathematical statistics (Wiley, 1975).

[6] J. Serra, Computer Graphics and Image Processing 12,

99 (1980).

[7] G. Matheron, Elements pour une Theorie des Milieux

Poreux (Masson, Paris, 1971).

[8] C. Arns, M. Knackstedt, and K. Mecke, Physical Review

[9] P. A. Rikvold and G. Stell, J. Chem. Phys. 82, 1014

E 80, 051303 (2009).

(1985).

[10] S. Torquato, Random heterogeneous materials: mi-
16

crostructure
(Springer Science & Business Media, 2013).

and macroscopic

properties, Vol.

[11] T. Bretheau and D. Jeulin, Revue de Physique Appliqu´ee

24, 861 (1989).

[12] D. Jeulin, Statistics and Computing 10, 121 (2000).
[13] C. Lin and M. H. Cohen, Journal of Applied Physics 53,

(1998).

[15] P.-E. Øren and S. Bakke, Journal of Petroleum Science

and Engineering 39, 177 (2003).

[16] M. J. Pyrcz and C. V. Deutsch, Geostatistical reservoir

modeling (Oxford University Press, 2014).

[17] J. Caers and T. Zhang, AAPG Memoir 80, 383 (2004).
[18] G. Mariethoz, P. Renard, and J. Straubhaar, Water Re-

[28] W. E. Smith, H. H. Barrett, and R. G. Paxman, Optics

43, 3 (2007).

Letters 8, 199 (1983).

[29] D. I. Svergun, Biophysical Journal 76, 2879 (1999).
[30] L. M. Pant, Stochastic Characterization and Reconstruc-
tion of Porous Media, Ph.D. thesis, University of Alberta
(2016).

[31] I. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu,
D. Warde-Farley, S. Ozair, A. Courville, and Y. Bengio,
in Advances in Neural Information Processing Systems
(2014) pp. 2672–2680.

[32] J. Wu, C. Zhang, T. Xue, W. T. Freeman, and J. B.
(2016), arXiv:1610.07584

Tenenbaum, ArXiv e-prints
[cs.CV].

[33] H. Zhang, T. Xu, H. Li, S. Zhang, X. Huang,
(2016),

and D. Metaxas, ArXiv e-prints

X. Wang,
arXiv:1612.03242 [cs.CV].
Goodfellow,

ArXiv

[34] I.

e-prints

(2016),

[35] T. Salimans, I. Goodfellow, W. Zaremba, V. Cheung,
A. Radford, and X. Chen, in Advances in Neural Infor-
mation Processing Systems (2016) pp. 2226–2234.
[36] C. Kaae Sønderby, J. Caballero, L. Theis, W. Shi,
and F. Husz´ar, ArXiv e-prints (2016), arXiv:1610.04490
[cs.CV].

[37] P. Debye, H. R. Anderson, and H. Brumberger, Journal

of Applied Physics 28, 679 (1957).

4152 (1982), http://dx.doi.org/10.1063/1.331238.

arXiv:1701.00160v3.

[14] C. L. Y. Yeong and S. Torquato, Phys. Rev. E 57, 495

sources Research 46, 11 (2010).

[38] S. Torquato and F. Lado, Journal of Physics A: Mathe-

[19] E. Meerschman, G. Pirot, G. Mariethoz, J. Straubhaar,
M. Van Meirvenne, and P. Renard, Computers & Geo-
sciences 52, 307 (2013).

[20] P. Tahmasebi, M. Sahimi, and J. Caers, Computers &

Geosciences 67, 75 (2014).

matical and General 18, 141 (1985).

[39] C. Scholz, F. Wirner, M. A. Klatt, D. Hirneise, G. E.
Schr¨oder-Turk, K. Mecke, and C. Bechinger, Physical
Review E 92, 043023 (2015).

[40] C. Lang, J. Ohser, and R. Hilfer, Journal of Microscopy

[21] A. Comunian, P. Renard, J. Straubhaar, and P. Bayer,

203, 303 (2001).

Journal of hydrology 405, 10 (2011).

[41] D. Legland, I. Arganda-Carreras, and P. Andrey, Bioin-

[22] G. Mariethoz and J. Caers, Multiple-point geostatistics:
stochastic modeling with training images (John Wiley &
Sons, 2014).

formatics 32, 3532 (2016).

put. Phys. 12, 620 (1998).

[42] H. G. Weller, G. Tabor, H. Jasak, and C. Fureby, Com-

[23] J. Straubhaar, P. Renard, G. Mariethoz, R. Froide-

[43] A. Radford, L. Metz, and S. Chintala, ArXiv e-prints

21

[44] S.

Ioﬀe and C. Szegedy, ArXiv e-prints

(2015),

(2015), arXiv:1511.06434.

arXiv:1502.03167 [cs.LG].

[45] V. Nair and G. E. Hinton, in Proceedings of the 27th
International Conference on Machine Learning (ICML-
10) (2010) pp. 807–814.

(1970).

[52] D. Emery, The Origin of Late Spar Cements in the
Lincolnshire Limestone, Jurassic of Central England:
145(4), Vol. 145 (Journal of the Geological Society, 1988)
pp. 621–633.

[53] J. Bear, Dynamics of ﬂuids in porous media (Courier

[46] A. L. Maas, A. Y. Hannun, and A. Y. Ng, in Proc. ICML,

Corporation, 2013).

Vol. 30 (2013).

arXiv:1412.6980.

[47] D. Kingma and J. Ba, ArXiv e-prints

(2014),

[48] N. Otsu, Automatica 11, 23 (1975).
[49] J. Finney, in Proceedings of the Royal Society of Lon-
don A: Mathematical, Physical and Engineering Sciences,
Vol. 319 (The Royal Society, 1970) pp. 479–493.

[50] J. F. Pepper, Geology of the Bedford Shale and Berea
Sandstone in the Appalachian Basin: A Study of the
Stratigraphy, Sedimentation and Paleogeography of Rocks
of Bedford and Berea Age in Ohio and Adjacent States,
Vol. 259 (US Government Printing Oﬃce, 1954).

[51] W. de Witt Jr, U.S. Geological Survey Bulletin 1294

[54] J. Gauthier, Class Project for Stanford CS231N: Convo-
lutional Neural Networks for Visual Recognition (2014).
[55] K. Schawinski, C. Zhang, H. Zhang, L. Fowler,
(2017),

and G. Krishnan Santhanam, ArXiv e-prints
arXiv:1702.00403 [astro-ph.IM].

[56] S. Ravanbakhsh, F. Lanusse, R. Mandelbaum, J. Schnei-
(2016),
and B. Poczos, ArXiv e-prints

der,
arXiv:1609.05796 [astro-ph.IM].

[57] X. Mao, Q. Li, H. Xie, R. Y. K. Lau, and Z. Wang,
ArXiv e-prints (2016), arXiv:1611.04076 [cs.CV].
[58] M. Arjovsky, S. Chintala, and L. Bottou, ArXiv e-prints

(2017), arXiv:1701.07875.

7
1
0
2
 
r
p
A
 
1
1
 
 
]

V
C
.
s
c
[
 
 
1
v
5
2
2
3
0
.
4
0
7
1
:
v
i
X
r
a

Reconstruction of three-dimensional porous media
using generative adversarial neural networks

Lukas Mosser,∗ Olivier Dubrule,† and Martin J. Blunt‡
Department of Earth Science and Engineering,
Imperial College London

(Dated: April 12, 2017)

To evaluate the variability of multi-phase ﬂow properties of porous media at the pore scale, it is
necessary to acquire a number of representative samples of the void-solid structure. While modern
x-ray computer tomography has made it possible to extract three-dimensional images of the pore
space, assessment of the variability in the inherent material properties is often experimentally not
feasible. We present a novel method to reconstruct the solid-void structure of porous media by
applying a generative neural network that allows an implicit description of the probability distribu-
tion represented by three-dimensional image datasets. We show, by using an adversarial learning
approach for neural networks, that this method of unsupervised learning is able to generate repre-
sentative samples of porous media that honor their statistics. We successfully compare measures of
pore morphology, such as the Euler characteristic, two-point statistics and directional single-phase
permeability of synthetic realizations with the calculated properties of a bead pack, Berea sand-
stone, and Ketton limestone. Results show that GANs can be used to reconstruct high-resolution
three-dimensional images of porous media at diﬀerent scales that are representative of the morphol-
ogy of the images used to train the neural network. The fully convolutional nature of the trained
neural network allows the generation of large samples while maintaining computational eﬃciency.
Compared to classical stochastic methods of image reconstruction, the implicit representation of
the learned data distribution can be stored and reused to generate multiple realizations of the pore
structure very rapidly.

PACS numbers: 02.50.Ey, 07.05.Mh, 42.30.Wb, 83.80.Fg
Keywords: stochastic image reconstruction, porous media, artiﬁcial neural networks

I.

INTRODUCTION

A.

Image Reconstruction

The reconstruction and the evaluation of the material
properties of porous media plays a key role across many
engineering disciplines. Many physical processes such as
the movement of multiple phases of ﬂuids through sedi-
mentary rocks are controlled by individual pores at the
micron and sub-micron scale [1].

In carbon capture and sequestration (CCS), the long
term storage behavior is controlled by the physical and
chemical interaction of super-critical CO2 with the reser-
voir brine, as well as the spatial distribution and connec-
tivity of minerals in the pore-space [2, 3]. The variability
of the controlling properties such as the permeability of
the host rock is determined by repeated experiments or
numerical modeling of these processes.

Using modern computer tomographic methods, it is
possible to observe porous materials and evaluate their
material properties at the micrometer scale (micro-CT)
under static and transient conditions at high pressures
and temperatures in near real time. Performing micro-

∗ lukas.mosser15@imperial.ac.uk
† o.dubrule@imperial.ac.uk
‡ m.blunt@imperial.ac.uk

CT imaging of porous media requires specialized, expen-
sive equipment and in the case of CCS, only a single
image of the investigated rock type is typically acquired.
To evaluate the variability associated with the geomet-
rical and mineralogical morphology of the pore-space, nu-
merous physical experiments using the same rock type
would have to be performed to obtain a distribution over
larger volumes. Due to time and cost limitations inher-
ent with the experimental acquisition of high-resolution
images, this is often deemed unfeasible. Material prop-
erties governing the single and multi-phase ﬂow behavior
of porous media can be estimated from numerical so-
lution of partial diﬀerential equations at the scale of a
representative elementary volume (REV) and veriﬁed by
experimental results [4].

Many sedimentary rocks consist of granular siliciclas-
tic or carbonate materials. Boolean models use this fun-
damental characteristic of natural granular materials to
emulate the shape of the arising pore space, due to an
underlying random process that controls the distribution
of the individual grains [5, 6]. While for the classical
Boolean model, the centers of the grains are uniformly
distributed in space and grains can arbitrarily overlap,
more complicated models with rigid hard sphere grains
and more complex grain interaction functions have been
developed [7–10]. The framework of Boolean models also
allows extension beyond spherical particles and enables
derivation of the properties of material models as

a function of the parameters of the underlying random

process [11–14].

In sedimentary rocks, the arrangement of individual
grains occurs due to the transport of material from a
high energy source to a low energy sink. Process mod-
els, where depositional mechanisms are simulated, have
been shown to reproduce realistic granular reconstruc-
tions capturing the pore space morphology of granular
sedimentary rocks [15].

Spatial probabilistic models such as truncated Gaus-
sian processes or sequential indicator simulation have
been widely applied in the geosciences to model the spa-
tial distribution of materials [16]. Many of these methods
rely on two-point probability functions as a measure of
spatial variability, whereas recent methods in geostatis-
tics use training images as a basis for sample reconstruc-
tion [17–19]. These images are usually assumed to exhibit
stationarity of the probability distribution of the prop-
erties of interest and rely on higher order multiple point
statistics (MPS) to reconstruct stochastic random media.
With MPS, the probability distributions are repre-
sented by training images and are sampled using a limited
multi-scale neighborhood that captures the variation on
a large scale, as well as ﬁne structural details on smaller
scales [20]. MPS based methods have been used in two
and three-dimensional conditional simulation of spatial
properties in reservoir-scale earth modeling applications
[21]. The computational complexity of these methods
is highly dependent on individual algorithms as well as
the size of the domains used to sample from the training
images [22]. Parallelized versions have been developed,
reducing the computational time required to perform re-
construction using multiple point statistics [23, 24].

Three-dimensional porous media have been recon-
structed using a modiﬁed multiple-point statistics ap-
proach based on two-dimensional images of porous media
[25–27].

Stochastic methods based on simulated annealing al-
low the incorporation of arbitrary cost functions of sta-
tistical and morphological properties used in uncondi-
tional three-dimensional image reconstruction [28, 29].
Recent advances have reduced the computational run-
time of simulated annealing based methods for recon-
struction of porous media, to the order of tens of hours
per realization at the scale of 3003 voxels [30].

In the following section, we introduce a recently de-
veloped class of unsupervised machine learning methods
called generative adversarial networks (GAN) that al-
low simulation of probability distributions given a set
of training data [31]. Volumetric generative adversarial
networks have previously been applied to low-resolution
three-dimensional CAD model synthesis, and practical
applications of 3D-GANs are few compared to their
two-dimensional counterpart [32]. Integration of multi-
resolution datasets incorporating image data across a
number of length scales is possible in the GAN frame-
work by using a Laplacian pyramid approach such as
StackGAN [33].

2

We investigate the applicability of GANs to model
three-dimensional textures of rocks based on three-
dimensional binary representations of porous media ac-
quired at the micrometer scale. We compare statistical,
morphological and transport properties of the simulated
images with those of the training images. We evaluate
the single-phase directional permeability to show that the
synthetic realizations sampled from the learned represen-
tation of the input data can capture single-phase ﬂow
properties of sedimentary rocks.

Training of these neural networks involves ﬁnding a
set of hyperparameters that lead to stable training [34].
While this training can take on the order of tens of hours,
the sampling of large volumetric domains occurs on the
order of seconds on the current generation of graphical
processing units (GPU). We show that in favorable cases
convolutional neural networks incorporated in the GAN
framework allow the generation of synthetic reconstruc-
tions of porous media that exceed the dimensions of their
training images. Contrary to most existing simulation
techniques the set of parameters used to generate syn-
thetic realizations can be stored once trained allowing
rapid generation of new samples to assess the variability
of material properties.

While we apply GANs to a set of micro-CT images
of porous media, the method can readily be applied to
volumetric images of porous media obtained from other
three-dimensional microscopy instruments such as nano
or medical-CT instruments.

We discuss the challenges involved in training GANs
for stochastic image reconstruction of porous media, as
compared to other stochastic image reconstruction meth-
ods and evaluate the computational eﬃciency of GAN
based image reconstruction. Finally, we provide empir-
ical guidelines on the requirements of the input dataset
to allow successful training of GANs on large three-
dimensional voxel representations of natural porous me-
dia.

All data used in this study is available in the public
domain and we have made the code used for training,
as well as example pre-trained models, available as addi-
tional supporting material 1. A public dataset of high-
resolution micro-CT images made available by the Impe-
rial College Pore-Scale Modelling Group 2, of a spherical
beadpack, Berea sandstone, and oolitic Ketton limestone
will serve as benchmark cases to study the application of
GANs to three-dimensional stochastic image reconstruc-
tion.

1 https://github.com/LukasMosser/PorousMediaGan
2 http://www.imperial.ac.uk/earth-science/research/

research-groups/perm/research/pore-scale-modelling/
micro-ct-images-and-networks/

3

FIG. 1. Overview of the GAN training process. Segmented volumetric images are usually split into 643 voxel training images.
The generator G is a function that is applied to a sample from a latent random space Z and creates a synthetic realization.
We assume that samples drawn from the hidden latent space Z are distributed according to a normal distribution (see Sec. II).
The discriminator’s role is to determine whether a sample is part of the training image dataset (label 1) or from the generator
(label 0). The misclassiﬁcation error is computed as a binary cross-entropy criterion and the error back-propagated to improve
the discriminator’s ability to distinguish real and ”fake” images. Then the generator is updated to improve the quality of
the produced samples and ”fool” the discriminator. When suﬃcient image quality is obtained, training is stopped, and the
discriminator may be discarded. The generator can now be used to create new samples. By providing larger latent vectors
than used initially for training, larger output images can be produced.

II. GENERATIVE ADVERSARIAL NETWORKS

In the following section, we present generative ad-
versarial networks (GAN) in the context of three-
dimensional image generation. Generative neural net-
works have been developed in the context of deep learn-
ing by Goodfellow et al. as a methodology to learn a
representation of a high-dimensional probability distri-
bution from a given dataset [31]. In the context of image
reconstruction, we refer to this dataset as a set of training
images that present representative samples of the proba-
bility distribution underlying the image space.

GANs learn an implicit representation of the proba-
bility density as opposed to explicit density models. The
main drawback of explicit density models is their compu-
tational cost which grows with the dimensionality of the
samples and requires sequential simulation of each voxel.
For high-dimensional samples such as volumetric image
data, the computational cost is O(N ) where N repre-
sents the number of voxels in the domain of interest and
can easily exceed 109 voxels for modern high-resolution

micro-CT image data. Using any of these methods would
make it intractable to generate a large number of very
large samples. GANs have been designed to perform fast
sampling from the learned density representation and al-
low full parallel generation, making them an ideal candi-
date to generate large volumetric images [34].

GANs consist of two diﬀerentiable functions: a dis-
criminator D and a generator G. The discriminator re-
ceives samples of the ”real” dataset (Label 1) x ∼ pdata
and ”fake” samples G(z) (Label 0) created by the gener-
ator from the hidden latent space Z (see Fig. 1 above).
The latent space Z is composed of independent real
random variables, typically normally or uniformly dis-
tributed, that represent the random input to the genera-
tor G. The generator G maps random variables from the
latent space into the space of images. The discrimina-
tor’s role is to assign a probability that a random sam-
ple is from the ”real” data distribution pdata. The dis-
criminator tries to label each sample correctly, while the
generator tries to ”fool” the discriminator into labeling
the fake images as part of the true data distribution and

therefore achieving D(G(z)) close to one.

More formally we can deﬁne the loss i.e. the cost func-
tion for GANs as a minimization-maximization problem

image datasets. We treat all images under the assump-
tion of stationarity and the existence of a representative
elementary volume.

4

max
D

{Ex∼pdata(x)[log(D(x))]
min
G
+Ez∼pz(z)[log(1 − D(G(z)))]}
Solutions to this optimization problem have been
shown to be Nash equilibria, where each player achieves
a local minimum of their loss function with respect to
their parameters [34].

(1)

In practice we represent G and D by convolutional
neural networks that are trained by a gradient descent
based optimization method. Training is performed in
two steps: First the discriminator is trained to maximize
J (D) = Ex∼pdata(x)[log(D(x))]
+Ez∼pz(z)[log(1 − D(G(z)))]
while the parameters of the generator are ﬁxed. This
improves the ability of the discriminator to distinguish
between real and fake images.

(2)

In a subsequent step we generate synthetic samples
G(z) by drawing samples z from an N-dimensional nor-
mal distributed latent space and train the generator to
minimize

J (G) = Ez∼pz[log(1 − D(G(z)))]

(3)

while keeping the discriminator ﬁxed.

By minimizing Eq. (3) the generator tries to ”fool” the
discriminator into believing that the samples G(z) are
real data samples.
In this way the generator learns to
represent a distribution pg(x) that is as close as possible
to the real data distribution pdata(x). When convergence
is reached pg(x) = pdata(x) and the value of the discrim-
inator becomes 1
2 as it cannot distinguish between the
two anymore.

Initially, the discriminator D outperforms the gener-
ator signiﬁcantly making the gradient used to train the
generator close to zero. Therefore, instead of minimiz-
ing log(1 − D(G(z)) for the generator, it is helpful to
maximize log(D(G(z)) [34].

GANs show highly unstable behavior during training
and a large number of trial and error runs are required to
ﬁnd an optimal set of hyperparameters that allow stable
training. A number of heuristics have been published
which have been shown to stabilize GAN training, such
as one-sided label smoothing and adding white noise to
the input layer of the discriminator [35, 36].

We provide a more detailed overview of the neural
networks used in this study in Sec. III B and later pro-
vide suggestions on how to facilitate eﬃcient training (see
Sec. VI) for volumetric image datasets of porous media.

III. METHODOLOGY

In the following section we outline the criteria used to
evaluate the quality of simulations based on the training

A. Evaluation Criteria

1. Two-Point Statistics

We characterize the second order structure of the
porous media by calculating the two-point probability
function of the pore phase. By assuming stationarity,
this function is equivalent to the non-centered covariance
[7]:

S2(r) = P(x ∈ P, x + r ∈ P ) f or x, r ∈ Rd

(4)

which is the probability P that two points x and x + r,
separated by the lag vector r, are located in the pore
phase P . At the origin, S2(0) is equal to the porosity φ.
S2 stabilizes around φ2 as r → ∞ (Fig. 2). Due to the
anisotropic nature of many porous media, we compute
S2(r) along the three Cartesian directions, as well as the
radial average of S2(r).

FIG. 2. Comparison of S2(r) for a Boolean model and a
packing of hard spheres at a porosity φ = 0.5. S2 exhibits ex-
ponential decay for the Boolean model, whereas a dampened
oscillation is characteristic for packings of spheres. The mean
chord length can be found at the intersection of the slope of
S2 at the origin with the x-axis [see Eq. (6)].

It is a well known result that the speciﬁc surface area
SV of a porous medium can be expressed as a function of
S2 [37]. In the case of an isotropic porous medium and
in three-dimensions SV is related to S2 by

SV = −4S(cid:48)

2(0)

(5)

where S(cid:48)

2(0) is the derivative of S2(r) at the origin.
Furthermore, the average chord length within the pore

and the grain phases are [10]

pore
c =

l

grain
c

l

=

φ
S(cid:48)
2(0)
1 − φ
S(cid:48)
2(0)

(6a)

(6b)

which for the pore phase can be readily found from the
intersection of the slope of S2(r) with the x-axis.

In favorable cases, it is possible to ﬁnd analytical ex-
pressions of S2(r) from the spatial distribution and ge-
ometry of the grains. A Boolean model of overlapping
spherical grains of uniform spatial distribution exhibits
an exponential decay of the covariance until the lag dis-
tance is equal to the diameter of the grains where it be-
comes zero [7]. For porous media that can be well de-
scribed by a Boolean model, we can estimate the size of
the elementary Boolean grain from the decay of S2.

Semi-analytical expressions for more complex models
such as for a packing of hard spheres have been devel-
oped [38]. Models of S2(r) for spherical packings exhibit
a dampened oscillation. The shape of the estimated co-
variance, therefore, allows us to obtain information on
the structure of the porous medium (see Fig. 2 above).

The covariance S2(r) was estimated for the training
images and the stochastic reconstructions generated by
the trained GAN model. For each GAN model, we evalu-
ate the non-centered covariance S2 as well as the speciﬁc
surface area SV [Eq. (5)] and compare these to the values
obtained from the original training images.

In our discussion on the required training image sizes
(Sec. VI), we will use the average chord length and the
speciﬁc surface area as possible indicators of the neces-
sary training image size.

2. Morphological Measures

It has been shown that ﬂow properties at the pore-
scale can be related to morphological characteristics of
the void-solid interface of a porous medium [39]. Had-
wiger’s theorem states that the size of a body in a d-
dimensional space can be described by a linear combina-
tion of d + 1 independent parameters characterizing the
body. In three dimensions we can, therefore, deﬁne four
so-called Minkowski functionals that fully characterize
the size of a three-dimensional object. We compute esti-
mates of three Minkowski functionals; the porosity φ, the
speciﬁc surface area SV and the Euler characteristic χV
corresponding to the zero, ﬁrst and 3rd order functionals.

5

(7)

(8)

(9)

We compute the densities of the Minkowski functionals
by dividing by the volume V .

The Minkowski functional of order zero is the porosity,
deﬁned as the ratio of volume of the void space to the
bulk volume of the sample

and is, therefore, a measure of the ability of a porous
medium to store ﬂuids.

The Minkowski functional of rank one is the speciﬁc

surface area SV .

φ =

Vpore
V

SV =

dS

(cid:90)

1
V

where integration occurs over the void-solid interface S.
The speciﬁc surface area SV has dimensions of
length and
its inverse allows us to deﬁne a characteristic pore size.
The speciﬁc Euler characteristic is closely related to
the order three Minkowski functional and represents a
dimensionless quantity deﬁned as

1

χv =

(cid:90)

1
4πV

1
r1r2

dS

where r1 and r2 are the principal radii of curvature of the
void-solid interface. To compute χV we do not directly
evaluate the integral in Eq. (9) but instead make use
of a relationship for the Euler characteristic of arbitrary
polyhedra,

χ = V − E + F − O

(10)

where V is the number of vertices, E the number of
edges, F the number of faces and O the number of objects
[1]. This expression is the basis for eﬃcient algorithms
to compute Minkowski functionals of arbitrary geomet-
ric bodies represented as volumetric voxelized domains
[40]. To compute these three Minkowski functionals we
have used the open-source image morphological software
library MorphoLibJ [41].

While the porosity expresses the ability to store ﬂu-
ids in a porous medium, adsorption and dissolution pro-
cesses are controlled by the speciﬁc surface area. The
Euler characteristic allows the connectivity of the porous
medium to be characterized, which is a critical compo-
nent in the ability of ﬂuids to ﬂow. Reconstructions of
porous media should therefore closely match the observed
Minkowski functionals to represent the behavior of rele-
vant physical processes at the pore-scale.

The direct computation of the speciﬁc surface area
SV and porosity φ from images allows us to perform a
comparison with the values obtained from estimates ob-
tained by computing the empirical non-centered covari-
ance S2(r) [see Eq. (5)].

6

TABLE I. Neural network conﬁgurations and hyperparameters used to train on voxelized image subsets.

Training Image Size
Latent Space z Dimension
Generator Filters NG
Discriminator Filters ND
Optimizer
Learning Rate / Momentum
Stabilization

Beadpack
1283 voxels
100
64
8

Training Image Dataset
Berea
643 voxels
512
64
16
Generator + Discriminator: Adam
2 × 10−4 / 0.5
Label Smoothing ((cid:15) = 0.1)

2 × 10−4 / 0.5
White Noise (σ = 0.1)

2 × 10−4 / 0.5
White Noise (σ = 0.1)

Ketton
643 voxels
100
64
16

subsets of the Imagenet and CIFAR-10 datasets [43]. The
hyperparameters for the generator to be used in the opti-
mization of the neural network architecture are the num-
ber of trainable convolutional ﬁlters in each layer of the
neural network NG,F , ND,F and the size of the latent
vector z.

The generator and discriminator are optimized using a
gradient descent based method where the parameters w
are changed by taking k steps in the gradient

wk+1 = wk − α∇f (wk)

(13)

where α is the learning rate. We have used the gradient
descent based optimiser ADAM for optimization of both
the generator and discriminator [47].

GANs have been shown to exhibit unstable behavior
during training. The addition of Gaussian noise to the
input of the discriminator provides an eﬀective measure
to prevent mode collapse and stabilize the training pro-
cess [36]. An additional stabilization measure called one-
sided label smoothing, wherein the class label of 1 for
real images is replaced by a new value of 1 − (cid:15) has been
empirically shown to improve training of GANs [35].

Both label smoothing and white noise addition to the
input of the discriminator have been used in this study
to stabilize the training based on the volumetric image
datasets. Table I gives an overview of the neural network
hyperparameters used for each evaluated sample, the hy-
perparameters and the stabilization measure used during
training.

Images generated by the GAN were post-processed us-
ing a 33 median ﬁlter to remove single-pixel noise. The
resulting images are grayscale images with all voxel val-
ues close to zero or one. To compare the resulting images
to the binary training images, we segment the generated
images using Otsu’s method [48].

3. Single-Phase Permeability

To evaluate the single-phase permeability of the porous
media and their generated synthetic reconstructions we
solve the Stokes equations for slow, incompressible ﬂow
assuming small inertial forces.

The Stokes equations are solved on the domain that is
connected to the ﬂuid inlet and outlet. This allows us to
deﬁne an eﬀective porosity where only the fraction of the
pore space that also contributes to ﬂow is considered

∇ · v = 0
µ∇2v = ∇p

φef f =

Vf low
V

(11a)
(11b)

(12)

A ﬁnite diﬀerence method to solve Eq. (11a)-(11b) on
pore-space representations has been implemented as a
parallel ﬂow solver, in the free open source numerical
framework OpenFOAM [4, 42].

B. Neural Network Architecture

The neural network architecture used for the three-
dimensional image reconstruction corresponds to a vol-
umetric version of the DCGAN network [43]. The net-
work consists of two independent fully convolutional neu-
ral networks, the generator G and the discriminator D.
Upsampling from the input latent vector z is performed
by volumetric transposed convolution, followed by batch
normalization and a rectiﬁed linear unit (ReLU) activa-
tion function in all layers except the last [44, 45].

The discriminator D receives images sampled from the
latent space by the generator G(z) and images from the
set of training images representing pdata(x). Therefore,
the size of the input layer of the discriminator corre-
sponds to the dimensions of the input training images.
The discriminator consists of volumetric convolution lay-
ers combined with LeakyReLU activation functions [46].
The ﬁnal convolutional layer of the discriminator is fol-
lowed by a Tanh activation function.

This combination of generator and discriminator neu-
ral network architectures has previously been applied to

7

FIG. 3. Cross-sections of the three binary images that have been reconstructed. The bordered regions indicate the size of
the training images extracted from the full dataset. The beadpack consists of spheres of equal diameter (d = 50 voxels). The
Berea sandstone is an angular granular sandstone that shows traces of dispersed clay. The oolitic Ketton limestone consists of
ellipsoidal grains showing inter and intra-granular porosity. The voxel sizes are 3 µm for the bead pack as well as the Berea
sandstone and 15.2 µm for the Ketton sample.

IV. EXPERIMENTAL DATA

2. Berea

A.

Image Data and Processing

To evaluate the applicability of GANs for reconstruc-
tion of natural porous media we use three previously ac-
quired datasets. All images have been segmented into a
three-dimensional binary voxel representation of the pore
space (white) and grain structure (black) (Fig. 3). We
create a training database of images by extracting sub-
volumes from the voxelized binary images. Ideally, these
training images should represent independent domains,
but due to the limited size of these images, we extract
subsets that overlap.

Training image sizes were chosen based on an estimate
of the average grain size for each sample. To be able
to match the covariance S2(r) [Eq. (4)] and image mor-
phological characteristics, training images larger than the
structuring element were necessary. We discuss this re-
quirement in more detail in the discussion of our results
(see Section VI). Due to computational limitations, train-
ing image sizes exceeding 1283 voxels were not consid-
ered.

1. Beadpack

The beadpack is based on a real packing of equally
sized ceramic grains in a disordered close packing [49].
The image consists of 5003 voxels with a size of 3 µm.
The size of an individual sphere is 50 voxels. 1727 train-
ing images were extracted of size 1283 voxels correspond-
ing to a spacing of 32 voxels between them in the original
image.

Berea sandstone is a ﬂuvial sandstone of medium to
ﬁne grain size (Wentworth classiﬁcation) [50]. The indi-
vidual grains are bonded by clays. The sample analyzed
in this study was acquired from an outcropping of the
Berea sandstone in a quarry near Berea, Ohio. De Witt
showed that the Berea sandstone was deposited in the
early Carboniferous (354-323 Mya) [51].

The image of Berea sandstone consists of angular
grains with no clay presence in the intergranular pore-
space. The image has dimensions of 4003 voxels with a
voxel size of 3 µm.

To capture the local interaction of grains we have ex-
tracted training images at 643 voxels which allows a num-
ber of grains to be present in one training image (see
Sec. VI). Due to the small image size of 4003 voxels, sub-
volumes were extracted at a spacing of 16 voxels.
In
all, 10647 training images were used for the image recon-
struction.

3. Ketton

The Ketton sample is an oolitic limestone of Juras-
sic age (201.3-145 Mya). The sample was acquired from
a quarry of Lincolnshire limestone in the North-East of
England. The oolites contained in the Lincolnshire for-
mation are mainly non-ferroan calcite grains. The oolitic
limestones of the Lincolnshire show a wide variety of ce-
mentation, ranging from uncemented oolite sands with
no intergranular cement to heavily ferroan spar-cemented
oolites with inﬁlled microporosity [52]. Microstructures
in the pore space can be observed that lead to a reduction
in porosity (Fig. 3).

8

FIG. 4. Value of the cost function i.e. loss of the discriminator and generator [Eq. (2)-(3)] for the GAN trained on the Berea
sandstone. The samples shown were computed with the same random number seed, showing the evolution of a single realization
during training. Initially, image quality is very low and random noise can be observed. After 2000 generator iterations a drop
in the generator loss function is observed and coarse structures can be identiﬁed in the resulting sample. Loss functions in
GAN models do not reﬂect improvement in image quality which can be observed from samples. Learning rates [see Eq. (13)]
were reduced after suﬃcient image quality was reached and training stopped based manual inspection of Minkowski functionals
and two-point statistics.

The Ketton sample chosen for this study consists of
large grains compared to the overall image size. The im-
age used for the following evaluation has been downsam-
pled from a 5003 voxel representation to an image size
of 2563 voxels. This allows more grains to be resolved
per training image extracted from the full volume. The
downsampled voxel size is 15.2 µm.

Training images were extracted at a sub-volume size of
643 with a spacing of 8 voxels leading to a total of 15624
training images. The small spacing of the training images
results from the small CT image size of 2563 voxels.

V. RESULTS

Three GANs were trained based on the network archi-
tectures highlighted in Sec. III B. The training time for
each dataset was 24 hours. Manual inspection of syn-
thetic realizations was performed during training to en-
sure convergence and intermediate evaluation of the co-
variance and Minkowski functionals.

Figure 4 shows the training curve for the Berea sand-
stone dataset. Initially the generator loss function [see
Eq. (3)] is very high and no structural components can
be observed in the samples. After a large reduction in
the loss function of the generator, initial structures are

observed. Image reconstruction quality signiﬁcantly im-
proves with the number of generator iterations, but can-
not be linked to the loss function of the generator. This
can be observed from the increase in generator loss at the
end of training while image quality improves signiﬁcantly.
The ﬁnal GAN models were subsequently evaluated
in terms of their directional and radial averaged non-
centered covariance S2(r), Minkowski functionals and the
single-phase permeability.

For all datasets, 20 realizations were generated using
the trained GAN model.
In the following section, we
present the results of the evaluation of the properties
outlined in Sec. III A and compare these to the properties
of the original input training image.

A. Beadpack

The evaluation of the non-centered covariance S2(r) for
the beadpack (Fig. 5) shows a strong hole eﬀect reﬂecting
the spherical nature of the grains.

A GAN model was trained for 24 hours on the bead-
pack training image dataset. The GAN model achieves a
small error in the porosity of the generated images with
a tendency towards higher porosities (Fig. 7).

A bias can be observed for the speciﬁc surface area and
the Euler characteristic of the microstructure (Table II).
This bias can be explained by the deviation of the
grains from a perfect spherical shape in the synthetic
realizations. Due to the smooth nature of the spheri-
cal particles in the training image, any deviation from
this geometry will lead to an increase in the surface area.
This is reﬂected by a higher speciﬁc surface area for the
synthetic realizations.
In addition we observe a reduc-
tion in connectivity, represented by a less negative Euler
characteristic.

The directional covariance S2 measured on the gener-
ated samples show excellent agreement up to the training
image size of 1283 voxels and stabilizes at φ2 (see Fig. 8).
As expected no directional variation of the covariance
is observed and the sample is therefore assumed to be
isotropic.

Single-phase permeability shows a close agreement in
both magnitude and variance between the measured
training image and the synthetic realizations (Fig. 7).
Figure 6 shows a crossplot of the eﬀective porosity φef f
i.e. the porosity open to ﬂow [Eq. (12)], and the single-
phase permeability exhibiting a similar trend in the dis-
tribution of values computed on training images and syn-
thetic realizations.

We provide a comparison of all twenty realizations gen-
erated by the GAN model in cross-sections through the
x-y plane of the original model and a synthetic realization
in Fig. 9.

Many of the grains show a circular to ellipsoidal shape,
which considering the fact that a priori the GAN model
does not have any knowledge of the geometry of the
grains, learning a representation of a perfect sphere can
be considered challenging (see Sec. VI). The complex
grain-grain interface where individual beads contact at
single points can be observed for numerous grain arrange-
ments in the generated realizations.

9

FIG. 5. Radial averaged covariance S2(r) for the beadpack
sample and 20 synthetic realizations generated by the GAN
model.The speciﬁc surface area SV and mean chord lengths
lC are derived from the slope of the covariance at the origin
[see Equ. (5)-(6)].

FIG. 6.
A comparison of the numerical estimated single-
phase permeability of the beadpack for 1283 voxel subdomains
of the original image and equal sized GAN based realizations
shows an overestimation of the eﬀective porosity for the syn-
thetic models. The mean and variance of both permeability
distributions have been found to be in close agreement (see
Fig. 7).

10

TABLE II. Chord lengths lC for the pore and grain phase [Eq. (6)] determined from the radial averaged covariance S2(r) of
each training image and corresponding realizations generated by the GAN model. The speciﬁc surface area SV and porosity φ
were evaluated for each of the samples using direct image morphological computation and derived from the covariance. Close
agreement between estimates of the porosity and speciﬁc surface area can be observed for values determined by direct image
morphological estimation and derived values obtained from the radial averaged covariance.

pore
l
C
grain
l
C

[voxel]
[voxel]

Beadpack
20
36

Berea
10
41

Ketton
9
64

Training Image
Minkowski Functional S2(r) Direct
0.359
7.3

Porosity φ
1
voxel ]

Sv × 10−2 [

0.363
7.0

Synthetic

Training Image
S2(r) Direct S2(r) Direct
0.198
0.368
8.2
6.9

0.196
7.5

0.366
7.5

Synthetic

Training Image
S2(r) Direct S2(r) Direct
0.119
0.199
5.2
7.9

0.197
8.5

0.127
5.2

Synthetic
S2(r) Direct
0.119
0.119
5.2
4.7

FIG. 7. Comparison of three Minkowski functionals for the beadpack evaluated on 2003 voxel subdomains of the original
training image and realizations of the GAN model. An error of less than 5% can be observed for the porosity and surface area.

FIG. 8.
realizations. A clear hole eﬀect can be observed in the original dataset, clearly captured by the GAN model.

Comparison of the directional covariance of the beadpack and the average covariance of GAN based synthetic

11

FIG. 9. Twenty realizations of the spherical beadpack (top) generated to evaluate the statistical, image morphological and
transport properties considered in this study. Cross-sectional view of the beadpack training image dataset (bottom).

12

FIG. 10. Radial averaged covariance S2(r) for Berea sand-
stone training images and 20 synthetic realizations generated
by the GAN model.

B. Berea

The radial averaged covariance S2(r) in Fig. 10, shows
a near exponential decay and stabilisation occurs at a
lag distance of 30 voxels for both covariance functions
obtained from the Berea training image and synthetic
realizations generated by the GAN model.

Additionally, Fig. 12 shows that the directional two-
point statistics characterized by the directional covari-
ances is captured in the generated images. This is shown
by comparing the small hole eﬀect observed in the z-
direction of the Berea sample with the x-direction where
a near exponential decay can be observed. In both cases,
the GAN model shows excellent agreement and closely
follows the trend of the empirical estimates of S2.

The results of the direct computation of the Minkowski
functionals is presented in Fig. 13 and show comparable
distributions for the porosity φ, speciﬁc surface area SV
and the Euler characteristic χV of the training images
and the synthetic realizations.

A comparison of the speciﬁc surface area SV obtained
from the covariance and the direct computation of the
Minkowski functional, show nearly equal values (Ta-
ble II).

The obtained estimates of the single-phase permeabil-
ity show a similar distribution covering the range of eﬀec-
tive permeability measured on the training images. Fig-
ure 11 shows the computed values of permeability and the
corresponding eﬀective porosity. The permeability of the
synthetic realizations capture the values, variability and
trend obtained from the Berea training image dataset.

Figure 14 shows a comparison of twenty realizations of
the GAN model trained on the Berea dataset. A smaller
training image size of 643 voxels was used, as compared
to the beadpack (1283 voxels). This is due to the smaller
size of the structuring elements observed in the training
image. A smaller training image size was therefore suf-
ﬁcient to capture the long and short range correlation
found in the Berea sample.

FIG. 11. The distribution of numerically obtained perme-
ability values on 1283 voxel subdomains and sampled realiza-
tions obtained from a GAN model trained on the Berea sand-
stone dataset show close agreement in the eﬀective porosity,
as well as the evaluated permeability.

13

FIG. 12. Directional non-centered covariance comparison for Berea sandstone. The trained GAN model shows good agreement
with the non-centered covariance S2 of the training image.

FIG. 13. Comparison of three Minkowski functionals for Berea sandstone. The porosity, speciﬁc surface area and speciﬁc
Euler characteristic show good agreement between the training image and samples from the trained GAN model.

14

FIG. 14. Realizations generated by the GAN model (top) compared to training images (bottom) for Berea sandstone.

15

FIG. 15. Radial averaged covariance S2(r) for the oolitic
Ketton limestone training image and 20 synthetic realizations
generated by the GAN model.

C. Ketton

The covariance S2(r) of the Ketton limestone shown
in Fig. 15, shows a pronounced hole eﬀect due to the el-
lipsoidal oolitic grains. Due to the hole eﬀect observed
in the radial averaged covariance (Fig. 15), we relate the
Ketton sample to a hard-sphere model. Figure 17 in-
dicates that the images generated by the GAN model
trained on the Ketton image, capture the oscillatory and
anisotropic behavior of the covariance observed in Ket-
ton. The speciﬁc surface area SV derived from the gener-
ated images is in close agreement with the training data.
An error of approximately 1% was achieved in the poros-
ity of the GAN generated images compared to the origi-
nal Ketton dataset (Fig. 18).

The measured speciﬁc surface area of the synthetic im-
ages shows a higher variance compared to the original
training images. Nevertheless, the average values of the
porosity φ and speciﬁc surface area SV derived from the
non-centered covariance S2(r) [see Eq. (5)] are in good
agreement with values obtained from direct image mor-
phological estimation (see Table II).

The distribution of single-phase permeability estimates
of the synthetic GAN realizations overlies the permeabil-
ity values of the Ketton training images.

The Euler characteristic χV and the permeability of
the Ketton training dataset are closely matched by the
synthetic images and therefore capture the connectivity
observed in the oolitic Ketton limestone.

We present an overview of the 20 realizations gener-
ated by the GAN model trained on the Ketton dataset
in Fig. 19.

FIG. 16. Evaluated single-phase permeability for the Ket-
ton training image. The synthetic realizations show similar
eﬀective porosity and permeability as the Ketton sample.

16

FIG. 17. The directional covariance of the Ketton sample shows oscillating behavior in the x-direction, whereas a nearly
exponential decrease can be observed for the y and z directions. This anisotropy in S2(r) is also reﬂected in the covariance of
the samples obtained from the GAN model.

FIG. 18. Comparison of the Minkowski functionals for the Ketton training image. The three evaluated Minkowski functionals
show good agreement. The evaluated Euler characteristic indicates that the sampled synthetic realizations show a similar
degree of connectivity as the training image.

17

FIG. 19. Realizations generated by the GAN model (top) compared to training images (bottom) for Ketton limestone.

VI. DISCUSSION

This paper presents a novel method for

three-
dimensional stochastic image reconstruction based on
generative adversarial neural networks (GAN) trained on
three-dimensional segmented images. To summarize, the
objectives of this contribution are threefold. Firstly, the
generation of stochastic reconstructions of porous media
such as sedimentary rocks exceeding the size of the ac-
quired image datasets. Secondly, to evaluate the ability
of GAN models to capture the image morphological and
physical properties of micro-scale porous media. Thirdly,
to establish a method of stochastic image reconstruction
that allows a probabilistic treatment of pore-scale prop-
erties such as permeability without the need to acquire
numerous images of a single rock type.

The ﬁrst objective stems from technical limitations of
micro-CT data acquisition.
Images are acquired as a
trade-oﬀ between sample size i.e. how many represen-
tative structures can be captured in one image versus
the resolution at which these pore-scale structures are
resolved. The generation of large porous domains based
on high-resolution images enables this gap in scales to
be bridged and micro-scale features to be incorporated
in macro-scale models.

Our ﬁndings show that GANs can learn an implicit
representation of the image space given a limited num-
ber of training images subsampled from larger images.
These subdomains were extracted based on characteris-
tic length scales (see Sec. III A 1) and serve as a training
set for the GAN model. For the Ketton limestone, a small
spacing of the extracted subdomains was required to in-
crease the size of the training image dataset. While we
did not ﬁnd any evidence of an introduced bias by using
correlated subdomains, we believe that these extracted
training images should represent independent regions.

We have evaluated the ability to train GANs for a num-
ber of training image sizes less than and up to twice the
size of the structuring elements. We have found that
models trained on images smaller than the average grain
size results in artifacts and distorted shapes occurring in
the generated micro-structures. For the beadpack, the
size of an individual sphere is 50 voxels. A training im-
age of 643 voxels would typically only contain parts of
an individual grain and only capture the interaction of
the particles, but not the geometry of the structuring el-
ement. For the beadpack, models trained on 643 voxels
were successful in learning a representation of the short
scale micro-structure but failed to reproduce the long dis-
tance correlation. A larger training image of 1283 voxels,
as was used to model the beadpack has a much higher
chance to represent the full geometry of the particles and
therefore not only learn interactions, but also the shapes
of grains.

We, therefore, suggest that training images extracted
from large datasets must be larger than the average grain
size. For models that are well described by a Boolean
model, the size of the structuring element can be readily

18

estimated from stabilization of the covariance S2(r). For
more complex samples a diﬀerent measure must be used
to estimate the size of the required training image.

grain
C

The chord length is one additional measure that can be
obtained to characterize the grain space of porous media.
While we have found that the mean chord length of the
grain
grain space l
is always less than or equal to our cho-
C
sen training image size, l
increases with decreasing
porosity. This contradicts the need to have the largest
training domain for the beadpack sample which also has
the highest porosity. A better estimate may be related
to the representative elementary volume of the speciﬁc
surface area which by deﬁnition is the same for the grain
and pore space and is, therefore, more representative of
the morphology of the porous medium [53]. Based on the
properties we have evaluated we could not ﬁnd a measure
derived from two-point statistical or image morphological
properties that is closely related to the required training
image size and we see a theoretical discussion of this as
possible future work.

Conceptually the simplest model considered in this
study, the spherical beadpack, has proven to be the
most challenging as a training image for the GAN model
(Sec. V A). While we observe spherical and ellipsoidal
shapes in the resulting realizations (see Fig. 9), the
shape is exactly deﬁned by the spherical nature of the
grains. Any deviation from this shape, which for GANs,
is learned implicitly from the data itself, will lead to a
misrepresentation of the eﬀective properties. Random
hard-sphere models with spherical grains will eﬃciently
capture the nature of this dataset. Therefore we suggest
a ﬁt-for-purpose application of GANs, for training images
that exhibit variability of grain sizes and shapes, which
are not readily captured by a simpler model.

While for many sedimentary granular rocks represen-
tative volumetric images can be obtained, this may be
more challenging for carbonate samples with complex
pore-grain structures. The three training images consid-
ered in this study were all treated under the assumption
of stationarity i.e. we do not expect a variation in the
mean and variance of the averaged properties as a func-
tion of location. In theory, GANs are not limited to learn-
ing representations of stationary datasets. This is shown
by the many successful applications for two-dimensional
image and texture synthesis of non-stationary domains,
such as learned image representations of human faces [54]
or galaxies [55, 56]. Therefore a model that incorporates
non-stationarity for a single rock-type would technically
be possible in the GAN framework but would require the
acquisition of many images of the same porous medium.
A valid representation of the microscale variability and
connectivity of the pore space is critical to assess the
single and multi-phase ﬂow behavior of porous media.
Therefore any stochastic reconstruction method used in
the process of deriving or evaluating the variability of
micro-scale properties must capture the statistical and
image morphological characteristics of the reconstructed
porous medium. While we have shown that for the eval-

uated datasets, the GAN based image reconstructions
capture the variation and characteristics of these porous
media, a number of challenges arise in this task that are
fundamentally diﬀerent to classical stochastic methods of
image reconstruction.

For porous media, many ﬂow related properties can
be related to the porosity. Classical stochastic methods
are able to capture the porosity eﬃciently by deﬁning a
speciﬁc proportion of the grain and pore domain. The
GAN based model presented in this study initially has
no knowledge of the porosity. The porosity, therefore,
arises as a feature of the training image data. Matching
the porosity distribution of the training image dataset
was found to be the main challenge in training a GAN
model. An error of three percent in porosity would lead
to a mismatch in the permeability of the synthetic im-
ages. It is, therefore, necessary to continuously monitor
the derived properties such as the Minkowski functionals
or estimates of the permeability, in the course of training
the neural networks to ensure that synthetic realizations
created by the GAN model are able to capture the eﬀec-
tive properties of the micro-scale domains.

While this can be considered one of the main chal-
lenges in the application of GANs for synthetic image
reconstruction, learning an implicit representation of the
training data itself can be seen as a strength. Many clas-
sic stochastic methods rely on the formulation of an ob-
jective function that ensures that statistical properties
are captured in the generated realizations e.g. matching
S2(r) and the speciﬁc surface area SV of the stochastic re-
constructions to a desired precision. The GAN approach
does not require an explicit objective function a priori.
The objective function is encoded in the discriminator
and adapted in the course of training.

During adversarial training both the generator and dis-
criminator are continuously improved. The discrimina-
tor’s sole purpose is to be able to distinguish real training
data from generated synthetic data. On the other hand,
the generator tries to generate synthetic data that the
discriminator is not able to distinguish from the training
data. Due to the multi-scale representation of the convo-
lutional neural networks, these features must be learned
across the full range of length scales present in the train-
ing data, leading to a high-resolution image that cap-
tures small and large scale features of the image dataset.
A number of stacked GAN models can be trained on
e.g. low-resolution medical-CT data and high-resolution
micro-CT allowing incorporation of spatial information
across multiple length scales [33].

Once the GAN model has successfully learned to create
physically representative samples of the porous medium,
one possible application is to evaluate the variability in
the ﬂow properties by evaluating the properties of a large
number of samples. This not only requires a physically
valid representation of the porous medium but also re-
quires a method that allows fast image reconstruction.
In Sec. V we have shown that training was performed for
approximately 24 hours and may vary due to the need for

19

FIG. 20. Measured CPU time for generating synthetic real-
izations of Berea sandstone at increasing image size. 100 re-
alizations were computed at each image dimension and CPU
time averaged. Computational cost increases linearly with
the number of voxels in the generated image.

manual inspection of the generated samples in the train-
ing process. Figure 20 shows the CPU time required for
generation of images at increasing image size. The fully
convolutional nature of the GAN architecture allows very
large images, exceeding the size of the original sample to
be generated very eﬃciently and at low computational
cost and runtime.

While training requires considerable time and compu-
tational resources in the form of modern graphics pro-
cessors as well as optimized neural network frameworks,
image reconstruction requires little computational eﬀort
and scales linearly in the total number of voxels of the
generated images. This, therefore, enables the genera-
tion of ensembles of large domains based on volumetric
images acquired from 3D microscopy, that capture the
physical behavior of the porous medium. The learned
representation of the generator consists of the weights of
the convolutional ﬁlters learned in the training process
and can, therefore, be stored for future use once training
has ﬁnished.

VII. CONCLUSIONS

We have evaluated the application of generative adver-
sarial neural networks (GAN) for stochastic image recon-
struction of porous media based on previously acquired
images of sedimentary rocks. Three image datasets were
used as training images: a beadpack, a Berea sandstone,
and an oolitic Ketton limestone.

By evaluating two-point statistical measures,

image
morphological features and computing the single-phase
eﬀective permeability we have shown that the synthetic
images generated by the GAN model are able to cap-
ture the characteristic statistical and physical behavior
of these porous media.

While a large computational eﬀort is required to train
the GAN model, the generation of samples from the
learned representation is highly eﬃcient and learned
models are easily stored for future use.

Future work in the application of GANs to stochastic
image reconstruction of porous media will include im-
proving the quality of the image reconstruction by eval-
uating various generator-discriminator architectures, the
use of grayscale and multi-channel training images, as
well as the application of large multi-scale domains of

20

porous media to evaluate the ensemble behavior of single
and multi-phase ﬂow properties in porous media. Recent
advances in the understanding of GANs should lead to a
more stable and consistent training process [57, 58].

ACKNOWLEDGMENTS

O. Dubrule thanks Total for seconding him as a

Visiting Professor at Imperial College.

[1] M. J. Blunt, Multiphase Flow in Permeable Media:
A Pore-Scale Perspective (Cambridge University Press,
2017).

[2] R. Juanes, E. Spiteri, F. Orr, and M. Blunt, Water Re-
sources Research 42 (2006), 10.1029/2005WR004806.
[3] Q. Kang, P. C. Lichtner, H. S. Viswanathan, and A. I.
Abdel-Fattah, Transport in porous media 82, 197 (2010).
[4] P. Mostaghimi, M. J. Blunt, and B. Bijeljic, Mathemat-

vaux, and O. Besson, Mathematical Geosciences 43, 305
(2011).

[24] T. Huang, X. Li, T. Zhang, and D.-T. Lu, Computers &

Geosciences 57, 13 (2013).

[25] H. Okabe and M. J. Blunt, Physical Review E 70, 1

(2004).

[26] H. Okabe and M. J. Blunt, Journal of Petroleum Science

and Engineering 46, 121 (2005).

ical Geosciences 45, 103 (2013).

[27] H. Okabe and M. J. Blunt, Water Resources Research

[5] G. Matheron, Random sets and integral geometry, Wiley
series in probability and mathematical statistics: Proba-
bility and mathematical statistics (Wiley, 1975).

[6] J. Serra, Computer Graphics and Image Processing 12,

99 (1980).

[7] G. Matheron, Elements pour une Theorie des Milieux

Poreux (Masson, Paris, 1971).

[8] C. Arns, M. Knackstedt, and K. Mecke, Physical Review

[9] P. A. Rikvold and G. Stell, J. Chem. Phys. 82, 1014

E 80, 051303 (2009).

(1985).

[10] S. Torquato, Random heterogeneous materials: mi-
16

crostructure
(Springer Science & Business Media, 2013).

and macroscopic

properties, Vol.

[11] T. Bretheau and D. Jeulin, Revue de Physique Appliqu´ee

24, 861 (1989).

[12] D. Jeulin, Statistics and Computing 10, 121 (2000).
[13] C. Lin and M. H. Cohen, Journal of Applied Physics 53,

(1998).

[15] P.-E. Øren and S. Bakke, Journal of Petroleum Science

and Engineering 39, 177 (2003).

[16] M. J. Pyrcz and C. V. Deutsch, Geostatistical reservoir

modeling (Oxford University Press, 2014).

[17] J. Caers and T. Zhang, AAPG Memoir 80, 383 (2004).
[18] G. Mariethoz, P. Renard, and J. Straubhaar, Water Re-

[28] W. E. Smith, H. H. Barrett, and R. G. Paxman, Optics

43, 3 (2007).

Letters 8, 199 (1983).

[29] D. I. Svergun, Biophysical Journal 76, 2879 (1999).
[30] L. M. Pant, Stochastic Characterization and Reconstruc-
tion of Porous Media, Ph.D. thesis, University of Alberta
(2016).

[31] I. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu,
D. Warde-Farley, S. Ozair, A. Courville, and Y. Bengio,
in Advances in Neural Information Processing Systems
(2014) pp. 2672–2680.

[32] J. Wu, C. Zhang, T. Xue, W. T. Freeman, and J. B.
(2016), arXiv:1610.07584

Tenenbaum, ArXiv e-prints
[cs.CV].

[33] H. Zhang, T. Xu, H. Li, S. Zhang, X. Huang,
(2016),

and D. Metaxas, ArXiv e-prints

X. Wang,
arXiv:1612.03242 [cs.CV].
Goodfellow,

ArXiv

[34] I.

e-prints

(2016),

[35] T. Salimans, I. Goodfellow, W. Zaremba, V. Cheung,
A. Radford, and X. Chen, in Advances in Neural Infor-
mation Processing Systems (2016) pp. 2226–2234.
[36] C. Kaae Sønderby, J. Caballero, L. Theis, W. Shi,
and F. Husz´ar, ArXiv e-prints (2016), arXiv:1610.04490
[cs.CV].

[37] P. Debye, H. R. Anderson, and H. Brumberger, Journal

of Applied Physics 28, 679 (1957).

4152 (1982), http://dx.doi.org/10.1063/1.331238.

arXiv:1701.00160v3.

[14] C. L. Y. Yeong and S. Torquato, Phys. Rev. E 57, 495

sources Research 46, 11 (2010).

[38] S. Torquato and F. Lado, Journal of Physics A: Mathe-

[19] E. Meerschman, G. Pirot, G. Mariethoz, J. Straubhaar,
M. Van Meirvenne, and P. Renard, Computers & Geo-
sciences 52, 307 (2013).

[20] P. Tahmasebi, M. Sahimi, and J. Caers, Computers &

Geosciences 67, 75 (2014).

matical and General 18, 141 (1985).

[39] C. Scholz, F. Wirner, M. A. Klatt, D. Hirneise, G. E.
Schr¨oder-Turk, K. Mecke, and C. Bechinger, Physical
Review E 92, 043023 (2015).

[40] C. Lang, J. Ohser, and R. Hilfer, Journal of Microscopy

[21] A. Comunian, P. Renard, J. Straubhaar, and P. Bayer,

203, 303 (2001).

Journal of hydrology 405, 10 (2011).

[41] D. Legland, I. Arganda-Carreras, and P. Andrey, Bioin-

[22] G. Mariethoz and J. Caers, Multiple-point geostatistics:
stochastic modeling with training images (John Wiley &
Sons, 2014).

formatics 32, 3532 (2016).

put. Phys. 12, 620 (1998).

[42] H. G. Weller, G. Tabor, H. Jasak, and C. Fureby, Com-

[23] J. Straubhaar, P. Renard, G. Mariethoz, R. Froide-

[43] A. Radford, L. Metz, and S. Chintala, ArXiv e-prints

21

[44] S.

Ioﬀe and C. Szegedy, ArXiv e-prints

(2015),

(2015), arXiv:1511.06434.

arXiv:1502.03167 [cs.LG].

[45] V. Nair and G. E. Hinton, in Proceedings of the 27th
International Conference on Machine Learning (ICML-
10) (2010) pp. 807–814.

(1970).

[52] D. Emery, The Origin of Late Spar Cements in the
Lincolnshire Limestone, Jurassic of Central England:
145(4), Vol. 145 (Journal of the Geological Society, 1988)
pp. 621–633.

[53] J. Bear, Dynamics of ﬂuids in porous media (Courier

[46] A. L. Maas, A. Y. Hannun, and A. Y. Ng, in Proc. ICML,

Corporation, 2013).

Vol. 30 (2013).

arXiv:1412.6980.

[47] D. Kingma and J. Ba, ArXiv e-prints

(2014),

[48] N. Otsu, Automatica 11, 23 (1975).
[49] J. Finney, in Proceedings of the Royal Society of Lon-
don A: Mathematical, Physical and Engineering Sciences,
Vol. 319 (The Royal Society, 1970) pp. 479–493.

[50] J. F. Pepper, Geology of the Bedford Shale and Berea
Sandstone in the Appalachian Basin: A Study of the
Stratigraphy, Sedimentation and Paleogeography of Rocks
of Bedford and Berea Age in Ohio and Adjacent States,
Vol. 259 (US Government Printing Oﬃce, 1954).

[51] W. de Witt Jr, U.S. Geological Survey Bulletin 1294

[54] J. Gauthier, Class Project for Stanford CS231N: Convo-
lutional Neural Networks for Visual Recognition (2014).
[55] K. Schawinski, C. Zhang, H. Zhang, L. Fowler,
(2017),

and G. Krishnan Santhanam, ArXiv e-prints
arXiv:1702.00403 [astro-ph.IM].

[56] S. Ravanbakhsh, F. Lanusse, R. Mandelbaum, J. Schnei-
(2016),
and B. Poczos, ArXiv e-prints

der,
arXiv:1609.05796 [astro-ph.IM].

[57] X. Mao, Q. Li, H. Xie, R. Y. K. Lau, and Z. Wang,
ArXiv e-prints (2016), arXiv:1611.04076 [cs.CV].
[58] M. Arjovsky, S. Chintala, and L. Bottou, ArXiv e-prints

(2017), arXiv:1701.07875.

