Adaptive Context Network for Scene Parsing

Jun Fu 1, 4
Yong Li 2 Yongjun Bao 2

Jing Liu∗ 1 Yuhang Wang 1

Jinhui Tang 3 Hanqing Lu 1

1National Laboratory of Pattern Recognition, Institute of Automation, Chinese Academy of Sciences
2Business Growth BU, JD.com 3 Nanjing University of Science and Technology
4 University of Chinese Academy of Sciences
{jun.fu,jliu,luhq}@nlpr.ia.ac.cn,wangyuhang.casia@gmail.com,
{liyong5,baoyongjun}@jd.com,jinhuitang@njust.edu.cn

9
1
0
2
 
v
o
N
 
5
 
 
]

V
C
.
s
c
[
 
 
1
v
4
6
6
1
0
.
1
1
9
1
:
v
i
X
r
a

Abstract

Recent works attempt to improve scene parsing perfor-
mance by exploring different levels of contexts, and typi-
cally train a well-designed convolutional network to exploit
useful contexts across all pixels equally. However, in this
paper, we ﬁnd that the context demands are varying from
different pixels or regions in each image. Based on this ob-
servation, we propose an Adaptive Context Network (AC-
Net) to capture the pixel-aware contexts by a competitive
fusion of global context and local context according to dif-
ferent per-pixel demands. Speciﬁcally, when given a pixel,
the global context demand is measured by the similarity be-
tween the global feature and its local feature, whose re-
verse value can be used to measure the local context de-
mand. We model the two demand measurements by the pro-
posed global context module and local context module, re-
spectively, to generate adaptive contextual features. Fur-
thermore, we import multiple such modules to build sev-
eral adaptive context blocks in different levels of network to
obtain a coarse-to-ﬁne result. Finally, comprehensive ex-
perimental evaluations demonstrate the effectiveness of the
proposed ACNet, and new state-of-the-arts performances
are achieved on all four public datasets, i.e. Cityscapes,
ADE20K, PASCAL Context, and COCO Stuff.

1. Introduction

Scene parsing is a fundamental image understanding task
which aims to perform per-pixel categorizations for a given
scene image. Most recent approaches for scene parsing are
based on Fully Convolutional Networks (FCNs) [24]. How-
ever, there are two limitations in FCN framworks. First, the

∗Corresponding Author

Figure 1. The performance improvements over the basic FCN (a.
Dilated FCN) on Cityscapes val set with the help of global context
(b. Dilated FCN+Global context) and local context (c. Dilated
FCN+Local context). Specially, pixel-wise enhanced representa-
tion by the global average pooling feature are employed as the
global context, and a concatenated representation with low-level
features as the local context.

consecutive subsampling operations like pooling and con-
volution striding lead to a signiﬁcant decrease of the ini-
tial image resolution and make the loss of spatial details for
scene parsing. Second, due to the limited receptive ﬁeld
[23, 25] or local context features, the per-pixel dense clas-
siﬁcation is often ambiguous. In the end, FCNs result in the
problems of rough object boundaries, ignorance of small
objects, and misclassiﬁcation of big objects and stuff.

Throughout various FCN-based improvements to over-
come the above limitations, effective strategies to utilize
different levels of contexts (i.e., local context and global
context) are the main directions. Speciﬁcally, some meth-
ods [22, 39, 34, 9] adopt “U-net” architectures, which ex-

ploit multi-scale local contexts from middle-layers, to com-
plement more visual details. Some methods [2, 35] em-
ploy dilated convolution layers to capture a wider context
with a larger receptive ﬁeld while maintaining the resolu-
tion. Besides, the image-level features obtained by global
average pooling [23, 3, 40] are proposed as a global context
to clarify local confusion. However, these FCN-based vari-
ants adopt per-pixel uniﬁed processing and overlook differ-
ent per-pixel demands on different levels of contexts. That
is, the local context from middle layers is essential for the
class prediction of those pixels on edges or small objects,
while the global context exploring the image-level represen-
tation is beneﬁt to categorize large objects or stuff regions,
especially for the case when the target region exceeds the
receptive ﬁeld of the network. We can also observe the
necessity of pixel-sensitive context modeling from the re-
sults comparison shown in Figure 1, in which the local and
global contexts achieve different improvements on differ-
ent objects or stuff. Therefore, how to effectively capture
such pixel- or region-aware contexts in an end-to-end train-
ing framework is an open but valuable research topic for
comprehensively accurate scene parsing.

In this paper, we propose an Adaptive Context Net-
work (ACNet) to capture the pixel-aware contexts for im-
age scene parsing. Different from previous methods which
fuse different-level contexts for each pixel equally, AC-
Net generates different per-pixel contexts, i.e., the context-
based features are functions of the input data and also vary
from different pixels. Such an adaptive context genera-
tion is achieved by a competitive fusion mechanism of the
global context from image-level feature and local context
from the middle-layer feature according to per-pixel differ-
ent demands. In other words, with the more attention paid
on global context for a certain pixel, the less attention is
paid on local context, and vice versa.

Usually, the global average pooled feature has a seman-
tic guidance for large objects and stuff, but it lacks spatial
information which makes it different from the features of
details. Hence, we can match the global pooled feature
with the feature of each pixel, obtaining the possibility of
the pixel to be an element of large objects or spatial details.
It can be further used as a pixel-aware context guidance to
adaptively fuse the global features (global context) and low-
level features (local context). Motivated by this intuition,
we propose a global context module to adaptively capture
global context. By measuring the similarity between the
global feature and per-pixel feature, we can obtain the pixel-
aware demanding extent, called as global gated coefﬁcient.
The larger gated coefﬁcient indicates that more global con-
text and the less local context could be fused to the pixel.
Then we multiply the global feature with the pixel-aware
global gated coefﬁcient before adding it to the pixel feature,
with which some mislabeling and inconsistent results can

be further corrected.

We also propose a local context module to compen-
sate spatial details according to the local context demands.
Speciﬁcally, we ﬁnd that the pixels with features dissimilar
to global feature, trend to be detail parts of images and need
more local context to obtain precise results. Hence, we re-
gard the reverse value of the global gated coefﬁcient as local
gated coefﬁcient and multiply it with the low-level feature
to generate a local gated feature. It emphasizes pixel-aware
local context to spatial details and avoids some noises to
the pixels belonging to big objects. Furthermore, we reuse
multiple local gated features, which is similar to a recurrent
learning process and complements more detail information.
We jointly employ a global context module and a local
context module as an adaptive context block, and import
such blocks into different levels of network. The architec-
ture of our proposed ACNet is shown in Figure 2. Finally,
comprehensive experimental analyses on Cityscapes dataset
[5], ADE20k[42], PASCAL Context [26], and COCO
stuff[1] dataset demonstrate the effectiveness of ACNet.
The main contributions of this paper are as follows:

• We propose an Adaptive Context Network (ACNet)
to improve contextual information fusion according to
the context demands of different pixels.

• A novel mechanism is proposed to measure global con-
text demand. Global pooled feature can be adaptively
fused to the pixels which need large context, thus re-
ducing misclassiﬁcation for large objects or stuff.

• We improve local context fusion according to the local
context demand and reuse local feature progressively,
thus improving segmentation results on small objects
and edges.

• ACNet achieves new state-of-the-art performance on
various scene parsing datasets. In particular, our AC-
Net achieves a Mean IoU score of 82.3% on Cityscapes
testing set without using coarse data, and 45.90% on
ADE20K validation set, respectively.

2. Related Work

Global context embedding. Global context embedding
have been proven its effectiveness to improve the catego-
rization of some large semantic regions. ParseNet [23] em-
ploys the global average pooled feature to augment the fea-
tures at each location. PSPNet [40] applies the global av-
erage pooling in their Spatial Pyramid Pooling module to
collect global context. The work [15] captures global con-
texts by a gloabl context network based on scene similar-
ities. BiSeNet [33] adds the global pooling on the top of
the encoder structure to capture the global context. EncNet
[37] employs an encoding layer to capture global context
and selectively highlight the class-dependent featuremaps.

Local context embedding. U-net based methods often
adopt local context from low- and middle-level visual fea-
tures to generate sharp boundaries or small details for high-
resolution prediction. ReﬁneNet [22] utilizes an encoder-
decoder framework and reﬁnes low-resolution segmenta-
tion with ﬁne-gained low-level feature. ExFuse [39] as-
signs auxiliary supervisions directly to the early stages
of the encoder network for improving low-level context.
Deeplabv3+ [4] adds a simple decoder module to capture
local context, reﬁning the segmentation results.
Attention and gating mechanisms. Attention mechanisms
have been widely used to improve the performance of seg-
mentation task. PAN [17] uses a global pooling to generate
global attention, which can select the channel maps effec-
tively. LRR [10] generates a multiplicative gating to reﬁne
segment boundaries reconstructed from lower-resolution
score maps. Ding et al.[7] proposes a scheme of RNN-based
gating mechanism to selectively aggregate multi-scale score
maps, which can achieve an optimal multi-scale aggrega-
tion. The works [16, 36, 14] adopt self-attention mechanism
to model the relationship of features.

Different from these works,we introduce a data-driven
gating mechanism to capture global context and local con-
text according to pixel-aware context demand.

3. Adaptive Context Network

3.1. Overview

Contextual information is effective for scene parsing
task, most of current methods fuse the different context to
each pixel equally, ignoring the different demands of pixel-
aware contexts.
In this work, we propose a novel Adap-
tive Context Network (ACNet) to weigh the global and local
context complemented to each pixel by a competitive fusion
mechanism.

The overall architecture is shown in Figure 2, which
adopts pretrained dilated ResNet [13], as the backbone net-
work, and multiple adaptive context blocks to progressively
generate high-resolution segmentation map.
In the back-
bone network, we remove the downsampling operations and
employ dilated convolutions in the last ResNet blocks, thus
obtaining dense feature with output size 1/16 of the input
image. It could achieve the balance between retaining spa-
tial details and computation cost [4]. In upsampling pro-
cess, three adaptive context blocks are employed with three
different resolutions. Each adaptive context block consists
of a global context module, an upsampling module and a lo-
cal context module, where the global context module selec-
tively captures global context from the high-level features
and the local context module selectively captures local con-
text from the low-level features.

In the following subsections, we will elaborate the de-
signing details of the global context module, the local con-

Figure 2. Overview of Adaptive Context Network. (Best viewed
in color)

text module and their aggregation within an adaptive con-
text block.

3.2. Global Context Module

Global context can provide global semantic guidance
for overall scene images, thus rectifying misclassiﬁcation
and inconsistent parsing results. However, the beneﬁt from
global context is different for large objects and spatial de-
tails. it is necessary to treat each pixel differently when ex-
ploring the global context, that is to say, some pixels need
more global context for categorization, while others may do
not. Based on the intuition that the global pooled feature
prefers to the large objects and stuff and lacks spatial infor-
mation, we can match the global feature with the feature in
each pixel, obtaining its possibility to be as an element of
large objects or spatial details. Then we can exploit it to
adaptively fuse the global context. To this end, we propose
a Global Context Module (GCM) as follows.

Given an input feature map A ∈ RC×H×W , we use
a global average pooling following a convolution layer to
generate a global feature p ∈ RC×1×1. In order to obtain
the pixel-aware demand for global context (global gated co-
efﬁcient), we ﬁrst measure the feature similarity by calcu-
lating the euclidean distance D ∈ RH×W between global
feature p and the features ai ∈ A for each pixel i, di ∈ D
is denoted as:

di = (cid:107)ai − p(cid:107)2
where ai ∈ A , i ∈ [1, 2, ..., H × W ] is ith location in A.
Noted that the smaller di indicates that the feature at ith
locations is closer to the global feature. Then we generate a
global gated coefﬁcient Wg ∈ RH×W which is smoothed
by an exponential function, wg

i ∈ Wg is denoted as:

(1)

wg

i = exp(−

di − k
δ

)

(2)

Figure 3. The details of Adaptive Context Block including (1) Global Context Module and (2) Local Context Module. (Best viewed in
color)

where k is set to minH×W
(di) for limiting the range of
wg
i ∈ (0, 1]. And δ is a hyperparameter, which controls
the amplitude of the difference between high response and
low response.

i=1

Finally, we multiply the global feature p by wg

i and a
scale parameter α, and then perform an element-wise sum
operation with the features A to obtain the ﬁnal output C ∈
RC×H×W , ci ∈ C is denoted as:

ci = αwg

i p + ai

(3)

where α is a learned factor and initialized as 1. Here, we
adopt sum operation instead of concatenation for saving
memory. The details of global context module is shown in
Figure.3 (1).

It can be inferred from the above formulation that the
feature C at different position obtain different global con-
text according to global gated coefﬁcient Wg.

With this design, GCM could selectively enhance seman-
tic consistency and reduce the misclassiﬁcation and incon-
sistent predictions for large objects or stuff.

3.3. Local Context Module

Local context contributes to reﬁne object boundaries and
details. However, many methods fuse local context to all
pixels without considering the different demand for local
context. To solve this problem, we propose a Local Context
Module (LCM) to selectively fuse local context for better
reﬁned segmentation.

As mentioned in Section 3.2, the global gated coefﬁcient
with high response indicates the pixels belong to large ob-
jects and stuff while low response indicates the pixels be-
long to spatial details. Based on this observation, we could
obtain the local gated coeffcient by reversing value of global
gated coefﬁcient, where the global gated coefﬁcient have

been upsampled, formulated as:

Wl = 1 − up(Wg)

(4)

where up(·) denotes a bilinear interpolation operation. In
this way, the local gated coefﬁcient indicates the more pos-
sibility the pixels belong to spatial details, the more lo-
cal contexts are required, and vice versa. Then we obtain
pixel-aware local context (gated local features) by multiply
the local feature B ∈ RC×H×W from middle-layer fea-
tures with the local gated coefﬁcient and a scale param-
eter β. Finally, we concat the feature with the upsam-
pled feature E ∈ RC×H×W to generate a reﬁned feature
F ∈ RC×H×W , fi ∈ F is denoted as:

fi = cat(βwl

ibi, ei)

(5)
where cat(·) denotes a concatenation operation, and β is a
learned factor and initialized as 1. We adopt concatenation
operation to combine the gated local feature and high-level
feature, and a convolution layer is employed to fuse them.
The details of local context module is shown in Figure.3(2).
With this design, we can selectively aggregate the local con-
text according to the context demand of each pixel.

In addition, we ﬁnd that it is useful to introduce gated
local context directly multiple times. Speciﬁcally, we reuse
gated local features by a concatenation operation followed
by a convolution layer for three times. Such a recur-
rent learning process complements more spatial details for
each position, and achieve a coarse-to-ﬁne performance im-
provement. Noted that, it haven’t been discussed in previ-
ous works [22, 39, 35, 4]. And we also verify the effective-
ness of this process in experiments.

3.4. Adaptive Context Block

Based on GCM and LCM, we further design an Adap-
tive Context Block to selectively capture global and local
contextual information simultaneously.

Adaptive context block is built upon a cascaded archi-
tecture, the high-layer features are ﬁrst fed into a global
context module to selectively fuse global context to each
pixel. Then passed sequentially through a bilinear upsam-
pling layer and a local context module for learning a restora-
tion of reﬁned features. In order to obtain resolution corre-
sponding to low-level feature, we also enlarge spatial res-
olution of the global gated coefﬁcient by a bilinear upsam-
pling operation before feeding into the local context mod-
ule. Following [4], we apply a convolution layer on the
low-level features to reduce the number of channels, thus
reﬁning the low-level features.

In the adaptive context block, we introduce a competi-
tive fusion mechanism to capture global and local context
according to their correlation of gated coefﬁcient, thus suit-
able context can be adaptively fused to each pixels for better
feature representation.

4. Experiments

The proposed method are evaluated on Cityscapes [5],
ADE20K [42], PASCAL Context [26], COCO Stuff [1].
Experimental results demonstrate that ACNet achieves new
state-of-the-art performance on these datasets. In the next
subsections, we ﬁrst introduce the datasets and implemen-
tation details, then we make detail comparisons to eval-
uate our approaches on Cityscapes dataset. Finally, we
present our results compared with state-of-the-art methods
on ADE20K, PASCAL Context, COCO Stuff dataset.

4.2. Implementation Details

We employ a dilated pretrained ResNet architecture as
our backbone network, where the dilated rates in the last
ResNet block is set to (2,2,2). Following [37, 40], we apply
a 3 × 3 convolution layer with BN, ReLU on the outputs
of the last ResNet block to reduce the number of channels
to 512 before feeding into the ﬁrst adaptive context block.
In addition, we adopt the outputs of ResNet block-1 and
ResNet block-2 as the low-level features, which provide lo-
cal context for the ﬁrst two adaptive context blocks. And we
only adopt a global context module in last adaptive context
block. In the ﬁrst two adaptive context block,we employ
a 3 × 3 convolution layer on the low-level featues before
feeding it into local context module. The other convolution
layers in the ﬁrst two adaptive context block are composed
of a 3 × 3 convolution operation with 448 and 256 kernels
respectively followed by BN and ReLU. Pytorch is used to
implement our method.

iter

During training phase, we employ a poly learning rate
policy where the initial learning rate is multiplied by (1 −
total iter )0.9 after each iteration, and enable synchronized
batch normalization [37]. The base learning rate is set
to 0.005 for Cityscapes and ADE20K, 0.001 for PASCAL
Context and COCO stuff. Momentum and weight decay
coefﬁcients are set to 0.9 and 0.0001 respectively. Follow-
ing [40], auxiliary loss is adopted when we adopt the bock-
bone ResNet101. In addition, we apply random cropping
and random left-right ﬂipping during training phase, and the
randomly scaling for data augmentation is not employed if
not mentioned on Cityscapes dataset.

4.1. Datasets

4.3. Results on Cityscape dataset

Cityscapes The dataset is a well-known road scene date-
set collected for scene parsing, which has 2,979 images for
training, 500 images for validation and 1,525 images for
testing. Each image has a high resolution of 2048 × 1024
pixels with 19 semantic classes. Noted that no coarse data
is employed in our experiments.
ADE20K The ADE20K dataset is a vary challenge scene
understanding dataset, which contains 150 classes (35 stuff
classes and 115 discrete object classes). The dataset is di-
vided into 20, 210/2, 000/3, 352 images for training, valida-
tion and testing.
PASCAL Context The dataset is widely used for scene
parsing, which contains 4,998 images for training and 5,105
images for testing. Following previous works [22, 37], we
evaluate the method on 60 categories ( 59 classes and one
background category ).
COCO Stuff The dataset has 171 categories including 80
objects and 91 stuff annotated to each pixel. Following pre-
vious works [7, 27, 22], we adopt 9,000 images for training
and 1,000 images for testing.

Global Context Module: Firts of all, we design a global
context module to adaptively aggregate global context ac-
cording to pixel-aware demands. Speciﬁcally, we follow
[2] and build two dilated networks (ResNet-50) which yield
the ﬁnal feature maps with the 1/8 and 1/16 size of the orig-
inal image. Next, the global context are added on the top
of the networks with two different settings, which are GC
and GCM respectively (GC denotes that we directly sum
the global features to each pixel equally, GCM represents
the global context module).

Experimental results are shown in Table. 1, we can see
that GCM (global context module) achieves better perfor-
mance than GC in both two settings, especially for the out-
put 1/8 size of the original image. It shows the effective-
ness of GCM and also indicates that the improvement will
be more obvious if the higher-resolution global gated coef-
ﬁcient is produced in GCM based on the dilated FCN. In
addition, we also provide a discussion about δ, which con-
trols the amplitude of the difference between high response
and low response of the global gated coefﬁcient (mentioned
in Sec.3.1). When we set δ to 5, the gloabl context module

Figure 4. Visualization results of global gated coefﬁcient from global context module with 1/16, 1/8 and 1/4 resolution respectively, we can
ﬁnd that the pixels with large global gated coefﬁcient perfer to dominant stuff and large objects. Compared with FCN, our method enhance
semantic guidance with global context in the regions with large coefﬁcient and provide more local context in other regions, thus obtaining
accurate segmentation results. (Best viewed in color)

Method
Outputsize

Res-50
Res-50+GC

Res-50+GCM ( δ = 2)
Res-50+GCM ( δ = 5)
Res-50+GCM ( δ = 10)

mIOU(%)
1/8

1/16

69.15
71.24

72.36
72.45
71.87

70.83
72.77

74.21
74.50
74.30

Table 1. Ablation experiments of Global Context Module on
Cityscapes validation set, δ denotes the amplitude of difference
distribution of the global gated coefﬁcient.

Method

mIOU(%)

Res-50
Res-50+GCM
Res-50+GCM+LC

Res-50+GCM+LCM(1)
Res-50+GCM+LCM(2)
Res-50+GCM+LCM(3)

69.15
72.45
73.48

74.03
74.56
74.67

Table 2. Ablation experiments of Local Context Module on
Cityscapes validation set, (n) denotes the n times of fusion of local
gated features in the LCM.

yields the best performance. We ﬁx this value and employ
the lowest resolution output 1/16 size of the original image
in following experiments.
Local Context Module: We also propose a local context
module to reﬁne spatial details. Since we need to generate
the local gated coefﬁcient for each pixel by inversing global
gated coefﬁcien, the local context module is built on the
global context module. Speciﬁcally, experiments are con-
ducted on a dilated ResNet-50 with a GCM, then we cas-
cade local features from the outputs of ResNet block-2 with
(LCM) and without (LC) local gated coefﬁcient .

Results are shown in Table 2, we can see that the local

Method

Res-50+ACB#1
Res-50+ACB#2
Res-50+ACB#3

Res-101+ACB#3
Res-101+ACB#3+MG
Res-101+ACB#3+MG+DA
Res-101+ACB#3+MG+DA+OHEM
Res-101+ACB#3+MG+DA+OHEM+MS

mIoU(%)

74.67
75.98
76.53

77.42
78.50
80.09
80.89
82.00

Table 3. Ablation experiments of Adaptive Context Block on
Cityscapes validation set, #n denotes the number of Adaptive Con-
text Block, MG denotes multi-grid dilated convolution, DA de-
notes data augmentation with multi-scale input during training
phase, MS denotes multi-scale testing.

context improves the performance from 72.45% to 73.48%.
When we adopt the local gated coefﬁcient to selectively fuse
local context for each pixel once, the performance is further
improved to 74.03%. Reusing local gated feature brings
continuous improvements of the performance from 74.03%
to 74.67%.
Adaptive Context Block: We further build an adaptive
context block and cascade it for three times to obtain high
resolution predictions. Results are listed in Table 3. When
we employ three adaptive context blocks (ACB#3), the per-
formance is improved to 76.53%, which veriﬁes the effec-
tiveness of our method.

In addition, we visualize the global gated coefﬁcients in
three adaptive context blocks with different resolutions as
shown in Figure 4. The images are from the validation set
of Cityscapes. We can ﬁnd that the pixels with large global
gated coefﬁcient perfer to dominant stuff and large objects,
such as the “road” in the ﬁrst row and “car” in the last two
rows. These stuff and objects are improved in our method.
In addition, the pixels with small global gated coefﬁcient
perfer to small objects and edges, such as the “trafﬁc sign”

Figure 5. Example results of ACNet on Cityscapes validation set. (Best viewed in color)

U
o
I
m

Methods

ReﬁneNet [22]
73.6
77.6
DUC [29]
ResNet-38 [30]
78.4
PSPNet [40]
78.4
BiSeNet [33]
78.9
80.1
PSANet [41]
DenseASPP [32] 80.6
81.4
CCNet [14]
81.5
DANet [16]
82.3
ACNet

d
a
o
r

98.2
98.5
98.5
-
-
-
98.7
-
98.6
98.7

k
l
a
w
e
d
i
s

83.3
85.5
85.7
-
-
-
87.1
-
86.1
87.1

g
n
i
d
l
i
u
b

91.3
92.8
93.1
-
-
-
93.4
-
93.5
93.9

l
l
a
w

47.8
58.6
55.5
-
-
-
60.7
-
56.1
61.6

e
c
n
e
f

50.4
55.5
59.1
-
-
-
62.7
-
63.3
61.8

t
h
g
i
l

c
ﬁ
f
a
r
t

-
-
-

-

e
l
o
p

-
-
-

-

56.1 66.9
65
73.5
67.1 74.8

65.6 74.6

69.7 77.3
71.4 78.7

n
g
i
s

c
ﬁ
f
a
r
t

71.3
77.9
78.7
-
-
-
78.5
-
81.3
81.7

n
o
i
t
a
t
e
g
e
v

92.3
93.3
93.7
-
-
-
93.6
-
93.9
94.0

n
i
a
r
r
e
t

70.3
72
72.6
-
-
-
72.5
-
72.9
73.3

y
k
s

94.8
95.2
95.5
-
-
-
95.4
-
95.7
96.0

n
o
s
r
e
p

80.9
84.8
86.6
-
-
-
86.2
-
87.3
88.5

r
e
d
i
r

r
a
c

63.3 94.5
68.5 95.4
69.2 95.7

-
-
-

-

-
-
-

-

71.9 96.0

72.9 96.2
74.9 96.5

k
c
u
r
t

64.6
70.9
64.5
-
-
-
78.0
-
76.8
77.1

s
u
b

76.1
78.8
78.8
-
-
-
90.3
-
89.4
89.0

n
i
a
r
t

64.3
68.7
74.1
-
-
-
80.7
-
86.5
89.2

e
l
c
y
c
r
o
t
o
m

e
l
c
y
c
i
b

70
62.2
65.9 73.8
76.7
69
-
-
-
-
-
-

69.7 76.8

-

-

72.2 78.2
71.4 79.0

Table 4. Category-wise comparison with state-of-the-art methods on Cityscapes testing set.

and “pole”,“person”, etc. These spatial details are also be
reﬁned in our results. A similar trend is also spotted in other
images.
Some improvement strategies: we follow the common
procedure of [3, 16, 12, 8, 6, 11] to further improve the
performance of ACNet: (1) A deeper and powerful net-
work ResNet-101. (2) MG: Different dilated rates (4,8,16)
in the last ResNet block. (3) DA: We transform the input
images with random scales (from 0.5 to 2.2) during train-
ing phase. (4) OHEM: The online hard example mining is
also adopted. (5) MS: we apply the multi-scale inputs with
scales {0.5 0.75, 1, 1.25, 1.5, 1.75, 2, 2.25} as well as their
mirrors for inference.

Experimental results are shown in Table 3, when em-
ploying a deeper backbone (ResNet101), ACNet obtains
77.42% in terms of mean IoU. Then multi-grid dilated
convolutional improves the performance by 1.08%. Data
augmentation with multi-scale input (DA) brings another
1.59% improvement. OHEM increases the performance to
80.89%. Finally, using multi-scale testing, we attains the
best performance of 82.00% on the validation set.
Compared with state-of-art methods: We also compare
our method with state-of-the-art methods on Cityscapes test
set. Speciﬁcally, we ﬁne tune our best model of ACNet
with only ﬁne annotated trainval data, and submit our test

results to the ofﬁcial evaluation server. For each method,
we report the accuracy for each class and the average class
accuracy, which are reported in the original paper. Results
are shown in Table. 4. We can see that our ACNet achieve
a new state-of-the-art performance of 82.3% % 1 on the
test set. With the same backbone ResNet-101, our model
outperforms DANet[16]. Moreover, ACNet also surpasses
DenseASPP [32] , which uses more powerful pretrained
models, and is heigher than Deeplabv3+ [4] (82.1%), which
uses extra the coarse annotations in training phase.

4.4. Results on ADE20K dataset

In this subsection, we conduct experiments on the
to validate the effectiveness of our
ADE20K dataset
method. Following previous works [14, 18, 37, 40, 41],
data augmentation with multi-scale input and multi-scale
testing are used. We evalute ACNet by pixel-wise accu-
racy (PixelAcc) and mean of class-wise intersection over
union (mIoU). Quantitative results are shown in Table.5.
With ResNet50, the dilated FCN obtains 37.32%/77.78% in
terms of mIoU and PixelAcc. When adopting our method,
the performance is improved by 5.69%/3.23%. When em-

1 https://www.cityscapes-dataset.com/anonymo
us-results/?id=205de9c8857dbbe1ab61e7f5cc08be5e
a290ece3c5125e3135d081139720d8f3

Backbone Method

Backbone Method

Res-50

Res-101

Dilated FCN
EncNet[37]
GCU[18]
PSPNet[40]
PASNet[41]
ACNet
UperNet[31]
PSPNet[40]
DSSPN[20]
PASNet[41]
SGR [19]
EncNet[37]
GCU[18]
ACNet

mIoU (%)
37.32
41.11
42.60
42.78
42.98
43.01
42.66
43.29
43.68
43.77
44.32
44.65
44.81
45.90

PixAcc%
77.78
79.73
79.51
80.76
80.92
81.01
81.01
81.39
81.13
81.51
81.43
81.19
81.19
81.96

Table 5. Results of semantic segmentation on ADE20K validation
set.

Method

Final score(%)

PSPNet269 (1st in place 2016)
PSANet-101[41]
CASIA IVA JD (1st in place 2017)
EncNet-101 [37]
ACNet-101

55.38
55.46
55.47
55.67
55.84

Table 6. Results of semantic segmentation on ADE20K testing set.

Backbone

Res-101

Res-152

Method
Ding et al.[7]
EncNet [37]
SGR [19]
DANet [16]
ACNet
ReﬁneNet [22]
MSCI[21]

mIoU (%)
51.6
51.7
52.5
52.6
54.1
47.3
50.3
52.5

Xception-71 Tian et al.[28]

Table 7. Segmentation results on PASCAL Context testing set.

ploying a deeper backbone ResNet101, ACNet achieves a
new state-of-the-art performance of 45.90%/81.96%, which
outperforms the previous state-of-the-art methods. In ad-
dition, we also ﬁne tune our best model of ACNet-101
with trainval data, and submit our test results on the test
set. The with single model of ACNet-101 gets ﬁnal score
as 55.84%. Among the approaches, most of methods
[40, 37, 18, 38, 41, 14] attemp to explore the global infor-
mation by aggregation variant and relationship of the fea-
ture on the the top of the backbones. While our method fo-
cuses on capturing the pixel-aware contexts from high and
low-level features and achieves better performance.

Res-101

ReﬁneNet [22]
Ding et al.[7]
DSSPN[20]
SGR [19]
DANet[16]
ACNet

mIoU(%)
33.6
35.7
38.9
39.1
39.7
40.1

Table 8. Segmentation results on COCO Stuff testing set.

4.5. Results on PASCAL Context Dataset

We also carry out experiments on the PASCAL Context
dataset to further demonstrate the effectiveness of ACNet.
We employ the ACNet-101 network with the same train-
ing strategy on ADE20K and compare our model with pre-
vious state-of-the-art methods. The results are reported in
Table 7. ACNet obtains a Mean IoU of 54.1%, which sur-
passes previous published methods. Among the approaches,
the recent methods[21, 28] use more powerful network(e.g.
ResNet-152 and Xception-71) as encoder network and fuse
high-and low-level feature in decoder network, our method
outperforms them by a relatively large margin.

4.6. Results on COCO stuff Dataset

Finally, we demonstrate the effectiveness of ACNet on
the COCO stuff dataset. The ACNet-101 network is also
employed. The COCO stuff results are reported in Table 8.
ACNet achieves performance of 40.1% Mean IoU, which
also outperforms other state-of-the-art methods.

5. Conclusion

In this paper, we present a novel network of ACNet to
capture pixel-aware adaptive contexts for scene parsing, in
which a global context module and a local context mod-
ule are carefully designed and jointly employed as an adap-
tive context block to obtain a competitive fusion of the both
contexts for each position. Our work is motivated by the
observation that the global context from high-level features
helps the categorization of some large semantic confused
regions, while the local context from lower-level visual fea-
tures helps to generate sharp boundaries or clear details.
Extensive experiments demonstrate the outstanding perfor-
mance of ACNet compared with other state-of-the-art meth-
ods. We believe such an adaptive context block can also be
extended to other vision applications including object de-
tection, pose estimation, and ﬁne-grained recognition.
Acknowledgement: This work was supported by Na-
tional Natural Science Foundation of China (61872366
and 61872364) and Beijing Natural Science Foundation
(4192059)

References

[1] Holger Caesar, Jasper Uijlings, and Vittorio Ferrari. Coco-
In Proceedings
stuff: Thing and stuff classes in context.
of the IEEE Conference on Computer Vision and Pattern
Recognition, pages 1209–1218, 2018. 2, 5

[2] Liang-Chieh Chen, George Papandreou, Iasonas Kokkinos,
Kevin Murphy, and Alan L. Yuille. Deeplab: Semantic im-
age segmentation with deep convolutional nets, atrous con-
IEEE Transactions on
volution, and fully connected crfs.
Pattern Analysis and Machine Intelligence., 40(4):834–848,
2018. 2, 5

[3] Liang-Chieh Chen, George Papandreou, Florian Schroff, and
Hartwig Adam. Rethinking atrous convolution for semantic
image segmentation. CoRR, abs/1706.05587, 2017. 2, 7
[4] Liang-Chieh Chen, Yukun Zhu, George Papandreou, Florian
Schroff, and Hartwig Adam. Encoder-decoder with atrous
separable convolution for semantic image segmentation. In
Proceedings of the European Conference on Computer Vi-
sion (ECCV), pages 801–818, 2018. 3, 4, 5, 7

[5] Marius Cordts, Mohamed Omran, Sebastian Ramos, Timo
Rehfeld, Markus Enzweiler, Rodrigo Benenson, Uwe
Franke, Stefan Roth, and Bernt Schiele. The cityscapes
In IEEE
dataset for semantic urban scene understanding.
Conference on Computer Vision and Pattern Recognition,
pages 3213–3223, 2016. 2, 5

[6] Henghui Ding, Xudong Jiang, Ai Qun Liu, Nadia Magnenat
Thalmann, and Gang Wang. Boundary-aware feature prop-
agation for scene segmentation. In Proceedings of the IEEE
International Conference on Computer Vision, 2019. 7
[7] Henghui Ding, Xudong Jiang, Bing Shuai, Ai Qun Liu, and
Gang Wang. Context contrasted feature and gated multi-
In Proceedings
scale aggregation for scene segmentation.
of the IEEE Conference on Computer Vision and Pattern
Recognition, pages 2393–2402, 2018. 3, 5, 8

[8] Henghui Ding, Xudong Jiang, Bing Shuai, Ai Qun Liu, and
Gang Wang. Semantic correlation promoted shape-variant
context for segmentation. In Proceedings of the IEEE Con-
ference on Computer Vision and Pattern Recognition, pages
8885–8894, 2019. 7

[9] Jun Fu, Jing Liu, Yuhang Wang, and Hanqing Lu. Stacked
deconvolutional network for semantic segmentation. arXiv
preprint arXiv:1708.04943, 2017. 1

[10] Golnaz Ghiasi and Charless C. Fowlkes. Laplacian pyramid
reconstruction and reﬁnement for semantic segmentation. In
the European Conference on Computer Vision, pages 519–
534, 2016. 3

[11] Junjun He, Zhongying Deng, and Yu Qiao. Dynamic multi-
scale ﬁlters for semantic segmentation. In Proceedings of the
International Conference on Computer Vision, 2019. 7
[12] Junjun He, Zhongying Deng, Lei Zhou, Yali Wang, and
Yu Qiao. Adaptive pyramid context network for seman-
In Proceedings of the IEEE Conference
tic segmentation.
on Computer Vision and Pattern Recognition, pages 7519–
7528, 2019. 7

ings of the IEEE conference on computer vision and pattern
recognition, pages 770–778, 2016. 3

[14] Zilong Huang, Xinggang Wang, Lichao Huang, Chang
Huang, Yunchao Wei, and Wenyu Liu. Ccnet: Criss-
cross attention for semantic segmentation. arXiv preprint
arXiv:1811.11721, 2018. 3, 7, 8

[15] Wei-Chih Hung, Yi-Hsuan Tsai, Xiaohui Shen, Zhe Lin,
Kalyan Sunkavalli, Xin Lu, and Ming-Hsuan Yang. Scene
In Proceedings
parsing with global context embedding.
of the IEEE International Conference on Computer Vision,
pages 2631–2639, 2017. 2

[16] Fu Jun, Liu Jing, Tian Haijie, Li Yong, Bao Yongjun, Fang
Zhiwei, and Lu Hanqing. Dual attention network for scene
In Proceedings of thr IEEE Conference on
segmentation.
Computer Vision and Pattern Recognition, 2019. 3, 7, 8
[17] Hanchao Li, Pengfei Xiong, Jie An, and Lingxue Wang.
Pyramid attention network for semantic segmentation. arXiv
preprint arXiv:1805.10180, 2018. 3

[18] Yin Li and Abhinav Gupta. Beyond grids: Learning graph
representations for visual recognition. In Advances in Neural
Information Processing Systems, pages 9245–9255, 2018. 7,
8

[19] Xiaodan Liang, Zhiting Hu, Hao Zhang, Liang Lin, and
Eric P Xing. Symbolic graph reasoning meets convolu-
In Advances in Neural Information Processing Sys-
tions.
tems, pages 1858–1868, 2018. 8

[20] Xiaodan Liang, Hongfei Zhou, and Eric Xing. Dynamic-
In Proceedings
structured semantic propagation network.
of the IEEE Conference on Computer Vision and Pattern
Recognition, pages 752–761, 2018. 8

[21] Di Lin, Yuanfeng Ji, Dani Lischinski, Daniel Cohen-Or, and
Hui Huang. Multi-scale context intertwining for semantic
In The European Conference on Computer
segmentation.
Vision (ECCV), September 2018. 8

[22] Guosheng Lin, Anton Milan, Chunhua Shen, and Ian D.
Reid. Reﬁnenet: Multi-path reﬁnement networks for high-
In IEEE Conference
resolution semantic segmentation.
on Computer Vision and Pattern Recognition, pages 5168–
5177, 2017. 1, 3, 4, 5, 7, 8

[23] Wei Liu, Andrew Rabinovich, and Alexander C. Berg.
Parsenet: Looking wider to see better. In the International
Conference on Learning Representations, 2016. 1, 2
[24] Jonathan Long, Evan Shelhamer, and Trevor Darrell. Fully
convolutional networks for semantic segmentation. In Pro-
ceedings of the IEEE conference on computer vision and pat-
tern recognition, pages 3431–3440, 2015. 1

[25] Wenjie Luo, Yujia Li, Raquel Urtasun, and Richard Zemel.
Understanding the effective receptive ﬁeld in deep convolu-
tional neural networks. In Advances in neural information
processing systems, pages 4898–4906, 2016. 1

[26] Roozbeh Mottaghi, Xianjie Chen, Xiaobai Liu, Nam-Gyu
Cho, Seong-Whan Lee, Sanja Fidler, Raquel Urtasun, and
Alan L. Yuille. The role of context for object detection and
In 2014 IEEE Confer-
semantic segmentation in the wild.
ence on Computer Vision and Pattern Recognition, pages
891–898, 2014. 2, 5

[13] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
Deep residual learning for image recognition. In Proceed-

[27] Bing Shuai, Zhen Zuo, Bing Wang, and Gang Wang. Scene
IEEE

segmentation with dag-recurrent neural networks.

spatial attention network for scene parsing. In Proceedings
of the European Conference on Computer Vision (ECCV),
pages 267–283, 2018. 7, 8

[42] Bolei Zhou, Hang Zhao, Xavier Puig, Sanja Fidler, Adela
Barriuso, and Antonio Torralba.
Scene parsing through
ADE20K dataset. In IEEE Conference on Computer Vision
and Pattern Recognition, pages 5122–5130, 2017. 2, 5

Trans. Pattern Anal. Mach. Intell., pages 1480–1493, 2018.
5

[28] Zhi Tian, Tong He, Chunhua Shen, and Youliang Yan. De-
coders matter for semantic segmentation: Data-dependent
In IEEE
decoding enables ﬂexible feature aggregation.
Conference on Computer Vision and Pattern Recognition
(CVPR’19), 2019. 8

[29] Panqu Wang, Pengfei Chen, Ye Yuan, Ding Liu, Zehua
Huang, Xiaodi Hou, and Garrison W. Cottrell. Understand-
In IEEE Win-
ing convolution for semantic segmentation.
ter Conference on Applications of Computer Vision, pages
1451–1460, 2018. 7

[30] Zifeng Wu, Chunhua Shen, and Anton van den Hengel.
Wider or deeper: Revisiting the resnet model for visual
recognition. arXiv preprint arXiv:1611.10080, 2016. 7
[31] Tete Xiao, Yingcheng Liu, Bolei Zhou, Yuning Jiang, and
Jian Sun. Uniﬁed perceptual parsing for scene understand-
In Proceedings of the European Conference on Com-
ing.
puter Vision (ECCV), pages 418–434, 2018. 8

[32] Maoke Yang, Kun Yu, Chi Zhang, Zhiwei Li, and Kuiyuan
Yang. Denseaspp for semantic segmentation in street scenes.
In Proceedings of the IEEE Conference on Computer Vision
and Pattern Recognition, pages 3684–3692, 2018. 7

[33] Changqian Yu, Jingbo Wang, Chao Peng, Changxin Gao,
Gang Yu, and Nong Sang. Bisenet: Bilateral segmenta-
In Pro-
tion network for real-time semantic segmentation.
ceedings of the European Conference on Computer Vision
(ECCV), pages 325–341, 2018. 2, 7

[34] Changqian Yu, Jingbo Wang, Chao Peng, Changxin Gao,
Gang Yu, and Nong Sang. Learning a discriminative feature
network for semantic segmentation. In CVPR, 2018. 1
[35] Fisher Yu and Vladlen Koltun. Multi-scale context aggrega-
tion by dilated convolutions. In the International Conference
on Learning Representations, 2016. 2, 4

[36] Yuhui Yuan and Jingdong Wang. Ocnet: Object context net-
work for scene parsing. arXiv preprint arXiv:1809.00916,
2018. 3

[37] Hang Zhang, Kristin Dana, Jianping Shi, Zhongyue Zhang,
Xiaogang Wang, Ambrish Tyagi, and Amit Agrawal. Con-
In The IEEE
text encoding for semantic segmentation.
Conference on Computer Vision and Pattern Recognition
(CVPR), 2018. 2, 5, 7, 8

[38] Rui Zhang, Sheng Tang, Yongdong Zhang, Jintao Li, and
Shuicheng Yan. Scale-adaptive convolutions for scene pars-
ing. In Proceedings of the IEEE International Conference on
Computer Vision, pages 2031–2039, 2017. 8

[39] Zhenli Zhang, Xiangyu Zhang, Chao Peng, Xiangyang Xue,
and Jian Sun. Exfuse: Enhancing feature fusion for semantic
segmentation.
In Vittorio Ferrari, Martial Hebert, Cristian
Sminchisescu, and Yair Weiss, editors, Computer Vision –
ECCV 2018, pages 273–288, 2018. 1, 3, 4

[40] Hengshuang Zhao, Jianping Shi, Xiaojuan Qi, Xiaogang
Wang, and Jiaya Jia. Pyramid scene parsing network.
In
IEEE Conference on Computer Vision and Pattern Recogni-
tion, pages 6230–6239, 2017. 2, 5, 7, 8

[41] Hengshuang Zhao, Yi Zhang, Shu Liu, Jianping Shi, Chen
Change Loy, Dahua Lin, and Jiaya Jia. Psanet: Point-wise

