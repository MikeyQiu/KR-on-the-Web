NIGHTTIME SKY/CLOUD IMAGE SEGMENTATION

Soumyabrata Dev,1 Florian M. Savoy,2 Yee Hui Lee,1 Stefan Winkler2

1 School of Electrical and Electronic Engineering, Nanyang Technological University (NTU), Singapore
2 Advanced Digital Sciences Center (ADSC), University of Illinois at Urbana-Champaign, Singapore

7
1
0
2
 
y
a
M
 
0
3
 
 
]

V
C
.
s
c
[
 
 
1
v
3
8
5
0
1
.
5
0
7
1
:
v
i
X
r
a

ABSTRACT

Imaging the atmosphere using ground-based sky cameras is
a popular approach to study various atmospheric phenom-
ena. However, it usually focuses on the daytime. Nighttime
sky/cloud images are darker and noisier, and thus harder to
analyze. An accurate segmentation of sky/cloud images is
already challenging because of the clouds’ non-rigid struc-
ture and size, and the lower and less stable illumination of
the night sky increases the difﬁculty. Nonetheless, nighttime
cloud imaging is essential in certain applications, such as con-
tinuous weather analysis and satellite communication.

In this paper, we propose a superpixel-based method to
segment nighttime sky/cloud images. We also release the ﬁrst
nighttime sky/cloud image segmentation database to the re-
search community. The experimental results show the efﬁ-
cacy of our proposed algorithm for nighttime images.

Index Terms— Superpixels, nighttime cloud segmenta-

tion, sky imagers, WAHRSIS, SWINSEG.

1. INTRODUCTION

Over the last few decades, there has been growing interest in
geoscience to study clouds and analyze their various features.
Satellite images are the conventional source for analyzing the
formation of clouds, their movement, and other atmospheric
properties. However, these images suffer from poor spatial
and/or temporal resolution. Therefore, remote sensing ana-
lysts increasingly turn to ground-based sky imagers [1] that
are able to produce images with signiﬁcantly higher spatial
resolution at much more frequent intervals. An accurate seg-
mentation of the cloud mass from these images is of prime
importance for any kind of cloud analysis.

Almost all existing works in sky/cloud image segmenta-
tion use color as the discriminatory feature to detect clouds
in ground-based sky camera images. This is because the sky
is predominantly blue during daytime owing to Rayleigh scat-
tering of light. However, this assumption no longer holds dur-
ing nighttime.

In the literature, most existing works consider only day-
time images. Several color models are used in cloud segmen-
tation [2–5]. Yang et al. (2009) used the Otsu threshold on
red-blue difference images [6]. Yang et al. (2010) employed
a local method [7] for cloud segmentation, which uses an
adaptive threshold on sub-images of the sky. Recently, Liu et
al. [8] used a superpixel approach and generated correspond-
ing thresholds for each superpixel to compute the ﬁnal binary
image. The local thresholds of these superpixels are empiri-
cally evaluated based on a set of case-based decisions, thereby
generating a matrix of thresholds.

Cloud segmentation in the nighttime sky is often ne-
glected. Yet, analyzing clouds at nighttime helps in several
areas viz. weather reporting and prediction, aviation, and
satellite communication. Only very recently, Gacal et al.
in [9] explored the nighttime cloud detection using ground-
based sky cameras. Their method uses a constant ﬁxed thresh-
old in the gray-scale channel of the cloud images, captured
over Manila region in the Philippines.

Addressing this gap in the literature, we propose an efﬁ-
cient nighttime cloud segmentation approach. In this paper,
we perform a careful selection of color spaces and compo-
nents, and thereby propose a superpixel-based approach to ef-
ﬁciently segment nighttime sky/cloud image. We also present
a new nighttime sky/cloud image segmentation database,
which we use for benchmarking our approach.

2. NIGHTTIME CLOUD SEGMENTATION

In this section, we present our detailed segmentation frame-
work for nighttime cloud segmentation.1 Our approach is il-
lustrated in Fig. 1. Using an input image as shown in Fig. 1(a),
we obtain a suitable color channel (in this example the red-
blue difference), shown in Fig. 1(b). We then perform an
over-segmentation of this image using a superpixel technique;
the over-segmented image is shown in Fig. 1(c). Thereafter,
we convert it into an indexed image as shown in Fig. 1(d) us-
ing a quantization procedure. Subsequently, we cluster these
superpixels into two clusters – cloud and sky. The resulting
binary segmented image is shown in Fig. 1(e).

This research is funded by the Defence Science and Technology Agency

(DSTA), Singapore.

1 The source code of all simulations in this paper is available online at

Send correspondence to stefan.winkler@adsc.com.sg.

https://github.com/Soumyabrata/nighttime-imaging.

(a)

(b)

(c)

(d)

(e)

Fig. 1: Proposed superpixel-based nighttime sky/cloud image segmentation approach. (a) Input image; (b) Red-blue difference
image; (c) Over-segmentation using superpixels; (d) Indexed image using average red-blue difference of the superpixels; (e)
Final sky/cloud segmentation result.

Unlike the conventional daytime sky/cloud image, night-
time images include several additional imaging challenges.
Figure 2 shows a sample day- and night-time image captured
by our high resolution sky camera. Unlike the clear blue
sky and white clouds seen during daytime, the night sky and
clouds appear more reddish. This is mainly because of in-
creasing light pollution in urban areas like Singapore. In a
cloudy night-sky, the longer wavelengths of the artiﬁcial light
are scattered back to the earth’s surface, providing a reddish
tinge to the night sky. More details on this phenomenon can
be found in a recent study [10]. Moreover, nighttime images
are more noisy and blurry in nature, with less distinctive fea-
tures, owing to the higher exposure time and lower f-numbers
of the camera lens.

c1 R c4 H c7 Y c10 L∗
c11 a∗
c2 G c5 S
b∗
c3 B c6 V c9 Q c12

c8

I

c13 R/B
c14 R − B
B−R
c15
B+R

c16 C

Table 1: Color spaces and components used in our analysis
of nighttime images.

color channels, and chroma (C). We choose the most discrim-
inatory color channel amongst these channels for our segmen-
tation approach (see Section 4.1). Let us denote this discrim-
inatory channel by c∗ ∈ IRm×n. We represent the feature
vector used during superpixel clustering as Xf , and the value
of the channel c∗ at the image co-ordinates (x, y) is r. Finally,
the number of superpixels is P .

2.2. Proposed Algorithm

As described in Fig. 2, the nighttime images are noisy in na-
ture, and pixel-wise classiﬁcation into day- and night- pixel
is not conducive. Therefore, we employ a superpixel-based
method that groups similar pixels together in a single super-
pixel, while respecting cloud boundaries. We use the super-
pixel generation algorithm, Simple Linear Iterative Clustering
(SLIC) [11] in our proposed nighttime image segmentation
approach. Instead of the default CIE LAB color space used
by SLIC, we use the discriminatory channel c∗ for the su-
perpixel clustering. The clustering is performed on the 3D
feature space Xf . We calculate this feature as:

Xf = [r x y],

(1)

15:34 – 1/125s, ISO 400, f/22.6

03:30 – 2s, ISO 800, f/2.8

Fig. 2: Sample day- and night-time image captured by our sky
camera. Note the different camera settings (exposure time,
ISO, f-number) in the two images.

2.1. Notation

Let us suppose that an image is represented by X ∈ IRm×n×3.
We perform an analysis of different color spaces and compo-
nents that are frequently used in cloud segmentation. Table 1
shows the 16 color channels, represented by c1−16, that are
used in our analysis.

It consists of channels from color models such as RGB,
HSV , Y IQ, L∗a∗b∗, various combinations of red and blue

where the vectors r, x, y represent the value, x- and y-
coordinate for the vectorized form of image c∗. This 3D
feature is used for superpixel clustering, similar to the 5D
LAB clustering technique used in SLIC approach [11]. We
thereby obtain an over-segmented image on the channel c∗.
An example is illustrated in Fig. 1(c).

The generated superpixels in Fig. 1(c) respect the sky/cloud
image boundaries very well, under the assumption that each
superpixel contains only sky or only cloud pixels. Therefore,

we compute the indexed image by mapping each pixels inside
a superpixel to a common value ¯r. This common quantity ¯r
for a superpixel is estimated by averaging all the r values in
that corresponding superpixel. The indexed image is shown
in Fig. 1(d). This vector quantization in the color channel c∗
is performed to reduce the color depth of the discriminatory
channel, and is inspired by Puzicha et al. [12].

Finally, we perform an unsupervised k-means clustering
on this quantized channel, whose feature vector comprises the
average value ¯r for the individual superpixels. We perform
this clustering into sky and cloud clusters. The cluster center
with lower value is assigned sky label, and the one with higher
value is assigned cloud label. The ﬁnal binary mask obtained
via k-means clustering is illustrated in Fig. 1(e).

In our proposed approach, the only input parameter is
the number of superpixels P used in the channel c∗, where
P ∈ N, 1 ≤ T ≤ mn. Therefore, the approximate size of
a superpixel is (mn/P ) pixels. The constant P is an indica-
tion of the degree of over-segmentation of the image. A large
P facilitates capturing ﬁne features of the input image. We
should set P to a large enough value, such that each super-
pixel contain only sky or cloud pixels. More discussion on
the value of P can be found in Section 4.

3. DATABASE

While there has been extensive work on daytime sky/cloud
image segmentation, nighttime sky imaging is rare. There-
fore,
there are no publicly available nighttime sky/cloud
image segmentation databases. We therefore created a new
database speciﬁcally for this purpose. In analogy to our pop-
ular SWIMSEG database with daytime sky images published
earlier [13], we refer to this database as Singapore Whole sky
Nighttime Imaging SEGmentation Database (SWINSEG).2

SWINSEG consists of 115 diverse images with a few
sample images shown in Fig. 3. The images were captured
using a ground-based whole sky imager called Wide Angle
High Resolution Sky Imaging System (WAHRSIS) [14], de-
signed and deployed at Nanyang Technological University
in Singapore. The images of SWINSEG were captured dur-
ing the period January to December 2016. The images were
hand-picked such that most of the variation in the image types
are captured in the dataset. Several factors such as time of the
image capture, cloud coverage, and seasonal variations were
considered in the selection process. The distribution of im-
ages in SWINSEG according to cloud coverage percentages
is shown in Fig. 4.

The extreme wide-angle ﬁsh-eye lens of WAHRSIS al-
lows us to capture almost the entire hemisphere. The dis-
tortions introduced by this lens need to be undone before
further processing. We generate undistorted pictures of a
smaller subsection of the captured images using a ray tracing

2 The SWINSEG dataset is available for download at http://vintage.

winklerbros.net/swinseg.html.

2%

18%

60%

79%

Fig. 3: Sample images from the SWINSEG database, along
with corresponding sky/cloud segmentation ground truth with
varying cloud coverage percentages.

Fig. 4: Distribution of images in the SWINSEG dataset ac-
cording to cloud coverage.

approach [13] by considering an imaginary camera (with a
standard lens) at the center of the hemisphere, which points
towards a user-deﬁned direction.
In order to simulate this
camera, we consider a target image of dimension 500 × 500,
with altitude of the virtual image plane at 150m, where each
pixel represents an incident light ray. All those rays will
intersect the hemisphere at a certain point and then converge
towards the center. The value of a pixel is then equal to the
color of the hemisphere at its intersection point. Figure 5
shows the output image as well as the lines corresponding to
its borders and diagonals on the original image.

The segmentation ground truth for SWINSEG was gener-
ated in consultation with experts from the Singapore Meteo-
rological Service.

4. EXPERIMENTAL EVALUATION

In order to present an objective evaluation of the proposed
algorithm, we report segmentation accuracy in terms of pre-
cision, recall, F-score, and error rate. Suppose TP, TN, FP
and FN denote the true positive, true negative, false posi-
tive and false negative samples of a segmented image, then
Precision = T P/(T P +F P ) and Recall = T P/(T P +F N ).

(a)

(b)

Fig. 5: Generation of undistorted images. (a) Illustration of
ray-tracing approach with input image at the bottom, projec-
tion on the unit sphere, and generation of the undistorted im-
age at the top. (b) Resulting image.

The F-score is the harmonic mean of Precision and Recall.
The error rate is the ratio of pixels classiﬁed incorrectly.

We also use Receiver Operating Characteristics (ROC)
curves to select the optimal color channel for nighttime seg-
mentation. The ROC curve is a graphical plot between true
positive rate and false positive rate, as the threshold is gradu-
ally changed. We compute the area between the ROC curve
and the random classiﬁer slope. These scores are averaged
over all images in the dataset.

4.1. Color Channel Selection

For an efﬁcient nighttime image segmentation, it is impor-
tant to choose the most discriminatory color channel c∗ in
our approach. We select the best color channel using the area
between the ROC curve and the random classiﬁer slope, to
identify the discriminatory capability of the respective color
channels. This is shown in Fig. 6.

As discussed in Section 2, the over-segmentation is de-
pendent on the number of superpixels P in an image. P
should be large enough to capture all the essential details of
the sky/cloud image.
Ideally each superpixel should con-
tain either only sky or only cloud. We experimentally set
P = 100. This makes the average size of a superpixel for
our test images in the SWIMSEG dataset about 502 pixels,
which appears to be a good size for this purpose.

4.2. Benchmarking

thresholding techniques in various color
In the literature,
spaces are widely used in cloud segmentation. As discussed
in Section 1, we benchmark our proposed framework with
several state-of-the-art methods, including Yang et al. [6],
Yang et al. [7], Liu et al. [8] and Gacal et al. [9].

Table 2 provides an objective evaluation of these algo-
rithms. We observe that methods such as Gacal et al. and
Liu et al. achieve very high recall but low precision (i.e. they
are too optimistic about what is a cloud). The method from
Yang et al. [6] on the other hand has a high precision and low
recall (i.e. too optimistic about sky regions). A good segmen-
tation method must have both high precision and high recall,
achieving a balance between sky and cloud detection; this is
indicated by the F-score and error rate. Our proposed method
outperforms other approaches, based on error rates, and has
the highest F-score value.

Methods
Yang et al. [6]
Yang et al. [7]
Liu et al. [8]
Gacal et al. [9]
Proposed approach

Precision Recall
0.69
0.19
0.93
0.99
0.76

0.98
0.90
0.68
0.47
0.95

F-score Error
0.14
0.40
0.23
0.53
0.13

0.79
0.26
0.77
0.62
0.83

Table 2: Performance evaluation of different benchmarking
algorithms. The average scores across all the images of the
database are reported. The best performance according to
each criterion is indicated in bold.

5. CONCLUSION

Fig. 6: Area between ROC curve and random classiﬁer slope
for different color channels.

The best color channel for nighttime sky/cloud image seg-
mentation is c14 (R − B), closely followed by c12 (b∗) and
c8 (I). The ranking of color channels is somewhat different
from the one for daytime sky/cloud image segmentation [13];
in particular, those channels involving red are better for night
sky/cloud segmentation.

We have presented a robust approach for the segmentation
of nighttime sky/cloud images obtained from ground-based
sky cameras. Our proposed method is based on superpixel
segmentation of the image and is entirely threshold-free. It
outperforms other state-of-the-art algorithms. We also release
the ﬁrst nighttime sky/cloud image segmentation database to
the research community. Our future work includes increasing
the SWINSEG dataset size.

6. REFERENCES

[1] S. Dev, B. Wen, Y. H. Lee, and S. Winkler, “Ground-
based image analysis: A tutorial on machine-learning
techniques and applications,” IEEE Geoscience and Re-
mote Sensing Magazine, vol. 4, no. 2, pp. 79–93, June
2016.

[2] S. Dev, F. M. Savoy, Y. H. Lee, and S. Winkler, “Rough-
set-based color channel selection,” IEEE Geoscience
and Remote Sensing Letters, vol. 10, pp. 52–56, Jan.
2017.

[3] Q. Li, W. Lu, and J. Yang, “A hybrid thresholding al-
gorithm for cloud detection on ground-based color im-
ages,” Journal of Atmospheric and Oceanic Technology,
vol. 28, no. 10, pp. 1286–1296, Oct. 2011.

[4] S. Dev, Y. H. Lee, and S. Winkler, “Systematic study
of color spaces and components for the segmentation of
sky/cloud images,” in Proc. International Conference
on Image Processing (ICIP), 2014, pp. 5102–5106.

[5] S. Dev, Y. H. Lee, and S. Winkler, “Multi-level semantic
labeling of sky/cloud images,” in Proc. International
Conference on Image Processing (ICIP), 2015, pp. 636–
640.

[6] J. Yang, W. Lu, Y. Ma, W. Yao, and Q. Li, “An automatic
ground based cloud detection method based on adaptive
threshold,” Journal of Applied Meteorological Science,
vol. 20, no. 6, pp. 713–721, 2009.

[7] J. Yang, W. Lu, Y. Ma, W. Yao, and Q. Li, “An au-
tomatic ground-based cloud detection method based on
the local threshold interpolation,” Acta Meteorologica
Sinica, vol. 68, no. 6, pp. 1007–1017, Mar. 2010.

[8] S. Liu, L. Zhang, Z. Zhang, C. Wang, and B. Xiao,
“Automatic cloud detection for all-sky images using su-

perpixel segmentation,” IEEE Geoscience and Remote
Sensing Letters, vol. 12, no. 2, pp. 354–358, Feb. 2015.

[9] G. F. B. Gacal, C. Antioquia, and N. Lagrosas, “Ground-
based detection of nighttime clouds above Manila Ob-
servatory (14.64N, 121.07E) using a digital camera,”
Applied Optics, vol. 55, no. 22, pp. 6040–6045, Aug.
2016.

[10] C. C. M. Kyba, T. Ruhtz, J. Fischer, and F. Hölker, “Red
is the new black: How the colour of urban skyglow
varies with cloud cover,” Monthly Notices of the Royal
Astronomical Society, vol. 425, no. 1, pp. 701–708, Aug.
2012.

[11] R. Achanta, A. Shaji, K. Smith, A. Lucchi, P. Fua, and
S. Süsstrunk, “SLIC superpixels compared to state-of-
the-art superpixel methods,” IEEE Transactions on Pat-
tern Analysis and Machine Intelligence, vol. 34, no. 11,
pp. 2274–2282, Nov. 2012.

[12] J. Puzicha, M. Held, J. Ketterer, J. M. Buhmann, and
D. W. Fellner, “On spatial quantization of color images,”
IEEE Transactions on Image Processing, vol. 9, no. 4,
pp. 666–682, Apr. 2000.

[13] S. Dev, Y. H. Lee, and S. Winkler, “Color-based seg-
mentation of sky/cloud images from ground-based cam-
eras,” IEEE Journal of Selected Topics in Applied Earth
Observations and Remote Sensing, vol. 10, pp. 231–
242, Jan. 2017.

[14] S. Dev, F. M. Savoy, Y. H. Lee, and S. Winkler, “De-
sign of low-cost, compact and weather-proof whole sky
imagers for High-Dynamic-Range captures,” in Proc.
International Geoscience and Remote Sensing Sympo-
sium (IGARSS), 2015, pp. 5359–5362.

NIGHTTIME SKY/CLOUD IMAGE SEGMENTATION

Soumyabrata Dev,1 Florian M. Savoy,2 Yee Hui Lee,1 Stefan Winkler2

1 School of Electrical and Electronic Engineering, Nanyang Technological University (NTU), Singapore
2 Advanced Digital Sciences Center (ADSC), University of Illinois at Urbana-Champaign, Singapore

7
1
0
2
 
y
a
M
 
0
3
 
 
]

V
C
.
s
c
[
 
 
1
v
3
8
5
0
1
.
5
0
7
1
:
v
i
X
r
a

ABSTRACT

Imaging the atmosphere using ground-based sky cameras is
a popular approach to study various atmospheric phenom-
ena. However, it usually focuses on the daytime. Nighttime
sky/cloud images are darker and noisier, and thus harder to
analyze. An accurate segmentation of sky/cloud images is
already challenging because of the clouds’ non-rigid struc-
ture and size, and the lower and less stable illumination of
the night sky increases the difﬁculty. Nonetheless, nighttime
cloud imaging is essential in certain applications, such as con-
tinuous weather analysis and satellite communication.

In this paper, we propose a superpixel-based method to
segment nighttime sky/cloud images. We also release the ﬁrst
nighttime sky/cloud image segmentation database to the re-
search community. The experimental results show the efﬁ-
cacy of our proposed algorithm for nighttime images.

Index Terms— Superpixels, nighttime cloud segmenta-

tion, sky imagers, WAHRSIS, SWINSEG.

1. INTRODUCTION

Over the last few decades, there has been growing interest in
geoscience to study clouds and analyze their various features.
Satellite images are the conventional source for analyzing the
formation of clouds, their movement, and other atmospheric
properties. However, these images suffer from poor spatial
and/or temporal resolution. Therefore, remote sensing ana-
lysts increasingly turn to ground-based sky imagers [1] that
are able to produce images with signiﬁcantly higher spatial
resolution at much more frequent intervals. An accurate seg-
mentation of the cloud mass from these images is of prime
importance for any kind of cloud analysis.

Almost all existing works in sky/cloud image segmenta-
tion use color as the discriminatory feature to detect clouds
in ground-based sky camera images. This is because the sky
is predominantly blue during daytime owing to Rayleigh scat-
tering of light. However, this assumption no longer holds dur-
ing nighttime.

In the literature, most existing works consider only day-
time images. Several color models are used in cloud segmen-
tation [2–5]. Yang et al. (2009) used the Otsu threshold on
red-blue difference images [6]. Yang et al. (2010) employed
a local method [7] for cloud segmentation, which uses an
adaptive threshold on sub-images of the sky. Recently, Liu et
al. [8] used a superpixel approach and generated correspond-
ing thresholds for each superpixel to compute the ﬁnal binary
image. The local thresholds of these superpixels are empiri-
cally evaluated based on a set of case-based decisions, thereby
generating a matrix of thresholds.

Cloud segmentation in the nighttime sky is often ne-
glected. Yet, analyzing clouds at nighttime helps in several
areas viz. weather reporting and prediction, aviation, and
satellite communication. Only very recently, Gacal et al.
in [9] explored the nighttime cloud detection using ground-
based sky cameras. Their method uses a constant ﬁxed thresh-
old in the gray-scale channel of the cloud images, captured
over Manila region in the Philippines.

Addressing this gap in the literature, we propose an efﬁ-
cient nighttime cloud segmentation approach. In this paper,
we perform a careful selection of color spaces and compo-
nents, and thereby propose a superpixel-based approach to ef-
ﬁciently segment nighttime sky/cloud image. We also present
a new nighttime sky/cloud image segmentation database,
which we use for benchmarking our approach.

2. NIGHTTIME CLOUD SEGMENTATION

In this section, we present our detailed segmentation frame-
work for nighttime cloud segmentation.1 Our approach is il-
lustrated in Fig. 1. Using an input image as shown in Fig. 1(a),
we obtain a suitable color channel (in this example the red-
blue difference), shown in Fig. 1(b). We then perform an
over-segmentation of this image using a superpixel technique;
the over-segmented image is shown in Fig. 1(c). Thereafter,
we convert it into an indexed image as shown in Fig. 1(d) us-
ing a quantization procedure. Subsequently, we cluster these
superpixels into two clusters – cloud and sky. The resulting
binary segmented image is shown in Fig. 1(e).

This research is funded by the Defence Science and Technology Agency

(DSTA), Singapore.

1 The source code of all simulations in this paper is available online at

Send correspondence to stefan.winkler@adsc.com.sg.

https://github.com/Soumyabrata/nighttime-imaging.

(a)

(b)

(c)

(d)

(e)

Fig. 1: Proposed superpixel-based nighttime sky/cloud image segmentation approach. (a) Input image; (b) Red-blue difference
image; (c) Over-segmentation using superpixels; (d) Indexed image using average red-blue difference of the superpixels; (e)
Final sky/cloud segmentation result.

Unlike the conventional daytime sky/cloud image, night-
time images include several additional imaging challenges.
Figure 2 shows a sample day- and night-time image captured
by our high resolution sky camera. Unlike the clear blue
sky and white clouds seen during daytime, the night sky and
clouds appear more reddish. This is mainly because of in-
creasing light pollution in urban areas like Singapore. In a
cloudy night-sky, the longer wavelengths of the artiﬁcial light
are scattered back to the earth’s surface, providing a reddish
tinge to the night sky. More details on this phenomenon can
be found in a recent study [10]. Moreover, nighttime images
are more noisy and blurry in nature, with less distinctive fea-
tures, owing to the higher exposure time and lower f-numbers
of the camera lens.

c1 R c4 H c7 Y c10 L∗
c11 a∗
c2 G c5 S
b∗
c3 B c6 V c9 Q c12

c8

I

c13 R/B
c14 R − B
B−R
c15
B+R

c16 C

Table 1: Color spaces and components used in our analysis
of nighttime images.

color channels, and chroma (C). We choose the most discrim-
inatory color channel amongst these channels for our segmen-
tation approach (see Section 4.1). Let us denote this discrim-
inatory channel by c∗ ∈ IRm×n. We represent the feature
vector used during superpixel clustering as Xf , and the value
of the channel c∗ at the image co-ordinates (x, y) is r. Finally,
the number of superpixels is P .

2.2. Proposed Algorithm

As described in Fig. 2, the nighttime images are noisy in na-
ture, and pixel-wise classiﬁcation into day- and night- pixel
is not conducive. Therefore, we employ a superpixel-based
method that groups similar pixels together in a single super-
pixel, while respecting cloud boundaries. We use the super-
pixel generation algorithm, Simple Linear Iterative Clustering
(SLIC) [11] in our proposed nighttime image segmentation
approach. Instead of the default CIE LAB color space used
by SLIC, we use the discriminatory channel c∗ for the su-
perpixel clustering. The clustering is performed on the 3D
feature space Xf . We calculate this feature as:

Xf = [r x y],

(1)

15:34 – 1/125s, ISO 400, f/22.6

03:30 – 2s, ISO 800, f/2.8

Fig. 2: Sample day- and night-time image captured by our sky
camera. Note the different camera settings (exposure time,
ISO, f-number) in the two images.

2.1. Notation

Let us suppose that an image is represented by X ∈ IRm×n×3.
We perform an analysis of different color spaces and compo-
nents that are frequently used in cloud segmentation. Table 1
shows the 16 color channels, represented by c1−16, that are
used in our analysis.

It consists of channels from color models such as RGB,
HSV , Y IQ, L∗a∗b∗, various combinations of red and blue

where the vectors r, x, y represent the value, x- and y-
coordinate for the vectorized form of image c∗. This 3D
feature is used for superpixel clustering, similar to the 5D
LAB clustering technique used in SLIC approach [11]. We
thereby obtain an over-segmented image on the channel c∗.
An example is illustrated in Fig. 1(c).

The generated superpixels in Fig. 1(c) respect the sky/cloud
image boundaries very well, under the assumption that each
superpixel contains only sky or only cloud pixels. Therefore,

we compute the indexed image by mapping each pixels inside
a superpixel to a common value ¯r. This common quantity ¯r
for a superpixel is estimated by averaging all the r values in
that corresponding superpixel. The indexed image is shown
in Fig. 1(d). This vector quantization in the color channel c∗
is performed to reduce the color depth of the discriminatory
channel, and is inspired by Puzicha et al. [12].

Finally, we perform an unsupervised k-means clustering
on this quantized channel, whose feature vector comprises the
average value ¯r for the individual superpixels. We perform
this clustering into sky and cloud clusters. The cluster center
with lower value is assigned sky label, and the one with higher
value is assigned cloud label. The ﬁnal binary mask obtained
via k-means clustering is illustrated in Fig. 1(e).

In our proposed approach, the only input parameter is
the number of superpixels P used in the channel c∗, where
P ∈ N, 1 ≤ T ≤ mn. Therefore, the approximate size of
a superpixel is (mn/P ) pixels. The constant P is an indica-
tion of the degree of over-segmentation of the image. A large
P facilitates capturing ﬁne features of the input image. We
should set P to a large enough value, such that each super-
pixel contain only sky or cloud pixels. More discussion on
the value of P can be found in Section 4.

3. DATABASE

While there has been extensive work on daytime sky/cloud
image segmentation, nighttime sky imaging is rare. There-
fore,
there are no publicly available nighttime sky/cloud
image segmentation databases. We therefore created a new
database speciﬁcally for this purpose. In analogy to our pop-
ular SWIMSEG database with daytime sky images published
earlier [13], we refer to this database as Singapore Whole sky
Nighttime Imaging SEGmentation Database (SWINSEG).2

SWINSEG consists of 115 diverse images with a few
sample images shown in Fig. 3. The images were captured
using a ground-based whole sky imager called Wide Angle
High Resolution Sky Imaging System (WAHRSIS) [14], de-
signed and deployed at Nanyang Technological University
in Singapore. The images of SWINSEG were captured dur-
ing the period January to December 2016. The images were
hand-picked such that most of the variation in the image types
are captured in the dataset. Several factors such as time of the
image capture, cloud coverage, and seasonal variations were
considered in the selection process. The distribution of im-
ages in SWINSEG according to cloud coverage percentages
is shown in Fig. 4.

The extreme wide-angle ﬁsh-eye lens of WAHRSIS al-
lows us to capture almost the entire hemisphere. The dis-
tortions introduced by this lens need to be undone before
further processing. We generate undistorted pictures of a
smaller subsection of the captured images using a ray tracing

2 The SWINSEG dataset is available for download at http://vintage.

winklerbros.net/swinseg.html.

2%

18%

60%

79%

Fig. 3: Sample images from the SWINSEG database, along
with corresponding sky/cloud segmentation ground truth with
varying cloud coverage percentages.

Fig. 4: Distribution of images in the SWINSEG dataset ac-
cording to cloud coverage.

approach [13] by considering an imaginary camera (with a
standard lens) at the center of the hemisphere, which points
towards a user-deﬁned direction.
In order to simulate this
camera, we consider a target image of dimension 500 × 500,
with altitude of the virtual image plane at 150m, where each
pixel represents an incident light ray. All those rays will
intersect the hemisphere at a certain point and then converge
towards the center. The value of a pixel is then equal to the
color of the hemisphere at its intersection point. Figure 5
shows the output image as well as the lines corresponding to
its borders and diagonals on the original image.

The segmentation ground truth for SWINSEG was gener-
ated in consultation with experts from the Singapore Meteo-
rological Service.

4. EXPERIMENTAL EVALUATION

In order to present an objective evaluation of the proposed
algorithm, we report segmentation accuracy in terms of pre-
cision, recall, F-score, and error rate. Suppose TP, TN, FP
and FN denote the true positive, true negative, false posi-
tive and false negative samples of a segmented image, then
Precision = T P/(T P +F P ) and Recall = T P/(T P +F N ).

(a)

(b)

Fig. 5: Generation of undistorted images. (a) Illustration of
ray-tracing approach with input image at the bottom, projec-
tion on the unit sphere, and generation of the undistorted im-
age at the top. (b) Resulting image.

The F-score is the harmonic mean of Precision and Recall.
The error rate is the ratio of pixels classiﬁed incorrectly.

We also use Receiver Operating Characteristics (ROC)
curves to select the optimal color channel for nighttime seg-
mentation. The ROC curve is a graphical plot between true
positive rate and false positive rate, as the threshold is gradu-
ally changed. We compute the area between the ROC curve
and the random classiﬁer slope. These scores are averaged
over all images in the dataset.

4.1. Color Channel Selection

For an efﬁcient nighttime image segmentation, it is impor-
tant to choose the most discriminatory color channel c∗ in
our approach. We select the best color channel using the area
between the ROC curve and the random classiﬁer slope, to
identify the discriminatory capability of the respective color
channels. This is shown in Fig. 6.

As discussed in Section 2, the over-segmentation is de-
pendent on the number of superpixels P in an image. P
should be large enough to capture all the essential details of
the sky/cloud image.
Ideally each superpixel should con-
tain either only sky or only cloud. We experimentally set
P = 100. This makes the average size of a superpixel for
our test images in the SWIMSEG dataset about 502 pixels,
which appears to be a good size for this purpose.

4.2. Benchmarking

thresholding techniques in various color
In the literature,
spaces are widely used in cloud segmentation. As discussed
in Section 1, we benchmark our proposed framework with
several state-of-the-art methods, including Yang et al. [6],
Yang et al. [7], Liu et al. [8] and Gacal et al. [9].

Table 2 provides an objective evaluation of these algo-
rithms. We observe that methods such as Gacal et al. and
Liu et al. achieve very high recall but low precision (i.e. they
are too optimistic about what is a cloud). The method from
Yang et al. [6] on the other hand has a high precision and low
recall (i.e. too optimistic about sky regions). A good segmen-
tation method must have both high precision and high recall,
achieving a balance between sky and cloud detection; this is
indicated by the F-score and error rate. Our proposed method
outperforms other approaches, based on error rates, and has
the highest F-score value.

Methods
Yang et al. [6]
Yang et al. [7]
Liu et al. [8]
Gacal et al. [9]
Proposed approach

Precision Recall
0.69
0.19
0.93
0.99
0.76

0.98
0.90
0.68
0.47
0.95

F-score Error
0.14
0.40
0.23
0.53
0.13

0.79
0.26
0.77
0.62
0.83

Table 2: Performance evaluation of different benchmarking
algorithms. The average scores across all the images of the
database are reported. The best performance according to
each criterion is indicated in bold.

5. CONCLUSION

Fig. 6: Area between ROC curve and random classiﬁer slope
for different color channels.

The best color channel for nighttime sky/cloud image seg-
mentation is c14 (R − B), closely followed by c12 (b∗) and
c8 (I). The ranking of color channels is somewhat different
from the one for daytime sky/cloud image segmentation [13];
in particular, those channels involving red are better for night
sky/cloud segmentation.

We have presented a robust approach for the segmentation
of nighttime sky/cloud images obtained from ground-based
sky cameras. Our proposed method is based on superpixel
segmentation of the image and is entirely threshold-free. It
outperforms other state-of-the-art algorithms. We also release
the ﬁrst nighttime sky/cloud image segmentation database to
the research community. Our future work includes increasing
the SWINSEG dataset size.

6. REFERENCES

[1] S. Dev, B. Wen, Y. H. Lee, and S. Winkler, “Ground-
based image analysis: A tutorial on machine-learning
techniques and applications,” IEEE Geoscience and Re-
mote Sensing Magazine, vol. 4, no. 2, pp. 79–93, June
2016.

[2] S. Dev, F. M. Savoy, Y. H. Lee, and S. Winkler, “Rough-
set-based color channel selection,” IEEE Geoscience
and Remote Sensing Letters, vol. 10, pp. 52–56, Jan.
2017.

[3] Q. Li, W. Lu, and J. Yang, “A hybrid thresholding al-
gorithm for cloud detection on ground-based color im-
ages,” Journal of Atmospheric and Oceanic Technology,
vol. 28, no. 10, pp. 1286–1296, Oct. 2011.

[4] S. Dev, Y. H. Lee, and S. Winkler, “Systematic study
of color spaces and components for the segmentation of
sky/cloud images,” in Proc. International Conference
on Image Processing (ICIP), 2014, pp. 5102–5106.

[5] S. Dev, Y. H. Lee, and S. Winkler, “Multi-level semantic
labeling of sky/cloud images,” in Proc. International
Conference on Image Processing (ICIP), 2015, pp. 636–
640.

[6] J. Yang, W. Lu, Y. Ma, W. Yao, and Q. Li, “An automatic
ground based cloud detection method based on adaptive
threshold,” Journal of Applied Meteorological Science,
vol. 20, no. 6, pp. 713–721, 2009.

[7] J. Yang, W. Lu, Y. Ma, W. Yao, and Q. Li, “An au-
tomatic ground-based cloud detection method based on
the local threshold interpolation,” Acta Meteorologica
Sinica, vol. 68, no. 6, pp. 1007–1017, Mar. 2010.

[8] S. Liu, L. Zhang, Z. Zhang, C. Wang, and B. Xiao,
“Automatic cloud detection for all-sky images using su-

perpixel segmentation,” IEEE Geoscience and Remote
Sensing Letters, vol. 12, no. 2, pp. 354–358, Feb. 2015.

[9] G. F. B. Gacal, C. Antioquia, and N. Lagrosas, “Ground-
based detection of nighttime clouds above Manila Ob-
servatory (14.64N, 121.07E) using a digital camera,”
Applied Optics, vol. 55, no. 22, pp. 6040–6045, Aug.
2016.

[10] C. C. M. Kyba, T. Ruhtz, J. Fischer, and F. Hölker, “Red
is the new black: How the colour of urban skyglow
varies with cloud cover,” Monthly Notices of the Royal
Astronomical Society, vol. 425, no. 1, pp. 701–708, Aug.
2012.

[11] R. Achanta, A. Shaji, K. Smith, A. Lucchi, P. Fua, and
S. Süsstrunk, “SLIC superpixels compared to state-of-
the-art superpixel methods,” IEEE Transactions on Pat-
tern Analysis and Machine Intelligence, vol. 34, no. 11,
pp. 2274–2282, Nov. 2012.

[12] J. Puzicha, M. Held, J. Ketterer, J. M. Buhmann, and
D. W. Fellner, “On spatial quantization of color images,”
IEEE Transactions on Image Processing, vol. 9, no. 4,
pp. 666–682, Apr. 2000.

[13] S. Dev, Y. H. Lee, and S. Winkler, “Color-based seg-
mentation of sky/cloud images from ground-based cam-
eras,” IEEE Journal of Selected Topics in Applied Earth
Observations and Remote Sensing, vol. 10, pp. 231–
242, Jan. 2017.

[14] S. Dev, F. M. Savoy, Y. H. Lee, and S. Winkler, “De-
sign of low-cost, compact and weather-proof whole sky
imagers for High-Dynamic-Range captures,” in Proc.
International Geoscience and Remote Sensing Sympo-
sium (IGARSS), 2015, pp. 5359–5362.

