Fast, Precise Myelin Water Quantiﬁcation
using DESS MRI and Kernel Learning

Gopal Nataraj⋆, Jon-Fredrik Nielsen†, Mingjie Gao⋆, and Jeffrey A. Fessler⋆

⋆Dept. of Electrical Engineering and Computer Science, University of Michigan
†Dept. of Biomedical Engineering, University of Michigan

Abstract

Purpose: To investigate the feasibility of myelin water content quantiﬁcation using fast

dual-echo steady-state (DESS) scans and machine learning with kernels.

Methods: We optimized combinations of steady-state (SS) scans for precisely estimat-
ing the fast-relaxing signal fraction fF of a two-compartment signal model, subject to a scan
time constraint. We estimated fF from the optimized DESS acquisition using a recently de-
veloped method for rapid parameter estimation via regression with kernels (PERK). We com-
pared DESS PERK fF estimates to conventional myelin water fraction (MWF) estimates from
a longer multi-echo spin-echo (MESE) acquisition in simulation, in vivo, and ex vivo studies.
Results: Simulations demonstrate that DESS PERK fF estimators and MESE MWF es-
timators achieve comparable error levels. In vivo and ex vivo experiments demonstrate that
MESE MWF and DESS PERK fF estimates are quantitatively comparable measures of WM
myelin water content. To our knowledge, these experiments are the ﬁrst to demonstrate myelin
water images from a SS acquisition that are quantitatively similar to conventional MESE MWF
images.

Conclusion: Combinations of fast DESS scans can be designed to enable precise fF esti-
mation. PERK is well-suited for fF estimation. DESS PERK fF and MESE MWF estimates
are quantitatively similar measures of WM myelin water content.

Keywords: myelin imaging, Bayesian experiment design, DESS, machine learning, kernel

regression

Funding Information: National Institutes of Health grant P30 AG053760, University of

Michigan MCubed seed grant, University of Michigan predoctoral fellowship

8
1
0
2
 
p
e
S
 
4
2
 
 
]
h
p
-
d
e
m

.
s
c
i
s
y
h
p
[
 
 
1
v
8
0
9
8
0
.
9
0
8
1
:
v
i
X
r
a

Submitted to Magnetic Resonance in Medicine

1

1 Introduction

Myelin is a lipid-rich material that forms an insulating sheath encasing neuronal axons predomi-
nantly in white matter (WM) regions of the human brain [1]. Demyelination (i.e., myelin loss) is
central to the development of several neurodegenerative disorders such as multiple sclerosis (MS)
[2]. Non-invasive myelin quantiﬁcation in WM is thus desirable for monitoring the onset and
progression of neurodegenerative disease.

MR relaxation time constants (especially spin-spin time constant T2) depend on the macro-
molecular environment surrounding water molecules. In nerve tissue, these environments vary
spatially on scales much smaller than the millimeter-scale resolutions used in typical MR imag-
ing experiments. Many researchers have attempted to characterize nerve tissue microstructure
by estimating the intravoxel distribution of MR relaxation time constants and associating certain
ranges of time constants with particular “compartments” or “pools” of water molecules that exist
in similar macromolecular environments. In vitro NMR studies of nerve animal tissue ascribed a
fast-relaxing water compartment with T2 ∼10-40ms initially to general protein and phospholipid
structures [3] and later more speciﬁcally to water trapped between the phospholipid bilayers of
myelin [4, 5]. Shortly thereafter, the ﬁrst MR images of so-called myelin water fraction (MWF),
deﬁned as the proportion of MR signal arising from the fast-relaxing water compartment relative
to total MR signal, were demonstrated in vivo in the human brain [6]. More recently, MWF has
been shown to correlate well with histological measurements of myelin content in animal models
of nerve injury [7] and demyelination [8]. In humans, MWF has been measured to be signiﬁcantly
lower in “normally appearing” WM of MS patients versus controls [9], and to correlate strongly
with post-mortem histological measurements of myelin content in MS patients [10]. These studies
provide growing evidence that MWF as deﬁned in [6] is a speciﬁc quantitative marker of intact
WM myelin content.

All of the aforementioned studies estimate MWF images from a multi-echo spin echo (MESE)
MRI pulse sequence [11] with long repetition time TR ≥ 2s to ensure sufﬁcient recovery of the
longitudinal magnetization in nerve tissue. Whole-brain MWF imaging using such long-TR MESE
acquisitions at a typical imaging resolution would require hours of scan time. To enable more clin-
ically practical scan times, researchers have more recently shown that MESE-based MWF imaging
can be accelerated without signiﬁcantly changing the resulting MWF images [12, 13] by acquiring
multiple gradient echoes per refocusing pulse [14]. However, these and other acquisition modiﬁca-
tions used in [13] do not address the fundamental long-TR requirement of MESE acquisitions and
thus would still require long scan times for whole-brain MWF imaging at millimeter-scale resolu-
tion. Furthermore, estimating a T2 distribution from MESE data constitutes a poorly conditioned
estimation problem that continues to demand high SNR [15, 16], so the need remains for a more
SNR-efﬁcient acquisition for myelin water imaging. As an alternative to MESE acquisitions, scan
proﬁles consisting of short-TR steady-state (SS) sequences were proposed for whole-brain myelin
water imaging in about 30m scan time [17]. Despite more recent further reﬁnements [18, 19],
myelin water images from SS pulse sequences have thus far been shown to be incomparable with
MWF images from MESE pulse sequences [20], likely due at least in part to insufﬁcient precision
[21] for reasonable scan times.

Inspired by [22], we reconsidered myelin water imaging from SS pulse sequences from the
perspective of statistical experiment design. In [22], we optimized several combinations of spoiled
gradient-recalled echo (SPGR) [23] and dual-echo steady-state (DESS) scans [24, 25] for single-

2

compartment T1, T2 estimation and found that different optimized scan combinations produced
signiﬁcantly different in vivo T2 estimates (but comparable phantom T2 estimates), indicating in
vivo sensitivity to model non-idealities. Further simulation studies suggested that these incon-
sistencies may be attributable to multi-compartmental relaxation. This paper demonstrates that
this apparent SPGR/DESS sensitivity to multi-compartmental relaxation can be exploited for fast,
precise myelin water imaging.

This paper introduces a new method1 for myelin water content quantiﬁcation based on a fast
SS MRI acquisition and PERK [28], a recently developed learning-inspired algorithm for fast,
scalable MRI parameter estimation. The acquisition consists of a combination of DESS scans
optimized to enable precise estimation of the fast-relaxing signal fraction fF in two-compartment
signal models, subject to a total scan time constraint. The PERK estimator learns a globally opti-
mal regression function that nonlinearly maps DESS measurements to fF estimates using simulated
training points, kernel functions, and convex optimization. Our precision-optimized DESS acqui-
sition is as fast as the SS acquisition proposed in [18] but enables ∼40% expected coefﬁcient of
variation in unbiased fF estimates. (Similar calculations for [17, 18] found that fF coefﬁcients
of variation frequently exceeded 100% [21].) In vivo and ex vivo experiments demonstrate that
DESS PERK fF estimates and conventional MESE MWF estimates are quantitatively compara-
ble measures of WM myelin water content. To our knowledge, these experiments are the ﬁrst to
demonstrate myelin water images from a SS acquisition that are quantitatively similar to MESE
MWF images.

2 Theory

This section highlights several unconventional aspects of our myelin water imaging framework.
§2.1 describes a two-compartment DESS signal model. §2.2 develops a scalable method for scan
optimization. §2.3 overviews Parameter Estimation via Regression with Kernels (PERK) [26, 28],
a recently developed machine learning algorithm for fast multiple-parameter estimation.

2.1 A Two-Compartment DESS Signal Model

We assume that MR signal arises from two intra-voxel water compartments: a fast-relaxing com-
partment characterized by comparatively short spin-lattice T1,F and spin-spin T2,F relaxation times
and a slow-relaxing compartment characterized by longer relaxation times T1,S, T2,S. If these com-
partments are allowed to exchange, the resulting DESS signal models are difﬁcult to express ex-
actly2 (unlike analogous SPGR [30] or balanced steady-state free precession [31] models) due to
strongly time-dependent off-resonance effects imparted by unbalanced DESS dephasing gradients.
We focus here on the non-exchanging case for simplicity (as is also commonly done in MESE
MWF imaging).

1This paper substantially extends our previous work in myelin water imaging. Conference paper [26] introduced
the estimation algorithm used herein but presented simulation results only. Conference proceeding [27] introduced the
experimental design algorithm used herein but did not compare results against conventional MESE MWF estimates.

2However, we have derived approximate two-compartment DESS models [29, Ch. 6] in the presence of ﬁrst-order

exchange.

3

Assuming the DESS echoes are acquired at symmetric echo times t ← ∓TE before and after
a near-instantaneous RF pulse centered at time t ← 0 (where ← denotes assignment), we have
shown [29, Ch. 6] through an analysis similar to those in [17,30] that the non-exchanging noiseless
DESS signals can, to within constants, be intuitively written as a sum over compartmental signal
contributions:

(1)

(2)

(3)

sD(−TE) ∝ −im0 tan

α
2

sD(+TE) ∝ +im0 tan

×

fF(1 − η(T1,F, T2,F))e+(1/T2,F−R′

2,F+iωF)TE

(cid:18)

+ (1 − fF)(1 − η(T1,S, T2,S))e+(1/T2,S−R′

2,S+iωS)TE

α
2
η(T1,F, T2,F)
ξ(T1,F)

×

fF

1 −

(cid:18)

(cid:18)

+ (1 − fF)

1 −

(cid:18)

(cid:19)

η(T1,S, T2,S)
ξ(T1,S)

(cid:19)

e−(1/T2,F+R′

2,F+iωF)TE

e−(1/T2,S+R′

2,S+iωS)TE

,
(cid:19)

;
(cid:19)

where η, ξ are intermediate functions deﬁned as

η(t′, t′′) :=

ξ(t′) :=

1 − (exp (−TR/t′′))2
1 − (exp (−TR/t′′)/ξ(t′))

s
1 − exp (−TR/t′) cos α
exp (−TR/t′) − cos α

.

2 ;

2,F, R′

Here, fF ∈ [0, 1] denotes fast-relaxing compartmental fraction; m0 denotes total spin density;
R′
2,S and ωF, ωS respectively denote compartment-speciﬁc broadening bandwidths and me-
dian off-resonance frequencies; α denotes ﬂip angle; and TR denotes repetition interval. These
expressions assume that off-resonance distributions are independent across compartments, with
Cauchy-distributed marginals. Though this is perhaps a strong assumption, it serves to clearly
demonstrate that unlike in the single-compartment case [22, Eq. 17], off-resonance effects may not
be aggregated into an apparent spin density – in fact, uncompensated off-resonance terms to ﬁrst
order would inﬂuence the apparent compartmental fractions of typical interest.

2.2 A Bayesian Approach to Acquisition Design

This subsection develops our approach to designing a fast SS acquisition that enables precise fF es-
timation. For clarity in presentation, we describe the method here in a general manner and provide
implementation details in §3.1. Our method is related to the Bayesian Cram´er-Rao Bound [32],
which has been applied previously in quantitative MRI [33, 34] though with a different cost func-
tion than the one developed in this section. We propose an intuitive cost function that is amenable
to gradient-based optimization and is thus suitable for multi-dimensional parameter estimation
problems.

4

After image reconstruction, many quantitative MRI acquisitions produce at each voxel position

a sequence of measurements y ∈ CD, modeled here as

y = s(x, ν, P) + ǫ.

Here, s : RL+K+AD 7→ CD models D noiseless signals; x ∈ RL denotes L latent (i.e., unknown)
parameters; ν ∈ RK denotes K known parameters; P ∈ RA×D collects A acquisition param-
eters for each of D measurements; and ǫ ∼ CN (0D, Σ) denotes complex Gaussian noise with
zero mean 0D ∈ RD and known covariance Σ ∈ RD×D. (As a concrete example, for single-
compartment T2 estimation from spin echo measurements, x could collect m0, T2; ν could collect
known main and RF transmit ﬁeld inhomogeneities; and P could collect D echo times.) We seek
to design P to enable precise estimation of one or more elements of x.

We approach acquisition design by minimizing a cost function that characterizes estimation
imprecision. To develop this cost function, we utilize the Cram´er-Rao Bound [35], which states
that the covariance of any unbiased estimator of x is bounded below by the inverse (if it exists) of
the Fisher information matrix

F(x, ν, P) := (∇xs(x, ν, P))

Σ−1∇xs(x, ν, P),

H

where ∇x denotes row gradient with respect to x and (·)
on minimizing a weighted average of latent parameter variance lower bounds

denotes conjugate transpose. We focus

H

Ψ(x, ν, P) := tr

WF−1(x, ν, P)W

(cid:1)

(cid:0)

where tr(·) denotes the matrix trace operation and W ∈ RL×L is a diagonal weighting matrix. Di-
rectly optimizing (6) over P would encourage precise estimation only for some speciﬁc x, ν values.
In [22], we addressed this dependence of Ψ on x, ν through a min-max optimization problem. The
associated “worst-case” design criterion required relatively mild assumptions on the distribution
of x, ν but was non-differentiable in P. For the lower-dimensional application studied in [22], we
optimized the min-max criterion through exhaustive grid search, so non-differentiability did not
matter. However, grid search scales poorly with D and D ≥ L for well-conditioned estimation, so
the need for an alternative approach increases for higher-L estimation problems. We study here an
alternate design criterion that is amenable to gradient-based optimization. Speciﬁcally, we seek P
that minimizes the expected weighted average of latent parameter variance lower bounds over an
acquisition parameter design search space P:

P∗ ∈

arg min
P∈P

¯Ψ(P)

, where

(cid:27)
¯Ψ(P) := Ex,ν(Ψ(x, ν, P))

(cid:26)

and Ex,ν(·) denotes joint expectation with respect to a prior joint distribution on x, ν. Under certain
conditions (detailed in the Appendix), expected cost ¯Ψ is differentiable in P and is thus amenable
to gradient-based local optimization.

2.3 PERK: A Fast Algorithm for Multiple-Parameter Estimation

This subsection overviews PERK, a fast machine learning algorithm for dictionary-free per-voxel
MRI parameter estimation. PERK is a computationally efﬁcient alternative to conventional dictionary-

5

(4)

(5)

(6)

(7)

(8)

based grid search estimation: speciﬁcally, PERK may scale better than grid search with the num-
ber of unknowns (see §S-II and §S-III respectively for supporting results and discussion). We
recently developed and demonstrated PERK for single-compartment T1, T2 estimation [28] and a
full description is provided therein. Here we review the PERK estimator at a conceptual level; the
Appendix reviews selected mathematical details and §S-I explains our implementation for myelin
water imaging.

In essence, PERK learns a simple nonlinear estimator from simulated labeled training points
and evaluates the learned estimator on unlabeled test data. PERK ﬁrst samples prior parameter
and noise distributions and evaluates signal model (4) many times to form a set of parameter-
measurement tuples. The goal of PERK is to then learn from these labeled training points a suit-
able estimator that maps each measurement and known parameter realization to a reasonable latent
parameter estimate. This supervised learning problem is subject to a tradeoff between expressivity
and training complexity: more complicated estimator architectures have the potential to accurately
represent a larger space of functions but are computationally harder to train. Towards good ex-
pressivity, researchers have recently proposed to learn deep neural network architectures for quan-
titative MRI [36, 37]. However, it is well known that deep learning requires enormous numbers of
training points to train many hyperparameters without overﬁtting, and its limited theoretical basis
renders its practical use largely an art. PERK instead learns a much simpler estimator architecture
that is a weighted combination of nonlinear kernel functions. For appropriate kernel choices, the
PERK estimator is uniquely and globally optimal over a very diverse function space, so PERK
enjoys good expressivity despite its simple form. We previously demonstrated good PERK per-
formance for single-compartment T1, T2 estimation from SS [26, 28] and MR ﬁngerprinting data
[38]; the results herein suggest that PERK is suitable for higher-dimensional estimation problems
as well.

3 Methods

This section describes our myelin water imaging experiments. §3.1 applies Bayesian scan design
(cf. §2.2) to design a fast combination of SPGR and DESS scans that enables precise fF estimation.
Interestingly, the optimized acquisition consists only of DESS scans (see §5 for discussion of this).
§3.2, §3.3, and §3.4 describe comparisons respectively in simulation, in vivo, and ex vivo studies of
PERK fF estimates from the optimized DESS acquisition to nonnegative least-squares (NNLS) and
regularized NNLS (RNNLS) conventional MWF fM estimates from a MESE acquisition. §S-I pro-
vides PERK and conventional estimator implementation details. In the interest of reproducible re-
search, code and data will be freely available at https://github.com/gopal-nataraj/mwf.

3.1 Acquisition Design

We assumed identical broadening distributions across compartments (i.e., R′
2,S and ωF ≡
ωS) to simplify scan design optimization. Speciﬁcally, this simpliﬁcation enabled generation via
the MATLAB R(cid:13) Symbolic Toolbox of cumbersome but analytical expressions for relevant gradi-
ents and mixed gradients of the SPGR [30] and DESS (1)-(2) magnitude signal models. We used
magnitude signal models to reduce SPGR/DESS signal dependence on off-resonance effects, not-
ing that Rician distributed noise in corresponding magnitude image data is well-approximated as

2,F ≡ R′

6

Gaussian for sufﬁciently large SNR [39]. We modeled each ﬂip angle α ← α0κ to deviate from
a nominal prescribed value α0 by spatially-varying transmit ﬁeld sensitivity κ ≈ 1. We ﬁxed TE
across scans and thereby reduced model dependencies to seven free object parameters per voxel:
fF, T1,F, T2,F, T1,S, T2,S, κ, and c := m0e−R′
2,STE; and two acquisition parameters
per dataset: pd ← [α0, TR]
, ∀d ∈ {1, . . . , D}. We assumed prior knowledge of transmit ﬁeld
sensitivity ν ← κ (that in experiments we estimated from separate fast acquisitions [40]-[41]) and
collected the remaining L ← 6 latent parameters as x ← [fF, T1,F, T2,F, T1,S, T2,S, c].

2,FTE ≡ m0e−R′

T

(cid:1)

(cid:0)

(Ex,ν(fF))−1, 05

We took fast-relaxing compartmental fraction fF to be a quantitative measure of myelin water
content and tailored scan design problem (7) to encourage scan combinations that enable precise
fF estimation. Speciﬁcally, we set weight matrix W ← diag
to penalize fF
imprecision only. Here, fast-fraction variance weight (Ex,ν(fF))−1 assigns interpretable meaning
¯Ψ(P) as a unitless measure of the expected coefﬁcient of variation afforded by P in asymp-
to
totically unbiased estimates of fF.

p
We approximated expectations of form Ex,ν(·) by taking empirical averages using samples of
x, ν drawn from a prior distribution. We used a coordinate-wise separable prior distribution, mod-
eling fF ∼ unif(0.03, 0.21) to conservatively contain state-of-the-art MESE MWF measurements
in WM [20] and modeling T1,F, T2,F, T1,S, and T2,S to be Gaussian distributed with means 400ms,
20ms, 1000ms, and 80ms selected from literature measurements [6, 18] and standard deviations
that are 20% of corresponding means. Since W placed zero weight on estimating c, it sufﬁced to
ﬁx c ← 1 and to assign noise variance Σ ← (1.49 × 10−7)I10 based on separate measurements in
unit-normalized image data. Lastly, we modeled κ ∼ unif(0.9, 1.1) to account for 10% transmit
ﬁeld variation (simulations demonstrate good performance even with 20% transmit ﬁeld variation).
We constrained our search space P to reﬂect hardware, safety, and model-accuracy limitations
and to avoid undesirably long acquisitions. To control RF energy deposition, we restricted DESS
ﬂip angles to range between 1◦ and 60◦. We further restricted SPGR ﬂip angles to be between 1◦
and 40◦ to avoid excessive model mismatch due to partial spoiling effects [23]. To comply with
other ﬁxed pulse sequence timing requirements, we required DESS and SPGR repetition times to
be no less than 17.5ms and 11.8ms respectively. We constrained each pair of DESS defocusing-
and refocusing-echo datasets to be assigned the same ﬂip angle and repetition time. Lastly, we
D
d=1 TR,d ≤ 108ms that ensured all
imposed a somewhat ambitious total scan time constraint
feasible points described acquisitions at least as fast as the state-of-the-art SS acquisition proposed
in [18]. These constraints together deﬁned a convex search space over which we optimized ¯Ψ.

P

We separately optimized (8) for each of the 25 candidate SPGR/DESS scan combinations that
are feasible under the above time constraint and also produce at least 6 measurements (necessary
for well-conditioned estimation). For a candidate combination containing D datasets, we sepa-
rately solved (7) with 200D initializations selected uniformly randomly within the feasible set.
For each combination and each initialization, we solved (7) using the built-in MATLAB R(cid:13) function
fmincon with the active-set algorithm, a maximum of 500 iterations, and otherwise default
options. We performed scan optimization running MATLAB R(cid:13) R2017a with a pool of 12 workers
on two Xeon-X5650 2.67GHz hexa-core CPUs.

Table 1 summarizes the optimized scan parameter

P that locally minimizes (8) over all combi-

nations and all initializations. We ﬁnd that

the acquisition deﬁned by
unbiased fF estimates from non-exchanging two-compartment signal models.

b

P) = 0.425, meaning that at a realistic noise level,
P is expected to yield 42.5% coefﬁcient of variation in asymptotically

q

b

¯Ψ(

b

7

Optimized ﬂip angles (deg) Optimized repetition times (ms)

SPGR
DESS

–
T
[33.0, 18.3, 15.1]

–
T
[17.5, 30.2, 60.3]

P, a scan parameter matrix
Table 1: SPGR/DESS ﬂip angles and repetition times that comprise
D
d=1 TR,d ≤ 108ms for precise fF estimation in WM. For our
designed under total time budget
noise variance measurements, this acquisition is expected to yield 42.5% coefﬁcient of variation
in asymptotically unbiased fF estimates from two-compartment signal models. Interestingly, the
optimized scan combination consists only of DESS scans.

P

b

3.2 Simulation Studies

We simulated data to arise from two non-exchanging water compartments with different fast
T2,F ← 20ms and slow T2,S ← 80ms transverse relaxation time constants (selected based on [6,18])
but the same bulk longitudinal relaxation time constant T1 ← 832ms in WM and T1 ← 1331ms
in GM (selected based on [42]). With this two-compartment ground truth, MWF fM and fast-
relaxing fraction fF are equivalent, so their estimates are statistically comparable. (§S-II.B de-
scribes a more realistic three-compartment study where fM and fF are no longer equivalent.) We
assigned fM ≡ fF ← 0.15 in WM and fM ≡ fF ← 0.03 in GM and constrained corresponding
slow-compartment fractions as 1−fF. We prescribed these parameter values to the 81st slice of the
BrainWeb digital phantom [43] to produce 217 × 181 ground truth parameter maps. We generated
κ to model 20% ﬂip angle spatial variation. Using extended phase graphs to model stimulated echo
signal contributions due to non-ideal refocusing, we simulated noiseless single-coil 32-echo MESE
image data with nominal 90◦ excitation and nominal 180◦ refocusing ﬂip angles; TE ← 10ms echo
interval spacing; TR ← 600ms repetition time; and two cycles of gradient dephasing before and
after each refocusing pulse. We corrupted noiseless MESE images with additive complex Gaussian
noise to yield noisy complex datasets with SNR ranging from 17-868 in WM and 15-697 in GM,
where SNR is deﬁned

SNR(

y,

ǫ) := k

yk2/k

ǫk2

(9)

for image data voxels
image.

y and noise voxels

ǫ corresponding to a region of interest (ROI) within one
e

e

e

e

e

Using non-exchanging two-compartment models (1)-(2), we also simulated noiseless single-
coil DESS image data using the precision-optimized nominal ﬂip angles and repetition times pre-
sented in Table 1 and ﬁxed symmetric defocusing and refocusing echo times TE ← 5.29ms. We
corrupted noiseless DESS images with additive complex Gaussian noise to yield noisy complex
datasets with SNR ranging from 22-222 in WM and 25-242 in GM, where SNR is computed via
(9).

e

We performed simulations and experiments running MATLAB R(cid:13) R2013a on a 3.5GHz desktop
computer with 32GB RAM. We estimated fM from noisy magnitude MESE images and known
T1, κ maps by solving NNLS (S1) and RNNLS (S2) problems as explained in §S-I.B. We esti-
mated fF from noisy magnitude DESS images and known κ maps as detailed in §S-I.A. NNLS and
RNNLS respectively took 40.3s and 49.6s. PERK training and testing respectively took 33.8s and
1.0s.

8

3.3 In vivo Studies

We acquired all datasets using the TOPPE pulse sequence prototyping environment [44] on a GE
DiscoveryTM MR750 3.0T scanner with a 32-channel Nova Medical R(cid:13) receive head array.
In a
single scan session involving a healthy volunteer, we collected the optimized DESS acquisition
described in §3.1; a MESE acquisition for validation; an SPGR acquisition for separate bulk T1 es-
timation; and a Bloch-Siegert (BS) acquisition for separate κ estimation. Each of these acquisitions
is described next in turn.

We acquired DESS data by prescribing the optimized nominal ﬂip angles and repetition times
presented in Table 1 and holding all other scan parameters ﬁxed across DESS scans. For excitation,
all acquisitions in this work used a 9.0mm slab-selective Shinnar-Le Roux (SLR) pulse [45] of
duration 3.0ms and time-bandwidth product 6. We interleaved RF excitations with 2 gradient
dephasing phase cycles over a 3mm slice thickness to distinguish the DESS echoes. We acquired
DESS data with a 200 × 200 × 8 matrix over a 240 × 240 × 24mm3 ﬁeld of view (FOV). Using a
31.25kHz readout bandwidth, we acquired 3D axial DESS data at minimum TE ← 5.29ms before
and after RF excitations. To avoid slice-proﬁle effects, we sampled k-space over a 3D Cartesian
grid. Including time to reach steady-state, the optimized DESS acquisition took 3m15s scan time.
We acquired MESE data with a 90◦ nominal excitation ﬂip angle, achieved by scaling the same
SLR pulse shape as above. A sequence of 32 identical nominally 180◦ refocusing pulses succeeded
each excitation, where the time between excitation and ﬁrst refocusing pulse peaks was ﬁxed to the
minimum possible TE
2 ← 4.6ms and subsequent refocusing pulse peaks were separated by echo
spacing TE ← 9.2ms. We designed each refocusing pulse as a 21.0mm slab-selective SLR pulse of
duration 2.0ms and time-bandwidth product 2. We elected to use shaped refocusing pulses instead
of shorter hard pulses to suppress unwanted signal outside the excitation slab due to imperfect
refocusing. To suppress stimulated echo signal contributions, we ﬂanked each refocusing pulse
with a symmetric gradient crusher pair, where each crusher imparted 14 phase cycles across the
21.0mm refocusing slab. Immediately following the refocusing pulse train, we imparted 8 gradient
dephasing phase cycles over a 3mm slice thickness to suppress residual transverse magnetization.
To reduce scan time, we used a repetition time TR ← 600ms that is shorter than those used in
recent works (e.g., [13, 20]) and used separate bulk T1 estimates (from the SPGR scans described
next) to account for incomplete recovery. We acquired 3D MESE data over the same imaging
volume and with the same resolution, readout bandwidth, and k-space trajectory as was used for
the DESS acquisition. We repeated the MESE scan twice to permit averaging in postprocessing for
increased SNR. Including three prepended repetitions to approach steady-state, each MESE scan
took 16m2s for a total MESE acquisition time of 32m4s.

We acquired SPGR data for separate bulk T1 estimation, for the sole purpose of aiding MESE
MWF estimation. We varied nominal ﬂip angles from 5◦ to 45◦ with 5◦ increments and ﬁxed all
other scan parameters across scans. We acquired 3D data at minimal echo time TE ← 5.1ms and
repetition time TR ← 13.1ms over the same imaging volume and with the same resolution, readout
bandwidth, and k-space trajectory as was used in the DESS acquisition. We implemented RF
spoiling by imparting 8 gradient dephasing phase cycles over a 3mm slice thickness immediately
following each readout and by RF phase cycling with a 117◦ linear RF phase increment [23].
Including time to reach steady-state, the SPGR acquisition took 3m32s scan time.

We acquired a pair of BS-shifted SPGR scans [40] for separate ﬂip angle scaling κ estimation.
We modiﬁed the 3D SPGR sequence just described by inserting a ±4kHz off-resonant Fermi pulse

9

(of 9.0ms duration and with 0.05G peak amplitude) immediately following on-resonant excitation
and immediately prior to readout. This extended the echo time to TE ← 15.0ms. We also con-
servatively extended the repetition time to TR ← 300ms to prevent excess RF heating. We used a
small 5◦ nominal excitation ﬂip angle for reduced contrast in BS images and thereby smoother κ
estimates. We acquired BS data with a reduced 200 × 50 × 8 matrix. All other scan parameters
were the same as for the SPGR acquisition. Including time to reach steady-state, the BS acquisition
took 4m30s scan time.

We reconstructed all raw coil images via 3D Fourier transform and subsequently processed
only one image slice centered within the excitation slab. We upsampled BS coil images along
the phase-encoding direction to the same image size as other coil images, using zero-padding
to suppress ringing. We jointly coil-combined all coil images using an extension of JSENSE
[46] for multiple datasets. We estimated ﬂip angle spatial variation κ maps by normalizing and
calibrating regularized transmit ﬁeld estimates [41] from complex coil-combined BS images. We
estimated bulk T1 maps from magnitude coil-combined SPGR images and κ maps using variable
projection method [47] and a one-dimensional grid search over 1000 logarithmically-spaced T1
samples between 10ms and 3000ms. To address bulk motion between acquisitions, we rigidly
registered coil-combined MESE and DESS images as well as κ, T1 maps to one coil-combined
MESE ﬁrst-echo image. After registration, we averaged MESE images voxel-by-voxel across scan
repetitions to increase effective SNR. We estimated fM from magnitude averaged MESE images
and κ, T1 maps by solving NNLS (S1) and RNNLS (S2) problems as explained in §S-I.B. We
estimated fF from magnitude DESS images and κ maps by applying PERK as explained in §S-I.A.
NNLS and RNNLS respectively took 47.2s and 115.4s. PERK training and testing respectively
took 35.6s and 0.9s.

3.4 Ex vivo Studies

Ex vivo experiments used a sample from the post-mortem brain of an 81-year-old male with a
clinical history of amyotrophic lateral sclerosis (ALS). The brain was ﬁxed in 10% neutral-buffered
formalin hours after extraction and was sectioned after two weeks of ﬁxation. We prepared an
imaging phantom by submerging a ∼1cm-thick sample from the prefrontal cortex in a viscous
perﬂuropolyether solution (Fomblin Y LVAC 25/6, California Vacuum Technology, Fremont, CA)
that does not produce signiﬁcant MR signal and has been used in other studies (e.g., [48, 49]). To
maintain complete immersion and to reduce gradient-induced motion, we anchored the sample at
three suture sites to our glass container using nylon thread (marked in Fig. 3). We waited several
hours after phantom preparation and before scanning to allow the phantom to equilibrate to scan
room temperature.

Similar to in vivo experiments, we acquired DESS, MESE, SPGR, and BS data in a single scan
session. We averaged over four MESE scan repetitions and extended MESE repetition interval
TR ← 1000ms to further increase effective MESE SNR. We reduced BS repetition interval TR ←
70.4ms since RF heating is of reduced concern here. For all four acquisitions, we collected k-space
data over a reduced 200×120×8 grid and reconstructed images onto a smaller 120×120×24 mm3
FOV. To accommodate elevated apparent MWF and shorter myelin water T2 after formalin ﬁxation
[50], we trained PERK using modiﬁed fF, T2,F, T2,S marginal distributions pfF ← unif(−0.1, 0.7),
pT2,F ← logunif(10, 30)ms, and pT2,S ← logunif(30, 300)ms. All other data acquisition, image
reconstruction, and parameter estimation details were unchanged from in vivo experiments. Each

10

Truth

MESE−NNLS

MESE−RNNLS

DESS−PERK

 

 

 

0.3

0.24

0.18

0.12

0.06

0.3

0.24

0.18

0.12

0.06

F
W
M

 

 

r
o
r
r

E

 
.
g
a
M
F
W
M

 

Figure 1: MESE NNLS/RNNLS fM estimates and DESS PERK fF estimates alongside corre-
sponding magnitude error images, in a two-compartment simulation. Voxels not assigned WM- or
GM-like compartmental fractions are masked out in post-processing for display. Table 2 presents
corresponding sample statistics.

MESE repetition took 16m3s for a total MESE acquisition time of 64m12s. DESS, SPGR, BS
acquisitions respectively took 1m57s, 2m7s, and 2m32s. NNLS and RNNLS respectively took
28.0s and 34.8s. PERK training and testing respectively took 35.8s and 0.2s.

4 Results

This section demonstrates myelin water imaging using our precision-optimized DESS acquisition
(cf. §2.2, 3.1) and fast PERK estimation (cf. §2.3, S-I.A). §4.1, §4.2, and §4.3 compare DESS
PERK fF estimates to conventional MESE NNLS/RNNLS fM estimates from the simulation, in
vivo, and ex vivo studies respectively described in §3.2, §3.3, and §3.4.

4.1 Simulation Studies

Fig. 1 compares MESE NNLS/RNNLS fM and DESS PERK fF estimates alongside magnitude
difference images with respect to the ground truth fM ≡ fF map. Unlike the DESS fF estimate,
both fM estimates visibly exhibit systematic error due to ﬂip angle spatial variation despite perfect

11

True fM ≡ fF

MESE-NNLS
MESE-RNNLS
DESS-PERK

WM
0.15
fM 0.1375 ± 0.0187 (0.0225)
fM 0.1285 ± 0.0146 (0.0260)
b
0.1352 ± 0.0267 (0.0305)
fF
b
b

GM
0.03
0.0203 ± 0.01296 (0.0162)
0.00207 ± 0.00524 (0.02841)
0.0436 ± 0.0267 (0.0299)

Table 2: Sample means ± sample standard deviations (RMSEs) of MESE NNLS/RNNLS fM
estimates and DESS PERK fF estimates in a two-compartment simulation. Sample statistics are
computed over 7810 WM-like and 9162 GM-like voxels. Each sample statistic is rounded off to
the highest place value of its (unreported) standard error, computed via formulas in [51]. Fig. 1
presents corresponding images.

knowledge of κ; this apparent MESE sensitivity to transmit ﬁeld variation increases in the presence
of realistic model mismatch (see §S-II.B).

Table 2 compares sample statistics of MESE NNLS/RNNLS fM estimates and DESS PERK
fF estimates, computed over 7810 WM-like and 9162 GM-like voxels. Except for the MESE-
RNNLS GM fM estimate, all estimates agree with true values to within one standard deviation.
The MESE-NNLS WM and GM fF estimates achieve the least root mean-squared errors (RMSEs)
overall. The RNNLS fM estimate is more precise but less accurate than the NNLS fM estimate
due to regularization. To better assess whether PERK is suitable for DESS fF estimation, §S-II.A
extends this simulation by adding conventional grid search fF estimation (that is practical only in
simulation).

4.2 In vivo Studies

Fig. 2 compares NNLS and RNNLS fM estimates from MESE scans as well as PERK fF estimates
from optimized DESS scans. PERK fF estimates exhibit less WM variation and more clearly
delineate cortical WM/GM boundaries than MESE fM estimates. RNNLS fM estimates are visibly
lower than NNLS fM estimates due to regularization but exhibit reduced WM variation, somewhat
improving visualization of WM tracts. RNNLS fM and PERK fF estimates appear visually similar
in lateral WM regions, but both NNLS and RNNLS fM estimates are elevated in medial regions.
Elevated MESE
fM estimates in internal capsules (IC) have been attributed to overlapping myelin
water and cellular water T2 peaks in MESE T2 spectrum estimates [20]. We additionally observe
that MESE fM estimates exhibit similar spatial variation here versus in simulations (cf. Figs. S1-
S2) suggesting that some spatial variation in MESE fM estimates may be attributable in part to ﬂip
angle variation, despite compensation for transmit ﬁeld inhomogeneity.

b

Table 3 summarizes sample statistics of NNLS/RNNLS fM estimates from MESE scans and
PERK fF estimates from optimized DESS scans, separately computed over four lateral WM ROIs
containing 90, 79, 182, and 201 voxels; one pooled medial IC WM ROI containing 347 voxels; and
one pooled anterior cortical (AC) GM ROI containing 78 voxels. PERK fF estimates exhibit the
lowest variation within WM ROIs and the most similar sample means across WM ROIs. NNLS
and RNNLS fM sample means are signiﬁcantly higher in the IC WM ROI than in lateral WM
ROIs, possibly due to overlap in NNLS T2 spectrum peaks and/or to ﬂip angle spatial variation (as
described in the previous paragraph). It is challenging to assess quantitative comparability between

12

MESE−NNLS

 
MESE−RNNLS

DESS−PERK

 

0.3

0.24

0.18

0.12

0.06

 

F
W
M

 

Figure 2: Representative NNLS and RNNLS fM estimates from a MESE acquisition alongside a
PERK fF estimate from a precision-optimized DESS acquisition, in the brain of a healthy volun-
teer. Using similar signal reception imaging parameters, MESE fM estimates took 40m6s total scan
time (averaging over two MESE scan repetitions) while DESS fF estimates took 7m45s total scan
time. PERK fF estimates exhibit less WM variation and more clearly delineate cortical WM/GM
boundaries than MESE fM estimates. Table 3 presents corresponding sample statistics computed
over manually selected WM and GM ROIs.

R

L

MESE-NNLS

fM MESE-RNNLS

fM DESS-PERK

ROI
AR WM
AL WM
PR WM
PL WM
IC WM
AC GM

0.081 ± 0.091
0.068 ± 0.086
b
0.049 ± 0.075
0.118 ± 0.095
0.208 ± 0.133
0.005 ± 0.020

0.074 ± 0.054
0.054 ± 0.041
b
0.043 ± 0.041
0.075 ± 0.050
0.177 ± 0.083
0.009 ± 0.017

fF
0.117 ± 0.019
0.100 ± 0.0119
b
0.093 ± 0.019
0.0870 ± 0.0114
0.111 ± 0.0241
0.019 ± 0.045

 
A

P

Table 3: Left: WM/GM ROIs, overlaid on a representative MESE ﬁrst-echo image. Separate lateral
WM ROIs are distinguished by anterior-right (AR), anterior-left (AL), posterior-right (PR), and
posterior-left (PL) directions and are respectively comprised of 90, 79, 182, and 201 voxels. Two
internal capsule (IC) polygons are pooled into a single medial WM ROI comprised of 347 voxels.
Three small anterior cortical (AC) GM polygons are pooled into a single GM ROI comprised of
78 voxels. Right: Sample means ± sample standard deviations of NNLS/RNNLS fM estimates
from a MESE acquisition as well as PERK fF estimates from an optimized DESS acquisition,
computed over WM/GM ROIs. Each sample statistic is rounded off to the highest place value
of its (unreported) standard error, computed via formulas in [51]. Fig. 2 presents corresponding
images.

DESS fF and MESE fM ROI sample means due to high within-ROI variation in MESE estimates,
though PERK WM fF sample means agree reasonably with several other methods (e.g., see [15]
fF estimators measured signiﬁcant myelin
fM nor PERK
for a review). Neither the NNLS/RNNLS

b

13

b

MESE−NNLS

 
MESE−RNNLS

DESS−PERK

 

0.7

F
W
M

 

 

0.56

0.42

0.28

0.14

0

Figure 3: NNLS and RNNLS fM estimates from a MESE acquisition alongside a PERK fF esti-
mate in a formalin-ﬁxed sample from the prefrontal cortex of an ALS patient about three weeks
after death. Using similar signal reception imaging parameters, MWF fM estimates took 68m51s
total scan time (averaging over four MESE scan repetitions) while DESS fF estimates took 4m29s
total scan time. Green arrows indicate three suture sites used to anchor and stabilize the sample.
Warping of the ∼1cm-thick sample caused partial-volume effects in the anterior-left and posterior
regions (clearly apparent in the anatomical MESE image within Table 4). Away from these regions,
MESE fM and DESS fF estimates exhibit similar spatial variation and are in reasonable agreement
in WM and near WM/GM boundaries. Table 4 presents corresponding sample statistics computed
over manually selected WM and GM ROIs.

water content in AC GM.

4.3 Ex vivo Studies

Fig. 3 compares NNLS and RNNLS fM estimates from MESE scans as well as PERK fF es-
timates from optimized DESS scans. All estimates are higher than corresponding in vivo esti-
mates, likely due to formalin ﬁxation [50]. Green arrows mark three suture sites. Warping of the
∼1cm-thick sample caused partial-volume effects in anterior-left and posterior regions of this re-
constructed slice (see shading in the MESE image within Table 4; adjacent slices contained larger
affected regions). Away from suture sites and partial-volume affected regions, MESE fM and
DESS fF estimates exhibit similar spatial variation and are in reasonable agreement in WM and
near WM/GM boundaries. In GM, DESS fF estimates appear higher than MESE fM estimates,
likely because PERK is here being trained with a sampling distribution support much broader than
the prior distribution over which DESS was designed to enable precise fF estimation. In partic-
ular, ex vivo training marginal pfF ← (−0.1, 0.7) is much broader than acquisition design prior
fF ∼ unif(0.03, 0.21). Narrowing pfF to the in vivo range improves agreement across fF and fM
estimators in ex vivo GM, but degrades PERK performance in ex vivo WM since PERK is then
extrapolating well beyond its training distribution.

Table 4 summarizes sample statistics of NNLS/RNNLS fM estimates from MESE scans and
PERK fF estimates from optimized DESS scans, computed over manually-selected WM and GM
ROIs respectively containing 143 and 73 voxels. Within both ROIs, PERK fF estimates exhibit

14

R

L

ROI MESE-NNLS
WM
GM

0.366 ± 0.113
0.08 ± 0.102
b

fM MESE-RNNLS

fM DESS-PERK

0.426 ± 0.061
0.20 ± 0.14
b

fF
0.420 ± 0.029
0.225 ± 0.075
b

 
A

P

Table 4: Left: WM/GM ROIs, overlaid on a representative MESE twelfth-echo image. The WM
ROI consists of two manually-selected polygons pooled into a single ROI consisting of 143 voxels.
The GM ROI consists of four manually-selected polygons pooled into a single ROI consisting of
73 voxels. Right: Sample means ± sample standard deviations of NNLS/RNNLS fM estimates
from a MESE acquisition as well as PERK fF estimates from an optimized DESS acquisition,
computed over WM/GM ROIs. Each sample statistic is rounded off to the highest place value
of its (unreported) standard error, computed via formulas in [51]. Fig. 3 presents corresponding
images. Within the WM ROI, MESE fM and DESS fF estimates are quantitatively comparable.

the lowest variation. Within the WM ROI, MESE fM and DESS fF estimates are quantitatively
comparable. Though RNNLS fM and PERK fF sample means are similar in GM, it is challenging
to quantitatively compare fM and fF estimates in GM due to high within-ROI variation in MESE
estimates.

5 Discussion

Simulations and experiments demonstrate the feasibility of myelin water content quantiﬁcation
using a precision-optimized DESS MR acquisition and fast machine learning with kernels (PERK).
Simulations show that DESS PERK fF estimators and conventional MESE fM estimators achieve
comparable RMSE in WM- and GM-like voxels. In vivo and ex vivo experiments demonstrate that
MESE fM and DESS fF estimates are quantitatively comparable measures of WM myelin water
content. To our knowledge, these experiments are the ﬁrst to demonstrate myelin water images
from a SS acquisition that are quantitatively similar to conventional MESE MWF images.

Despite freedom to design arbitrary combinations of SPGR and DESS scans, the optimized
acquisition used here, as well as several other unreported acquisitions designed under different
total time constraints, ended up consisting either entirely or mostly of DESS scans. Since the two-
compartment SPGR signal models used in acquisition design depend on T1,F, T1,S but not T2,F, T2,S,
DESS-dominated scan designs suggest that multi-compartmental T2 effects give rise to fF sensi-
tivity in SS sequences more so than multi-compartmental T1 effects. Perhaps surprisingly, reported
and unreported precision-optimized acquisitions also exhibit substantial TR diversity across scans,
even at the expense of fewer scans than possible under time constraints. In further unreported stud-
ies, we investigated this phenomenon by repeating scan optimization while implicitly constraining
repetition times to be minimal. We consistently observed substantial (∼10-20%) degradation in
expected fF coefﬁcient of variation, suggesting that TR diversity (in addition to ﬂip angle diversity)
is important for designing acquisitions that enable precise fF estimation.

Our experiments used non-exchanging SPGR and DESS signal models so as to work with
closed-form signal models and gradients during acquisition design and to keep consistent with

15

standard MESE model assumptions. There is growing evidence however that some signiﬁcant
physical exchange across the myelin bilayers likely persists in cerebral WM (e.g., see [16] for a
recent review). A thorough investigation of the sensitivity of DESS fF or MESE fM estimates to
realistic physical exchange rates is a topic for further research.

Even with high SNR, differences in model assumptions, cost functions, and estimation algo-
rithms may limit the quantitative comparability of DESS fF and MESE fM imaging as imple-
mented here. For more similar model assumptions, one could attempt to estimate from a suitably
optimized DESS acquisition a T2 (or joint (T1, T2)) distribution using two-compartment, three-
compartment, or higher-compartment models and correspondingly estimate from MESE data a
more coarsely sampled T2 (or joint (T1, T2)) distribution.
If κ, T1 maps are known and non-
exchanging additive models are employed, one could estimate T2 distributions from both MESE
and DESS data using NNLS or RNNLS objective functions. With milder model assumptions that
cause signal models to be nonlinear in unknowns, one could instead estimate distributions using
PERK. This work focused on demonstrating the feasibility of myelin water content quantiﬁcation
using a simple two-compartment model of a fast DESS acquisition; estimating more unknowns
from more complicated models will necessitate more scans but could be an interesting area for
further research.

6 Conclusion

This paper has introduced a new method for precise myelin water content quantiﬁcation based on a
fast SS acquisition and PERK [28], a fast, scalable machine learning algorithm for MRI parameter
estimation. The acquisition consists of three DESS scans whose ﬂip angles and repetition times
were optimized under a competitive time constraint to enable precise estimation of the faster-
relaxing signal fraction fF in a two-compartment DESS signal model. Simulations demonstrated
that DESS PERK fF estimators and conventional MESE fM estimators achieve comparable RMSE
in WM- and GM-like voxels. In vivo and ex vivo experiments demonstrated that MESE fM and
DESS PERK fF estimates are quantitatively comparable measures of WM myelin water content.
To our knowledge, these experiments are the ﬁrst to demonstrate myelin water images from a SS
acquisition that are quantitatively similar to conventional MESE MWF images.

Acknowledgments

We thank Roger Albin for initial discussions about neurodegenerative applications, Clay Scott for
several discussions about kernel learning, Marina Epelman for a discussion about global optimiza-
tion for scan design, and Scott Swanson for several discussions about myelin. We also thank the
University of Michigan Brain Bank for providing the brain tissue used in ex vivo studies and Tyler
Cork for suggesting Fomblin to prepare our ex vivo phantom.

16

Appendix

Gradient of Bayesian Scan Design Cost

Acquisition design cost ¯Ψ is non-convex but typically differentiable in acquisition parameter matrix
P. Here we construct the gradient matrix ∇P ¯Ψ(P) ∈ RA×D and provide sufﬁcient conditions for
when this gradient matrix exists. Our strategy involves ﬁrst constructing ∇PΨ(x, ν, P) element-
wise for ﬁxed x, ν and then relating ∇P ¯Ψ(P) to ∇PΨ(x, ν, P). Let
be the (a, d)th element
of matrix operator ∇P. By standard matrix derivative identities, we have

∂
∂pa,d

∂
∂pa,d

Ψ(x, ν, P) ≡

tr

WF−1(x, ν, P)W

∂
∂pa,d

(cid:0)

(cid:18)

= − tr

WF−1(x, ν, P)

(cid:1)
(F(x, ν, P))F−1(x, ν, P)W

∂
∂pa,d

(10)

.
(cid:19)

If elements of measurement vector y are assumed to be independent as is typical, Σ takes the form
Σ ← diag

[σ2

and

T
1, . . . , σ2
D]

(cid:16)

∂
∂pa,d

(cid:17)
(F(x, ν, P)) =

∂
∂pa,d

D

1
σ2
d′

=

1
σ2
d

Xd′=1
∂
∂pa,d

(cid:16)

(∇xsd′(x, ν, pd′))

∇xsd′(x, ν, pd′)

H

(∇xsd(x, ν, pd))

∇xsd(x, ν, pd)

,

H

(11)

(cid:17)

where diag(·) assigns its argument to the diagonal entries of an otherwise zero matrix; and sd and
pd respectively denote dth entry of s and the dth column of P. Substituting (5) and (11) into (10)
gives expressions in terms of signal model derivatives for each element of ∇PΨ(x, ν, P). These
expressions are well-deﬁned if F is invertible and if mixed partial derivatives ∇p1(∇xs1)
exist and are continuous in x, P, where (·)
remains bounded for all x, ν,

denotes transpose. Further assuming that ∇PΨ(x, ν, P)

T

T

, . . . , ∇pD(∇xsD)

T

∇P ¯Ψ(P) ≡ ∇PEx,ν(Ψ(x, ν, P))
= Ex,ν(∇PΨ(x, ν, P)),

(12)

which provides an expression for the gradient of the expected cost, as desired.

Brief Review of PERK

PERK learns a nonlinear estimator from simulated labeled training points. PERK ﬁrst samples
a prior joint distribution on x, ν and evaluates signal model (4) N times (with previously opti-
mized and now ﬁxed acquisition parameter P∗) to generate sets of parameter and noise realizations
{x1, ν1, ǫ1}, . . . , {xN , νN , ǫN } and corresponding measurements {y1, . . . , yN }. PERK then seeks
x(·) : RQ 7→ RL that maps each regres-
to learn from these samples a suitable regression function

T

, νT
n

T
|yn|
h

sor qn :=
x(qn) that is “close” to corresponding regressand xn, where
Q := D+K and n ∈ {1, . . . , N}. This supervised learning problem is subject to an inherent trade-
off between training complexity and estimator accuracy. At one extreme, restricting the estimator

to an estimate

b

i

b

17

aT(·) +

x(·) ←

b (i.e., afﬁne regression) typically corresponds to well-posed
to the afﬁne form
training problem, but an afﬁne estimator is unlikely to be useful when the signal model is nonlin-
ear in x. At the other extreme, attempting to learn an overly ﬂexible estimator may fail because
many candidate regression functions ﬁt any ﬁnite N training points with zero training error. PERK
b,
balances between these extremes by learning an estimator
where k : R2Q 7→ R is a (typically nonlinear) reproducing kernel function [52]. Speciﬁcally, the
PERK estimator reads
b

a k(·, qn) +

x of form

x(·) ←

N
n=1

P

b

b

b

b

b

b

x(·) ← X

1N + M(MKM + NρIN )−1k(·)

,

(13)

(cid:19)

1
N

(cid:18)

b

N 1N 1T

where X := [x1, . . . , xN ] collects the regressands; 1N ∈ RN denotes a vector of ones; M :=
IN − 1
N denotes a de-meaning operator; IN ∈ RN ×N denotes an identity matrix; Gram
matrix K ∈ RN ×N consists of entries k(qn, qn′) for n, n′ ∈ {1, . . . , N}; ρ > 0 is a regularization
T
N K1N : RQ 7→ RN is a (typically nonlinear)
parameter; and k(·) := [k(·, q1), . . . , k(·, qN )]
kernel embedding operator.

− 1

PERK estimator (13) is the uniquely and globally optimal regression function within a certain
function space whose richness is determined by the choice of kernel, and for good PERK accuracy
it is desirable for this function space to be sufﬁciently diverse. As in [28], we use Gaussian kernel

(14)

k(q, q′) ← exp

−

kq − q′k

1
2

2
Λ−2

,
(cid:19)

(cid:18)
where Λ ∈ RQ×Q denotes a positive deﬁnite bandwidth matrix (that can be selected in a data-
denotes a weighted ℓ2 norm for positive semideﬁnite Γ.
driven manner [28]) and k·kΓ ≡
For this kernel choice, PERK can approximate L2 functions to arbitrary accuracy for N sufﬁciently
large [53].

Γ1/2(·)

(cid:13)
(cid:13)

(cid:13)
(cid:13)

More challenging applications typically require larger numbers of training samples N, which
complicates direct use of PERK estimator (13) due its dependence on dense N ×N Gram matrix K.
Fortunately, Gaussian kernel (14) admits an approximation k(q, q′) ≈ z(q)
z(q′) ∀q, q′ [54] that
enables constructing Z := [z(q1), . . . , z(qN )] ∈ RZ×N such that ZTZ ≈ K for Z ≪ N, where
z : RQ 7→ RZ denotes an approximate nonlinear feature map that admits very fast implementation
[28]. Substituting low-rank approximation ZTZ in place of K in (13) and applying the matrix
inversion lemma [55] yields approximate PERK estimator

T

x(·) ← mx + Cxz(Czz + ρIZ)−1(z(·) − mz),

(15)

N X1N and mz := 1
b

N XMZT and Czz :=
where mx := 1
N ZMZT are sample covariances. Estimator (15) elucidates that Gaussian PERK is approximately
1
equivalent to ﬁrst nonlinearly transforming regressors q1, . . . , qN into features z(q1), . . . , z(qN )
and then performing regularized afﬁne regression with these (typically higher-dimensional) fea-
tures; this approximation approaches equality asymptotically in Z.

N Z1N are sample means; and Cxz := 1

18

References

[1] P. Morell. Myelin. Springer, 1984.

[2] M. M. Goldenberg. Multiple sclerosis review. Pharmacy and Therapeutics, 37(3):175–84,

March 2012.

[3] V. Vasilescu, E. Katona, V. Simplaceanu, and D. Demco. Water compartments in the myeli-

nated nerve. III. Pulsed NMR results. Experientia, 34(11):1443–4, November 1978.

[4] R. S. Menon and P. S. Allen. Application of continuous relaxation time distributions to the
ﬁtting of data from model systems and excised tissue. Mag. Res. Med., 20(2):214–27, August
1991.

[5] W. A. Stewart, A. L. Mackay, K. P. Whittall, G. R. W. Moore, and D. W. Paty. Spin-spin
relaxation in experimental allergic encephalomyelitis. Analysis of CPMG data using a non-
linear least-squares method and linear inverse theory. Mag. Res. Med., 29(6):767–75, June
1993.

[6] A. Mackay, K. Whittall, J. Adler, D. Li, D. Paty, and D. Graeb. In vivo visualization of myelin

water in brain by magnetic resonance. Mag. Res. Med., 31(6):673–7, June 1994.

[7] P. J. Gareau, B. K. Rutt, S. J. Karlik, and J. R. Mitchell. Magnetization transfer and multi-
component T2 relaxation measurements with histopathologic correlation in an experimental
model of MS. J. Mag. Res. Im., 11(6):586–95, June 2000.

[8] S. Webb, C. A. Munro, R. Midha, and G. J. Stanisz. Is multicomponent T2 a good measure

of myelin content in peripheral nerve? Mag. Res. Med., 49(4):628–45, April 2003.

[9] C. Laule, I. M. Vavasour, G. R. W. Moore, J. Oger, D. K. B. Li, D. W. Paty, and A. L. MacKay.
Water content and myelin water fraction in multiple sclerosis. J. Neurol., 251(3):284–93,
March 2004.

[10] C. Laule, E. Leung, D. K. B. Li, A. L. Traboulsee, D. W. Paty, A. L. MacKay, and
G. R. W. Moore. Myelin water imaging in multiple sclerosis: quantitative correlations with
histopathology. Multiple Sclerosis J., 12(6):747–53, November 2006.

[11] H. Y. Carr and E. M. Purcell. Effects of diffusion on free precession in nuclear magnetic

resonance experiments. Phys. Rev., 94(3):630–8, May 1954.

[12] M. D. Does and J. C. Gore. Rapid acquisition transverse relaxometric imaging. J. Mag. Res.,

147(1):116–20, November 2000.

[13] T. Prasloski, A. Rauscher, A. L. MacKay, M. Hodgson, I. M. Vavasour, C. Laule, and
B. M¨adler. Rapid whole cerebrum myelin water imaging using a 3D GRASE sequence.
NeuroImage, 63(1):533–9, October 2012.

[14] D. A. Feinberg and K. Oshio. GRASE (gradient- and spin-echo) MR imaging: a new fast

clinical imaging technique. Radiology, 181(2):597–602, November 1991.

19

[15] E. Alonso-Ortiz, I. R. Levesque, and G. B. Pike. MRI-based myelin water imaging: A tech-

nical review. Mag. Res. Med., 73(1):70–81, January 2015.

[16] M. D. Does. Inferring brain tissue composition and microstructure via MR relaxometry. J.

Neuroimag., 2018.

[17] S. C. L. Deoni, B. K. Rutt, T. Arun, C. Pierpaoli, and D. K. Jones. Gleaning multicomponent
T1 and T2 information from steady-state imaging data. Mag. Res. Med., 60(6):1372–87,
December 2008.

[18] S. C. L. Deoni. Correction of main and transmit magnetic ﬁeld (B0 and B1) inhomogeneity
effects in multicomponent-driven equilibrium single-pulse observation of T1 and T2. Mag.
Res. Med., 65(4):1021–35, April 2011.

[19] S. C. L. Deoni, L. Matthews, and S. H. Kolind. One component? Two components? Three?
The effect of including a nonexchanging ”free” water component in multicomponent driven
equilibrium single pulse observation of T1 and T2. Mag. Res. Med., 70(1):147–54, July 2013.

[20] J. Zhang, S. H. Kolind, C. Laule, and A. L. MacKay. Comparison of myelin water fraction
from multiecho T2 decay curve and steady-state methods. Mag. Res. Med., 73(1):223–32,
January 2015.

[21] C. L. Lankford and M. D. Does. On the inherent precision of mcDESPOT. Mag. Res. Med.,

69(1):127–36, January 2013.

[22] G. Nataraj, J-F. Nielsen, and J. A. Fessler. Optimizing MR scan design for model-based T1,
T2 estimation from steady-state sequences. IEEE Trans. Med. Imag., 36(2):467–77, February
2017.

[23] Y. Zur, M. L. Wood, and L. J. Neuringer. Spoiling of transverse magnetization in steady-state

sequences. Mag. Res. Med., 21(2):251–63, October 1991.

[24] T. W. Redpath and R. A. Jones. FADE-A new fast imaging sequence. Mag. Res. Med.,

6(2):224–34, February 1988.

[25] H. Bruder, H. Fischer, R. Graumann, and M. Deimling. A new steady-state imaging sequence
for simultaneous acquisition of two MR images with clearly different contrasts. Mag. Res.
Med., 7(1):35–42, May 1988.

[26] G. Nataraj, J-F. Nielsen, and J. A. Fessler. Dictionary-free MRI parameter estimation via

kernel ridge regression. In Proc. IEEE Intl. Symp. Biomed. Imag., pages 5–9, 2017.

[27] G. Nataraj, J-F. Nielsen, and J. A. Fessler. Myelin water fraction estimation from optimized
steady-state sequences using kernel ridge regression. In Proc. Intl. Soc. Mag. Res. Med., page
5076, 2017.

[28] G. Nataraj, J-F. Nielsen, C. D. Scott, and J. A. Fessler. Dictionary-free MRI PERK: Parameter
estimation via regression with kernels. IEEE Trans. Med. Imag., 37(9):2103–14, September
2018.

20

[29] G. Nataraj. Advances in quantitative MRI: acquisition, estimation, and application. PhD

thesis, Univ. of Michigan, Ann Arbor, MI, 48109-2122, Ann Arbor, MI, 2018.

[30] R. G. Spencer and K. W. Fishbein. Measurement of spin-lattice relaxation times and concen-
trations in systems with chemical exchange using the one-pulse sequence: breakdown of the
Ernst model for partial saturation in nuclear magnetic resonance spectroscopy. J. Mag. Res.,
142(1):120–35, January 2000.

[31] S. C. L. Deoni, B. K. Rutt, and D. K. Jones. Investigating exchange and multicomponent re-
laxation in fully-balanced steady-state free precession imaging. J. Mag. Res. Im., 27(6):1421–
9, June 2008.

[32] R. D. Gill and B. Y. Levit. Applications of the van Trees inequality: A Bayesian Cram´er-rao

bound. Bernoulli, 1(1/2):59–79, 1995.

[33] M. Akcakaya, S. Weingartner, Sebastien Roujol, and R. Nezafat. On the selection of sampling

points for myocardial T1 mapping. Mag. Res. Med., 73(5):1741–53, May 2015.

[34] C. M. Lewis, S. A. Hurley, M. E. Meyerand, and C. G. Koay. Data-driven optimized ﬂip
angle selection for T1 estimation from spoiled gradient echo acquisitions. Mag. Res. Med.,
76(3):792–802, September 2016.

[35] H. Cramer. Mathematical methods of statistics. Princeton Univ. Press, Princeton, 1946.

[36] P. Virtue, S. X. Yu, and M. Lustig. Better than real: Complex-valued neural nets for MRI

ﬁngerprinting. In Proc. IEEE Intl. Conf. on Image Processing, pages 3953–7, 2017.

[37] O. Cohen, B. Zhu, and M. S. Rosen. MR ﬁngerprinting Deep RecOnstruction NEtwork

(DRONE). Mag. Res. Med., 80(3):885–94, September 2018.

[38] G. Nataraj, M. Gao, J. Asslander, C. Scott, and J. A. Fessler. Shallow learning with kernels
for dictionary-free magnetic resonance ﬁngerprinting. In ISMRM Workshop on MR Finger-
printing, 2017.

[39] H. Gudbjartsson and S. Patz. The Rician distribution of noisy MRI data. Mag. Res. Med.,

34(6):910–4, December 1995.

[40] L. I. Sacolick, F. Wiesinger, I. Hancu, and M. W. Vogel. B1 mapping by Bloch-Siegert shift.

Mag. Res. Med., 63(5):1315–22, May 2010.

[41] H. Sun, W. A. Grissom, and J. A. Fessler. Regularized estimation of Bloch-Siegert B1+ Maps

in MRI. In Proc. IEEE Intl. Conf. on Image Processing, pages 3646–50, 2014.

[42] J. P. Wansapura, S. K. Holland, R. S. Dunn, and W. S. Ball. NMR relaxation times in the

human brain at 3.0 Tesla. J. Mag. Res., 9(4):531–8, April 1999.

[43] D. L. Collins, A. P. Zijdenbos, V. Kollokian, J. G. Sled, N. J. Kabani, C. J. Holmes, and A. C.
Evans. Design and construction of a realistic digital brain phantom. IEEE Trans. Med. Imag.,
17(3):463–8, June 1998.

21

[44] J-F. Nielsen and D. C. Noll. TOPPE: A framework for rapid prototyping of MR pulse se-

quences. Mag. Res. Med., 79(6):3128–34, June 2018.

[45] J. Pauly, P. Le Roux, D. Nishimura, and A. Macovski. Parameter relations for the Shinnar-
Le Roux selective excitation pulse design algorithm. IEEE Trans. Med. Imag., 10(1):53–65,
March 1991.

[46] L. Ying and J. Sheng.

Joint image reconstruction and sensitivity estimation in SENSE

(JSENSE). Mag. Res. Med., 57(6):1196–1202, June 2007.

[47] G. Golub and V. Pereyra. Separable nonlinear least squares: the variable projection method

and its applications. Inverse Prob., 19(2):R1–26, April 2003.

[48] V. V. Itskovich, D. D. Samber, V. Mani, J. G. S. Aguinaldo, J. T. Fallon, C. Y. Tang, V. Fuster,
and Z. A. Fayad. Quantiﬁcation of human atherosclerotic plaques using spatially enhanced
cluster analysis of multicontrast-weighted magnetic resonance images. Mag. Res. Med.,
52(3):515–23, September 2004.

[49] R. Symons, T. E. Cork, M. N. Lakshmanan, R. Evers, C. Davies-Venn, K. A. Rice, M. L.
Thomas, C-Y. Liu, S. Kappler, S. Ulzheimer, V. Sandfort, D. A. Bluemke, and A. Pour-
morteza. Dual-contrast agent photon-counting computed tomography of the heart: initial
experience. Int. J. Cardiovasc. Imaging, 33(8):1253–61, August 2017.

[50] A. S. Shatil, M. N. Uddin, K. M. Matsuda, and C. R. Figley. Quantitative ex vivo MRI
changes due to progressive formalin ﬁxation in whole human brain specimens: longitudinal
characterization of diffusion, relaxometry, and myelin water fraction measurements at 3T.
Frontiers in Medicine, 5(31):1–15, February 2018.

[51] S. Ahn and J. A. Fessler. Standard errors of mean, variance, and standard deviation estimators.
Technical Report 413, Comm. and Sign. Proc. Lab., Dept. of EECS, Univ. of Michigan, Ann
Arbor, MI, 48109-2122, July 2003.

[52] N. Aronszajn. Theory of reproducing kernels. Trans. Amer. Math. Soc., 68(3):337–404, May

1950.

[53] I. Steinwart and A. Christmann. Support vector machines. Springer, 2008.

[54] A. Rahimi and B. Recht. Random features for large-scale kernel machines. In NIPS, 2007.

[55] M. A. Woodbury.

Inverting modiﬁed matrices, 1950. Tech. Report 42, Stat. Res. Group,

Princeton Univ.

[56] G. Nataraj, J-F. Nielsen, M. Gao, and J. A. Fessler. Fast, precise myelin water quantiﬁcation

using DESS MRI and kernel learning, 2018. In preparation.

[57] M. M. Siddiqui. Statistical inference for Rayleigh distributions. RADIO SCIENCE Journal

of Research NBS/USNC-URSI, 68D(9):1005–10, September 1964.

[58] D. Arthur and S. Vassilvitskii. K-means++: The advantages of careful seeding. In Proc. 18th

Annual ACM-SIAM Symp. Disc. Alg. (SODA), pages 1027–35, 2007.

22

[59] C. L. Lawson and R. J. Hanson. Solving least squares problems. Prentice-Hall, 1974.

[60] R. M. Kroeker and R. M. Henkelman. Analysis of biological NMR relaxation data with
continuous distributions of relaxation data. J. Mag. Res., 69(2):218–35, September 1986.

[61] K. P. Whittall and A. L. MacKay. Quantitative interpretation of NMR relaxation data. J. Mag.

Res., 84(1):134–52, August 1989.

[62] T. Prasloski, B. M¨adler, Q-S. Xiang, A. MacKay, and C. Jones. Applications of stimulated
echo correction to multicomponent T2 analysis. Mag. Res. Med., 67(6):1803–14, June 2012.

[63] J. Hennig. Multiecho imaging sequences with low refocusing ﬂip angles. J. Mag. Res.,

88(3):397–407, July 1988.

23

Supporting Information for
Fast, Precise Myelin Water Quantiﬁcation
using DESS MRI and Kernel Learning

Gopal Nataraj⋆, Jon-Fredrik Nielsen†, Mingjie Gao⋆, and Jeffrey A. Fessler⋆
⋆Dept. of Electrical Engineering and Computer Science, University of Michigan
†Dept. of Biomedical Engineering, University of Michigan

This supplement elaborates upon methodology details and presents additional results that were
excluded from the main body of the manuscript [56] due to word limits. §S-I details our imple-
mentations of PERK and three other estimators used in myelin water imaging experiments. §S-II
describes additional simulation studies that investigate reasons for differences between the con-
ventional and proposed myelin water imaging methods. §S-III discusses additional advantages
demonstrated by these extended simulations.

S-I Parameter Estimation Implementation Details

S-I.A DESS fF Estimation

We used data arising from the fast SS scan combination described in Table 1. Since this scan
combination consisted of three DESS scans and each DESS scan generates two signals per exci-
tation, this acquisition yielded D ← 6 datasets. We assumed non-exchanging two-compartment
DESS signal models (1)-(2) and took the same assumptions as in Subsection 3.1 to reduce model
T
dependencies to L ← 6 latent parameters x ← [fF, T1,F, T2,F, T1,S, T2,S, c]
and K ← 1 known
parameter ν ← κ per voxel. We focused on precisely estimating fF in WM from this fast DESS
acquisition. We considered the other ﬁve latent parameters to be nuisance parameters and thus did
not evaluate the performance of their (possibly imprecise) estimators.

In all experiments discussed in the main body, we estimated fF using approximate PERK
estimator (15). We assumed a separable prior distribution px,ν ← pfFpT1,FpT2,FpT1,SpT2,Spcpκ.
We set fast-relaxing fraction marginal distribution pfF ← unif(−0.1, 0.4) and deliberately sam-
ple negative values3 with nonzero probability to reduce fF estimation bias, especially in low-
fF regions. We chose relaxation parameter marginal distributions pT1,F ← logunif(50, 700)ms,
pT2,F ← logunif(5, 50)ms, pT1,S ← logunif(700, 2000)ms, pT2,S ← logunif(50, 300)ms similar to
those used for scan design but with ﬁnite support. To match the scaling of training and testing
data, we set pc ← unif(2.2 × 10−16, u), with u set as 10× the maximum value of magnitude test
data. We estimated ﬂip angle scaling marginal pκ from known κ map voxels via kernel density
estimation (implemented using the built-in MATLAB R(cid:13) function fitdist with default options)

3Our two-compartment signal models are linear in fF and are therefore well-deﬁned for zero or even negative fF

values.

1

T

and then clipped the support of pκ to assign nonzero probability only within [0.5, 2]. We assumed
noise covariance Σ of form σ2I6 and estimated the (spatially invariant) noise variance σ2 from
Rayleigh-distributed regions of magnitude test data, using estimators described in [57]. We sam-
pled N ← 106 latent and known parameter realizations from these distributions and evaluated two-
compartment DESS signal models (1)-(2) to generate corresponding complex noiseless measure-
ments. After adding complex Gaussian noise realizations, we concatenated the (Rician) magnitude
of these noisy measurements with known parameter realizations to construct pure-real regressors.

We used Gaussian kernel (14) with bandwidth matrix Λ selected as Λ ← λ diag
,
(cid:19)
where m|y| ∈ RD and mν ∈ RK denote sample means across voxels of magnitude test image data
and known parameters, respectively. We separately selected and then held ﬁxed bandwidth scaling
parameter λ ← 20.3 and regularization parameter ρ ← 2−19 via the holdout procedure described in
[28]. We implemented a (Z ← 103)-dimensional approximate feature map z. For training, we used
z to nonlinearly lift regressors into features and then stored mx, Cxz(Czz + ρIZ)−1, and mz. For
testing, we evaluated (15) on test image data and the known transmit ﬁeld map on a voxel-by-voxel
basis.

(cid:18)h

i

mT

|y|, mT

ν

In the extended simulation study discussed in §S-II, we compared PERK fF estimates to max-
imum likelihood (ML) fF estimates achieved via the variable projection method (VPM) [47] and
grid search. Following [22, 28], we clustered known ﬂip angle scaling map voxels into 20 clusters
via k-means++ [58] and used each of the cluster means to compute 20 dictionaries. Each of these
dictionaries consisted of nearly 8 × 106 signal vectors computed using ﬁnely spaced samples on an
unrealistically narrow feasible region consisting of a hypercube with boundaries set as [−0.1, 0.4]
in fF and ±20% away from the truth in other latent parameter dimensions. Iterating over clusters,
we generated each cluster’s dictionary and applied VPM and grid search over magnitude image
data voxels assigned to that cluster.

S-I.B MESE fM Estimation

We compared fF estimates from our optimized DESS acquisition to two conventional MWF fM
estimates from a MESE acquisition. The ﬁrst conventional MWF estimate [6] is related to the
solution of a nonnegative least-squares (NNLS) problem [59]

x(y) ∈

arg min
x∈X

(cid:26)

ky − Axk2
2

,

(cid:27)

b

where y ∈ RD here denotes MESE echo amplitudes at D echo times; A ∈ RD×L models the D
MESE signals as weighted sums of L discrete T2 component signals; X ⊂ RL is the nonnegative
orthant; and x ∈ X here denotes L component weights. Whereas solutions to (S1) tend to be
sparse for L > D as is typical, researchers have suggested that spectral distributions are more
likely smooth in biological tissue [60]. For smoother in vivo spectrum estimates and for improved
problem conditioning, we also compared to a second MWF estimate [61] that is related to the
solution of a regularized NNLS problem (RNNLS)

(S1)

(S2)

ky − Axk2

2 + βkxk2

2

,

(cid:27)

x(y) ∈

arg min
x∈X

(cid:26)

b

2

(cid:1)

(cid:0)

b

b

b

iT

/k

x(·)

fM :=

x(·)k1, where

where β > 0 is a regularization parameter. Similar to [6] or [61], each of the two conven-
x(·) is
tional MWF estimators are then respectively deﬁned as
given by (S1) or (S2) and i ∈ {0, 1}L is in both cases nonzero only in entries corresponding to
T2 ∈ [15, 40]ms. As recommended in recent MESE MWF imaging literature [62], we computed
MESE signal amplitudes using the extended phase graph (EPG) formalism [63] to account for
stimulated echo signal contributions that persist in MESE due to non-ideal refocusing pulses. Note
that the conventional EPG-based MESE model ignores exchange. We accounted for non-ideal re-
focusing by assuming κ is known. We also accounted for incomplete recovery by assuming bulk
T1 is known. To circumvent separate EPG simulations for every voxel, we clustered known κ, T1
map voxels into 100 clusters via k-means++ [58] and ran 100 EPG simulations using each of the
cluster means. Iterating over clusters, we generated each cluster’s system matrix and solved (S1)
and (S2) for MESE image voxels assigned to that cluster. We constructed NNLS and RNNLS
MWF estimates by estimating L ← 100 spectral component images from D ← 32 MESE mea-
surement images (reducing L did not appreciably inﬂuence results). We manually ﬁxed RNNLS
regularization parameter β ← 2−13 as a small value that provided reasonable in vivo results. We
solved (S1) and (S2) using the MATLAB R(cid:13) function lsqnonneg with default options.

b

S-II Extensions to Simulation Studies

This section describes additional simulation studies that aid in understanding reasons for differ-
ences in MESE fM and DESS fF estimates. To help assess whether differences can be explained
by the unconventional PERK fF estimator, §S-II.A extends the two-compartment simulation de-
scribed in the main body by adding conventional ML fF estimation. To help assess whether differ-
ences can be explained by the idealized two-compartment DESS signal model, §S-II.B investigates
estimator performance when voxel data is simulated to more realistically arise from three water
compartments.

S-II.A Extension to Two-Compartment Simulation

We extended the two-compartment simulation study described in §3.2 to now include ML fF es-
timates (these results were omitted in the main body for consistency across experiments). We
estimated fF from the same noisy magnitude DESS images and the same known κ maps as in
the main body, now using the dictionary-based grid search ML estimator described in §S-I.A in
addition to the PERK estimator as before. ML estimation took 17726s (nearly 5h). As mentioned
in the main body, PERK training and testing respectively took 33.8s and 1.0s.

Fig. S1 extends Fig. 1 by adding the resulting DESS ML fF estimate alongside a corresponding
magnitude difference image with respect to the ground truth fM ≡ fF map. The PERK fF estimate
visibly exhibits less error in WM-like voxels than the ML fF estimate, perhaps in part because
PERK tuning parameters (λ, ρ) were optimized via holdout for estimating WM-like fF values.
Both the ML and PERK fF estimates exhibit less spatial variation in error maps than MESE fM
estimates, suggesting that reduced transmit ﬁeld sensitivity is not a property of the PERK estimator,
but rather due to consideration of transmit ﬁeld variation during acquisition design.

Table S1 extends Table 2 by adding ML fF sample statistics. The PERK fF estimate is more
precise but less accurate than the ML fF estimate because it is a Bayesian estimator [28]. PERK

3

Truth

 
MESE−NNLS MESE−RNNLS DESS−ML

DESS−PERK

 

 

0.3

0.24

0.18

0.12

0.06

0.3

0.24

0.18

0.12

0.06

F
W
M

 

r
o
r
r

E

 

 
.
g
a
M
F
W
M
 

Figure S1: NNLS/RNNLS MESE fM and ML/PERK DESS fF estimates alongside corresponding
magnitude error images, in a two-compartment simulation where none of the associated estimators
incur bias due to model mismatch. Voxels not assigned WM- or GM-like compartmental fractions
are masked out in post-processing for display. Table S1 presents corresponding sample statistics.

True fM ≡ fF

MESE-NNLS
MESE-RNNLS
DESS-ML
DESS-PERK

WM
0.15
fM 0.1375 ± 0.0187 (0.0225)
fM 0.1285 ± 0.0146 (0.0260)
b
0.1590 ± 0.0433 (0.0442)
fF
b
0.1352 ± 0.0267 (0.0305)
fF
b
b

GM
0.03
0.0203 ± 0.01296 (0.0162)
0.00207 ± 0.00524 (0.02841)
0.0334 ± 0.0272 (0.0274)
0.0436 ± 0.0267 (0.0299)

Table S1: Sample means ± sample standard deviations (RMSEs) of NNLS/RNNLS MESE fM
estimates and ML/PERK DESS fF estimates in a two-compartment simulation where none of the
associated estimators incur bias due to model mismatch. Sample statistics are computed over 7810
WM-like and 9162 GM-like voxels. Each sample statistic is rounded off to the highest place value
of its (unreported) standard error, computed via formulas in [51]. Fig. S1 presents corresponding
images.

fF estimates exhibit better WM RMSE and slightly worse GM RMSE than ML fF estimates. This
extended simulation suggests that PERK is at least as suitable as grid search for reasonable fF
estimation in WM.

4

Truth

 
MESE−NNLS MESE−RNNLS DESS−ML

DESS−PERK

 

 

0.3

0.24

0.18

0.12

0.06

0.3

0.24

0.18

0.12

0.06

F
W
M

 

r
o
r
r

E

 

 
.
g
a
M
F
W
M
 

Figure S2: NNLS/RNNLS MESE fM and ML/PERK DESS fF estimates alongside corresponding
magnitude error images, in a three-compartment simulation where any of the associated estimators
could incur bias due to model mismatch. Voxels not assigned WM- or GM-like compartmental
fractions are masked out in post-processing for display. Table S2 presents corresponding sample
statistics.

S-II.B Three-Compartment Simulation with Model Mismatch

We next simulated data to arise from three non-exchanging water compartments with myelin water-
like (500, 20)ms, cellular water-like (1000, 80)ms, and free water-like (3000, 3000)ms (longitudi-
nal, transverse) relaxation time constants selected based on [6, 18]. With this three-compartment
ground truth, the aforementioned MESE MWF estimators could incur bias due to their bulk-
T1 assumption and the aforementioned DESS fast-fraction estimators could incur bias due to
their two-compartment assumption. Thus fM and fF are not equivalent here and their estimates
need not necessarily be comparable. We assigned (myelin, cellular, free) water-like fractions of
(0.15, 0.82, 0.03) in WM, and (0.03, 0.94, 0.03) in GM. We simulated data otherwise exactly as
detailed in §3.2 to yield MESE image datasets with SNR ranging from 24-795 in WM and 29-862
in GM and to yield DESS image datasets with SNR ranging from 24-221 in WM and 30-241 in
GM, where SNR is computed via (9). We estimated fM from noisy magnitude MESE images and
known bulk T1 and κ maps by solving NNLS (S1) and RNNLS (S2) problems as explained in
§S-I.B. We estimated fF from noisy magnitude DESS images and known κ maps using ML and
PERK estimators, as explained in §S-I.A. NNLS and RNNLS respectively took 42.7s and 69.2s.
ML estimation took 17681s (nearly 5h), while PERK training and testing respectively took 34.2s
and 1.1s.

Fig. S2 compares NNLS and RNNLS fM estimates as well as ML and PERK fF estimates
alongside magnitude difference images with respect to the ground truth MWF. The PERK fF esti-

5

True fM ≡ fF

MESE-NNLS
MESE-RNNLS
DESS-ML
DESS-PERK

WM
0.15
fM 0.1910 ± 0.0463 (0.0618)
fM 0.1699 ± 0.0354 (0.0406)
b
0.1987 ± 0.0275 (0.0559)
fF
b
0.1576 ± 0.0243 (0.0254)
fF
b
b

GM
0.03
0.0349 ± 0.0192 (0.0198)
0.00272 ± 0.00673 (0.02809)
0.0632 ± 0.0280 (0.0434)
0.0754 ± 0.0231 (0.0510)

Table S2: Sample means ± sample standard deviations (RMSEs) of NNLS/RNNLS MESE fM
estimates and ML/PERK DESS fF estimates in a three-compartment simulation where any of the
associated estimators could incur bias due to model mismatch. Sample statistics are computed
over 7810 WM-like and 9162 GM-like voxels. Each sample statistic is rounded off to the highest
place value of its (unreported) standard error, computed via formulas in [51]. Fig. S2 presents
corresponding images.

mator achieves the lowest errors in WM but overestimates in GM (as does the ML fF estimator),
causing reduced WM/GM contrast relative to other estimators. Unlike both fF estimates, both fM
estimates visibly exhibit systematic error due to ﬂip angle spatial variation, despite perfect knowl-
edge of κ. All estimates are higher (though to varying degrees) than corresponding estimates pre-
sented in Fig. S1, indicating some sensitivity to model mismatch. Except for PERK fF estimates
in WM and RNNLS fM estimates in GM, all estimates exhibit greater error than corresponding
estimates presented in Fig. S1, indicating that in most cases model mismatch is detrimental to
estimation performance.

Table S2 compares sample statistics of NNLS and RNNLS fM estimates as well as ML and
PERK fF estimates, computed over the same WM-like and GM-like ROIs as in Table S1. Several
estimates now differ from true values by more than one standard deviation, indicating signiﬁcant
bias due to model mismatch in these cases. The PERK fF estimator is most accurate and achieves
the lowest RMSE in WM, but also suffers from the highest RMSE in GM. The NNLS fM estimator
is most accurate and achieves the lowest RMSE in GM, but also suffers from the highest RMSE in
WM. RNNLS fM (PERK fF) estimates are now both more accurate and more precise than NNLS
fM (ML fF) estimates in WM, suggesting that regularization may be beneﬁcial in cases of model
mismatch. Perhaps surprisingly, RNNLS fM and PERK fF estimates do not differ signiﬁcantly
in WM (but do differ in GM) suggesting that these WM estimates may be comparable even when
characterizing 3-compartment systems, at least for the nominal ground-truth values selected here.

S-III Further Discussion

Extended simulations provide evidence that PERK is well-suited for DESS fF estimation. Ideal-
ized two-compartment simulations demonstrate that PERK and standard ML fF estimators achieve
comparable RMSE in WM- and GM-like voxels, but PERK is more than 500× faster. More real-
istic three-compartment simulations reveal that conventional MESE fM estimates are sensitive to
unaccounted variable T1-recovery rates across compartments and accounted ﬂip angle spatial vari-
ation while DESS fF estimates are sensitive to relaxation in an unaccounted third compartment,
though the DESS PERK fF estimator is most robust in WM to these sources of model misspeciﬁ-

6

cation errors.

Taken together with the results in [28], results herein also provide evidence that the PERK
estimator can maintain good performance while scaling more gracefully with the number of un-
knowns per voxel L than conventional ML estimators. In an application with L ← 3 unknowns
[28], PERK was consistently at least 140× faster than two well-suited ML estimators and achieved
comparable performance in simulation, phantom, and in vivo studies. In myelin water imaging
simulations (L ← 6), PERK was consistently at least 500× faster than an ML estimator achieved
via unrealistically narrow grid search around the ground truth. In early myelin water imaging in
vivo experiments on other precision-optimized SPGR/DESS datasets from the same healthy volun-
teer, PERK took comparable time (∼1m including training) and produced similar fF estimates as
reported here while a more realistically-constrained grid search took about 68 CPU-days (running
on 24 nodes of a computing cluster). We omitted in vivo and ex vivo ML results here because these
early experiments produced poor ML fF estimates, likely due to multiple global minima of the as-
sociated ML cost function. Since PERK training time scales negligibly with the number of voxels,
all of these acceleration factors would scale roughly linearly with the number of reconstructed
slices for full-volume parameter estimation problems.

7

