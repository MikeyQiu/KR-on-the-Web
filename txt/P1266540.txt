4
1
0
2
 
v
o
N
 
4
2
 
 
]
L
M

.
t
a
t
s
[
 
 
1
v
0
9
5
6
.
1
1
4
1
:
v
i
X
r
a

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

NICOL ´AS GARC´IA TRILLOS1, DEJAN SLEP ˇCEV1, JAMES VON BRECHT2, THOMAS LAURENT3, XAVIER
BRESSON4.

ABSTRACT. This paper establishes the consistency of a family of graph-cut-based algorithms for clus-
tering of data clouds. We consider point clouds obtained as samples of a ground-truth measure. We in-
vestigate approaches to clustering based on minimizing objective functionals deﬁned on proximity graphs
of the given sample. Our focus is on functionals based on graph cuts like the Cheeger and ratio cuts.
We show that minimizers of the these cuts converge as the sample size increases to a minimizer of a
corresponding continuum cut (which partitions the ground truth measure). Moreover, we obtain sharp
conditions on how the connectivity radius can be scaled with respect to the number of sample points for
the consistency to hold. We provide results for two-way and for multiway cuts. Furthermore we provide
numerical experiments that illustrate the results and explore the optimality of scaling in dimension two.

1. INTRODUCTION

Partitioning data clouds in meaningful clusters is one of the fundamental tasks in data analysis and
machine learning. A large class of the approaches, relevant to high-dimensional data, relies on creating
a graph out of the data cloud by connecting nearby points. This allows one to leverage the geometry of
the data set and obtain high quality clustering. Many of the graph-clustering approaches are based on
optimizing an objective function which measures the quality of the partition. The basic desire to obtain
clusters which are well separated leads to the introduction of objective functionals which penalize the
size of cuts between clusters. The desire to have clusters of meaningful size and for approaches to
be robust to outliers leads to the introduction of ”balance” terms and objective functionals such as
Cheeger cut (closely related to edge expansion) [5, 11, 12, 28, 38], ratio cut [23, 27, 40, 43], normalized
cut [4, 34, 40], and conductance (sparsest cut) [5, 28, 36]. Such functionals can be extended to treat
multiclass partitioning [13, 45]. The balanced cuts above have been widely studied theoretically and
used computationally. The algorithms of [2, 36, 37] utilize local clustering algorithms to compute
balanced cuts of large graphs. Total variation based algorithms [12, 13, 26, 27, 38] are also used to
optimize either the conductance or the edge expansion of a graph. Closely related are the spectral
approaches to clustering [34, 40] which can be seen as a relaxation of the normalized cuts.

In this paper we consider data clouds, Xn = {x1, . . . , xn}, which have been obtained as i.i.d.
samples of a measure ν with density ρ on a bounded domain D. The measure ν represents the ground
truth that Xn is a sample of. In the large sample limit, n → ∞, clustering methods should exhibit
consistency. That is, the clustering of the data sample Xn should converge as n → ∞ toward a speciﬁc
clustering of the underlying sample domain. In this paper we characterize in a precise manner when
and how the minimizers of a ratio and Cheeger graph cuts converge towards a suitable partition of the
domain. We deﬁne the discrete and continuum objective functionals considered in Subsections 1.1 and
1.2 respectively, and informally state our result in Subsection 1.3.

Date: November 25, 2014.
1991 Mathematics Subject Classiﬁcation. 62H30, 62G20, 49J55, 91C20, 68R10, 60D05.
Key words and phrases. data clustering, balanced cut, consistency, Gamma convergence, graph partitioning.

1

2

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

An important consideration when investigating consistency of algorithms is how the graphs on Xn
are constructed. In simple terms, when building a graph on Xn one sets a length scale εn such that
edges between vertices in Xn are given signiﬁcant weights if the distance of points they connect is εn
or less. In some way this sets the length scale over which the geometric information is averaged when
setting up the graph. Taking smaller εn is desirable because it is computationally less expensive and
gives better resolution, but there is a price. Taking εn small increases the error due to randomness and
in fact if εn is too small the resulting graph may not represent the geometry of D well and consequently
the discrete graph cut may be very far from the desired one. In our work we determine precisely how
small εn can be taken for the consistency to hold. We obtain consistency results both for two-way and
multiway cuts.

To prove our results we use the variational notion of convergence known as the Γ-convergence. It
is one of the standard tools of modern applied analysis to consider a limit of a family of variational
problems [10, 16]. In the recent work [18], this notion was developed in the random discrete setting
designed for the study of consistency of minimization problems on random point clouds. In particular
the proof of Γ-convergence of total variation on graphs proved there provides the technical backbone of
this paper. The approach we take is general and ﬂexible and we believe suitable for the study of many
problems involving large sample limits of minimization problems on graphs.

Background on consistency of clustering algorithms and related problems. Consistency of clus-
tering algorithms has been considered for a number of approaches. Pollard [33] has proved the con-
sistency of k-means clustering. Consistency for a class of single linkage clustering algorithms was
shown by Hartigan [24]. Arias-Castro and Pelletier have proved the consistency of maximum variance
unfolding [3]. Consistency of spectral clustering was rigorously considered by von Luxburg, Belkin,
and Bousquet [41, 42]. These works show the convergence of all eigenfunctions of the graph laplacian
for ﬁxed length scale εn = ε which results in the limiting (as n → ∞) continuum problem beeing a
nonlocal one. Belkin and Niyogi [7] consider the spectral problem (Laplacian eigenmaps) and show
that there exists a sequence εn → 0 such that in the limit the (manifold) Laplacian is recovered, how-
ever no rate at which εn can go to zero is provided. Consistency of normalized cuts was considered by
Arias-Castro, Peletier, and Pudlo [4] who provide a rate on εn → 0 under which the minimizers of the
discrete cut functionals minimized over a speciﬁc family of subsets of Xn converge to the continuum
Cheeger set. Our work improves on [4] in several ways. We minimize the discrete functionals over all
discrete partitions on Xn as it is considered in practice and prove the result for the optimal, in terms of
scaling, range of rates at which εn → 0 as n → ∞.

There are also a number of works which investigate how well the discrete functionals approximate
the continuum ones for a particular function. Among them are works by Belkin and Niyogi [8], Gin´e
and Koltchinskii [20], Hein, Audibert, von Luxburg [25], Singer [35] and Ting, Huang, and Jordan [39].
Maier, von Luxburg and Hein [30] considered pointwise convergence for Cheeger and normalized cuts,
both for the geometric and kNN graphs and obtained a range of scalings of graph construction on n for
the convergence to hold. While these results are quite valuable, we point out that they do not imply that
the minimizers of discrete objective functionals are close to minimizers of continuum functionals.

1.1. Graph partitioning. The balanced cut objective functionals we consider are relevant to general
graphs (not just ones obtained from point clouds). We introduce them here.

Given a weighted graph G = (X, W ) with the vertex set X = {x1, . . . , xn} and the weight matrix

W = {wij}1≤i,j≤n, the balanced graph cut problems we consider take the form

(1.1)

Minimize

Cut(Y, Y c)
Bal(Y, Y c)

:=

(cid:80)

(cid:80)

xj ∈Y c wij

xi∈Y

Bal(Y, Y c)

over all nonempty Y (cid:40) X.

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

3

That is, we consider the class of problems with Cut(Y, Y c) as the numerator together with different
balance terms. For Y ⊂ X let |Y | be the ratio between the number of vertices in Y and the number of
vertices in X. Well-known balance terms include

(1.2)

BalR(Y, Y c) = 2|Y ||Y c|

and

BalC(Y, Y c) = min(|Y |, |Y c|),

which correspond to Ratio Cut [23, 27, 40, 43] and Cheeger Cut [5, 14, 15, 28] respectively 1. A
variety of other balance terms have appeared in the literature in the context of two-class and multiclass
clustering [11, 27]. We refer to a pair {Y, Y c} that solves (1.1) as an optimal balanced cut of the graph.
Note that a given graph G = (X, W ) may have several optimal balanced cuts (although generically the
optimal cut is unique).

We are also interested in multiclass balance cuts. Speciﬁcally, in order to partition the set X into

K ≥ 3 clusters, we consider the following ratio cut functional:

(1.3)

Minimize
(Y1,...,YK )

K
(cid:88)

k=1

Cut(Yk, Y c
k )
|Yk|

,

Yk ∩ Ys = ∅

if

r (cid:54)= s,

Yk = X.

K
(cid:91)

k=1

1.2. Continuum partitioning. Given a bounded and connected open domain D ⊂ Rd and a probabil-
ity measure ν on D, with positive density ρ > 0, we deﬁne the class of balanced domain cut problems
in an analogous way. A balanced domain-cut problem takes the form

(1.4)

Minimize

A ⊂ D with 0 < ν(A) < 1.

Cutρ(A, Ac)
Balρ(A, Ac)

,

where Ac = D\A. Just as the graph cut term Cut(Y, Y c) in (1.1) provides a weighted (by W ) measure
of the boundary between Y and Y c, the cut term Cutρ(A, Ac) for a domain denotes a ρ2−weighted
area of the boundary between the sets A and Ac. If ∂DA := ∂A ∩ D (the boundary between A and Ac)
is a smooth curve (in 2d), surface (in 3d) or manifold (in 4d+) then we deﬁne

(1.5)

Cutρ(A, Ac)

:=

ρ2(x) dS(x).

For our results and analysis we need the notion of continuum cut which is deﬁned for sets with less
regular boundary. We present the required notions of geometric measure theory and the rigorous and
mathematically precise formulation of problem (1.4) in Subsection 3.1.

If ρ(x) = 1 then Cutρ(A, Ac) simply corresponds to arc-length (in 2d) or surface area (in 3d). In the
general case, the presence of ρ2(x) in (1.5) indicates that the regions of low density are easier to cut,
so ∂A has a tendency to pass through regions in D of low density. As in the graph case, we consider
balance terms

(1.6)

Balρ(A, Ac) = 2|A||Ac|

and

Balρ(A, Ac) = min(|A|, |Ac|),

which correspond to weighted continuous equivalents of the Ratio Cut and the Cheeger Cut. In the
continuum setting |A| stands for the total ν-content of the set A, that is,

(1.7)

|A| = ν(A) =

ρ(x) dx.

We refer to a pair {A, Ac} that solves (1.4) as an optimal balanced cut of the domain.

ˆ

∂DA

ˆ

A

1The factor of 2 in the deﬁnition of BalR(Y, Y c) is introduced to simplify the computations in the remainder. We remark

that when using BalR, problem (1.1) is equivalent to the usual ratio cut problem.

4

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

The continuum equivalent of the multiway cut problem (1.3) reads

(1.8)

Minimize
(A1,...,AR)

R
(cid:88)

r=1

Cutρ(Ar, Ac
r)
|Ar|

, Ar ∩ As = ∅

if

r (cid:54)= s,

Ar = D.

R
(cid:91)

r=1

1.3. Consistency of partitioning of data clouds. We consider the sample Xn = {x1, . . . , xn} con-
sisting of i.i.d. random points drawn from an underlying ground-truth measure ν. We assume that D is
a bounded, open set with Lipschitz boundary. Furthermore we assume that ν has continuous density ρ
and that λ ≤ ρ ≤ Λ on D.

To extract the desired information about the point cloud one builds a graph by connecting the nearby
points. More precisely consider a kernel η : Rd → [0, ∞) to be radially symmetric, radially decreasing,
and decaying to zero sufﬁciently fast. We introduce a parameter ε which basically describes over which
length scale the data points are connected. We assign for i, j ∈ {1, . . . , n} the weights by

(1.9)

wi,j = η

(cid:18) xi − xj
ε

(cid:19)

.

As more data points are available one takes smaller ε to obtain increased resolution. That is, one sets
the length scale εn based on the number of available data points. We investigate under what scaling of
εn on n the optimal balanced cuts (that is minimizers of (1.1)) of the graph Gn = (Xn, Wn) converge
towards optimal balanced cuts in the continuum setting (minimizers of (1.4)). On Figure 1, we illustrate
partitioning a data cloud sampled from the uniform distribution for the given domain D.

(a) A sample of n = 120 points.

(b) Geometric graph with ε = 0.3.

(c) Minimizer of Cheeger graph cut.

(d) Minimizer of continuum Cheeger cut.

FIGURE 1. Given the sample of Figure (a), graph is constructed using η(z) = 1{|z|≤1}
and ε = 0.3, as illustrated on Figure (b). On Figure (c) we present the solution to the
Cheeger graph-cut problem obtained using [12]. A solution to the continuum Cheeger-
cut problem is illustrated in Figure (d).

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

5

Informal statement of (a part of) the main results. Consider d ≥ 2 and assume the continuum

balanced cut (1.4) has a unique minimizer {A, Ac}. Consider εn > 0 such that limn→∞ εn = 0 and
(log n)pd
n1/d

lim
n→∞

= 0,

1
εn

where pd = 1/d for d ≥ 3 and p2 = 3/4. Then almost surely the minimizers, {Yn, Y c
n }, of the balanced
cut (1.1) of the graph Gn , converge to {A, Ac}. Moreover, after appropriate rescaling, almost surely
the minimum of problem (1.1) converges to the minimum of (1.4). The result also holds for multiway
cuts. That is the minimizers of (1.3) converge towards minimizers of (1.8).

Let us make the notion of convergence of discrete partitions {Yn, Y c

n } to continuum partitions {A, Ac}
precise. Let 1Yn : Xn → {0, 1} be the characteristic function of Yn on the set Xn. Let pi,1 =
n (xi)) for i = 1, . . . , n be the points on the graphs of 1Yn and 1Y c
(xi, 1Yn(xi)) and pi,2 = (xi, 1Y c
respectively.

n

(cid:80)n

γn,2 := 1
n

Consider the probability measures on the graphs of 1Yn and 1Y c

i=1 δpi,1
i=1 δpi,2. Let γ be the push-forward of the measure ν to the graph of 1A, that is
and
γ = (Id × 1A)(cid:93)ν = ν(cid:120)A × δ1 + ν(cid:120)Ac × δ0 where Id is the identity mapping from Rd to Rd and ν(cid:120)A
is the restriction of the measure ν to the set A . We say that {Yn, Y c
n } converge towards {A, Ac} as
n → ∞ if there is a sequence of indices I : N → {1, 2} such that

n : that is let γn,1 := 1
n

(cid:80)n

(1.10)

γn,I(n)

w(cid:42) γ

as n → ∞,

which is to be read as γn,I(n) converges weakly to γ (see [17] for the deﬁnition of weak convergence
of probability measures.) In other words the convergence of discrete towards continuum partitions is
deﬁned as the weak convergence of graphs, considered as probability measures.

In Section 2 we discuss this topology in more detail and present a more general and conceptually
clearer picture. In particular we point out that the weak convergence of measures on the space of graphs
of functions is stronger than it may look and actually corresponds to L1 convergence of functions.

Remark 1 (Optimality of scaling of εn for d ≥ 3). If d ≥ 3 then the rate presented in the statement
above is sharp in terms of scaling. Namely for D = (0, 1)d, ν being the Lebesgue measure on D and
η compactly supported, it is known from graph theory (see [21, 22, 31]) that there exists a constant
c > 0 such that if εn < c (log n)1/d
then the weighted graph associated to (Xn, Wn) is disconnected
with high probability. The resulting optimal discrete cuts have zero energy, but may be very far from
the optimal continuum cuts. While the above example demonstrates the optimality of our results, we
caution that there may be settings relevant to machine learning in which the convergence of minimizers
of appropriate functionals involving perimeter may hold even when 1

n1/d (cid:28) εn < c (log n)1/d

n1/d

n1/d

.

Remark 2. In case d = 2 the connectivity threshold for a random geometric graph is εn = c log(n)1/2
,
which is below the rate for which we can establish the consistency of balanced cuts. Thus, an interesting
open problem is to determine if the consistency results we present in this paper are still valid when the
parameter εn is taken below the rate log(n)3/4
n1/2 we obtained the proof for, but above the connectivity rate.
In particular we are interested in determining if connectivity is the determining factor in order to obtain
consistency of balance graph cuts. We numerically explore this problem in Section 8.

n1/2

We also remark that, despite the fact that for a general graphs the problems (1.1) and (1.3) are NP
hard, in practice when the graph is obtained by sampling from a measure ν as above, such minimization
problems can be effectively approached [12, 13]. In fact, by choosing an appropriate initialization, the
algorithms (see [12, 13]), give very good results in clustering real-world data.

6

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

1.4. Outline. In Section 2 we introduce the notion of convergence we use to bridge between discrete
and continuum partitions. It relies on some of the notions of the theory of optimal transportation which
we recall. Finally we recall results on optimal min-max matching which are needed in the proof of
the convergence. In Section 3 we study more carefully continuum partitioning (1.4). We introduce the
notion of total variation of functions on D in Subsection 3.1 and recall some of its basic properties.
It enables us to introduce, in Subsection 3.2, the general setting for problem (1.4) where desirable
properties such as lower semicontinuity and existence of minimizers hold. In Section 4 we give the
precise statement of the consistency result, both for the two-way cuts and the multiple-way cuts. Proving
that minimizers of discrete balanced cuts converge to continuum balanced cuts relies on a notion of
variational convergence known as Γ-convergence. In Section 5 we recall the deﬁnition of Γ convergence
and its basic properties. In Subsection 5.1 we recall the results on Γ-convergence of graph total variation
which provide the backbone for our result. Section 6 contains the proof of the Theorem 8 and Section
7 the proof of Theorem 10. Finally, in Section 8 we present numerical experiments which illustrate our
results and we also investigate the issues related to Remark 2.

2. FROM DISCRETE TO CONTINUUM

For the two-class case, our main result shows that a sequence of partitions {Yn, Y c

n } of the sample
points Xn = {x1, . . . , xn} ⊂ D converges toward a continuum partition {A, Ac} of the domain D.
In this section we expand on the notion of convergence introduced in Subsection 1.3 to compare the
discrete and continuum partitions. We give an equivalent deﬁnition for such type of convergence which
turns out to be more useful for the computations in the remainder.

Associated to the partitions {Yn, Y c

n } of Xn = {x1, . . . , xn} there are characteristic functions of Yn
: Xn → {0, 1}. Let νn = 1
n , namely 1Yn : Xn → {0, 1} and 1c
and Y c
i=1 δxi be the empirical
Yn
n
n ∈ L1(νn). Likewise a continuum partition of D by
measures associated to Xn Note that 1Yn, 1Y c
measurable sets A and Ac = D\A can be described via the characteristic functions 1A : D → {0, 1}
and 1Ac : D → {0, 1}. These too can be considered as L1 functions, but with respect to the measure ν
rather than νn.

We compare partitions the {Yn, Y c

n } and {A, Ac} by comparing the associated characteristic func-
tions. To do so, we need a way of comparing L1 functions with respect to different measures. We
follow the approach of [18]. We denote by B(D) the Borel σ-algebra on D and by P(D) the set of
Borel probability measures on D. The set of objects of our interest is

(cid:80)n

T L1(D) := {(µ, f ) : µ ∈ P(D), f ∈ L1(µ)}.

Note that (νn, 1Yn) and (ν, 1A) both belong to T L1. To compare functions deﬁned with respect to
different measures, say (µ, f ) and (θ, g) in T L1, we need a way to say for which (x, y) ∈ supp(µ) ×
supp(θ) should we compare f (x) and g(y). The notion of coupling (or transportation plan) between
µ and θ, provides a way to do that. A coupling between µ, θ ∈ P(D) is a probability measure π on the
product space D × D, such that the marginal on the ﬁrst variable is µ and the marginal on the second
variable is θ. The set of couplings Γ(µ, θ) is thus

Γ(µ, θ) = {π ∈ P(D × D) : (∀U ∈ B(D)) π(U × D) = µ(U ) and π(D × U ) = θ(U )}.

For (µ, f ) and (θ, g) in T L1(D) we deﬁne the distance

¨

(2.1)

dT L1((µ, f ), (θ, g)) = inf

π∈Γ(µ,θ)

|x − y| + |f (x) − g(y)|dπ(x, y).

D×D
This is the distance that we use to compare L1 functions with respect to different measures. To un-
derstand it better we focus on the case that one of the measures, say µ, is absolutely continuous with

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

7

respect to the Lebesgue measure, as this case is relevant for us when passing from discrete to contin-
uum. In this case the convergence in T L1 space can be formulated in simpler ways using transportation
maps instead of couplings to match the measures. Given a Borel map T : D → D and µ ∈ P(D) the
push-forward of µ by T , denoted by T(cid:93)µ ∈ P(D) is given by:

T(cid:93)µ(A) := µ (cid:0)T −1(A)(cid:1) , A ∈ B(D).
A Borel map T : D → D is a transportation map between the measures µ ∈ P(D) and θ ∈ P(D) if
θ = T(cid:93)µ. Associated to a transportation map T , there is a plan πT ∈ Γ(µ, θ) given by πT := (Id ×T )(cid:93)µ,
where (Id ×T )(x) = (x, T (x)).

We note that if θ = T(cid:93)µ then the following change of variables formula holds for any f ∈ L1(θ)
ˆ

ˆ

f (y)dθ(y) =

f (T (x))dµ(x).

D
In order to give the desired interpretation of convergence in T L1 we also need the notion of a stag-
nating sequence of transportation maps. A sequence {Tn}n∈N of transportation maps between µ and
{µn}n∈N (i.e. Tn(cid:93)µ = µn) is stagnating if

D

ˆ

D

|x − Tn(x)|dµ(x) → 0

as n → ∞.

(2.2)

(2.3)

This notion is relevant to our considerations since for the measure ν and its empirical measures νn there
exists (with probability one) a sequence of stagnating transportation maps Tn(cid:93)ν = νn. The idea is that
as n → ∞ the mass from ν needs to be moved only very little to be matched with the mass of νn. We
make this precise in Proposition 4

We now provide the desired interpretation of the convergence in T L1, which is a part of Proposition

3.12 in [18].

Proposition 3. Consider a measure µ ∈ P(D) which is absolutely continuous with respect to the
Lebesgue measure. Let (µ, f ) ∈ T L1(D) and let {(µn, fn)}n∈N be a sequence in T L1(D). The
following statements are equivalent:

(i) (µn, fn) T L1
(ii) µn

−→ (µ, f ) as n → ∞.

w(cid:42) µ and there exists a stagnating sequence of transportation maps Tn(cid:93)µ = µn such that:

(2.4)

|f (x) − fn (Tn(x))| dµ(x) → 0, as n → ∞.

(iii) µn

w(cid:42) µ and for any stagnating sequence of transportation maps Tn(cid:93)µ = µn convergence (2.4)

holds.

The previous proposition implies that in order to show that (µn, fn) converges to (µ, f ) in the T L1-
sense, it is enough to ﬁnd a sequence of stagnating transportation maps Tn(cid:93)µ = µn and then show the
L1 convergence of fn ◦ Tn to f . An important feature of Proposition 3 is that there is complete freedom
on what sequence of transportation maps {Tn}n∈N to take, as long as it is stagnating. In particular this
shows that if µn = µ for all n then the convergence in T L1 is equivalent to convergence in L1.

To apply the above to our setting we need a stagnating sequence of transportation maps between ν
and {νn}n∈N. The results on optimal transportation provide such a sequence with precise information
on the rate at which (2.3) occurs. For some of our considerations it is useful to have the control of
x − Tn(x) in the stronger L∞-norm , rather than in the L1-norm. The following result of [19] provides
such transportation maps with optimal scaling of the norm on n.

ˆ

D

8

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

Proposition 4. Let D be an open, connected and bounded subset of Rd which has Lipschitz boundary.
Let ν be a probability measure on D with density ρ which is bounded from below and from above by
positive constants. Let x1, . . . , xn, . . . be a sequence of independent random points distributed on D
according to measure ν and let νn = 1
i=1 δxi. Then there is a constant C > 0 such that with
n
probability one there exists a sequence of transportation maps {Tn}n∈N from ν to νn (Tn(cid:93)ν = νn) and
such that:

(cid:80)n

(2.5)

lim sup
n→∞

n1/d(cid:107)Id − Tn(cid:107)∞
(log n)pd

≤ C,

where the power pd is equal to 1/d if d ≥ 3 and equal to 3/4 if d = 2.

Having deﬁned the T L1-convergence for functions, we turn to deﬁning the T L1-convergence for par-
R }, we need

titions. When formalizing a notion of convergence for sequences of partitions {Y n
to address the inherent ambiguity that arises from the fact that both {Y n
refer to the same partition for any permutation P on the set {1, . . . , R}. Having the previous observation
in mind, the convergence of partitions is deﬁned in a natural way.

P (1), . . . , Y n

R } and {Y n

1 , . . . , Y n

1 , . . . , Y n

P (R)}

Deﬁnition 5. The sequence {Y n
R } is a partition of Xn, converges in
the T L1-sense to the partition {A1, . . . , AR} of D, if there exists a sequence of permutations {Pn}n∈N
of the set {1, . . . , R}, such that for every r ∈ {1, . . . , R},

R }n∈N, where {Y n

1 , . . . , Y n

1 , . . . , Y n

(cid:16)

νn, 1Y n

Pn(r)

(cid:17) T L1

−→ (ν, 1Ar )

as n → ∞.

We note that the deﬁnition above is equivalent to the deﬁnition in (1.10) which we gave in Subsection
(1.3) when discussing the main result. The equivalence follows from the fact that the T L1 metric (2.1)
can be seen as the distance between the graphs of functions, considered as measures. Namely given
(µ, f ), (θ, g) ∈ T L1(D), let Γf = (Id ×f )(cid:93)µ and Γg = (Id ×g)(cid:93)θ be the measures representing the
graphs. Consider d(Γf , Γg) := dT L1((µ, f ), (θ, g). Proposition 3.3 in [18] implies that this distance
metrizes the weak convergence of measures on the family of graph measures. Therefore the convergence
of partitions of Deﬁnition 5 is equivalent to one given in (1.10).

We end this section by making some remarks about why the T L1-metric is a suitable metric for
considering consistency problems. On one hand if one considers a sequence of minimizers {Yn, Y c
n } of
the graph balanced cut (1.1) the topology needs to be weak enough for the sequence of minimizers to
be guaranteed to converge (at least along a subsequence). Mathematically speaking the topology needs
to be weak enough for the sequence to be pre-compact. On the other hand the topology has to be strong
enough for one to be able to conclude that the limit of a sequence of minimizes is a minimizer of the
continuum balanced cut energy. In Proposition 19 and Lemma 21 we establish that the T L1-metric
satisﬁes both of the desired properties.

Finally we point out that our approach from discrete to continuum can be interpreted as an extrapola-
tion or extension approach, as opposed to restriction viewpoint. Namely when comparing (µn, fn) and
(µ, f ) where µn is discrete and µ is absolutely continuous with respect to the Lebesgue measure we end
up comparing two L1 functions with respect to the Lebesgue measure, namely fn ◦ Tn and f , in (2.4).
Therefore fn ◦ Tn used in Proposition 3 can be seen as a continuum representative (extrapolation) of
the discrete fn. We think that this approach is more ﬂexible and suitable for the task than the, perhaps
more common, approach of comparing the discrete and continuum by restricting the continuum object
to the discrete setting (this would correspond to considering f |supp(µn) and comparing it to fn).

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

9

3. CONTINUUM PARTITIONING: RIGOROUS SETTING

We ﬁrst recall the general notion of (weighted) total variation and some notions of analysis and

geometric measure theory.

3.1. Total Variation. Let D be an open and bounded domain in Rd with Lipschitz boundary and let
ρ : D → (0, ∞) be a continuous density function. We let ν be the measure with density ρ. We assume
that ρ is bounded above and below by positive constants, that is, λ ≤ ρ ≤ Λ on D for some Λ ≥ λ > 0.
If needed, we consider an extension of ρ to the whole Rd by setting ρ(x) = λ for x ∈ Rd \ D. This
extension is a lower semi-continuous function and has the same lower and upper bounds that the original
ρ has.

Given a function u ∈ L1(ν), we deﬁne the weighted (by weight ρ2) total variation of u by:

(3.1)

T V (u; D) := sup

u(x)div(Φ(x)) dx : Φ(x) ∈ C1

c (D : Rd),

|Φ(x)| ≤ ρ2(x)

.

(cid:27)

ˆ

(cid:26)

D

If u is regular enough then the weighted total variation can be written as

T V (u; D) =

|∇u|ρ2(x) dx.

D
Also, given that ρ : D → R is continuous, if u = 1A is the characteristic function of a set A ⊆ Rd with
C1 boundary, then

T V (1A; D) =

ρ2(x) dHd−1(x),

∂A∩D
where Hd−1 represents the (d − 1)-dimensional Hausdorff measure in Rd. In case ρ is a constant ( ν is
the uniform distribution), the functional T V (·; D) reduces to a multiple of the classical total variation
and in particular (3.3) reduces to a multiple of the surface area of the portion of ∂A contained in D.

Since ρ is bounded above and below by positive constants, a function u ∈ L1(ν) has ﬁnite weighted
total variation if and only if it has ﬁnite classical total variation. Therefore, if u ∈ L1(ν) with
T V (u; D) < ∞, then u is a BV function and hence it has a distributional derivative Du which is a
Radon measure (see Chapter 13 in [29]). We denote by |Du| the total variation of the measure Du and
denote by |Du|ρ2 the measure determined by

ˆ

ˆ

By Theorem 4.1 in [6]

d|Du|ρ2 = ρ2(x)d|Du|.

T V (u; D) = |Du|ρ2(D) =

ρ2(x) d|Du|(x).

ˆ

D

A simple consequence of the deﬁnition of the weighted T V is its lower semicontinuity with respect

to L1-convergence. More precisely, if uk

L1(ν)
−→ u then

(3.2)

(3.3)

(3.4)

(3.5)

(3.6)

Finally, for u ∈ BV (D), the co-area formula
ˆ

T V (u; D) ≤ lim inf
k→∞

T V (uk; D).

T V (u; D) =

T V (1{u>t}; D) dt,

R

relates the weighted total variation of u with the weighted total variation of its level sets. A proof of
this formula can be found in [9]. For a proof of the formula in case ρ is constant see [29].

In the remainder of the paper, we write T V (u) instead of T V (u; D) when the context is clear.

10

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

3.2. Continuum partitioning. We use the total variation to rigorously formulate the continuum parti-
tioning problem (1.4). The precise deﬁnition of the Cutρ(A, Ac) in functional in (1.4) is

Cutρ(A, Ac) = T V (1A; D),
where T V (1A; D) is deﬁned in (3.1). We note that T V (1A; D) is equal to T V (1Ac; D), and is the
perimeter of the set A in D weighted by ρ2.

We also formulate the balance terms, deﬁned by (1.6) and (1.7), using characteristic functions. In

fact, we start by extending the balance term to arbitrary functions u ∈ L1(ν):
ˆ

ˆ

(3.7)

BR(u) =

|u(x) − meanρ(u)|ρ(x) dx and BC(u) = min
c∈R

D

D

|u(x) − c|ρ(x) dx,

where meanρ(u) denotes the mean/expectation of u(x) with respect to the measure dν = ρdx. From
here on, we use B to represent either BR or BC depending on the context. We have the relations:

BR(1A) = BalR(A, Ac), BC(1A) = BalC(A, Ac),

(3.8)
for every measurable subset A of D. We also consider normalized indicator functions ˜1A given by
1A
B(1A)

, A ⊆ D,

˜1A :=

and consider the set

(3.9)
Then for u = ˜1A ∈ Ind(D)

Ind(D) := (cid:8)u ∈ L1(ν) : u = ˜1A for some measurable set A ⊆ D with B(1A) (cid:54)= 0(cid:9) .

(3.10)

T V (u) = T V (˜1A) = T V

(cid:18) 1A

(cid:19)

B(1A)

=

T V (1A)
B(1A)

=

2Cut(A, Ac)
Bal(A, Ac)

.

Thus, we deduce that problem (1.4) is equivalent to :

(3.11)

Minimize E(u) :=

(cid:40)

T V (u)
+∞

if u ∈ Ind(D)
otherwise.

Before we show that both the continuum ratio cut and Cheeger cut indeed have a minimizer we need
the following lemma:

Lemma 6.

(i) The balance functions B are continuous on L1(ν).

(ii) The set Ind(D) is closed in L1(D).

Proof. Let us start by proving (i). We ﬁrst consider the balance term BC(u) that corresponds to the
Cheeger Cut. Suppose that uk → u in L1(ν), and let ck, c∞ denote medians of uk and u respectively.
By deﬁnition, ck and c satisfy

c∈R

This implies that

ˆ

D

ˆ

ˆ

c∈R

D

ˆ

ck ∈ argmin

|uk(x) − c| ρ(x) dx,

c∞ ∈ argmin

|u(x) − c| ρ(x) dx

|uk(x) − ck|ρ(x) dx ≤

|uk(x) − c|ρ(x) dx

for any c ∈ R, so that in particular we have

ˆ

ˆ

|uk − ck|ρ(x) dx −
ˆ

|u − c∞| ρ(x) dx
ˆ

ˆ

≤

|uk − c∞|ρ(x) dx −

|u − c∞|ρ(x) dx ≤

|uk − u|ρ(x) dx = (cid:107)uk − u(cid:107)L1(ν)

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

11

Exchanging the role of uk and u in this argument implies that the inequality

ˆ

ˆ

ˆ

|u − c∞|ρ(x) dx −

|uk − ck|ρ(x) dx ≤

|u − uk|ρ(x) dx ≤ (cid:107)uk − u(cid:107)L1(ν)

also holds. Combining these inequalities shows that |B(uk) − B(u)| ≤ (cid:107)uk − u(cid:107)L1(ν) → 0 as desired.
Now consider the balance term BR(u) that corresponds to the ratio Cut. For the ratio cut, the inequality
||a| − |b|| ≤ |a − b| immediately implies
ˆ
(cid:12)
(cid:12)
(cid:12)
(cid:12)

|u − meanρ(u)|ρ(x) dx

|uk − meanρ(uk)|ρ(x) dx −
ˆ

(cid:12)
(cid:12)
(cid:12)
(cid:12)

ˆ

ˆ

ˆ

≤

≤

|uk − u|ρ(x) dx +

| meanρ(uk) − meanρ(u)|ρ(x) dx

|uk − u|ρ(x) dx + | meanρ(uk) − meanρ(u)|.

Since uk → u in L1(ν) we have that meanρ(uk) → meanρ(u) and therefore |B(uk) − B(u)| ≤
(cid:107)uk − u(cid:107)L1(ν) + | meanρ(uk) − meanρ(u)| → 0 as desired.

In order to prove (ii) suppose that {uk}n∈N is a sequence in Ind(D) converging in L1(ν) to some
u ∈ L1(ν), we need to show that u ∈ Ind(D). By (i) we know that B(uk) → B(u) as k → ∞. Since
uk ∈ Ind(D), in particular B(uk) = 1. Thus, B(u) = 1. On the other hand, uk ∈ Ind(D) implies that
uk has the form uk = αk1Ak . Since this is true for every k, in particular we must have that u has the
form u = α1Afor some real number α and some measurable subset A of D. Finally, the fact that B is
1-homogeneous implies that 1 = B(u) = αB(1A). In particular B(1A) (cid:54)= 0 and α = 1
B(1A) . Thus
u = ˜1A with B(1A) (cid:54)= 0 and hence u ∈ Ind(D).
(cid:3)

Lemma 7. Let D and ν be as stated at the beginning of this section. There exists a measurable set
A ⊆ D with 0 < ν(A) < 1 such that ˜1A minimizes (3.11).

Proof. The statement follows by the direct method of the calculus of variations. Since the functional is
bounded from below it sufﬁces to show that it is lower semicontinuous with respect to the L1(ν) norm
and that a minimizing sequence is precompact in L1(ν). To show lower semi-continuity it is enough to
consider a sequence un = 1An ∈ Ind(D) converging in L1(ν) to u ∈ L1(ν). From Lemma 6 it follows
that u ∈ Ind(D) and hence u = ˜1A for some A with B(A) > 0. Therefore 1An → 1A as n → ∞
in L1(ν). The lower semi-continuity then follows from the lower semi-continuity of the total variation
(3.6), the continuity of B and the fact that since B(1A) > 0, 1/B(1An) → 1/B(1A) as n → ∞.

The pre-compactness of any minimizing sequence of (3.11) follows directly from Theorem 5.1 in
(cid:3)

[6], which completes the proof.

4. ASSUMPTIONS AND STATEMENTS OF MAIN RESULTS.

Here we present the precise hypotheses we use and state precisely the main results of this paper. Let
D be an open, bounded, connected subset of Rd with Lipschitz boundary, and let ρ : D → R be a
continuous density which is bounded below and above by positive constants, that is, for all x ∈ D

(4.1)

λ ≤ ρ(x) ≤ Λ

for some Λ ≥ λ > 0. We let ν be the measure dν = ρdx. Let η : [0, ∞) → [0, ∞) be a similarity
kernel, that is, a function satisfying:

(K1) η(0) > 0 and η is continuous at 0.
(K2) η is non-increasing.
´
(K3) ση :=

Rd η(|x|)|(cid:104)x, e1(cid:105)| dx < ∞.

12

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

We refer to the quantity ση as the surface tension associated to η. These hypotheses on η hold for
the standard similarity functions used in clustering contexts, such as the Gaussian similarity function
η(r) = exp(−r2) and the proximity similarity kernel (i.e. η(r) = 1 if r ≤ 1 and η(r) = 0 otherwise).

The main result of our paper is:

Theorem 8 (Consistency of cuts). Let domain D, probability measure ν and kernel η satisfy the con-
ditions above. Let εn denote any sequence of positive numbers converging to zero that satisfy

lim
n→0

(log n)3/4
n1/2

1
εn

= 0 (d = 2),

= 0

(d ≥ 3).

lim
n→0

(log n)1/d
n1/d

1
εn

Let {xj}j∈N be an i.i.d. sequence of points in D drawn from the density ρ(x) and let Xn = {x1, . . . , xn}.
Let Gn = (Xn, Wn) denote the graph whose edge weights are

wn

ij := η

(cid:19)

(cid:18) |xi − xj|
εn

1 ≤ i, j ≤ n.

n , Y ∗
n

c} denote any optimal balanced cut of Gn (solution of problem (1.1)). If {A∗, A∗c}
Finally, let {Y ∗
is the unique optimal balanced cut of the domain D (solution of problem (3.11)) then with probability
c} converges to {A∗, A∗c} in the T L1-sense. If there is more than one optimal
one the sequence {Y ∗
c} converges along a subsequence to an optimal continuum
continuum balanced cut (3.11) then {Y ∗
balanced cut.

n , Y ∗
n

n , Y ∗
n

Additionally, Cn, the minimum balance cut of the graph Gn (the minimum of (1.1)), satisﬁes

(4.2)

lim
n→∞

Cn
n2εd+1
n

= σηC,

where ση is the surface tension associated to the kernel η and C is the minimum of (1.4).

As we discussed in Remark 1 for d ≥ 3 the scaling of ε on n is essentially the best possible.
The proof of Theorem 8 relies on establishing a variational convergence of discrete balanced cuts to
continuum balanced cuts called the Γ-convergence which we recall in Subsection 5. The proof utilizes
the results obtained in [18], where the notion of Γ-convergence is introduced in the context of data
analysis problems, and in particular the Γ-convergence of the graph total variation is considered. The
Γ-convergence, together with a compactness result, provides sufﬁcient conditions for the convergence
of minimizers of a given family of functionals to the minimizers of a limiting functional.

Remark 9. A few remarks help clarify the hypotheses and conclusions of our main result. The scaling
condition εn (cid:29) (log n)pdn−1/d comes directly from the existence of transportation maps from Propo-
sition (4). This means that εn must decay more slowly than the maximal distance a point in D has
to travel to match its corresponding data point in Xn. In other words, the similarity graph Gn must
contain information on a larger scale than that on which the intrinsic randomness operates. Lastly, the
c} only approximate an optimal balanced
conclusion of the theorem still holds if the partitions {Y ∗
cut, that is if the energies of {Y ∗

n , Y ∗
n

n , Y ∗
n
(cid:18) Cut(Yn
Bal(Y ∗

c} satisfy
c)
∗, Y ∗
n
c)
n , Y ∗
n

lim
n→∞

− min
Y (cid:40)Xn

(cid:19)

Cut(Y, Y c)
Bal(Y, Y c)

= 0.

This important property follows from a general result on Γ-convergence which we recall in Proposition
15.

We also establish the following multiclass equivalent to Theorem 8.

Theorem 10. Let domain D, measure ν, kernel η, sequence {εn}n∈N, sample points {xi}i∈N , and
graph Gn satisfy the assumptions of Theorem 8. Let (Y ∗n
R) denote any optimal balanced
cut of Gn, that is a minimizer of (1.3). If (A∗
R) is the unique optimal balanced cut of D (i.e.

1 , . . . , Y ∗n

1, . . . , A∗

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

13

minimizer of (1.8)) then with probability one the sequence (Y ∗n
in the T L1-sense.
minimizer holds along subsequences. Additionally, Cn, the minimum of (1.3), satisﬁes

1, . . . , A∗
R)
If the optimal continuum balanced cut is not unique then the convergence to a

R) converges to (A∗

1 , . . . , Y ∗n

lim
n→∞

Cn
n2εd+1
n

= σηC,

where ση is the surface tension associated to the kernel η and C is the minimum of (1.8).

The proof of Theorem 10 involves modifying the geometric measure theoretical results from [18].
This leads to a substantially longer and more technical proof than the proof of Theorem 8, but the overall
spirit of the proof remains the same in the sense that the Γ-convergence plays the leading role. Finally,
we remark that analogous observations to the ones presented in Remark 9 apply to Theorem 10.

5. BACKGROUND ON Γ-CONVERGENCE

We recall and discuss the notion of Γ-convergence. In the literature Γ-convergence is deﬁned for
deterministic functionals. Nevertheless, the objects we are interested in are random and thus we decided
to introduce this notion of convergence in this non-deterministic setting.

Let (X, dX ) be a metric space and let (Ω, F, P) be a probability space. Let Fn : X × Ω → [0, ∞] be

a sequence of random functionals.

Deﬁnition 11. The sequence {Fn}n∈N Γ-converges with respect to metric dX to the deterministic func-
tional F : X → [0, ∞] as n → ∞ if with P-probability one the following conditions hold simultane-
ously:

(1) Liminf inequality: For every x ∈ X and every sequence {xn}n∈N converging to x,

(2) Limsup inequality: For every x ∈ X there exists a sequence {xn}n∈N converging to x satisfy-

ing

lim inf
n→∞

Fn(xn) ≥ F (x),

lim sup
n→∞

Fn(xn) ≤ F (x).

We say that F is the Γ-limit of the sequence of functionals {Fn}n∈N (with respect to the metric dX ).

Remark 12. In most situations one does not prove the limsup inequality for all x ∈ X directly. Instead,
one proves the inequality for all x in a dense subset X (cid:48) of X where it is somewhat easier to prove, and
then deduce from this that the inequality holds for all x ∈ X. To be more precise, suppose that the
limsup inequality is true for every x in a subset X (cid:48) of X and the set X (cid:48) is such that for every x ∈ X
there exists a sequence {xk}k∈N in X (cid:48) converging to x and such that F (xk) → F (x) as k → ∞, then
the limsup inequality is true for every x ∈ X. It is enough to use a diagonal argument to deduce this
claim. This property is not related to the randomness of the functionals in any way.

Deﬁnition 13. We say that the sequence of nonnegative random functionals {Fn}n∈N satisﬁes the com-
pactness property if with P-probability one, the following statement holds: any sequence {xn}n∈N
bounded in X and for which

is relatively compact in X.

Fn(xn) < +∞,

sup
k∈N

Remark 14. The boundedness assumption of {xn}n∈N in the previous deﬁnition is a necessary condition
for relative compactness and so it is not restrictive.

14

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

The notion of Γ-convergence is particularly useful when the functionals {Fn}n∈N satisfy the com-
pactness property. This is because it guarantees that with P-probability one, minimizers (or approximate
minimizers) of Fn converge to minimizers of F and it also guarantees convergence of the minimum en-
ergy of Fn to the minimum energy of F (this statement is made precise in the next proposition). This is
the reason why Γ-convergence is said to be a variational type of convergence. The next proposition can
be found in [10, 16]. We present its proof for completeness and for the beneﬁt of the reader. We also
want to highlight the way this type of convergence works as ultimately this is one of the essential tools
used to prove the main theorems of this paper.

Proposition 15. Let Fn : X × Ω → [0, ∞] be a sequence of random nonnegative functionals which are
not identically equal to +∞, satisfying the compactness property and Γ-converging to the deterministic
functional F : X → [0, ∞] which is not identically equal to +∞. If it is true that with P-probability
one, there is a bounded sequence {xn}n∈N satisfying

Then, with P-probability one the following statements hold

(cid:18)

(cid:19)

lim
n→∞

Fn(xn) − inf
x∈X

Fn(x)

= 0

lim
n→∞

inf
x∈X

Fn(x) = min
x∈X

F (x),

(5.1)

(5.2)

furthermore, every bounded sequence {xn}n∈N in X satisfying (5.1) is relatively compact and each
of its cluster points is a minimizer of F . In particular, if F has a unique minimizer, then a bounded
sequence {xn}n∈N satisfying (5.1) converges to the unique minimizer of F .
Proof. Consider Ω(cid:48) a set with P-probability one for which all the statements in the deﬁnition of Γ-
convergence together with the statement of the compactness property hold. We also assume that for
every ω ∈ Ω(cid:48), there exists a bounded sequence {xn}n∈N satisfying (5.1). We ﬁx such ω ∈ Ω(cid:48) and in
particular we can assume that Fn is deterministic for every n ∈ N.

Let {xn}n∈N be a sequence as the one described above. Let ˜x ∈ X be arbitrary. By the limsup

inequality we know that there exists a sequence {˜xn}n∈N with ˜xn → ˜x and such that
lim sup
n→∞

Fn(˜xn) ≤ F (˜x).

By 5.1 we deduce that

(5.3)

F (xn) = lim sup
n→∞
and since ˜x was arbitrary we conclude that

lim sup
n→∞

inf
x∈X

Fn(x) ≤ lim sup
n→∞

Fn(˜xn) ≤ F (˜x),

(5.4)

lim sup
n→∞

Fn(xn) ≤ inf
x∈X

F (x).

The fact that F is not identically equal to +∞ implies that the term on the right hand side of the previous
expression is ﬁnite and thus lim supn→∞ Fn(xn) < +∞. Since the sequence {xn}n∈N was assumed
bounded, we conclude from the compactness property for the sequence of functionals {Fn}n∈N that
{xn}n∈N is relatively compact.

Now let x∗ be any accumulation point of the sequence {xn}n∈N ( we know there exists at least one
due to compactness), we want to show that x∗ is a minimizer of F . Working along subsequences, we
can assume without the loss of generality that xn → x∗. By the liminf inequality, we deduce that
F (x) ≤ F (x∗) ≤ lim inf
(5.5)
n→∞

F (xn).

inf
x∈X

The previous inequality and (5.3) imply that

F (x∗) ≤ F (˜x),

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

15

where ˜x is arbitrary. Thus, x∗ is a minimizer of F and in particular inf x∈X F (x) = minx∈X F (x).
(cid:3)
Finally, to establish (5.2) note that this follows from (5.4) and (5.5).

5.1. Γ-convergence of graph total variation. Of fundamental importance in obtaining our results is
the Γ-convergence of the graph total variation proved in [18]. Let us describe this functional and also
let us state the results we use. Given a point cloud Xn := {x1, . . . , xn} ⊆ D where D is a domain in
Rd, we denote by GT Vn,εn : L1(νn) → [0, ∞] the functional:
(cid:18) |xi − xj|
εn

|un(xi) − un(xj)|,

GT Vn,εn(un) :=

1
n2εd+1
n

n
(cid:88)

(5.6)

(cid:19)

η

i,j=1

where η is a Kernel satisfying conditions (K1)-(K3). The connection of the functional GT Vn,εn to
problem (1.1) is the following: if Yn is a subset of Xn, then the graph total variation of the indicator
function 1Yn is equal to a rescaled version of the graph cut of Yn, that is,

GT Vn,εn(1Yn) =

2Cut(Yn, Y c
n )
n2εd+1
n

.

Now we present the results obtained in [18].

Theorem 16 (Theorem 1.1 in [18] ). Let domain D, measure ν, kernel η, sequence {εn}n∈N, sample
points {xi}i∈N , and graph Gn satisfy the assumptions of Theorem 8. Then, GT Vn,εn, deﬁned by (5.6),
Γ-converge to σηT V as n → ∞ in the T L1 sense, where ση is the surface tension associated to the
kernel η (see condition (K3)) and T V is the weighted (by ρ2) total variation functional deﬁned in (3.1).

Moreover, we have the following compactness result.

Theorem 17 (Theorem 1.2 in [18]). Under the same hypothesis of Theorem 1.1 in [18], the sequence
of functionals {GT Vn,εn}n∈N satisﬁes the compactness property. Namely, if a sequence {un}n∈N with
un ∈ L1(νn) satisﬁes

(cid:107)un(cid:107)L1(νn) < ∞,

sup
n∈N

GT Vn,εn(un) < ∞,

sup
n∈N
then {un}n∈N is T L1-relatively compact.

Finally, Corollary 1.3 in [18] allows us to restrict the functionals GT Vn,εn and T V to characteristic

functions of sets and still obtain Γ-convergence.

Theorem 18 (Corollary 1.3 in [18]). Under the assumptions of Theorem 1.1 in [18], with probability one
the following statement holds: for every A ⊆ D measurable, there exists a sequence of sets {Yn}n∈N
with Yn ⊆ Xn such that,

and

and

1Yn

T L1
−→ 1A

lim sup
n→∞

GT Vn,εn(1Yn) ≤ σηT V (1A).

6. CONSISTENCY OF TWO-WAY BALANCED CUTS

Here we prove Theorem 8.

16

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

6.1. Outline of the proof. Before proving that {Y ∗
Deﬁnition 5, we ﬁrst pause to outline the main ideas. Rather than directly working with the sets Y ∗
Y ∗
n
by an explicit construction in Subsection 6.2, that

c} converges to {A∗, A∗c} in the sense of
n and
c(x) instead. We ﬁrst show,

c, it proved easier to work with their indicator functions 1Y ∗

n (x) and 1Y ∗

n , Y ∗
n

n

n := ˜1Y ∗

n := ˜1Y ∗
u∗

n (x), u∗∗

(6.1)
where En denotes a suitable objective function deﬁned on L1(νn), the set of functions deﬁned over Xn.
Each function ˜1Yn(x) := αn1Yn(x) is simply a rescaled version of the original indicator function (for
some explicit coefﬁcient αn that we will deﬁne later). Similarly, in Subsection 3.2 we showed that the
normalized indicator functions

minimize En(un) over all un ∈ L1(νn),

c(x)

n

(6.2)

u∗ := ˜1A∗(x), u∗∗ := ˜1A∗c(x) minimize E(u) over all u ∈ L1(ν),

where E is deﬁned by (3.11) .

In Subsection 6.3 we show that the approximating functionals En Γ-converge to σηE in the T L1-
sense. In Lemma 21 we establish that u∗
n exhibit the required compactness. Thus, they must
converge toward the normalized indicator functions ˜1A∗(x) and ˜1A∗c(x) up to relabeling (see Propo-
sition 15). If {A∗, A∗c} is the unique minimizer, the convergence of the whole sequence follows. The
c} toward the partition {A∗, A∗c} in the sense of Deﬁnition 5 is a
convergence of the partition {Y ∗
direct consequence. The convergence (4.2) follows from (5.2) in Proposition 15.

n and u∗∗

n , Y ∗
n

6.2. Functional description of discrete cuts. We introduce functionals that describe the discrete ratio
and Cheeger cuts in terms of functions on Xn, rather than in terms of subsets of Xn. This mirrors the
description of continuum partitions provided in Subsection 3.2. For un ∈ L1(νn), we start by deﬁning

(6.3)

Bn

R(un) :=

|un(xi) − meann(un)|

n
(cid:88)

1
n

and Bn

C(un) := min
c∈R

|un(xi) − c|.

n
(cid:88)

1
n

(cid:80)n

i=1
Here meann(un) = 1
i=1 un(xi). A straightforward computation shows that for Yn ⊆ Xn
n
R(1Yn) = BalR(Yn, Y c
Bn
(6.4)
From here on we write Bn to represent either Bn

n ), Bn
R or Bn
Instead of deﬁning En(un) simply as the ratio GT Vn,εn(un)/Bn(un), which is the direct analogue
of (1.1), it proves easier to work with suitably normalized indicator functions. Given Yn ⊆ Xn with
Bn(1Yn) (cid:54)= 0, the normalized indicator function ˜1Yn(x) is deﬁned by

C(1Yn) = BalC(Yn, Y c
C depending on the context.

n ).

i=1

˜1Yn(x) = 1Yn(x)/Bn

˜1Yn(x) = 1Yn(x)/Bn
Note that Bn(˜1A) = 1. We also restrict the minimization of En(u) to the set
(6.5)

C(1Yn)

Indn(D) := {un ∈ L1(νn) : un = ˜1Yn for some Yn ⊆ Xn with Bn(1Yn) (cid:54)= 0}.
Now, suppose that un ∈ Indn(D), i.e. that un = ˜1Yn for some set Yn with Bn(1Yn) > 0. Using

R(1Yn).

or

(3.8) together with the fact that GT Vn,εn (deﬁned in (5.6)) is one-homogeneous implies, as in (3.10)

(6.6)

GT Vn,εn(un) =

2
n2εd+1
n
Thus, minimizing GT Vn,εn over all un ∈ Indn(D) is equivalent to the balanced graph-cut problem
(1.1) on the graph Gn = (Xn, Wn) constructed from the ﬁrst n data points. We have therefore arrived
at our destination, i.e. a proper reformulation of (1.1) deﬁned over functions un ∈ L1(νn) instead of
subsets of Xn:

Cut(Yn, Y c
n )
Bal(Yn, Y c
n )

.

(6.7)

Minimize En(un) :=

(cid:40)

GT Vn,εn(un)
+∞

if un ∈ Indn(D)
otherwise.

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

17

6.3. Γ-Convergence.

Proposition 19. (Γ-Convergence) Let domain D, measure ν, kernel η, sequence {εn}n∈N, sample
points {xi}i∈N , and graph Gn satisfy the assumptions of Theorem 8. Let En be as deﬁned in (6.7) and
E as in (3.11). Then

En

Γ−→ σnE with respect to T L1 metric as n → ∞

where ση is the surface tension deﬁned in assumption (K3). That is

(1) For any u ∈ L1(ν) and any sequence {un}n∈N with un ∈ L1(νn) that converges to u in T L1,

(6.8)

σηE(u) ≤ lim inf
n→∞
(2) For any u ∈ L1(ν) there exists at least one sequence {un}n∈N with un ∈ L1(νn) which

En(un).

converges to u in T L1 and also satisﬁes

(6.9)

lim sup
n→∞

En(un) ≤ σηE(u).

We leverage Theorem 16 to prove this claim. We ﬁrst need a preliminary lemma which allows us to

handle the presence of the additional balance terms in (6.7) and (3.11).

Lemma 20.

(i) If {un}n∈N is a sequence with un ∈ L1(νn) and un

T L1
−→ u for some u ∈ L1(ν),

(ii) If un = ˜1Yn, where Yn ⊂ Xn, converges to u = ˜1A in the T L1-sense, then 1Yn converges to

then Bn(un) → B(u).

1A in the T L1-sense.

Proof. To prove (i), suppose that un ∈ L1(νn) and that un

T L1
−→ u. Let us consider {Tn}n∈N a stagnating
L1(ν)
sequence of transportation maps between ν and {νn}n∈N. Then, we have un ◦ Tn
−→ u and thus by
(i), we have that B(un ◦ Tn) → B(u). To conclude the proof we notice that B(un ◦ Tn) = Bn(un) for
every n. In fact, by the change of variables (2.2) we have that for every c ∈ R

(6.10)

|un(x) − c|dνn(x) =

|un ◦ Tn(x) − c|dν(x)

ˆ

D

ˆ

D

In particular we have Bn
meann(un) = meanρ(un ◦ Tn) and combining with (6.10) we deduce that Bn

C(un) = BC(un ◦ Tn). Applying the change of variables (2.2), we obtain

R(un) = BR(un ◦ Tn).

(cid:3)

The proof of (ii) is straightforward.

Now we turn to the proof or Proposition 19.

Proof. Liminf Inequality. For arbitrary u ∈ L1(ν) and arbitrary sequence {un}n∈N with un ∈ L1(νn)
and with un

T L1
−→ u, we need to show that

lim inf
n→∞

En(un) ≥ σηE(u).

First assume that u ∈ Ind(D). In particular E(u) = T V (u). Now, note that working along a sub-
sequence we can assume that the liminf is actually a limit and that this limit is ﬁnite (otherwise the
inequality would be trivially satisﬁed). This implies that for all n large enough we have E(un) < +∞,
which in particular implies that En(un) = GT Vn,εn(un). Theorem 16 then implies that

lim inf
n→∞

En(un) = lim inf
n→∞

GT Vn,εn(un) ≥ σηT V (u) = σηE(u).

Now let as assume that u (cid:54)∈ Ind(D). Let us consider a stagnating sequence of transportation maps

{Tn}n∈N between {νn}n∈N and ν. Since un

T L1
−→ u then un ◦ Tn

L1(ν)
−→ u. By Lemma 20 , the set

18

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

Ind(D) is a closed subset of L1(ν). We conclude that un ◦ Tn (cid:54)∈ Ind(D) for all large enough n. From
the proof of Lemma 20 we know that Bn(un) = B(un ◦ Tn) and from this fact, it is straightforward to
show that un ◦ Tn (cid:54)∈ Ind(D) if and only if un (cid:54)∈ Indn(D). Hence, un (cid:54)∈ Indn(D) for all large enough
n and in particular lim inf n∈N En(un) = +∞ which implies that the desired inequality holds in this
case.

Limsup Inequality. We now consider u ∈ L1(ν). We want to show that there exists a sequence

{un}n∈N with un ∈ L1(νn) such that

lim sup
n→∞

En(un) ≤ σηE(u).

Let us start by assuming that u (cid:54)∈ Ind(D). In this case E(u) = +∞. From Theorem 16 we know there
exists at least one sequence {un}n∈N with un ∈ L1(νn) such that un
inequality is trivially satisﬁed in this case.

T L1
−→ u. Since E(u) = +∞, the

On the other hand, if u ∈ Ind(D), we know that u = ˜1A for some measurable subset A of D with
T L1
−→ 1A

B(1A) (cid:54)= 0. By Theorem 18, there exists a sequence {Yn}n∈N with Yn ⊆ Xn, satisfying 1Yn
and

(6.11)

lim sup
n→∞

GT Vn,εn(1Yn) ≤ σηT V (1A).

T L1
−→ 1A Lemma 20 implies that

Since 1Yn
Bn(1Yn) → B(1A).
(6.12)
In particular Bn(1Yn) (cid:54)= 0 for all n large enough, and thus we can consider the function un := ˜1Yn ∈
Indn(D). From (6.12) it follows that un

T L1
−→ u and together with (6.11) it follows that
1
Bn(Yn)

GT Vn,εn(1Yn) ≤

1
B(1A)

σηT V (1A) = σηT V (u)

lim sup
n→∞

GT Vn,εn(un) = lim sup
n→∞

Since, un ∈ Indn(D) for all n large enough, in particular we have GT Vn,εn(1Yn) = En(1Yn) and
also since u ∈ Ind(D), we have E(u) = T V (u). These facts together with the previous chain of
(cid:3)
inequalities imply the result.

6.4. Compactness.

Lemma 21 (Compactness). Any subsequence of {u∗
(6.1) and (6.2)) has a further subsequence that converges in the T L1-sense.

n}n≥1 or {u∗∗

n }n≥1 of minimizers of En (deﬁned in

Proof. Let u∗
subsequence, it sufﬁces to show that both

n, u∗∗

n denote minimizing sequences. To show that any subsequence of u∗

n has a convergent

(6.13)

(6.14)

lim sup
n→∞

lim sup
n→∞

GT Vn,εn(u∗

n) < +∞

(cid:107)u∗

n(cid:107)L1(νn) < +∞

hold due to Theorem 1.2 in [18]. From the Γ-convergence established in Proposition 19 and from the
proof of Proposition 15 it follows that (6.13) is satisﬁed for both minimizing sequences. Recall that
u∗
n = 1Y ∗
To show (6.14), consider ﬁrst the balance term that corresponds to the Cheeger Cut. Deﬁne a se-

n denotes an optimal balanced cut.

n ) and that u∗∗

n ), where Y ∗

n /Bn(1Y ∗c

n /Bn(1Y ∗

n = 1Y ∗c

quence vn as follows. Set vn := u∗

n if |Y ∗

n | ≤ |Y ∗c

n | and vn = u∗∗

n otherwise. It then follows that

(cid:107)vn(cid:107)L1(νn) =

min{|Y ∗
min{|Y ∗

n |, |Y ∗c
n |, |Y ∗c

n |}
n |}

= 1.

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

19

Also, note that GT Vn,εn(vn) = GT Vn,εn(u∗
n). Thus (6.13) and (6.14) hold for vn, so that any sub-
T L1
sequence of vn has a convergent subsequence in the T L1-sense. Let vnk
−→ v denote a convergent
subsequence. Now observe that by construction vnk minimizes Enk for every k. Thus, it follows from
Proposition 19 and general properties of Γ-convergence (see Proposition 15), that v minimizes E and
in particular v is a normalized characteristic function, that is, v = 1A/B(1A) for some A ⊆ D with
T L1
−→ v implies that
B(1A) (cid:54)= 0. Since Bnk (1Y ∗
nk

) = Bnk (1Y ∗c
nk

), vnk

Therefore, for large enough k we have

1
Bnk (Y ∗
nk

)

→

1
B(A)

.

(cid:107)u∗
nk

(cid:107)L1(νnk ) ≤

1
Bnk (Y ∗
nk

)

≤

2
B(A)

and

We conclude that (cid:107)u∗
nk

(cid:107)u∗∗
nk

(cid:107)L1(νnk ) ≤
(cid:107)L1(νnk ) and (cid:107)u∗∗
nk

=

1
Bnk (Y ∗c
nk

1
Bnk (Y ∗
nk

2
B(A)
(cid:107)L1(νnk ) remain bounded, so that both minimizing subse-

≤

)

)

.

quences satisfy (6.14) and (6.13) simultaneously. This yields compactness in the Cheeger Cut case.

Now consider the balance term B(u) = BR(u) that corresponds to the Ratio Cut. Deﬁne a sequence
n) since the total variation is invariant

n), and note that GT Vn,εn(vn) = GT Vn,εn(u∗

vn := u∗
with respect to translation. It then follows that

n−meann(u∗

(cid:107)vn(cid:107)L1(ν) =

|u∗

n(x) − meanρ(u∗

n)|ρ(x) dx = B(u∗

n) = 1.

ˆ

D

T L1
Thus the sequence {vn}n∈N is precompact in T L1. Let vnk
−→ v denote a convergent subsequence.
Using a stagnating sequence of transportation maps {Tnk }k∈N between ν and the sequence of measures
L1(ν)
{νnk }k∈N, we have that vnk ◦ Tnk
−→ v. By passing to a further subsequence if necessary, we may
assume that vnk ◦ Tnk (x) → v(x) for almost every x in D.

For any such x, we have that either Tnk (x) ∈ Y ∗

nk or Tnk (x) ∈ Y ∗c

vnk ◦ Tnk (x) =

or

vnk ◦ Tnk (x) = −

1
2|Y ∗
nk

|

nk so that either
1
2|Y ∗c
nk

|

.

Now, by continuity of the balance term, we have

and also

B(v) = lim
k→∞

Bnk (vnk ) = 1,

meanρ(v) = lim
k→∞

meannk (vnk ) = 0.

In particular the measure of the region in which v is positive is strictly greater than zero, and likewise
the measure of the region in which v is negative is strictly greater than zero. It follows that both |Y ∗
|
nk
and |Y ∗c
| remain bounded away from zero for all k sufﬁciently large. As a consequence, the fact that
nk

(cid:107)u∗
nk

(cid:107)L1(νnk ) =

1
2|Y ∗c
nk

,

|

(cid:107)u∗∗
nk

(cid:107)L1(νnk ) =

1
2|Y ∗
nk

,

|

implies that both (6.13) and (6.14) hold along a subsequence, yielding the desired compactness.

(cid:3)

20

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

6.5. Conclusion of the proof of Theorem 8. We may now turn to the ﬁnal step of the proof. From
n}n∈N ( in the T L1 sense) must equal u∗ or u∗∗. As
Proposition 15, we know that any limit point of {u∗
T L1
a consequence, for any subsequence u∗
−→ 1A∗ by lemma 20,

nk that converges to u∗ we have that 1Y ∗
nk
T L1
−→ 1A∗c if the subsequence converges to u∗∗ instead. Moreover, in the ﬁrst case we would
T L1
−→ 1A∗. Thus in either case we have

while 1Y ∗
nk

also have 1Y ∗c
nk

T L1
−→ 1A∗c and in the second case 1Y c
nk
(cid:9) T L1

, Y ∗c
nk

(cid:8)Y ∗
nk
n , Y ∗c
n }n∈N it is possible to obtain a further subsequence converging

−→ {A∗, A∗c}

Thus, for any subsequence of {Y ∗

to {A∗, A∗c}, and thus the full sequence converges to {A∗, A∗c}.

7. CONSISTENCY OF MULTIWAY BALANCED CUTS

Here we prove Theorem 10.
Just as what we did in the two-class case, the ﬁrst step in the proof of Theorem 10 involves a refor-
mulation of both the balanced graph-cut problem (1.3) and the analogous balanced domain-cut problem
(1.8) as equivalent minimizations deﬁned over spaces of functions and not just spaces of partitions or
sets.

We let Bn(un) := meann(un) for un ∈ L1(νn) and B(u) := meanρ(u) for u ∈ L1(ν), to be the
corresponding balance terms. Given this balance terms, we let Indn(D) and Ind(D) be deﬁned as in
(6.5) and (3.9) respectively.

We can then let the sets Mn(D) and M(D) to consist of those collections U = (u1, . . . , uR)
comprised of exactly R disjoint, normalized indicator functions that cover D. The sets Mn(D) and
M(D) are the multi-class analogues of Indn(D) and Ind(D) respectively. Speciﬁcally, we let
(7.1)

Mn(D) =

(un

1 , . . . , un

R) : un

r ∈ Indn(D),

r (x)un
un

s (x) dνn(x) = 0 if r (cid:54)= s,

un
r > 0

(cid:40)

(cid:40)

(7.2)

M(D) =

(u1, . . . , uR) : ur ∈ Ind(D),

ur(x)us(x) dν(x) = 0 if r (cid:54)= s,

ur > 0

.

Note for example that if U = (u1, . . . , uR) ∈ M(D), then the functions ur are normalized indicator
functions, ur = 1Ar /|Ar| for 1 ≤ r ≤ R, and the orthogonality constraints imply that {A1, . . . , AR}
is a collection of pairwise disjoint sets (up to Lebesgue-null sets). Additionally, the condition that
(cid:80)R
r=1 ur > 0 holds almost everywhere implies that the sets {A1, . . . , AR} cover D up to Lebesgue-

With these deﬁnitions in hand, we may follow the same argument in the two-class case to conclude

null sets.

that that the minimization

(7.3)

Minimize En(Un) :=

r=1 GT Vn,εn(un
r )

(cid:40)(cid:80)R

+∞

if Un ∈ Mn(D)
otherwise

is equivalent to the balanced graph-cut problem (1.3), while the minimization

(7.4)

Minimize E(U) :=

is equivalent to the balance domain-cut problem (1.8).

(cid:40)(cid:80)R

+∞

r=1 T V (ur)

if U ∈ M(D)
otherwise

R
(cid:88)

r=1

(cid:41)

(cid:41)

R
(cid:88)

r=1

ˆ

D

ˆ

D

sense,

That is

(7.5)

(7.6)

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

21

At this stage, the proof of Theorem 10, is completed by following the same steps as in the two-class
case. In particular we want to show that En deﬁned in (7.3) Γ-converges in the T L1-sense to σηE,
where E is deﬁned in 7.4. That is, we want to prove the following.

Proposition 22. (Γ-Convergence) Let domain D, measure ν, kernel η, sequence {εn}n∈N, sample
points {xi}i∈N , and graph Gn satisfy the assumptions of Theorem 8. Consider functionals En of (7.3)
and E of (7.4). Then

En

Γ−→ σnE with respect to (T L1)⊗R metric as n → ∞.

(1) For any U ∈ [L1(D)]R and any sequence Un ∈ (L1(νn))R that converges to U in the T L1

(2) For any U ∈ [L1(D)]R there exists at least one sequence Un that both converges to U in the

T L1-sense and also satisﬁes

E(U) ≤ lim inf
n→∞

En(Un).

lim sup
n→∞

En(Un) ≤ E(U).

Remark 23. We remark that all the types of convergence for vector-valued functions are to be understood
as component-wise convergence in the corresponding topology. This helps us clarify the way the T L1
-convergence is considered in Proposition 22.

Assuming Proposition 22, the following lemma follows in a straightforward way. We omit its proof

since it follows analogous arguments to the ones used in the proof of Proposition 21.

Lemma 24 (Compactness). Any subsequence of {U ∗
quence that converges in the T L1-sense.

n}n≥1 of minimizers to (7.3) has a further subse-

Finally, due to Proposition 22 and Lemma 24, the arguments presented in Subsections 6.1 and 6.5
can be adapted in a straightforward way to complete the proof of Theorem 10. So we focus on the proof
of Proposition 22, where arguments not present in the two-class case are needed. On one hand, this
is due to the presence of the orthogonality constraints in the deﬁnition of Mn(D) and M(D), and on
the other hand, from a geometric measure theory perspective, due to the fact that an arbitrary partition
of the domain D into more than two sets can not be approximated by smooth partitions as multiple
junctions appear when more than two sets in the partition meet.

7.1. Proof of Proposition 22. The next lemma is the multiclass analogue of Lemmas 6 and 20 com-
bined.

Lemma 25. (i) If Uk → U in (L1(ν))R then B(uk
M(D) is closed in L1(ν). (iii) If {Un} is a sequence with Un ∈ (L1(νn))R and Un
U ∈ (L1(ν))R, then Bn(un
to u = ˜1A in the T L1-sense, then 1Yn converges to 1A in the T L1-sense.

r ) → B(ur) for all 1 ≤ r ≤ R.
T L1
−→ U for some
r ) → B(ur) for all 1 ≤ r ≤ R. (iv) If un = ˜1Yn, where Yn ⊂ Xn, converges

(ii) The set

Proof. Statements (i), (iii) and (iv) follow directly from the proof of Proposition 20.

In order to prove the second statement, suppose that a sequence {Uk}k∈N in M(D) converges to
some U in (L1(ν))R. We need to show that U ∈ M(D). First of all note that for every 1 ≤ r ≤ R,
r ∈ Ind(D) for every k ∈ N, and since Ind(D) is a closed subset of L1(ν) (by
uk
r
Proposition 20), we deduce that ur ∈ Ind(D) for every r.

L1(ν)
−→ ur. Since uk

22

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

The orthogonality condition follows from Fatou’s lemma. In fact, working along a subsequence we
r → ur for almost every x in D. Hence, for

can without the loss of generality assume that for every r, uk
r (cid:54)= s we have
ˆ

ˆ

ˆ

0 ≤

ur(x)us(x)dν(x) =

D

lim inf
k→∞

(uk

r (x)uk

s (x))dν(x) ≤ lim inf
k→∞

D

r (x)uk
uk

s (x)dν(x) = 0

Now let us write uk

must have B(1Ak

r

r = 1Ak

) and ur = 1Ak
) → B(1Ar ) as k → ∞. Thus, for almost every x ∈ D

r

r

r

/B(1Ar ). As in the proof of Proposition (20) we

R
(cid:88)

r=1

ur(x) = lim
k→∞

uk
r (x) ≥ lim
k→∞

min
r=1,...,R

1
B(1Ak

r

)

= min

r=1,...,R

1
B(1Ar )

> 0.

D
/B(1Ak

R
(cid:88)

r=1

(cid:3)

Proof of Proposition 22. Liminf inequality. The proof of (7.5) follows the approach used in the two-

T L1
class case. Let Un
−→ U denote an arbitrary convergent sequence. As M(D) is closed, if U /∈ M(D)
then as in the two-class case, it is easy to see that Un /∈ Mn(D) for all n sufﬁciently large. The
inequality (7.5) is then trivial in this case, as both sides of it are equal to inﬁnity. Conversely, if U ∈
M(D) then we may assume that Un ∈ Mn(D) for all n, since only those terms with Un ∈ Mn(D)
can contribute non-trivially to the limit inferior. In this case we easily have

lim inf
n→∞

En(Un) = lim inf
n→∞

GT Vn,εn (un

r ) ≥

lim inf
n→∞

GT Vn,εn(un
r )

R
(cid:88)

r=1

R
(cid:88)

r=1

R
(cid:88)

r=1

≥ ση

T V (ur) = σηE(U).

The last inequality follows from Theorem 16. This establishes the ﬁrst statement in Proposition 22.

Limsup inequality. We now turn to the proof of (7.6), which is signiﬁcantly more involved than the
two-class argument due to the presence of the orthogonality constraints. Borrowing terminology from
the Γ-convergence literature, we say that U ∈ (L1(ν))R has a recovery sequence when there exists a
sequence Un ∈ (L1(νn))R such that (7.6) holds. To show that each U ∈ (L1(ν))R has a recovery
sequence, we ﬁrst remark that due to general properties of the Γ-convergence, it is enough to verify
(7.6) for U belonging to a dense subset of M(D) with respect to the energy E (see Remark 12). We
furthermore remark that it is enough to consider U = (u1, . . . , uR) ∈ (L1(D))R for which E(U) < ∞,
as the other case is trivial. So we can consider U ∈ M(D) that satisfy

R
(cid:88)

r=1

T V (ur) < ∞.

Let ur = 1Ar /B(1Ar ) and let c0 := max{B(1A1), . . . , B(1AR)} denote the size of the largest set in
the collection. The fact that E(U) < ∞ then implies

T V (1Ar ) ≤ c0 T V (ur) ≤ c0

T V (ur) < ∞,

R
(cid:88)

r=1

so that all sets {A1, . . . , AR} in the collection deﬁning U have ﬁnite perimeter. Additionally because
U ∈ M(D) implies that any two sets Ar, As with r (cid:54)= s have empty intersection up to a Lebesgue-
null set, we may freely assume without the loss of generality that the sets {A1, . . . , AR} are mutually
disjoint.

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

23

Let us deﬁne sets with piecewise (PW) smooth boundary to be the subsets of Rd whose boundary is
a subset of ﬁnitely many open d − 1-dimensional manifolds embedded in Rd. We start by constructing
a recovery sequence for a U whose deﬁning sets {A1, . . . , AR} are of the form Ar = Br ∩ D, where
Br has piecewise smooth boundary and satisﬁes |D1Br |ρ2(D) = 0. We say that such U is induced by
piecewise smooth sets. We later prove that such partitions are dense among partitions of D by sets of
ﬁnite perimeters. 2

Contructing a recovery sequence for U induced by piecewise smooth sets. Let Y n

r = Ar ∩ Xn
denote the restriction of Ar to the ﬁrst n data points. Now, let us consider the transportation maps
{Tn}n∈N from Proposition 4. We let Ar
n be the set for which 1An
We ﬁrst notice that the fact that Br has a piecewise smooth boundary in Rd and the fact that ||Id −

r = 1Y r

n ◦ Tn.

Tn||∞ → 0, imply that

(7.7)

(cid:107)1An

r − 1Ar (cid:107)L1(ν) ≤ C0(Br) ||Id − Tn||∞,

where C0(Br) denotes some constant that depends on the set Br. This inequality follows from the
formulas for the volume of tubular neighborhoods (see [44]). In particular, note that by the change of
variables (2.2) we have, |Y n
r | → |Ar| as n → ∞, so that in particular we can assume that
r | (cid:54)= 0. We deﬁne un
|Y n
r | as the corresponding normalized indicator function. We claim
1 , . . . , un
that Un := (un

R) furnishes the desired recovery sequence.

r | = |An
r /|Y n

r := 1Y n

To see that Un ∈ Mn(D) we ﬁrst note that each un

the fact that {A1, . . . , AR} forms a partition of D implies that {Y n
As a consequence,

r ∈ Indn(D) by construction. On the other hand,
R } deﬁnes a partition of Xn.

1 , . . . , Y n

En(Un) =

GT Vn,εn(un
r )

R
(cid:88)

r=1

by deﬁnition of the En functionals.

Using (7.7), we can proceed as in remark 5.1 in [18]. In particular, we can assume that η has the
form η(z) = a for z < b and η(z) = 0 otherwise. We set ˜εn := εn + 2
b ||Id − Tn||∞. Recall that by
assumption ||Id − Tn||∞ (cid:28) εn, and thus ˜εn is a perturbation of εn. Deﬁne the non-local total variation
(cid:103)T V ˜εn of an integrable function u ∈ L1(ν) as

(cid:103)T V ˜εn(u) :=

(cid:18) |x − y|
˜εn
Using the deﬁnition of ˜εn, and the form of the kernel η, we deduce that for all n ∈ N, and almost every
x, y ∈ D we have

|u(x) − u(y)|ρ(x)ρ(y) dxdy.

1
˜εd+1
n

D×D

(cid:19)

η

ˆ

This inequality an a change of variables (see 2.2) implies that

η

(cid:18) |Tn(x) − Tn(y)|
εn

(cid:19)

≤ η

(cid:18) |x − y|
˜εn

(cid:19)

.

εd+1
n
˜εd+1
n

GT Vn,εn(1Y n

r ) ≤ (cid:103)T V ˜εn(1An

r ).

A straightforward computation shows that there exists a constant K0 such that

|(cid:103)T V ˜εn(1An

r ) − (cid:103)T V ˜εn(1Ar )| ≤

(cid:107)1An

r − 1Ar (cid:107)L1(ν) ≤ K0C0(Br)

K0
˜εn

||Id − Tn||∞
˜εn

.

2Note that unlike in the two-class case, due to ”triple junctions”, one cannot approximate a general partition by a partition

with sets with smooth boundaries. This makes the construction more complicated.

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

24

Since εn
˜εn

→ 1, the previous inequalities imply that

lim sup
n∈N

GT Vnεn(1Y n

r ) ≤ lim sup

(cid:103)T V ˜εn(1An

r ) = lim sup

(cid:103)T V ˜εn(1Ar ).

n∈N

n∈N

Finally, from remark 4.3 in [18] we deduce that

lim sup
n→∞

(cid:103)T V ˜εn(1An

r ) ≤ σηT V (1Ar ),

and thus we conclude that lim supn→∞ GT Vn,εn(1Ar ) ≤ σηT V (1Ar ). As a consequence we have

lim sup
n→∞

GT Vn,εn(un

r ) = lim sup
n→∞

r )
GT Vn,εn(1Y n
r )
Bn(1Y n

≤ ση

T V (1Ar )
B(1Ar )

for each r, by continuity of the balance term. From the previous computations we conclude that
En(Un) → E(U), and from 7.7, we deduce that Un → U in the T L1-sense, so that Un does furnish the
desired recovery sequence.

Density. To establish Proposition 22, we show that for any given U = (˜1A1, . . . , ˜1AR) where each
m∈N, where each

)(cid:9)
of the sets Ar has ﬁnite perimeter, there exists a sequence (cid:8)Um = (˜1Am
of the Um is induced by piecewise smooth sets, and such that for every r ∈ {1, . . . , R}

, . . . , ˜1Am

R

1

and

1Am

r

L1(ν)
−→ 1Ar ,

lim
m→∞

T V (1Am

r ; D) = T V (1Ar ; D).

Note that in fact, by establishing the existence of such approximating sequence, it immediately fol-
lows that Um → U in (L1(ν))R and that limm→∞ E(Um) = E(U) ( by continuity of the balance
terms). We provide the construction of the approximating sequence {Um}m∈N through the sequence of
three lemmas presented below.

Lemma 26. Let {A1, . . . , AR} denote a collection of open and bounded sets with smooth boundary in
Rd that satisfy

(7.8)

Hd−1(∂Ar ∩ ∂As) = 0 , ∀r (cid:54)= s.
Let D denote an open and bounded set. Then there exists a permutation π : {1, . . . , R} → {1, . . . , R}
such that

T V (1Aπ(r)\(cid:83)R

s=r+1 Aπ(s)

; D) ≤ T V (1Aπ(r); D), ∀r ∈ {1, . . . , R} .

Proof. The proof is by induction on R. Base case: Note that if R = 1 there is nothing to prove.
Inductive Step: Suppose that the result holds when considering any R − 1 sets as described in the
statement. Let A1, . . . , AR be a collection of sets as in the statement. By the induction hypothesis it is
enough to show that we can ﬁnd r ∈ {1, . . . , R} such that

(7.9)

T V (1Ar\(cid:83)
To simplify notation, denote by Γr the set ∂Ar and deﬁne ars as the quantity

s(cid:54)=r As; D) ≤ T V (1Ar ; D).

ˆ

ars :=

Γr∩(As\(cid:83)

k(cid:54)=r,k(cid:54)=s Ak)∩D

ρ2(x) dHd−1(x).

Hypothesis (7.8) and (3.3) imply that the equality

ˆ

(7.10)

T V (1Ar\(cid:83)

s(cid:54)=r As; D) =

Γr∩((cid:83)

k(cid:54)=r Ak)c∩D

ρ2(x) dHd−1(x) +

(cid:88)

asr

s: s(cid:54)=r

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

25

holds for every r ∈ {1, . . . , R} , as does the inequality

ˆ

(7.11)

T V (1Ar ; D) ≥

Γr∩((cid:83)

k(cid:54)=r Ak)c∩D

ρ2(x) dHd−1 +

(cid:88)

ars.

s: s(cid:54)=r

If T V (1Ar\(cid:83)

s(cid:54)=r As; D) > T V (1Ar ; D) for every r then (7.11) and (7.10) would imply that
(cid:88)

(cid:88)

asr >

ars, ∀r,

s: s(cid:54)=r

s: s(cid:54)=r

which after summing over r would imply

R
(cid:88)

(cid:88)

R
(cid:88)

(cid:88)

R
(cid:88)

(cid:88)

ars =

asr.

asr >

r=1

s: s(cid:54)=r

r=1

s: s(cid:54)=r

r=1

s: s(cid:54)=r

This would be a contradiction. Hence there exists at least one r for which (7.9) holds.

(cid:3)

Lemma 27. Let D denote an open, bounded domain in Rd with Lipschitz boundary and let (B1, . . . , BR)
denote a collection of R bounded and mutually disjoint subsets of Rd that satisfy

(i) T V (1Br ; Rd) < +∞ ,

(ii) |D1Br |ρ2(∂D) = 0 and

(iii) D ⊆ ∪R

r=1Br.

Then there exists a sequence of mutually disjoint sets {Am
which cover D and satisfy

1 , . . . , Am

R } with piecewise smooth boundaries

(7.12)

1Am

r →L1(Rd) 1Br

and

lim
m→∞

T V (1Am

r ; D) = T V (1Br ; D)

for all 1 ≤ r ≤ R.
Proof. First of all note that T V (1Br ; Rd) and |D1Br |ρ2(∂D) are deﬁned considering ρ as a function
from Rd into R. We are using the extension considered when we introduced the weighted total variation
at the beginning of subsection 3.1. Given that ρ2 : Rd → (0, ∞) is lower semi-continuous and bounded
below and above by positive constants then, it belongs to the class of weights considered in [6] where
the weighted total variation is studied.

Let {γk}k∈N denote some sequence of positive reals converging to zero and
(cid:19)

ˆ

Jk(x) :=

1
γd
k

J

(cid:18) |x|
γk

J ≥ 0, J ∈ C∞

c ([0, 1]),

J(x) dx = 1

Rd

a corresponding sequence of positive, radially symmetric molliﬁers. Let Dk := {x ∈ Rd : dist(x, D) <
γk} denote the open γk-neighborhood of the domain D. For each k ∈ N and each Br in the collection
let

uk
r := Jk ∗ 1Br

denote a smoothed version of the characteristic function.

For any test function Φ ∈ C1

c (D : Rd) with |Φ(x)| ≤ ρ2(x), we have

ˆ

D

ˆ

Dk

uk
r div(Φ(x)) dx = −

1Br div(Jk ∗ Φ(y)) dy ≤ |D1Br |ρ2(Dk).

The equality follows from the symmetry of Jk and the fact that Jk ∗ Φ has support within Dk while
the inequality follows from the fact that |Jk ∗ Φ| ≤ ρ2 so it produces an admissible test function in the
deﬁnition of the total variation. As a consequence,

lim sup
k→∞

T V (uk

r ; D) ≤ lim sup
k→∞

|D1Br |ρ2(Dk) = |D1Br |ρ2(D) = |D1Br |ρ2(D)

26

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

due to the second assumption in the statement of the lemma. The fact that uk
with the lower-semicontinuity of the total variation to imply

r →L1(Rd) 1Br combines

T V (1Br ; D) ≤ lim inf
k→∞

T V (uk

r ; D) ≤ lim sup
k→∞

T V (uk

r ; D) ≤ T V (1Br ; D).

In other words, these sequences satisfy

uk
r →L1(Rd) 1Br ,
The (uk
1, . . . , uk
α > 0 so that

T V (uk

r ; D) → T V (1Br ; D),

0 ≤ uk

r (x) ≤ 1 ∀x ∈ Rd.

R) also satisfy one additional property that will prove useful: there exists a constant

Σk(x) :=

uk
r (x) ≥ α > 0

for all x ∈ D.

R
(cid:88)

r=1

To see this, note that the fact that D is an open and bounded set with Lipschitz boundary implies that
there exists a cone C ⊆ Rd with non-empty interior, a family of rotations {Rx}x∈D and ζ > 0 such
that for every x ∈ D,

The fact that J is radially symmetric then implies that for every x ∈ D,

x + Rx(C ∩ B(0, ζ)) ⊆ D.

ˆ

ˆ

D
ˆ

Jk(x − y)dy ≥

Jk(x − y)dy =

x+Rx(C∩B(0,ζ))

ˆ

Jk(y)dy =

J(y)dy ≥ α > 0

C∩B(0,ζ)

C∩B(0, ζ
γk

)

for some positive constant α. The summation Σk(x) of all uk

r therefore satisﬁes the pointwise esti-

mate

R
(cid:88)

Σk(x) :=

uk
r (x) =

ˆ

Rd

r=1
for all x ∈ D as claimed.

Step 1: Now, for each uk

Jk(x − y)

1Br (y) dy ≥

Jk(x − y)dy ≥ α

R
(cid:88)

r=1

ˆ

D

r and each t ∈ (0, 1) consider the superlevel set
(cid:110)

(cid:111)

Bk

r (t) :=

uk
r > t

.

The ﬁrst claim is that, for any ﬁxed t in (0, 1), the characteristic function 1Bk
to the characteristic function of the original set. To see this, note that
(cid:111)

(cid:110)

Bk

r (t) \ Br ⊂

|uk

r − 1Br | ≥ t

.

r (t) converges in L1(Rd)

By Chebyshev’s/Markov’s inequality, if Ld denotes Lebesgue measure in Rd then
(cid:16)(cid:110)

(cid:111)(cid:17)

Ld(Bk

r (t) \ Br) ≤ Ld

|uk

r − 1Br | > t

≤

(cid:107)uk

r − 1Br (cid:107)L1 → 0.

1
t

In a similar fashion,

Ld(Br \ Bk

r (t)) ≤ Ld

|uk

r − 1Br | ≥ (1 − t)

(cid:107)uk

r − 1Br (cid:107)L1 → 0.

(cid:16)(cid:110)

(cid:111)(cid:17)

≤

1
1 − t

As a consequence, it follows that

ˆ

Rd

as claimed.

|1Bk

r (t) − 1Br | dx = Ld(Bk

r (t) \ Br) + Ld(B \ Bk

r (t)) → 0

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

27

Step 2: The next claim is that there exists a set T ⊂ (0, 1) of full Lebesgue measure with the
following property: if t ∈ T then Bk
R(t))
in the collection. To see this, note Sard’s lemma (see for example [29]) implies that for any ﬁxed k ∈ N
the set Bk
r (t) has smooth boundary up to an exceptional set Tk,r ⊂ (0, 1) of Lebesgue measure zero.
Now deﬁne the set T as

r (t) has a smooth boundary for all k and all sets (Bk

1 (t), . . . , Bk

T = (0, 1) \

Tk,r.

∞
(cid:91)

R
(cid:91)

k=1

r=1

Note that T has full measure since a countable union of Lebesgue-null sets has measure zero. If t ∈ T
then it does not lie in any of the exceptional sets, meaning that for each k and each r the set Bk
r (t) has
a smooth boundary.

Step 3: We use a diagonal argument to construct an approximating sequence of partitions that are

not necessarily disjoint, but satisfy the hypotheses of Lemma (7.8).

For the set B1, Step 1 and lower semi-continuity of the total variation imply that for all t ∈ (0, 1)

On the other hand, Fatou’s lemma combines with the co-area formula to imply

T V (1B1; D) ≤ lim inf
k→∞

T V (1Bk

1 (t); D).

lim inf
k→∞

T V (1Bk

1 (t); D) dt ≤ lim
k→∞

T V (1Bk

1 (t); D) dt = lim
k→∞

T V (uk

1; D) = T V (1B1; D).

ˆ

1

0

T V (1B1; D) ≤ lim inf
k→∞

T V (1Bk

1 (t); D)

and

T V (1Bk

1 (t); D) dt = T V (1B1; D),

ˆ

1

lim inf
k→∞

0

ˆ

1

0

In other words,

which implies

lim inf
k→∞

T V (1Bk

1 (t); D) = T V (1B1; D)

In particular, there exists a t1 ∈ T with 0 < t1 < α/R and a subsequence

almost everywhere.
{km}m∈N with the property that

(7.13) ∂Bkm

1 (t1) is smooth ∀m,

lim
m→∞
We now pass to the set B2. As ∂Bkm

measure for all m in particular. As ukm
2
Hd−1 (cid:16)

T V (1Bkm

(t1); D) = T V (1B1; D),

1

1Bkm

1

(t1)

L1(ν)
−→ 1B1.

1 (t1) is smooth and bounded for all m, it has zero Lebesgue
is smooth, lemma 2.95 in [1] implies that

∂Bkm

1 (t1) ∩ ∂Bkm

2 (t)

= 0

(cid:17)

for almost every t ∈ (0, 1). Let T2,m denote the mth exceptional set for which this property does not
hold. Deﬁne the set

which has full Lebesgue measure. By deﬁnition, if t ∈ T2 then ∂Bkm

2 (t) is smooth for all m and

T2 := T \

T2,m,

∞
(cid:91)

m=1

Hd−1 (cid:16)

∂Bkm

1 (t1) ∩ ∂Bkm

2 (t)

= 0

(cid:17)

for all m as well. Along the subsequence {km}, the lower semi-continuity property still holds,

T V (1B2; D) ≤ lim inf
k→∞

T V (1B

nk

2 (t); D),

28

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

as does the argument based on Fatou’s lemma and the co-area formula. In particular, there exists a
further subsequence {kml}l∈N and a t2 ∈ T2 with 0 < t2 < α/R so that (7.13) holds along this
subsequence. The analogous properties hold for the sets {B

Hd−1 (cid:16)

kml
∂B
1

kml
2
kml
(t1) ∩ ∂B
2

(t2)

= 0

(t2)} as well. Moreover, the relation
(cid:17)

also holds along this subsequence. By extracting (R − 2) more subsequences in this way, we obtain
a subsequence taht we denote simply by km of the original sequence together with a sequence of sets
Bkm
r

(tr) with 0 < tr < α/R that satisfy

(tr) is smooth ∀m,

T V (1Bkm

r

(tr); D) = T V (1Br ; D),

1Bkm

r

(tr)

L1(ν)
−→ 1Br ,

∂Bkm
r
Hd−1 (cid:16)

(7.14)

∂Bkm
r

(tr) ∩ ∂Bkm

s

(ts)

= 0

for all m and all r (cid:54)= s.

lim
m→∞
(cid:17)

Let Bm
r
exists

:= Bkm

Step 4: We now use the sets constructed in the previous step and lemma 26 to complete the proof.
1 , . . . , Bm
R ) cover D as well. To see this, suppose there
(cid:32) R
(cid:91)

(tr). We claim that the sets (Bm

(cid:33)

r

x ∈ D \

Bm
r

.

This would imply that ukm

r (x) ≤ tr for all r by deﬁnition. In turn,

r=1

R
(cid:88)

r=1

Σkm(x) ≤

tr < α,

which contradicts the estimate on Σkm obtained earlier. Due to (7.14) and Lemma 26, for each m ∈ N
there exists a permutation πm : {1, . . . , R} → {1, . . . , R} with the property that
T V (cid:0)1Am
r denotes the set

for all 1 ≤ r ≤ R, where Am

r ; D(cid:1) ≤ T V (1Bm

r ; D)

Am

r := Bm

r \

Bm

πm(s).

R
(cid:91)

s=π−1

m (r)+1

1Am

r →L1(Rd) 1Br

Each Am
r has a piecewise smooth boundary for all m due to the fact that each Bm
ary. The disjointness of (B1, . . . , BR) combines with the L1-convergence of 1Bm

r has a smooth bound-
to 1Br to show that

r

as well. This combines with lower semi-continuity of the total variation to imply
; T V (cid:0)1Am
T V (cid:0)1Am

r ; D(cid:1)
r ; D(cid:1) ≤ lim sup

T V (1Br ; D) ≤ lim inf
m→∞
≤ lim sup
m→∞

T V (1Bm

m→∞

r ; D) = T V (1Br ; D).

Finally, noting that

D ⊂

Bm

r =

Am
r

R
(cid:91)

r=1

R
(cid:91)

r=1

and that the Am

r are pairwise disjoint yields the claim.

(cid:3)

To complete the construction, and therefore to conclude the proof of theorem 2, we need to verify

the hypotheses (i − ii) of the previous lemma. This is the content of our ﬁnal lemma.

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

29

Lemma 28. Let D be an open and bounded domain with Lipschitz boundary and let {A1, . . . , AR}
denote a disjoint collection of sets that satisfy

Ar ⊂ D and T V (1Ar ; D) < ∞.
Then, there exists a disjoint collection of bounded sets (B1, . . . , BR) that satisfy Br ∩ D = Ar together
with the properties

(i) T V (1Br ; Rd) < +∞ and

(ii) |D1Br |ρ2(∂D) = 0.

The proof follows from remark 3.43 in [1] (which with minimal modiﬁcations applies to total varia-
(cid:3)

tion with weight ρ2).

8. NUMERICAL EXPERIMENTS

We now present numerical experiments to provide a concrete demonstration and visualization of
the theoretical results developed in this paper. These experiments focus on elucidating when and how
minimizers of the graph-based Cheeger Cut problem,

(8.1)

(8.2)

u∗
n ∈ argmin
u∈L1(νn)

En(u)

with

Bn(u) := min
c∈R

|u(xi) − c|,

converge in the appropriate sense to a minimizer of the continuum Cheeger Cut problem

u∗ ∈ argmin
u∈L1(ν)

E(u)

with

B(u) := min
c∈R

|u(x) − c| dx.

1
n

n
(cid:88)

i=1

ˆ

D

We always take ρ(x) := 1/vol(D) as the constant density. The data points Xn := {x1, . . . , xn} there-
fore represent i.i.d. samples from the uniform distribution. We consider the following two rectangular
domains

D1 := (0, 1) × (0, 4)

and

D2 := (0, 1) × (0, 1.5)

in our experiments. We may easily compute the optimal continuum Cheeger Cut for these domains.
The characteristic function

1A1(x)
when appropriately normalized, provides a minimizer u∗
former case, while the characteristic function

for

A1 := {(x, y) ∈ D1 : y > 2} ,

1 ∈ L1(ν) of the continuum Cheeger Cut in the

1A2(x)

for
analogously furnishes a minimizer u∗
2 ∈ L1(ν) in the latter case. Figure 2 provides an illustration of a
sequence of discrete partitions, computed from the graph-based Cheeger Cut problem, to the optimal
continuum Cheeger Cut.

A2 := {(x, y) ∈ D2 : y > 0.75}

Each of our experiments utilize the nearest neighbor kernel η(z) = 1{|z|≤1} for the computation of

the similarity weights,

wi,j = 1{(cid:107)xi−xj (cid:107)≤εn},
so that the graphs Gn = (Xn, Wn) correspond to εn-nearest neighbor graphs (a.k.a. random geometric
graphs). We use the steepest descent algorithm from [12] to solve the graph-based Cheeger Cut problem
on these graphs. We initialized the algorithm with the “ground-truth” partition Y i
n := Ai ∩ Xn, and we
terminated the algorithm once three consecutive iterates show 0% change in the corresponding partition
of the graph. We let Y ∗
n denote the partition of Gn returned by the algorithm, which we view as the
“optimal” solution of the graph-based Cheeger Cut problem. We quantify the error between the optimal

30

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

FIGURE 2. Visualization of the convergence process. Each ﬁgure depicts a computed
optimal partition Y ∗
n (in black) of one random realization of the random geometric
graph Gn = (Xn, Wn) for each k ∈ {0, 1, . . . , 7}, where n = 1000 × 2k, ε = n−0.3
and the domain considered is D1. Note that the scaling of ε with respect to n falls
within the context of our theoretical results. The red line indicates the optimal cut, i.e.
the boundary of the set A1 := {(x, y) ∈ D1 : y > 2} , at the continuum level.

1
n

n
(cid:88)

i=1

ˆ

D

ˆ

continuum partition Ai (cid:40) Di and the nth optimal graph-based partition Y ∗
percentage of misclassiﬁed data points, i.e.

n of Gn simply by using the

(8.3)

en =

|1Y i

n

(xi) − 1Y ∗

n (xi)|.

If Tn(x) denotes a sequence of transportation maps between νn and ν that satisfy ||Id − Tn||∞ =

o(1), then by the change of variables (2.2)

en =

|1Ai ◦ Tn(x) − 1Y n

∗ ◦ Tn(x)| dx.

By the triangle inequality, we therefore obtain

(cid:107)1Ai − 1Y ∗

n ◦ Tn(cid:107)L1(ν) :=

|1Ai(x) − 1Y ∗
ˆ

D

n ◦ Tn(x)| dx

≤ en +

|1Ai(x) − 1Ai ◦ Tn(x)| dx ≤ en + O (||Id − Tn||∞) .

D

The last inequality follows since each Ai has a piecewise smooth boundary. In this way, if ||Id −
Tn||∞ = o(1) then verifying en = o(1) sufﬁces to show that T L1 convergence of minimizers holds.
Under this assumption, i.e. ||Id − Tn||∞ = o(1), a similar argument shows that having en = o(1) is
equivalent to T L1 convergence in the context of our experiments.

To check convergence, and to explore the issues related to Remark (2), we perform exhaustive nu-
merical experiments for three distinct scalings of εn with respect to the total number of sample points
on the domain D2. Speciﬁcally, we consider the scalings

εn = n−0.3,

εn = 2

,

and

εn =

(cid:19)1/2

(cid:18) log n
πn

(cid:18) log n
πn

(cid:19)1/2

.

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

31

(a) εn = n−0.3

(b) εn = 2(log n/(πn))1/2

FIGURE 3. Graph regularity. We work with the domain D2. For each scaling
of εn with n, the corresponding plot depicts two measures of regularity for the
sequence of random geometric graphs. The ﬁrst measure (in red) is the average
E(max(di)/min(di)), i.e.
the average ratio of the maximal degree max(di) of Gn
to the minimal degree. For each n, the average is computed over 1, 440 independent
graph realizations. The second measure (in green) corresponds to the ratio of the aver-
age maximal degree to the average minimal degree, computed over 1, 440 independent
trials as before. The graphs with εn = n−0.3 become increasingly regular while the
graphs with εn = 2(log n/(πn))1/2 become increasingly irregular.

These scalings correspond to three distinct types of random geometric graphs. The ﬁrst scaling falls well
within the acceptable bounds for εn covered by our consistency theorems. In particular, Gn is almost
surely connected in this regime. The second scaling also gives rise to a sequence Gn of connected
random geometric graphs (see [22], [32]). However, the geometric graphs Gn exhibit rather different
structural properties in this case; if εn = n−0.3 then the graphs Gn become increasingly regular as
n → ∞, while if πε2
n = 2(log n)/n then the graphs Gn become increasingly irregular. See Figure 3 for
an illustration. The ﬁnal scaling corresponds to a scaling bellow the connectivity threshold of random
geometric graphs (c.f. [22], [32]). The graphs Gn are almost surely disconnected under this scaling.
However, in this regime each Gn has a “giant component” (i.e. a connected subgraph Hn of Gn) that
contains all but a small handful of vertices (c.f. Figure 5 at left).

We designed our experiments to explore the extent to which connectivity, and connectivity alone, is
responsible for consistency of balanced cuts. The ﬁrst scaling εn = n−0.3 serves as a benchmark or con-
trol. It falls within the context of our consistency theorems, and so provides a means of determining the
“typical” behavior of balanced cut algorithms when consistency holds. The second scaling, which falls
outside the realm of our consistency results, tests whether connected graphs with different structural
properties still lead to consistent results. The ﬁnal scaling probes the realm where connectivity fails,
but in a mild and easily correctible way. As the theory outlined above indicates, if we pose the balance
cut minimization over the full graph Gn then we can no longer expect consistency to hold. These graphs
pose no practical difﬁculty, however, as we may simply extract the giant component Hn of each Gn and
then minimize the balanced cut over this connected subgraph. We simply assign each vertex in Gn \ Hn
to one of the two classes uniformly at random. Our last experiment explores whether consistency might
still hold using this modiﬁed approach.

32

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

n =

εn = n−0.3 :
E(en)
Trials

E(en)
Trials

E(en)
Trials

εn = 2(log n/(πn))1/2 :

εn = (log n/(πn))1/2 :

1k

2k

4k

8k

16k

32k

64k

128k

.0778

.0609

.0471 .0397 .0321 .0238 .0205 .0161

20063

4800

1200

1536

1536

1008

192

156

.0717

.0605

.0507 .0431 .0366 .0309

10080 10080

4032

1008

1008

304

×

×

×

×

×

.3243

.1977

.1203 .0891 .0672 .0545 .0442

2896

16128

×
TABLE 1. Average error E(en) between partitions. For each n and each scaling of εn,
we obtained an estimate of the average error E(en) by computing the mean of (8.3)
over the indicated number of independent trials. Figure 4 provides a corresponding
error plot.

2016

1008

8064

592

80

(a) εn = n−0.3

(b) εn = 2(log n/(πn))1/2

FIGURE 4. Log-log plot of the expected errors computed in Table 1, together with a
corresponding linear approximation.

Table 1, Figure 4 and Figure 5 report the results of these experiments. In all cases, we measure
error by using the expected number of misclassiﬁed points (8.3) averaged over the number of trials
indicated in Table 1. We used a smaller number of trials for large n (or no trial at all, indicated by a
×) simply due to the overwhelming computational burden. The measure of error considered in these
experiments, taken alone, does not sufﬁce to show convergence in the almost sure sense as provided by
our consistency theorems. It does, however, indicate consistency in the weaker sense of convergence in
probability (via Markov’s inequality). The algorithm we use to optimize the discrete Cheeger cut also
relies upon a non-convex minimization [12], so we cannot say with certainty that the corresponding
computed optimizers are global. Instead, initializing the algorithm with the “ground truth” partition

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

33

(a)

(b)

FIGURE 5. Convergence in the disconnected regime εn = (log n/(πn))1/2. At left:
the expected fraction of vertices that lie in the giant component Hn of the disconnected
random geometric graph Gn. At right: a log-log plot of the expected errors computed
in Table 1, together with a corresponding linear approximation for n large.

biases the algorithm toward the correct cut. If the algorithm were to fail under these circumstances, it
would provide strong numerical evidence against consistency.

The results appear rather similar regardless of whether εn lies in the strongly connected (εn = n−0.3),
weakly connected (εn = 2(log n/(πn))1/2) or weakly disconnected (εn = (log n/(πn))1/2) regimes.
Indeed, in each case the error E(en) decays to zero with a polynomial rate. In other words, the varying
structural properties of the random geometric graphs in these regimes do not seem to play much of a
role. While certainly not conclusive evidence, it seems reasonable to conjecture that consistency should
hold, perhaps in the weaker probabilistic sense, for εn as small as the critical scaling for connectivity.
We leave a further exploration of this for future research.

Acknowledgements. The authors are grateful to ICERM, where part of the research was done during
the research cluster Geometric analysis methods for graph algorithms. DS and NGT are grateful to
NSF (grant DMS-1211760) for its support. JvB was supported by NSF grant DMS 1312344. TL was
supported by NSF (grant DMS-1414396). The authors would like to thank the Center for Nonlinear
Analysis of the Carnegie Mellon University for its support.

REFERENCES

[1] L. Ambrosio, N. Fusco, and D. Pallara. Functions of bounded variation and free discontinuity problems. Oxford Mathe-

matical Monographs. The Clarendon Press, Oxford University Press, New York, 2000.

[2] R. Andersen, F. Chung, and K. Lang. Local graph partitioning using pagerank vectors. In Proceedings of the 47th Annual

Symposium on Foundations of Computer Science (FOCS ’06), pages 475–486, 2006.

[3] E. Arias-Castro and B. Pelletier. On the convergence of maximum variance unfolding. The Journal of Machine Learning

[4] E. Arias-Castro, B. Pelletier, and P. Pudlo. The normalized graph cut and Cheeger constant: from discrete to continuous.

Research, 14(1):1747–1770, 2013.

Advances in Applied Probability, 44:907–937, 2012.

[5] S. Arora, S. Rao, and U. Vazirani. Expander ﬂows, geometric embeddings and graph partitioning. Journal of the ACM

[6] A. Baldi. Weighted BV functions. Houston J. Math., 27(3):683–705, 2001.
[7] M. Belkin and P. Niyogi. Convergence of Laplacian eigenmaps. Advances in Neural Information Processing Systems

(JACM), 56(2):5, 2009.

(NIPS), 19:129, 2006.

34

N. GARCIA TRILLOS, D. SLEP ˇCEV, J. VON BRECHT, T. LAURENT AND X. BRESSON

[8] M. Belkin and P. Niyogi. Towards a theoretical foundation for Laplacian-based manifold methods. J. Comput. System

[9] G. Bellettini, G. Bouchitt´e, and I. Fragal`a. BV functions with respect to a measure and relaxation of metric integral

Sci., 74(8):1289–1308, 2008.

functionals. J. Convex Anal., 6(2):349–366, 1999.

[10] A. Braides. Gamma-Convergence for Beginners. Oxford Lecture Series in Mathematics and Its Applications, Oxford

University Press, 2002.

12-27, UCLA, 2012.

[11] X. Bresson and T. Laurent. Asymmetric Cheeger cut and application to multi-class unsupervised clustering. CAM report

[12] X. Bresson, T. Laurent, D. Uminsky, and J. von Brecht. Convergence and energy landscape for Cheeger cut clustering.

In Advances in Neural Information Processing Systems (NIPS), pages 1394–1402, 2012.

[13] X. Bresson, T. Laurent, D. Uminsky, and J. von Brecht. Multiclass total variation clustering. In Advances in Neural

Information Processing Systems (NIPS), 2013.

[14] J. Cheeger. A Lower Bound for the Smallest Eigenvalue of the Laplacian. Problems in Analysis, pages 195–199, 1970.
[15] F. R. K. Chung. Spectral Graph Theory, volume 92 of CBMS Regional Conference Series in Mathematics. Published for

the Conference Board of the Mathematical Sciences, Washington, DC, 1997.

[16] G. Dal Maso. An Introduction to Γ-convergence. Springer, 1993.
[17] R. M. Dudley. Real analysis and probability, volume 74 of Cambridge Studies in Advanced Mathematics. Cambridge

University Press, Cambridge, 2002. Revised reprint of the 1989 original.

[18] N. Garc´ıa Trillos and D. Slepˇcev. Continuum limit of total variation on point clouds. Preprint, 2014.
[19] N. Garc´ıa Trillos and D. Slepˇcev. On the rate of convergence of empirical measures in ∞-transportation distance.

Preprint, 2014.

[20] E. Gin´e and V. Koltchinskii. Empirical graph Laplacian approximation of Laplace-Beltrami operators: large sample
results. In High dimensional probability, volume 51 of IMS Lecture Notes Monogr. Ser., pages 238–259. Inst. Math.
Statist., Beachwood, OH, 2006.

[21] A. Goel, S. Rai, and B. Krishnamachari. Sharp thresholds for monotone properties in random geometric graphs. In
Proceedings of the 36th Annual ACM Symposium on Theory of Computing, pages 580–586, New York, 2004. ACM.
[22] P. Gupta and P. R. Kumar. Critical power for asymptotic connectivity in wireless networks. In Stochastic analysis,
control, optimization and applications, Systems Control Found. Appl., pages 547–566. Birkh¨auser Boston, Boston, MA,
1999.

[23] L. Hagen and A. Kahng. New spectral methods for ratio cut partitioning and clustering. IEEE Trans. Computer-Aided

Design, 11:1074 –1085, 1992.

[24] J. Hartigan. Consistency of single linkage for high density clusters. J. Amer. Statist. Assoc., 76:388–394., 1981.
[25] M. Hein, J.-Y. Audibert, and U. Von Luxburg. From graphs to manifolds–weak and strong pointwise consistency of

graph Laplacians. In Learning theory, pages 470–485. Springer, 2005.

[26] M. Hein and T. B¨uhler. An Inverse Power Method for Nonlinear Eigenproblems with Applications in 1-Spectral Clus-

tering and Sparse PCA. In Advances in Neural Information Processing Systems (NIPS), pages 847–855, 2010.

[27] M. Hein and S. Setzer. Beyond Spectral Clustering - Tight Relaxations of Balanced Graph Cuts. In Advances in Neural

Information Processing Systems (NIPS), 2011.

[28] R. Kannan, S. Vempala, and A. Vetta. On clusterings: Good, bad and spectral. Journal of the ACM (JACM), 51(3):497–

[29] G. Leoni. A ﬁrst course in Sobolev spaces, volume 105 of Graduate Studies in Mathematics. American Mathematical

515, 2004.

Society, Providence, RI, 2009.

[30] M. Maier, U. von Luxburg, and M. Hein. How the result of graph clustering methods depends on the construction of the

graph. ESAIM: Probability and Statistics, 17:370–418, 1 2013.

[31] M. Penrose. A strong law for the longest edge of the minimal spanning tree. Ann. Probab., 27(1):246–260, 1999.
[32] M. Penrose. Random geometric graphs, volume 5 of Oxford Studies in Probability. Oxford University Press, Oxford,

[33] D. Pollard. Strong consistency of k-means clustering. ann. statist. 9 135–140. Annals of Statistics, 9:135–140, 1981.
[34] J. Shi and J. Malik. Normalized Cuts and Image Segmentation. IEEE Transactions on Pattern Analysis and Machine

Intelligence (PAMI), 22(8):888–905, 2000.

[35] A. Singer. From graph to manifold Laplacian: the convergence rate. Appl. Comput. Harmon. Anal., 21(1):128–134,

2003.

2006.

[36] D. A. Spielman and S.Teng. Nearly-linear time algorithms for graph partitioning, graph sparsiﬁcation, and solving linear
systems. In Proceedings of the thirty-sixth annual ACM symposium on Theory of computing, pages 81–90, 2004.
[37] D. A. Spielman and S. Teng. A local clustering algorithm for massive graphs and its application to nearly linear time

graph partitioning. SIAM Journal on Computing, 42(1):1–26, 2013.

CONSISTENCY OF CHEEGER AND RATIO GRAPH CUTS

35

[38] A. Szlam and X. Bresson. Total variation and Cheeger cuts. In International Conference on Machine Learning (ICML),

pages 1039–1046, 2010.

[39] D. Ting, L. Huang, and M. I. Jordan. An analysis of the convergence of graph Laplacians. In Proceedings of the 27th

International Conference on Machine Learning, 2010.

[40] U. von Luxburg. A tutorial on spectral clustering. Statistics and Computing, 17(4):395–416, 2007.
[41] U. von Luxburg, M. Belkin, and O. Bousquet. Consistency of spectral clustering. Technical Report TR 134, Max Planck

[42] U. von Luxburg, M. Belkin, and O. Bousquet. Consistency of spectral clustering. The Annals of Statistics, 36(2):555–

Institute for Biological Cybernetics, 2004.

586, 2008.

[43] Y.-C. Wei and C.-K. Cheng. Towards efﬁcient hierarchical designs by ratio cut partitioning. In Computer-Aided Design,

1989. ICCAD-89. Digest of Technical Papers., 1989 IEEE International Conference on, pages 298–301. IEEE, 1989.

[44] H. Weyl. On the Volume of Tubes. Amer. J. Math., 61(2):461–472, 1939.
[45] S. X. Yu and J. Shi. Multiclass spectral clustering. In Computer Vision, 2003. Proceedings. Ninth IEEE International

Conference on, pages 313–319. IEEE, 2003.

1 DEPARTMENT OF MATHEMATICAL SCIENCES, CARNEGIE MELLON UNIVERSITY, PITTSBURGH, PA, 15213, USA.,

TEL. +412 268-2545, EMAILS: NGARCIAT@ANDREW.CMU.EDU, SLEPCEV@MATH.CMU.EDU

2 DEPARTMENT OF MATHEMATICS AND STATISTICS, CALIFORNIA STATE UNIVERSITY, LONG BEACH LONG BEACH,

CA 90840, USA., EMAIL: JAMES.VONBRECHT@CSULB.EDU

3 DEPARTMENT OF MATHEMATICS, LOYOLA MARYMOUNT UNIVERSITY, 1 LMU DR, LOS ANGELES, CA 90045,

USA., EMAIL: THOMAS.LAURENT@LMU.EDU

4 INSTITUTE OF ELECTRICAL ENGINEERING, SWISS FEDERAL INSTITUTE OF TECHNOLOGY (EPFL), 1015 LAU-

SANNE, SWITZERLAND, EMAIL: XAVIER.BRESSON@EPFL.CH

